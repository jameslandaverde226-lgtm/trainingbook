--- FILE: ./app/api/create-user/route.ts ---
import { NextResponse } from 'next/server';
import { getAdminAuth, getAdminDb } from '@/lib/firebase-admin'; 

export async function POST(request: Request) {
  try {
    const adminAuth = getAdminAuth();
    const adminDb = getAdminDb();
    const { name, email, password, role, linkedMemberId } = await request.json();

    if (!email || !password || !linkedMemberId) {
      return NextResponse.json({ error: 'Missing required fields' }, { status: 400 });
    }

    console.log(`[API] Processing user: ${linkedMemberId} (${email})`);

    // --- 1. CHECK IF USER EXISTS ---
    let userRecord;
    try {
      userRecord = await adminAuth.getUser(linkedMemberId);
      console.log(`[API] Found existing user: ${userRecord.uid}. Updating...`);
    } catch (error: any) {
      if (error.code === 'auth/user-not-found') {
        console.log(`[API] User not found. Creating new...`);
        userRecord = null;
      } else {
        throw error;
      }
    }

    // --- 2. CREATE OR UPDATE ---
    if (userRecord) {
      // UPDATE EXISTING
      await adminAuth.updateUser(linkedMemberId, {
        email,
        password,
        displayName: name,
      });
    } else {
      // CREATE NEW
      // Note: We deliberately set the UID to match the teamMember ID
      userRecord = await adminAuth.createUser({
        uid: linkedMemberId,
        email,
        password,
        displayName: name,
      });
    }

    // --- 3. SET CLAIMS & FIRESTORE ---
    await adminAuth.setCustomUserClaims(linkedMemberId, { role });

    await adminDb.collection('teamMembers').doc(linkedMemberId).set({
      email,
      status: role,
      hasLogin: true, 
      updatedAt: new Date()
    }, { merge: true });

    return NextResponse.json({ success: true, uid: linkedMemberId, action: userRecord ? "updated" : "created" });

  } catch (error: any) {
    console.error('[API] Create/Update Error:', error);
    return NextResponse.json({ 
      error: error.message || "Failed to process user account." 
    }, { status: 500 });
  }
}
--- FILE: ./app/manifest.ts ---
// app/manifest.ts
import type { MetadataRoute } from 'next'

export default function manifest(): MetadataRoute.Manifest {
  return {
    name: 'TrainingBook Command',
    short_name: 'Trainingbook',
    description: 'Operational Management System',
    start_url: '/',
    display: 'standalone',
    background_color: '#0F172A', // Slate 900 matches your app theme
    theme_color: '#0F172A',
    orientation: 'portrait',
    icons: [
      {
        src: '/web-app-manifest-192x192.png',
        sizes: '192x192',
        type: 'image/png',
        purpose: 'maskable'
      },
      {
        src: '/web-app-manifest-512x512.png',
        sizes: '512x512',
        type: 'image/png',
        purpose: 'maskable'
      }
    ],
  }
}
--- FILE: ./app/(main)/settings/_components/PermissionToggle.tsx ---
// app/(main)/settings/_components/PermissionToggle.tsx
"use client";

import { motion } from "framer-motion";
import { cn } from "@/lib/utils";

interface Props {
    label: string;
    description: string;
    isEnabled: boolean;
    onToggle: () => void;
    disabled?: boolean;
}

export function PermissionToggle({ label, description, isEnabled, onToggle, disabled }: Props) {
    return (
        <div className={cn(
            "flex items-center justify-between p-4 rounded-2xl border transition-all duration-200",
            isEnabled 
                ? "bg-white border-[#004F71]/20 shadow-sm" 
                : "bg-slate-50 border-slate-100 opacity-80",
            disabled && "opacity-50 cursor-not-allowed"
        )}>
            <div className="flex-1 pr-4">
                <h4 className={cn("text-xs font-bold uppercase tracking-wider mb-1", isEnabled ? "text-slate-900" : "text-slate-500")}>
                    {label}
                </h4>
                <p className="text-[10px] font-medium text-slate-400 leading-tight">
                    {description}
                </p>
            </div>

            <button
                onClick={onToggle}
                disabled={disabled}
                className={cn(
                    "w-10 h-6 rounded-full relative transition-colors duration-300 flex items-center shrink-0",
                    isEnabled ? "bg-[#004F71]" : "bg-slate-300",
                    disabled ? "cursor-not-allowed" : "cursor-pointer"
                )}
            >
                <motion.div
                    initial={false}
                    animate={{ x: isEnabled ? 18 : 2 }}
                    className="w-5 h-5 bg-white rounded-full shadow-md"
                    transition={{ type: "spring", stiffness: 500, damping: 30 }}
                />
            </button>
        </div>
    );
}
--- FILE: ./app/(main)/settings/page.tsx ---
"use client";

import { useState, useEffect, useMemo } from "react";
import { 
  User, Shield, Fingerprint, Loader2, Camera, Plus, Check, Search, UserPlus, Save,
  ChevronDown, Trash2, RefreshCw, KeyRound, UserMinus, Lock, Unlock, FileKey, BarChart3, Users,
  Terminal, Server, AlertCircle, CheckCircle2, Activity, Mail, Crown, Star, Briefcase, RefreshCcw, Sparkles
} from "lucide-react";
import { AnimatePresence, motion } from "framer-motion";
import { useAppStore } from "@/lib/store/useStore"; 
import { auth, db } from "@/lib/firebase"; 
import { doc, getDoc, setDoc, serverTimestamp, collection, query, orderBy, limit, onSnapshot, updateDoc } from "firebase/firestore";
import { updateProfile, updateEmail, updatePassword, signOut } from "firebase/auth"; 
import toast from "react-hot-toast";
import { ROLE_HIERARCHY, Status, PermissionSet, DEFAULT_PERMISSIONS } from "../calendar/_components/types"; 
import { cn } from "@/lib/utils";
import { PermissionToggle } from "./_components/PermissionToggle";
import { format } from "date-fns";

// --- PERMISSION LABELS MAP ---
const PERMISSION_CONFIG: { key: keyof PermissionSet; label: string; desc: string; category: "ops" | "people" | "system" }[] = [
    { key: "canCreateEvents", label: "Create Missions", desc: "Start new operations or goals.", category: "ops" },
    { key: "canEditEvents", label: "Modify Logs", desc: "Edit details of existing records.", category: "ops" },
    { key: "canDeleteEvents", label: "Expunge Records", desc: "Permanently delete data.", category: "ops" },
    { key: "canViewFullRoster", label: "View Global Roster", desc: "See all staff details.", category: "people" },
    { key: "canCreateUsers", label: "Onboard Operatives", desc: "Create new login accounts.", category: "people" },
    { key: "canPromoteUsers", label: "Promote Rank", desc: "Change security clearance levels.", category: "people" },
    { key: "canAccessSettings", label: "System Config", desc: "Access this settings panel.", category: "system" },
];

export default function SettingsPage() {
  const { currentUser, team } = useAppStore(); 
  
  // Tabs
  const [activeTab, setActiveTab] = useState('identity');
  
  // Identity State
  const [formData, setFormData] = useState({ name: "", email: "", password: "" });
  const [isSaving, setIsSaving] = useState(false);

  // Operations State
  const [newUser, setNewUser] = useState({ name: "", email: "", password: "", role: "Team Member" as Status, dept: "FOH", linkedMemberId: "" });
  const [isCreating, setIsCreating] = useState(false);
  const [memberSearch, setMemberSearch] = useState("");
  const [isRoleDropdownOpen, setIsRoleDropdownOpen] = useState(false);
  
  // NEW: Track if we are editing an existing user to change UI labels
  const [isUpdateMode, setIsUpdateMode] = useState(false);

  // --- ROLE MANAGEMENT STATE ---
  const [selectedRole, setSelectedRole] = useState<Status>("Team Member");
  const [rolePermissions, setRolePermissions] = useState<PermissionSet>(DEFAULT_PERMISSIONS["Team Member"]);
  const [isPermSaving, setIsPermSaving] = useState(false);

  // --- LOGS STATE ---
  const [systemLogs, setSystemLogs] = useState<any[]>([]);

  // --- HIERARCHY LOGIC ---
  const myLevel = ROLE_HIERARCHY[currentUser?.role || "Team Member"] || 0;
  const canCreateAccounts = myLevel >= 2;
  const canManageRoles = myLevel >= 3; 

  // Filter existing members
  const filteredMembers = useMemo(() => {
     return team.filter(m => 
        m.name.toLowerCase().includes(memberSearch.toLowerCase())
     );
  }, [team, memberSearch]);

  // --- UPDATED FILTER: Only show users who ACTUALLY have login access ---
  const activeUsers = useMemo(() => {
      return team.filter(m => m.hasLogin === true).sort((a, b) => {
          // Sort by Rank High -> Low
          return (ROLE_HIERARCHY[b.role] || 0) - (ROLE_HIERARCHY[a.role] || 0);
      });
  }, [team]);

  useEffect(() => {
    if (currentUser) {
      setFormData(prev => ({
        ...prev,
        name: currentUser.name || "",
        email: currentUser.email || ""
      }));
    }
  }, [currentUser]);

  // Load Permissions on Role Change
  useEffect(() => {
    const loadPermissions = async () => {
        setRolePermissions(DEFAULT_PERMISSIONS[selectedRole]);
    };
    loadPermissions();
  }, [selectedRole]);

  // Load System Logs when on that tab
  useEffect(() => {
      if (activeTab === 'logs') {
          const q = query(collection(db, "systemLogs"), orderBy("timestamp", "desc"), limit(20));
          const unsub = onSnapshot(q, (snapshot) => {
              setSystemLogs(snapshot.docs.map(d => ({ id: d.id, ...d.data() })));
          });
          return () => unsub();
      }
  }, [activeTab]);

  // --- HANDLERS ---
  const handleTogglePermission = (key: keyof PermissionSet) => {
      if (selectedRole === "Director") return; 
      setRolePermissions(prev => ({ ...prev, [key]: !prev[key] }));
  };

  const handleSavePermissions = async () => {
      setIsPermSaving(true);
      try {
          await setDoc(doc(db, "roles", selectedRole), { ...rolePermissions, updatedAt: serverTimestamp() });
          toast.success(`${selectedRole} protocols updated.`);
      } catch (e) {
          toast.error("Failed to update protocols.");
      } finally {
          setIsPermSaving(false);
      }
  };

  const selectMemberForActivation = (member: any) => {
      // DETECT IF USER ALREADY HAS ACCESS
      const alreadyHasLogin = member.hasLogin === true;
      setIsUpdateMode(alreadyHasLogin);

      setNewUser({
          ...newUser,
          name: member.name,
          email: member.email || "", 
          role: member.role || "Team Member",
          dept: member.dept || "FOH",
          linkedMemberId: member.id,
          password: "" // Clear password field for new entry
      });
      setMemberSearch(""); 
      toast.success(alreadyHasLogin ? `Editing Access: ${member.name}` : `Selected: ${member.name}`);
  };

  // --- NEW: MANUALLY CREATE A MEMBER ID IF NOT FOUND ---
  const handleManualCreationSelect = () => {
      const generatedId = `manual_${Date.now()}`; // Simple unique ID
      setIsUpdateMode(false);
      
      setNewUser({
          ...newUser,
          name: memberSearch, 
          email: "",
          role: "Team Member",
          dept: "FOH",
          linkedMemberId: generatedId,
          password: ""
      });
      setMemberSearch("");
      toast.success(`Creating New Profile: ${memberSearch}`);
  };

  const provisionViaApi = async () => {
      if (!currentUser) return;
      if (!formData.password) throw new Error("Password required for initialization.");

      const res = await fetch('/api/create-user', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
              name: formData.name,
              email: formData.email,
              password: formData.password,
              role: currentUser.role, 
              linkedMemberId: currentUser.uid
          })
      });

      const data = await res.json();
      if (!res.ok) throw new Error(data.error || "Provisioning failed");
      return data;
  };

  const handleSaveProfile = async () => {
    if (!currentUser) return;
    
    setIsSaving(true);
    const toastId = toast.loading("Deploying changes...");

    try {
        if (auth.currentUser) {
            try {
                const user = auth.currentUser;
                const updates = [];
                if (formData.email !== user.email) updates.push(updateEmail(user, formData.email));
                if (formData.password) updates.push(updatePassword(user, formData.password));
                if (formData.name !== user.displayName) updates.push(updateProfile(user, { displayName: formData.name }));
                await Promise.all(updates);
                
                toast.success("Identity Updated", { id: toastId });
                setFormData(prev => ({ ...prev, password: "" }));
            } catch (authError: any) {
                if (authError.code === 'auth/user-token-expired' || authError.code === 'auth/requires-recent-login' || authError.code === 'auth/operation-not-allowed') {
                    console.log("Auth session stale, forcing API update...");
                    await provisionViaApi();
                    toast.success("Account Re-initialized. Please Log In.", { id: toastId });
                    await signOut(auth);
                } else {
                    throw authError;
                }
            }
        } else {
            await provisionViaApi();
            toast.success("Account Initialized. Please Log In.", { id: toastId });
        }
        await updateDoc(doc(db, "teamMembers", currentUser.uid), {
            name: formData.name,
            email: formData.email,
            updatedAt: serverTimestamp()
        });
    } catch (error: any) {
        console.error(error);
        toast.error(error.message || "Update Failed", { id: toastId });
    } finally {
        setIsSaving(false);
    }
  };

  const handleCreateUser = async (e: React.FormEvent) => {
      e.preventDefault();
      // Ensure we have an ID (either selected or generated)
      if (!newUser.linkedMemberId) return toast.error("Please select a team member or create a new one.");
      
      setIsCreating(true);
      try {
          let token = "";
          try { token = await auth.currentUser?.getIdToken() || ""; } catch(e) {}
          
          const res = await fetch('/api/create-user', {
              method: 'POST',
              headers: { 
                  'Content-Type': 'application/json',
                  'Authorization': token ? `Bearer ${token}` : '' 
              },
              body: JSON.stringify(newUser)
          });

          const data = await res.json();
          if (!res.ok) throw new Error(data.error);

          toast.success(isUpdateMode ? `Credentials Updated: ${newUser.name}` : `Access Granted: ${newUser.name}`);
          setNewUser({ name: "", email: "", password: "", role: "Team Member", dept: "FOH", linkedMemberId: "" });
          setIsUpdateMode(false);
      } catch (error: any) {
          toast.error(error.message || "Failed to create operative");
      } finally {
          setIsCreating(false);
      }
  };

  const handleRevokeAccess = async (userId: string) => {
     if(!confirm("Are you sure you want to revoke login access? This cannot be undone from the dashboard.")) return;
     try {
         await updateDoc(doc(db, "teamMembers", userId), { hasLogin: false });
         toast.success("Access Revoked");
     } catch(e) {
         toast.error("Failed to revoke");
     }
  };

  const availableRoles = [
      { id: "Team Member", label: "Team Member (Lvl 0)", level: 0 },
      { id: "Team Leader", label: "Team Leader (Lvl 1)", level: 1 },
      { id: "Assistant Director", label: "Assistant Director (Lvl 2)", level: 2 },
      { id: "Director", label: "Director (Lvl 3)", level: 3 },
  ].filter(r => r.level < myLevel || myLevel === 4); 

  // --- HELPER: Role Styling ---
  const getRoleStyle = (role: string) => {
      switch(role) {
          case 'Admin': return "bg-slate-900 text-white border-slate-700";
          case 'Director': return "bg-[#004F71] text-white border-[#004F71]";
          case 'Assistant Director': return "bg-blue-50 text-[#004F71] border-blue-100";
          case 'Team Leader': return "bg-amber-50 text-amber-600 border-amber-100";
          default: return "bg-slate-50 text-slate-500 border-slate-100";
      }
  };

  const getRoleIcon = (role: string) => {
      switch(role) {
          case 'Admin': return Crown;
          case 'Director': return Shield;
          case 'Assistant Director': return Briefcase;
          case 'Team Leader': return Star;
          default: return User;
      }
  };

  if (!currentUser) return <div className="flex h-screen items-center justify-center bg-[#F8FAFC]"><Loader2 className="w-8 h-8 animate-spin text-[#E51636]" /></div>;

  const NAV_ITEMS = [
      { id: 'identity', label: 'Identity', icon: User, visible: true },
      { id: 'ops', label: 'Operations', icon: Fingerprint, visible: canCreateAccounts }, 
      { id: 'roles', label: 'Access Control', icon: FileKey, visible: canManageRoles }, 
      { id: 'logs', label: 'System Logs', icon: Terminal, visible: true },
  ];

  return (
    <div className="min-h-screen bg-[#F8FAFC] pb-32">
      
      {/* --- DESKTOP SPACER (Since Layout adds padding, we adjust here) --- */}
      <div className="hidden lg:block h-12" />

      <div className="max-w-6xl mx-auto space-y-6 lg:space-y-8 px-4 md:px-8 lg:px-12 pt-6 lg:pt-0">
        
        {/* HEADER */}
        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-6">
            <div>
                <div className="flex items-center gap-3 mb-2">
                    <div className="w-1 h-6 bg-[#E51636]" />
                    <span className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">System Configuration</span>
                </div>
                <h1 className="text-3xl lg:text-5xl font-[1000] text-slate-900 tracking-tighter">Command Settings</h1>
            </div>
            
            {/* Desktop Action Buttons */}
            <div className="hidden lg:block">
                {activeTab === 'identity' && (
                    <button onClick={handleSaveProfile} disabled={isSaving} className="px-8 py-4 bg-[#E51636] hover:bg-red-600 text-white rounded-2xl font-black uppercase text-[10px] tracking-[0.25em] shadow-lg shadow-red-500/20 transition-all flex items-center gap-3 active:scale-95 disabled:opacity-50">
                        {isSaving ? <Loader2 className="w-4 h-4 animate-spin" /> : <Save className="w-4 h-4" />}
                        Deploy Changes
                    </button>
                )}
                
                {activeTab === 'roles' && (
                    <button onClick={handleSavePermissions} disabled={isPermSaving} className="px-8 py-4 bg-[#004F71] text-white rounded-2xl font-black uppercase text-[10px] tracking-[0.25em] shadow-lg shadow-blue-900/20 transition-all flex items-center gap-3 active:scale-95 disabled:opacity-50">
                        {isPermSaving ? <Loader2 className="w-4 h-4 animate-spin" /> : <Save className="w-4 h-4" />}
                        Save Protocols
                    </button>
                )}
            </div>
        </div>

        <div className="flex flex-col lg:flex-row gap-6 lg:gap-8 items-start">
            
            {/* DESKTOP SIDEBAR */}
            <div className="hidden lg:block w-64 shrink-0 space-y-2 sticky top-24">
                {NAV_ITEMS.filter(i => i.visible).map((item) => (
                    <button 
                        key={item.id}
                        onClick={() => setActiveTab(item.id)}
                        className={cn(
                            "w-full flex items-center gap-4 p-4 rounded-2xl text-xs font-bold uppercase tracking-wider transition-all",
                            activeTab === item.id 
                            ? "bg-[#004F71] text-white shadow-lg shadow-blue-900/20" 
                            : "bg-white text-slate-400 hover:bg-white/80 hover:text-slate-600"
                        )}
                    >
                        <item.icon className={cn("w-4 h-4", activeTab === item.id ? "text-white" : "text-slate-300")} />
                        {item.label}
                    </button>
                ))}
            </div>

            {/* MOBILE HORIZONTAL TABS (Sticky under Header) */}
            <div className="lg:hidden w-full sticky top-16 z-30 bg-[#F8FAFC]/95 backdrop-blur-md pb-2 -mx-4 px-4 overflow-x-auto no-scrollbar flex items-center gap-2">
                {NAV_ITEMS.filter(i => i.visible).map((item) => (
                     <button
                        key={item.id}
                        onClick={() => setActiveTab(item.id)}
                        className={cn(
                            "flex items-center gap-2 px-4 py-3 rounded-full text-[10px] font-black uppercase tracking-widest whitespace-nowrap border transition-all shadow-sm",
                            activeTab === item.id 
                                ? "bg-[#004F71] text-white border-[#004F71]" 
                                : "bg-white text-slate-500 border-slate-200"
                        )}
                     >
                         <item.icon className={cn("w-3 h-3", activeTab === item.id ? "text-white" : "text-slate-400")} />
                         {item.label}
                     </button>
                ))}
            </div>

            {/* 
                ==================================
                CONTENT AREA 
                ==================================
            */}
            <div className="flex-1 w-full space-y-6">
                
                {/* --- TAB: IDENTITY --- */}
                {activeTab === 'identity' && (
                    <div className="bg-white rounded-[32px] md:rounded-[40px] p-6 md:p-12 shadow-sm border border-slate-100">
                         <div className="mb-8 md:mb-10">
                            <h2 className="text-xl md:text-2xl font-[1000] text-slate-900 tracking-tight">Operator Identity</h2>
                            <p className="text-xs md:text-sm font-medium text-slate-400 mt-1">Manage your administrative profile.</p>
                        </div>
                        {/* ... (Identity Content Unchanged) ... */}
                        <div className="flex flex-col md:flex-row gap-8 md:gap-10 items-center md:items-start">
                            <div className="relative group shrink-0">
                                <div className="w-24 h-24 md:w-40 md:h-40 rounded-[24px] md:rounded-[32px] bg-slate-100 border-4 border-white shadow-xl flex items-center justify-center overflow-hidden">
                                    {currentUser.image ? (
                                        <img src={currentUser.image} alt="Profile" className="w-full h-full object-cover" />
                                    ) : (
                                        <span className="text-3xl md:text-4xl font-black text-slate-300">{currentUser.name?.charAt(0) || "U"}</span>
                                    )}
                                </div>
                                <button className="absolute -bottom-2 -right-2 md:-bottom-3 md:-right-3 p-2 md:p-3 bg-slate-900 text-white rounded-xl shadow-lg hover:scale-110 transition-transform">
                                    <Camera className="w-3.5 h-3.5 md:w-4 md:h-4" />
                                </button>
                            </div>

                            <div className="flex-1 w-full space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                                    <div className="space-y-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">Display Name</label>
                                        <div className="relative">
                                            <input 
                                                value={formData.name}
                                                onChange={(e) => setFormData({...formData, name: e.target.value})}
                                                className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all"
                                            />
                                            <User className="absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-300" />
                                        </div>
                                    </div>

                                    <div className="space-y-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">Administrative Email</label>
                                        <div className="relative">
                                            <input 
                                                value={formData.email}
                                                onChange={(e) => setFormData({...formData, email: e.target.value})}
                                                className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all"
                                            />
                                        </div>
                                    </div>

                                    <div className="space-y-2 col-span-1 md:col-span-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">
                                            {auth.currentUser ? "Change Password" : "Set Initial Password"}
                                        </label>
                                        <div className="relative group">
                                            <input 
                                                type="password"
                                                value={formData.password}
                                                onChange={(e) => setFormData({...formData, password: e.target.value})}
                                                placeholder={auth.currentUser ? "Enter new password to change..." : "Create password to enable login..."}
                                                className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all"
                                            />
                                            <KeyRound className="absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-300 group-focus-within:text-[#E51636] transition-colors" />
                                        </div>
                                    </div>
                                </div>
                                <div className="p-4 bg-blue-50/50 rounded-2xl border border-blue-100/50 flex items-start gap-4">
                                    <div className="p-2 bg-blue-100 text-[#004F71] rounded-lg"><Shield className="w-4 h-4" /></div>
                                    <div>
                                        <p className="text-xs font-black text-[#004F71] uppercase tracking-wide mb-0.5">Rank: {currentUser.role}</p>
                                        <p className="text-[11px] font-medium text-slate-500">Level {myLevel} Access Clearance.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                )}

                {/* --- TAB: OPERATIONS (Create & Manage) --- */}
                {activeTab === 'ops' && canCreateAccounts && (
                    <div className="space-y-6">
                        {/* 1. ONBOARDING CARD */}
                        <div className="bg-white rounded-[32px] md:rounded-[40px] p-6 md:p-12 shadow-sm border border-slate-100">
                            <div className="mb-8 md:mb-10 flex items-center justify-between">
                                <div>
                                    <h2 className="text-xl md:text-2xl font-[1000] text-slate-900 tracking-tight">Personnel Onboarding</h2>
                                    <p className="text-xs md:text-sm font-medium text-slate-400 mt-1">Grant system access to existing team members.</p>
                                </div>
                                <div className={cn("p-2 md:p-3 rounded-2xl transition-colors", isUpdateMode ? "bg-amber-50 text-amber-600" : "bg-emerald-50 text-emerald-600")}>
                                    {isUpdateMode ? <RefreshCcw className="w-5 h-5 md:w-6 md:h-6" /> : <UserPlus className="w-5 h-5 md:w-6 md:h-6" />}
                                </div>
                            </div>

                            {/* --- TEAM MEMBER SELECTOR --- */}
                            <div className="mb-8 p-4 md:p-6 bg-slate-50 rounded-[24px] md:rounded-3xl border border-slate-200">
                                <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] mb-3 block flex items-center gap-2">
                                    <Search className="w-3 h-3" /> Select Team Member to Activate
                                </label>
                                <div className="relative group">
                                    <input 
                                        value={memberSearch}
                                        onChange={(e) => setMemberSearch(e.target.value)}
                                        placeholder="Search roster..."
                                        className="w-full bg-white border border-slate-200 rounded-2xl px-5 py-3 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all"
                                    />
                                    {memberSearch.length > 0 && (
                                        <div className="absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-xl border border-slate-100 max-h-48 overflow-y-auto z-20">
                                            {filteredMembers.length > 0 ? (
                                                filteredMembers.map(m => (
                                                    <button 
                                                        key={m.id}
                                                        onClick={() => selectMemberForActivation(m)}
                                                        className="w-full text-left px-4 md:px-5 py-3 hover:bg-slate-50 text-sm font-bold text-slate-700 flex justify-between items-center gap-3"
                                                    >
                                                        {/* FIXED: Truncation for long names on mobile */}
                                                        <div className="flex items-center gap-2 min-w-0 overflow-hidden">
                                                            <span className="truncate">{m.name}</span>
                                                            {m.hasLogin && (
                                                                <span className="shrink-0 px-1.5 py-0.5 rounded bg-blue-50 text-blue-600 text-[8px] font-black uppercase">
                                                                    Active
                                                                </span>
                                                            )}
                                                        </div>
                                                        <span className="shrink-0 text-[9px] md:text-[10px] uppercase text-slate-400 bg-slate-100 px-2 py-1 rounded-md whitespace-nowrap">
                                                            {m.role}
                                                        </span>
                                                    </button>
                                                ))
                                            ) : (
                                                /* --- CREATE NEW OPTION --- */
                                                <button 
                                                    onClick={handleManualCreationSelect}
                                                    className="w-full text-left px-5 py-4 hover:bg-emerald-50 text-sm font-bold text-slate-600 flex items-center gap-3 transition-colors"
                                                >
                                                    <div className="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600">
                                                        <Plus className="w-4 h-4" />
                                                    </div>
                                                    <div>
                                                        <p className="text-emerald-700">Create New: &quot;{memberSearch}&quot;</p>
                                                        <p className="text-[10px] font-medium text-emerald-600/70">Add manual entry to database</p>
                                                    </div>
                                                </button>
                                            )}
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            {/* ... FORM CONTENT ... */}
                            <div className="w-full h-px bg-slate-100 mb-8" />
                            <form onSubmit={handleCreateUser} className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div className="space-y-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">Operative Name</label>
                                        <input required value={newUser.name} onChange={e => setNewUser({...newUser, name: e.target.value})} placeholder="e.g. John Doe" className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all" />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">Secure Email</label>
                                        <input required type="email" value={newUser.email} onChange={e => setNewUser({...newUser, email: e.target.value})} placeholder="john@trainingbook.com" className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all" />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">
                                            {isUpdateMode ? "New Password" : "Initial Password"}
                                        </label>
                                        <input required type="password" value={newUser.password} onChange={e => setNewUser({...newUser, password: e.target.value})} placeholder="••••••••" className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all" />
                                    </div>
                                    
                                    <div className="space-y-2 relative">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">Clearance Level</label>
                                        <button 
                                            type="button"
                                            onClick={() => setIsRoleDropdownOpen(!isRoleDropdownOpen)}
                                            className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-sm font-bold text-slate-900 outline-none focus:border-[#E51636] transition-all flex items-center justify-between"
                                        >
                                            <span>{availableRoles.find(r => r.id === newUser.role)?.label || newUser.role}</span>
                                            <ChevronDown className={cn("w-4 h-4 text-slate-400 transition-transform", isRoleDropdownOpen && "rotate-180")} />
                                        </button>
                                        
                                        <AnimatePresence>
                                            {isRoleDropdownOpen && (
                                                <motion.div 
                                                    initial={{ opacity: 0, y: 5 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 5 }}
                                                    className="absolute top-full left-0 right-0 mt-2 bg-white border border-slate-100 rounded-2xl shadow-xl z-30 overflow-hidden"
                                                >
                                                    {availableRoles.map(role => (
                                                        <button
                                                            key={role.id}
                                                            type="button"
                                                            onClick={() => { setNewUser({...newUser, role: role.id as Status}); setIsRoleDropdownOpen(false); }}
                                                            className="w-full text-left px-5 py-3 hover:bg-slate-50 text-sm font-bold text-slate-700 flex items-center gap-2"
                                                        >
                                                            <span className={cn("w-2 h-2 rounded-full", newUser.role === role.id ? "bg-[#004F71]" : "bg-slate-200")} />
                                                            {role.label}
                                                        </button>
                                                    ))}
                                                </motion.div>
                                            )}
                                        </AnimatePresence>
                                    </div>

                                    <div className="space-y-2">
                                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] pl-1">Unit Assignment</label>
                                        <div className="flex gap-4">
                                            {['FOH', 'BOH'].map(dept => (
                                                <button 
                                                    key={dept}
                                                    type="button"
                                                    onClick={() => setNewUser({...newUser, dept})}
                                                    className={`flex-1 py-4 rounded-2xl text-xs font-black uppercase tracking-widest border transition-all ${newUser.dept === dept ? (dept === 'FOH' ? 'bg-[#004F71] text-white border-[#004F71]' : 'bg-[#E51636] text-white border-[#E51636]') : 'bg-white border-slate-200 text-slate-400'}`}
                                                >
                                                    {dept}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                                
                                <button 
                                    type="submit"
                                    disabled={isCreating}
                                    className={cn(
                                        "w-full py-5 text-white rounded-2xl font-black uppercase text-xs tracking-[0.3em] shadow-xl hover:scale-[1.01] active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50",
                                        isUpdateMode ? "bg-[#004F71] hover:bg-[#003b55]" : "bg-slate-900 hover:bg-black"
                                    )}
                                >
                                    {isCreating ? <Loader2 className="w-4 h-4 animate-spin" /> : isUpdateMode ? <RefreshCcw className="w-4 h-4" /> : <Sparkles className="w-4 h-4" />}
                                    {isUpdateMode ? "Update Credentials" : "Create & Initialize"}
                                </button>
                            </form>
                        </div>
                        
                        {/* 2. MANAGE ACTIVE ACCOUNTS (Same as previous) */}
                        <div className="bg-white rounded-[32px] md:rounded-[40px] p-6 md:p-12 shadow-sm border border-slate-100">
                             <div className="mb-8 flex items-center justify-between">
                                <div>
                                    <h2 className="text-xl md:text-2xl font-[1000] text-slate-900 tracking-tight">Active Accounts</h2>
                                    <p className="text-xs font-medium text-slate-400 mt-1">Users with authenticated system login.</p>
                                </div>
                                <div className="p-2.5 bg-slate-100 text-slate-500 rounded-xl">
                                    <KeyRound className="w-5 h-5" />
                                </div>
                            </div>
                            {/* ... List of users ... */}
                            <div className="space-y-3">
                                {activeUsers.length > 0 ? activeUsers.map(user => {
                                    const RoleIcon = getRoleIcon(user.role);
                                    return (
                                        <div key={user.id} className="group flex items-center p-4 bg-white border border-slate-100 rounded-3xl hover:shadow-md hover:border-slate-200 transition-all">
                                            {/* Avatar Area */}
                                            <div className="relative shrink-0">
                                                <div className="w-12 h-12 rounded-2xl bg-slate-50 border border-slate-100 flex items-center justify-center overflow-hidden">
                                                    {user.image && !user.image.includes('ui-avatars') ? (
                                                        <img src={user.image} alt={user.name} className="w-full h-full object-cover" />
                                                    ) : (
                                                        <span className="text-lg font-black text-slate-300">{user.name.charAt(0)}</span>
                                                    )}
                                                </div>
                                                <div className={cn("absolute -bottom-1 -right-1 p-1 rounded-full border-2 border-white", user.dept === 'FOH' ? "bg-[#004F71]" : "bg-[#E51636]")}>
                                                    <RoleIcon className="w-2.5 h-2.5 text-white" />
                                                </div>
                                            </div>

                                            {/* Info Area */}
                                            <div className="flex-1 ml-4 min-w-0">
                                                <div className="flex items-center gap-2 mb-0.5">
                                                    <h3 className="text-sm font-bold text-slate-900 truncate">{user.name}</h3>
                                                    <span className={cn("px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-widest border", getRoleStyle(user.role))}>
                                                        {user.role}
                                                    </span>
                                                </div>
                                                <div className="flex items-center gap-2 text-slate-400">
                                                    <Mail className="w-3 h-3" />
                                                    <p className="text-[10px] font-medium truncate">{user.email}</p>
                                                </div>
                                            </div>

                                            {/* Actions Area */}
                                            <div className="flex items-center gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                                                <button 
                                                    onClick={() => selectMemberForActivation(user)}
                                                    className="p-2.5 rounded-xl text-slate-400 hover:bg-slate-50 hover:text-slate-600 transition-colors" 
                                                    title="Edit Password"
                                                >
                                                    <RefreshCw className="w-4 h-4" />
                                                </button>
                                                <button 
                                                    onClick={() => handleRevokeAccess(user.id)}
                                                    className="p-2.5 rounded-xl text-slate-400 hover:bg-red-50 hover:text-red-500 transition-colors" 
                                                    title="Revoke Access"
                                                >
                                                    <Trash2 className="w-4 h-4" />
                                                </button>
                                            </div>
                                        </div>
                                    );
                                }) : (
                                    <div className="text-center py-12 text-slate-400 border-2 border-dashed border-slate-100 rounded-3xl">
                                        <Users className="w-8 h-8 mx-auto mb-2 opacity-50" />
                                        <p className="text-xs font-bold uppercase tracking-widest">No active logins found</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                )}

                {/* --- TAB: ROLES (RBAC) --- */}
                {activeTab === 'roles' && canManageRoles && (
                    <div className="bg-white rounded-[32px] md:rounded-[40px] p-6 md:p-12 shadow-sm border border-slate-100">
                         {/* (Existing role content preserved) */}
                        <div className="mb-10">
                            <h2 className="text-2xl font-[1000] text-slate-900 tracking-tight">Access Protocols</h2>
                            <p className="text-sm font-medium text-slate-400 mt-1">Configure capability matrix for each rank.</p>
                        </div>
                        {/* ... Role Selector and Permissions Grid (Unchanged from prev) ... */}
                        <div className="flex p-1.5 bg-slate-100 rounded-2xl mb-8 overflow-x-auto no-scrollbar">
                            {["Team Member", "Team Leader", "Assistant Director", "Director"].map((role) => (
                                <button
                                    key={role}
                                    onClick={() => setSelectedRole(role as Status)}
                                    className={cn(
                                        "flex-1 px-4 py-3 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all whitespace-nowrap",
                                        selectedRole === role 
                                            ? "bg-white text-slate-900 shadow-sm" 
                                            : "text-slate-400 hover:text-slate-600"
                                    )}
                                >
                                    {role.replace("Assistant", "Asst.")}
                                </button>
                            ))}
                        </div>

                        <div className="space-y-8">
                             {/* ... Permission Toggles ... */}
                             {/* CATEGORY: OPERATIONS */}
                            <div>
                                <div className="flex items-center gap-2 mb-4 px-1">
                                    <Fingerprint className="w-4 h-4 text-[#004F71]" />
                                    <span className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Operational Access</span>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    {PERMISSION_CONFIG.filter(p => p.category === "ops").map(p => (
                                        <PermissionToggle 
                                            key={p.key} 
                                            label={p.label} 
                                            description={p.desc} 
                                            isEnabled={rolePermissions[p.key]} 
                                            onToggle={() => handleTogglePermission(p.key)}
                                            disabled={selectedRole === "Director"}
                                        />
                                    ))}
                                </div>
                            </div>

                            {/* CATEGORY: PEOPLE */}
                            <div>
                                <div className="flex items-center gap-2 mb-4 px-1">
                                    <Users className="w-4 h-4 text-[#E51636]" />
                                    <span className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Personnel Management</span>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    {PERMISSION_CONFIG.filter(p => p.category === "people").map(p => (
                                        <PermissionToggle 
                                            key={p.key} 
                                            label={p.label} 
                                            description={p.desc} 
                                            isEnabled={rolePermissions[p.key]} 
                                            onToggle={() => handleTogglePermission(p.key)}
                                            disabled={selectedRole === "Director"}
                                        />
                                    ))}
                                </div>
                            </div>

                            {/* CATEGORY: SYSTEM */}
                            <div>
                                <div className="flex items-center gap-2 mb-4 px-1">
                                    <Shield className="w-4 h-4 text-slate-900" />
                                    <span className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">System Intelligence</span>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    {PERMISSION_CONFIG.filter(p => p.category === "system").map(p => (
                                        <PermissionToggle 
                                            key={p.key} 
                                            label={p.label} 
                                            description={p.desc} 
                                            isEnabled={rolePermissions[p.key]} 
                                            onToggle={() => handleTogglePermission(p.key)}
                                            disabled={selectedRole === "Director"}
                                        />
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                )}
                
                {/* --- TAB: SYSTEM LOGS --- */}
                {activeTab === 'logs' && (
                    <div className="bg-white rounded-[32px] md:rounded-[40px] p-6 md:p-12 shadow-sm border border-slate-100 relative overflow-hidden">
                        {/* Header */}
                        <div className="mb-8 relative z-10 flex items-center justify-between">
                            <div>
                                <h2 className="text-xl md:text-2xl font-[1000] text-slate-900 tracking-tight">System Logs</h2>
                                <p className="text-xs md:text-sm font-medium text-slate-400 mt-1">Real-time uplink from backend services.</p>
                            </div>
                            <div className="p-3 bg-slate-100 rounded-2xl">
                                <Activity className="w-6 h-6 text-slate-400" />
                            </div>
                        </div>

                        {/* Terminal / Log Viewer */}
                        <div className="bg-slate-50 rounded-[24px] border border-slate-200 p-2 relative z-10 font-mono overflow-hidden shadow-inner">
                            {/* Toolbar */}
                            <div className="flex items-center justify-between px-4 py-3 border-b border-slate-200/60 bg-white/50 rounded-t-[18px]">
                                <div className="flex items-center gap-2">
                                    <div className="w-2.5 h-2.5 rounded-full bg-slate-300" />
                                    <div className="w-2.5 h-2.5 rounded-full bg-slate-300" />
                                    <div className="w-2.5 h-2.5 rounded-full bg-slate-300" />
                                    <span className="ml-3 text-[10px] text-slate-400 font-bold uppercase tracking-widest">Connection: Active</span>
                                </div>
                                <span className="text-[9px] font-black text-slate-300 uppercase">TrainingBook Kernel v4.2</span>
                            </div>

                            {/* Logs List */}
                            <div className="p-3 space-y-2 max-h-[500px] overflow-y-auto custom-scrollbar">
                                {systemLogs.length > 0 ? systemLogs.map((log) => (
                                    <div key={log.id} className="group flex items-start gap-4 p-4 rounded-2xl bg-white border border-slate-100 shadow-sm transition-all hover:shadow-md hover:border-slate-200">
                                        <div className={cn(
                                            "shrink-0 w-10 h-10 rounded-xl flex items-center justify-center mt-0.5",
                                            log.status === "SUCCESS" ? "bg-emerald-50 text-emerald-600" : "bg-red-50 text-red-600"
                                        )}>
                                            {log.status === "SUCCESS" ? <CheckCircle2 className="w-5 h-5" /> : <AlertCircle className="w-5 h-5" />}
                                        </div>
                                        <div className="flex-1 min-w-0">
                                            <div className="flex items-center gap-3 mb-1.5">
                                                <span className={cn(
                                                    "text-[8px] font-black uppercase tracking-widest px-2 py-0.5 rounded-md border",
                                                    log.status === "SUCCESS" ? "bg-emerald-50 border-emerald-100 text-emerald-700" : "bg-red-50 border-red-100 text-red-700"
                                                )}>
                                                    {log.status}
                                                </span>
                                                <span className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">
                                                    {log.timestamp?.toDate ? format(log.timestamp.toDate(), "MMM dd • HH:mm:ss") : "Just now"}
                                                </span>
                                            </div>
                                            <p className="text-xs text-slate-600 font-medium break-all leading-relaxed font-sans">
                                                {log.message}
                                            </p>
                                        </div>
                                    </div>
                                )) : (
                                    <div className="py-20 flex flex-col items-center justify-center text-slate-400">
                                        <Loader2 className="w-10 h-10 animate-spin mb-4 opacity-20" />
                                        <p className="text-xs font-bold uppercase tracking-widest opacity-50">Waiting for uplink...</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                )}

            </div>
            
            {/* MOBILE SAVE BUTTON (Fixed Bottom - Raised to clear nav dock) */}
            <div className="lg:hidden fixed bottom-28 left-0 right-0 px-4 z-40 pointer-events-none">
                 <div className="pointer-events-auto">
                    {activeTab === 'identity' && (
                        <button onClick={handleSaveProfile} disabled={isSaving} className="w-full py-4 bg-[#E51636] hover:bg-red-600 text-white rounded-2xl font-black uppercase text-[10px] tracking-[0.25em] shadow-xl shadow-red-500/20 flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50">
                            {isSaving ? <Loader2 className="w-4 h-4 animate-spin" /> : <Save className="w-4 h-4" />}
                            Deploy Changes
                        </button>
                    )}
                    
                    {activeTab === 'roles' && (
                        <button onClick={handleSavePermissions} disabled={isPermSaving} className="w-full py-4 bg-[#004F71] text-white rounded-2xl font-black uppercase text-[10px] tracking-[0.25em] shadow-xl shadow-blue-900/20 flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50">
                            {isPermSaving ? <Loader2 className="w-4 h-4 animate-spin" /> : <Save className="w-4 h-4" />}
                            Save Protocols
                        </button>
                    )}
                 </div>
            </div>

        </div>
      </div>
    </div>
  );
}
--- FILE: ./app/(main)/calendar/_components/AdvancedCreateModal.tsx ---
"use client";

import { useState, useEffect, useMemo } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { 
  X, Target, Shield, Zap, MessageSquare, 
  ChevronRight, Calendar as CalendarIcon, 
  Clock, Flag, FileText, User, Sparkles, 
  Search, ChevronLeft, ChevronDown, Check, AlertCircle
} from "lucide-react";
import { 
  format, addDays, startOfToday, isSameDay, 
  startOfMonth, endOfMonth, eachDayOfInterval, 
  startOfWeek, endOfWeek, addMonths, subMonths,
  isBefore, isAfter, isWithinInterval 
} from "date-fns";
import { cn } from "@/lib/utils";
import { useAppStore } from "@/lib/store/useStore";
import { db } from "@/lib/firebase";
import { collection, addDoc, serverTimestamp } from "firebase/firestore";
import toast from "react-hot-toast";
import ClientPortal from "@/components/core/ClientPortal";
import { EventType } from "./types";

interface Props {
  isOpen: boolean;
  onClose: () => void;
  preselectedDate?: Date;
  preselectedMemberId?: string;
}

// --- CONFIGURATION ---
const EVENT_TYPES: { id: EventType; label: string; icon: any; color: string; bg: string; border: string }[] = [
  { id: "Goal", label: "Strategic Goal", icon: Target, color: "text-emerald-500", bg: "bg-emerald-50", border: "border-emerald-200" },
  { id: "Deadline", label: "Hard Deadline", icon: Zap, color: "text-[#E51636]", bg: "bg-red-50", border: "border-red-200" },
  { id: "Training", label: "Training Module", icon: Shield, color: "text-[#004F71]", bg: "bg-blue-50", border: "border-blue-200" },
  { id: "OneOnOne", label: "1-on-1 Session", icon: MessageSquare, color: "text-purple-500", bg: "bg-purple-50", border: "border-purple-200" },
];

const PRIORITIES = [
  { id: "Low", label: "Low Impact", color: "text-slate-500", bg: "bg-slate-100" },
  { id: "Medium", label: "Medium", color: "text-amber-500", bg: "bg-amber-50" },
  { id: "High", label: "Critical", color: "text-[#E51636]", bg: "bg-red-50" },
] as const;

// --- CUSTOM SEARCHABLE SELECT COMPONENT ---
function MemberSelect({ 
    label, 
    value, 
    onChange, 
    options, 
    disabled = false, 
    placeholder = "Select...",
    zIndex = 20
}: { 
    label: string, 
    value: string, 
    onChange: (val: string) => void, 
    options: {id: string, name: string, dept: string}[], 
    disabled?: boolean,
    placeholder?: string,
    zIndex?: number
}) {
    const [isOpen, setIsOpen] = useState(false);
    const [search, setSearch] = useState("");
    const selectedOption = options.find(o => o.id === value);

    // FILTER LOGIC: Exclude "Unassigned" members
    const filteredOptions = options.filter(o => 
        o.name.toLowerCase().includes(search.toLowerCase()) && 
        o.dept !== "Unassigned"
    );

    return (
        <div className={cn("space-y-1.5 relative")} style={{ zIndex }}>
            <span className="text-[9px] font-black text-slate-400 uppercase tracking-wider ml-1">{label}</span>
            <div className="relative">
                <button
                    onClick={() => !disabled && setIsOpen(!isOpen)}
                    disabled={disabled}
                    className={cn(
                        "w-full flex items-center justify-between bg-white border rounded-xl px-4 py-3 text-xs font-bold transition-all text-left relative z-10",
                        disabled ? "bg-slate-100 border-slate-200 text-slate-400 cursor-not-allowed" : "border-slate-200 text-slate-900 hover:border-slate-300 focus:ring-2 focus:ring-blue-500/20"
                    )}
                >
                    <span className="truncate">{selectedOption ? selectedOption.name : placeholder}</span>
                    <ChevronDown className={cn("w-4 h-4 text-slate-400 transition-transform", isOpen && "rotate-180")} />
                </button>

                <AnimatePresence>
                    {isOpen && (
                        <>
                            <div className="fixed inset-0 z-[100]" onClick={() => setIsOpen(false)} />
                            <motion.div
                                initial={{ opacity: 0, y: 5 }}
                                animate={{ opacity: 1, y: 0 }}
                                exit={{ opacity: 0, y: 5 }}
                                className="absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-slate-100 overflow-hidden z-[110] flex flex-col max-h-[240px]"
                            >
                                <div className="p-2 border-b border-slate-50 sticky top-0 bg-white">
                                    <div className="relative">
                                        <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400" />
                                        <input 
                                            autoFocus
                                            value={search}
                                            onChange={(e) => setSearch(e.target.value)}
                                            placeholder="Search operatives..."
                                            className="w-full bg-slate-50 rounded-lg pl-9 pr-3 py-2 text-xs font-bold text-slate-900 placeholder:text-slate-400 focus:outline-none"
                                        />
                                    </div>
                                </div>
                                <div className="overflow-y-auto p-1 custom-scrollbar max-h-[180px]">
                                    {filteredOptions.length > 0 ? filteredOptions.map(opt => (
                                        <button
                                            key={opt.id}
                                            onClick={() => {
                                                onChange(opt.id);
                                                setIsOpen(false);
                                                setSearch("");
                                            }}
                                            className={cn(
                                                "w-full flex items-center justify-between px-3 py-2 rounded-lg text-xs font-bold transition-colors",
                                                value === opt.id 
                                                    ? "bg-[#E51636] text-white" // CHANGED FROM bg-slate-900
                                                    : "text-slate-600 hover:bg-slate-50"
                                            )}
                                        >
                                            <div className="flex flex-col items-start">
                                                <span>{opt.name}</span>
                                                <span className={cn(
                                                    "text-[8px] uppercase font-bold tracking-wider",
                                                    value === opt.id ? "text-white/80" : "text-slate-400"
                                                )}>{opt.dept} Unit</span>
                                            </div>
                                            {value === opt.id && <Check className="w-3.5 h-3.5" />}
                                        </button>
                                    )) : (
                                        <div className="p-4 text-center flex flex-col items-center gap-2">
                                            <AlertCircle className="w-5 h-5 text-amber-500" />
                                            <p className="text-[10px] font-bold text-slate-400 uppercase tracking-wider">No active personnel found</p>
                                            <p className="text-[9px] text-slate-300">Unassigned members cannot be selected.</p>
                                        </div>
                                    )}
                                </div>
                            </motion.div>
                        </>
                    )}
                </AnimatePresence>
            </div>
        </div>
    );
}

// --- MAIN MODAL COMPONENT ---
export default function AdvancedCreateModal({ isOpen, onClose, preselectedDate, preselectedMemberId }: Props) {
  const { team, currentUser } = useAppStore();
  
  // Form State
  const [title, setTitle] = useState("");
  const [type, setType] = useState<EventType>("Goal");
  
  // Date State: Range Selection
  const [dateRange, setDateRange] = useState<{ start: Date; end: Date | null }>({
      start: preselectedDate || new Date(),
      end: null
  });
  
  const [currentMonth, setCurrentMonth] = useState<Date>(startOfToday());
  const [assignee, setAssignee] = useState("");
  const [leaderId, setLeaderId] = useState(currentUser?.uid || "");
  const [description, setDescription] = useState("");
  const [priority, setPriority] = useState<"Low" | "Medium" | "High">("Medium");
  const [isSubmitting, setIsSubmitting] = useState(false);

  // Auto-fill logic
  useEffect(() => {
    if (isOpen) {
        if (preselectedMemberId) {
             const member = team.find(m => m.id === preselectedMemberId);
             // Safety check: Don't autofill if unassigned
             if (member && member.dept !== "Unassigned") {
                 setAssignee(preselectedMemberId);
             } else {
                 toast.error("Cannot assign mission to Unassigned member");
             }
        }
        if (preselectedDate) {
            setDateRange({ start: preselectedDate, end: null });
            setCurrentMonth(preselectedDate);
        }
    }
  }, [isOpen, preselectedMemberId, preselectedDate, team]);

  // Calendar Generation
  const calendarDays = useMemo(() => {
    const start = startOfWeek(startOfMonth(currentMonth));
    const end = endOfWeek(endOfMonth(currentMonth));
    return eachDayOfInterval({ start, end });
  }, [currentMonth]);

  // --- DATE SELECTION LOGIC ---
  const handleDateClick = (day: Date) => {
    if (!dateRange.start || (dateRange.start && dateRange.end)) {
        setDateRange({ start: day, end: null });
    } else {
        if (isBefore(day, dateRange.start)) {
            setDateRange({ start: day, end: null });
        } else if (isSameDay(day, dateRange.start)) {
            setDateRange({ start: day, end: null });
        } else {
            setDateRange({ ...dateRange, end: day });
        }
    }
  };

  const handleSubmit = async () => {
    if (!title || !assignee) {
      toast.error("Mission Objective & Operative Required");
      return;
    }

    setIsSubmitting(true);
    const toastId = toast.loading("Deploying Mission...");

    try {
      const participant = team.find(m => m.id === assignee);
      const participantName = participant ? participant.name : "Unknown Operative";
      
      const leader = team.find(m => m.id === leaderId);
      const leaderName = leader ? leader.name : "System";

      const startDate = new Date(dateRange.start);
      if (isSameDay(startDate, new Date())) {
          const now = new Date();
          startDate.setHours(now.getHours(), now.getMinutes(), 0, 0);
      } else {
          startDate.setHours(9, 0, 0, 0);
      }

      // If no end date selected, default to start date
      const endDate = dateRange.end ? new Date(dateRange.end) : new Date(startDate);
      endDate.setHours(18, 0, 0, 0);

      await addDoc(collection(db, "events"), {
        title,
        type,
        startDate,
        endDate,
        assignee: leaderId || "System", 
        assigneeName: leaderName,       
        teamMemberId: assignee,         
        teamMemberName: participantName,
        description,
        priority,
        status: "To Do", 
        createdBy: currentUser?.uid || "System",
        createdAt: serverTimestamp(),
        stickers: [],
      });

      toast.success("Mission Deployed", { id: toastId });
      onClose();
      
      setTitle("");
      setDescription("");
      
    } catch (error) {
      console.error("Error:", error);
      toast.error("Deployment Failed", { id: toastId });
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <ClientPortal>
      <AnimatePresence>
        {isOpen && (
          <div className="fixed inset-0 z-[150] flex items-end md:items-center justify-center pointer-events-none">
            {/* BACKDROP */}
            <motion.div 
              initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
              className="absolute inset-0 bg-[#0F172A]/80 backdrop-blur-md pointer-events-auto"
              onClick={onClose}
            />
            
            {/* MODAL CARD */}
            <motion.div 
              initial={{ y: "100%", opacity: 0 }} 
              animate={{ y: 0, opacity: 1 }} 
              exit={{ y: "100%", opacity: 0 }}
              transition={{ type: "spring", damping: 25, stiffness: 300 }}
              className="pointer-events-auto relative bg-[#F8FAFC] w-full md:max-w-5xl h-[92vh] md:h-auto md:max-h-[90vh] rounded-t-[40px] md:rounded-[40px] shadow-2xl flex flex-col overflow-hidden"
            >
                {/* --- HEADER --- */}
                <div className="shrink-0 h-32 md:h-40 bg-[#E51636] z-0 flex items-start justify-between p-6 md:p-10 relative overflow-hidden">
                    <div className="relative z-10 pt-4 md:pt-0">
                        <div className="flex items-center gap-2 text-white/70 mb-1 md:mb-2">
                            <span className="text-[9px] md:text-[10px] font-black uppercase tracking-[0.25em]">Ops Command</span>
                            <div className="w-1 h-1 rounded-full bg-white/50" />
                            <span className="text-[9px] md:text-[10px] font-bold uppercase tracking-widest text-white/50">New Entry</span>
                        </div>
                        <h2 className="text-3xl md:text-4xl font-[1000] text-white tracking-tighter shadow-sm leading-none">Deploy Mission</h2>
                    </div>
                    <button onClick={onClose} className="relative z-10 p-2.5 bg-white/10 hover:bg-white/20 rounded-full text-white transition-all active:scale-90 backdrop-blur-sm">
                        <X className="w-5 h-5 md:w-6 md:h-6" />
                    </button>
                    <div className="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] mix-blend-overlay pointer-events-none" />
                    <div className="absolute -bottom-24 -right-24 w-96 h-96 bg-white/10 rounded-full blur-3xl pointer-events-none" />
                </div>

                {/* --- CONTENT --- */}
                <div className="flex-1 overflow-y-auto custom-scrollbar bg-white relative z-10 -mt-6 md:-mt-10 rounded-t-[32px] md:rounded-t-none md:rounded-none">
                    <div className="flex flex-col md:flex-row min-h-full">
                    
                        {/* LEFT COLUMN */}
                        <div className="flex-1 p-6 md:p-10 space-y-8 border-b md:border-b-0 md:border-r border-slate-100/80">
                            
                            <div className="space-y-3">
                                <label className="text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 ml-1">
                                    <Target className="w-3 h-3" /> Mission Objective
                                </label>
                                <div className="relative group">
                                    <span className="absolute left-5 top-1/2 -translate-y-1/2 text-slate-300 font-black text-xl select-none">{">_"}</span>
                                    <input 
                                        value={title}
                                        onChange={(e) => setTitle(e.target.value)}
                                        placeholder="Enter directive details..."
                                        className="w-full bg-slate-50 border border-slate-200 rounded-2xl pl-14 pr-6 py-4 md:py-5 text-base md:text-lg font-bold text-slate-900 placeholder:text-slate-300 focus:outline-none focus:border-[#E51636] focus:ring-4 focus:ring-red-500/5 transition-all shadow-inner"
                                        autoFocus
                                    />
                                </div>
                            </div>

                            <div className="space-y-3">
                                <label className="text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 ml-1">
                                    <Shield className="w-3 h-3" /> Classification
                                </label>
                                <div className="grid grid-cols-2 gap-3">
                                    {EVENT_TYPES.map((t) => (
                                        <button
                                            key={t.id}
                                            onClick={() => setType(t.id as EventType)}
                                            className={cn(
                                                "flex flex-col items-center justify-center gap-2 py-3 px-2 rounded-xl border-2 transition-all active:scale-95 h-20",
                                                type === t.id 
                                                    ? cn(t.bg, t.border, t.color, "shadow-md scale-[1.02]") 
                                                    : "border-slate-100 bg-white text-slate-400 hover:border-slate-200 hover:bg-slate-50"
                                            )}
                                        >
                                            <t.icon className={cn("w-5 h-5", type !== t.id && "opacity-50")} />
                                            <span className="text-[8px] font-black uppercase tracking-widest">{t.label}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="space-y-3">
                                <div className="flex items-center justify-between px-1">
                                    <label className="text-[9px] font-black text-[#E51636] uppercase tracking-widest flex items-center gap-2">
                                        <CalendarIcon className="w-3 h-3" /> 
                                        {dateRange.end ? "Date Range" : "Target Date"}
                                    </label>
                                    <div className="flex items-center gap-2">
                                        <button onClick={() => setCurrentMonth(subMonths(currentMonth, 1))} className="p-1 hover:bg-slate-100 rounded-full transition-colors"><ChevronLeft className="w-4 h-4 text-slate-400" /></button>
                                        <span className="text-[10px] font-black text-slate-900 uppercase tracking-wider min-w-[80px] text-center">{format(currentMonth, "MMMM yyyy")}</span>
                                        <button onClick={() => setCurrentMonth(addMonths(currentMonth, 1))} className="p-1 hover:bg-slate-100 rounded-full transition-colors"><ChevronRight className="w-4 h-4 text-slate-400" /></button>
                                    </div>
                                </div>
                                <div className="bg-white rounded-2xl p-4 border border-slate-100 shadow-sm select-none">
                                    <div className="grid grid-cols-7 gap-1 text-center mb-3">
                                        {['Su','Mo','Tu','We','Th','Fr','Sa'].map((d, i) => (
                                            <span key={i} className="text-[9px] font-black text-slate-300 uppercase">{d}</span>
                                        ))}
                                    </div>
                                    <div className="grid grid-cols-7 gap-y-2 gap-x-1">
                                        {calendarDays.map((day, i) => {
                                            const isStart = isSameDay(day, dateRange.start);
                                            const isEnd = dateRange.end ? isSameDay(day, dateRange.end) : false;
                                            
                                            const isMiddle = dateRange.end 
                                                ? isWithinInterval(day, { start: dateRange.start, end: dateRange.end }) && !isStart && !isEnd
                                                : false;

                                            const isToday = isSameDay(day, new Date());
                                            const isCurrentMonth = day.getMonth() === currentMonth.getMonth();

                                            return (
                                                <button
                                                    key={i}
                                                    onClick={() => handleDateClick(day)}
                                                    className={cn(
                                                        "h-9 rounded-xl text-xs font-bold transition-all flex flex-col items-center justify-center relative",
                                                        !isCurrentMonth && "text-slate-200",
                                                        isCurrentMonth && !isStart && !isEnd && !isMiddle && "text-slate-600 hover:bg-slate-50 hover:text-slate-900",
                                                        
                                                        (isStart || isEnd) ? "bg-[#E51636] text-white shadow-lg shadow-red-500/30 z-10 scale-105" : "",
                                                        isMiddle ? "bg-[#E51636]/10 text-[#E51636] rounded-none scale-110 mx-[-2px] w-[calc(100%+4px)]" : ""
                                                    )}
                                                >
                                                    <span>{format(day, "d")}</span>
                                                    {isToday && !isStart && !isEnd && !isMiddle && <div className="w-1 h-1 rounded-full bg-[#E51636] mt-0.5" />}
                                                </button>
                                            )
                                        })}
                                    </div>
                                </div>
                            </div>

                        </div>

                        {/* RIGHT COLUMN */}
                        <div className="flex-1 p-6 md:p-10 bg-slate-50/50 flex flex-col space-y-8 relative">
                            <div className="absolute top-0 right-0 w-64 h-64 bg-slate-100 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 opacity-50 pointer-events-none" />
                            
                            <div className="space-y-6 relative z-10">
                                <label className="text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 ml-1">
                                    <Zap className="w-3 h-3" /> Logistics
                                </label>

                                <MemberSelect 
                                    label="Mission Lead"
                                    value={leaderId}
                                    onChange={setLeaderId}
                                    options={team.map(m => ({ id: m.id, name: m.name, dept: m.dept }))} 
                                    zIndex={30}
                                />

                                <MemberSelect 
                                    label="Assign Participant"
                                    value={assignee}
                                    onChange={setAssignee}
                                    options={team.map(m => ({ id: m.id, name: m.name, dept: m.dept }))} 
                                    disabled={!!preselectedMemberId}
                                    zIndex={20}
                                />

                                <div className="space-y-1.5 relative z-10">
                                    <span className="text-[9px] font-black text-slate-400 uppercase tracking-wider ml-1">Impact Level</span>
                                    <div className="flex bg-white p-1.5 rounded-xl border border-slate-200 shadow-sm">
                                        {PRIORITIES.map((p) => (
                                            <button
                                                key={p.id}
                                                onClick={() => setPriority(p.id)}
                                                className={cn(
                                                    "flex-1 py-2.5 rounded-lg text-[9px] font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2",
                                                    priority === p.id 
                                                        ? cn(p.bg, p.color, "shadow-sm ring-1 ring-inset ring-black/5") 
                                                        : "text-slate-400 hover:text-slate-600 hover:bg-slate-50"
                                                )}
                                            >
                                                <Flag className={cn("w-3 h-3 fill-current", priority === p.id ? "opacity-100" : "opacity-0")} />
                                                {p.id}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            <div className="space-y-2 flex-1 flex flex-col relative z-0">
                                <label className="text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 ml-1">
                                    <FileText className="w-3 h-3" /> Operational Context
                                </label>
                                <textarea 
                                    value={description}
                                    onChange={(e) => setDescription(e.target.value)}
                                    placeholder="Add specific instructions, success criteria, or notes..."
                                    className="w-full flex-1 bg-white border border-slate-200 rounded-2xl p-4 text-xs font-medium text-slate-700 placeholder:text-slate-300 focus:outline-none focus:border-slate-400 focus:ring-4 focus:ring-slate-100 transition-all resize-none min-h-[120px] shadow-sm"
                                />
                            </div>
                        </div>

                    </div>
                </div>

                {/* --- STICKY FOOTER --- */}
                <div className="shrink-0 p-6 md:px-10 md:py-6 border-t border-slate-200/60 bg-white relative z-20 flex items-center justify-end">
                    <button 
                        onClick={handleSubmit}
                        disabled={isSubmitting}
                        className="w-full md:w-auto px-8 py-4 bg-[#004F71] hover:bg-[#003f5c] text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-xl shadow-blue-900/20 hover:scale-[1.02] active:scale-95 transition-all flex items-center justify-center gap-3"
                    >
                        {isSubmitting ? "Deploying..." : (
                            <>
                                <Zap className="w-4 h-4 fill-white" /> Initialize Directive
                            </>
                        )}
                    </button>
                </div>

            </motion.div>
          </div>
        )}
      </AnimatePresence>
    </ClientPortal>
  );
}
--- FILE: ./app/(main)/calendar/_components/TimelineConnections.tsx ---
"use client";

import { motion, AnimatePresence } from "framer-motion";
import { CalendarEvent } from "./types";
import { Scissors, Link2Off } from "lucide-react"; // Imported Link2Off icon
import { useState } from "react";
import { cn } from "@/lib/utils";

interface Props {
  events: CalendarEvent[];
  eventCoordinates: Map<string, { xStart: number; xEnd: number; y: number }>;
  onRemoveLink?: (targetId: string, sourceId: string) => void;
  mode?: 'cables' | 'controls';
  draggingId?: string | null;
  isUnlinkingMode?: boolean; 
}

export default function TimelineConnections({ 
  events, 
  eventCoordinates, 
  onRemoveLink,
  mode = 'cables',
  draggingId,
  isUnlinkingMode = false
}: Props) {
  const [hoveredLink, setHoveredLink] = useState<string | null>(null);

  const getPath = (x1: number, y1: number, x2: number, y2: number, index: number = 0) => {
    const width = Math.abs(x2 - x1);
    const isBackwards = x2 < x1;
    const fanOffset = (index % 2 === 0 ? 1 : -1) * (index * 6); 

    if (isBackwards) {
        const loopSize = Math.max(width * 0.4, 150) + Math.abs(fanOffset); 
        return `M ${x1} ${y1} C ${x1 + 50} ${y1 + 80 + fanOffset}, ${x2 - 50} ${y2 + 80 + fanOffset}, ${x2} ${y2}`;
    } else {
        const curvature = Math.min(width * 0.6, 250) + Math.abs(fanOffset); 
        return `M ${x1} ${y1} C ${x1 + curvature} ${y1}, ${x2 - curvature} ${y2}, ${x2} ${y2}`;
    }
  };

  return (
    <svg className="absolute inset-0 pointer-events-none overflow-visible w-full h-full">
      <defs>
        <linearGradient id="activeFlow" gradientUnits="userSpaceOnUse">
          <stop offset="0%" stopColor="#3b82f6" stopOpacity="0" />
          <stop offset="50%" stopColor="#60a5fa" stopOpacity="1" />
          <stop offset="100%" stopColor="#3b82f6" stopOpacity="0" />
        </linearGradient>
        
        <marker id="arrowHead" markerWidth="4" markerHeight="4" refX="2" refY="2" orient="auto">
          <path d="M0,0 L4,2 L0,4 L1,2 Z" fill="#94a3b8" />
        </marker>
        <marker id="arrowHeadSever" markerWidth="4" markerHeight="4" refX="2" refY="2" orient="auto">
          <path d="M0,0 L4,2 L0,4 L1,2 Z" fill="#ef4444" />
        </marker>

        <filter id="wireShadow" x="-50%" y="-50%" width="200%" height="200%">
          <feDropShadow dx="0" dy="2" stdDeviation="1.5" floodColor="#0f172a" floodOpacity="0.15" />
        </filter>
      </defs>

      {events.map((event) => {
        // 1. Check if the target event (current iteration) is visible
        if (!eventCoordinates.has(event.id)) return null;
        if (!event.linkedEventIds || event.linkedEventIds.length === 0) return null;

        const target = eventCoordinates.get(event.id)!;

        return event.linkedEventIds.map((sourceId, idx) => {
            const source = eventCoordinates.get(sourceId);

            // 2. CASE: Source is HIDDEN (Filtered out)
            // Render a "Stub" or "Ghost Link" indicator instead of a full line
            if (!source) {
                if (mode === 'cables') {
                     // Draw a short dashed line fading out to the left to indicate an incoming connection from a hidden event
                     return (
                         <g key={`ghost-${event.id}-${sourceId}`}>
                             <path 
                                d={`M ${target.xStart - 40} ${target.y} L ${target.xStart} ${target.y}`} 
                                stroke="#cbd5e1" 
                                strokeWidth="2" 
                                strokeDasharray="4 4"
                                opacity="0.5"
                                markerEnd="url(#arrowHead)"
                             />
                             <circle cx={target.xStart - 45} cy={target.y} r="3" fill="#cbd5e1" opacity="0.5" />
                         </g>
                     );
                }
                return null;
            }

            if (draggingId && (event.id === draggingId || sourceId === draggingId)) return null;

            // 3. CASE: Both Visible - Render Full Connection
            const path = getPath(source.xEnd, source.y, target.xStart, target.y, idx);
            
            const isBackwards = target.xStart < source.xEnd;
            const midX = (source.xEnd + target.xStart) / 2;
            const midY = isBackwards ? Math.max(source.y, target.y) + 60 : (source.y + target.y) / 2;

            const linkKey = `${event.id}-${sourceId}`;
            const isHovered = hoveredLink === linkKey;
            
            const showTriggers = isHovered || isUnlinkingMode;

            if (mode === 'cables') {
                return (
                    <g key={linkKey}>
                        <path 
                          d={path} 
                          fill="none" 
                          stroke={isHovered ? "#fca5a5" : "#cbd5e1"} 
                          strokeWidth={isHovered ? "3" : "2"} 
                          strokeLinecap="round"
                          style={{ filter: "url(#wireShadow)", transition: "stroke 0.3s ease, stroke-width 0.3s ease" }}
                          markerEnd={isHovered ? "url(#arrowHeadSever)" : "url(#arrowHead)"}
                        />
                        {!showTriggers && (
                            <motion.path
                              d={path} 
                              fill="none" 
                              stroke="url(#activeFlow)" 
                              strokeWidth="3" 
                              strokeLinecap="round"
                              strokeDasharray="100 400"
                              initial={{ strokeDashoffset: 500 }}
                              animate={{ strokeDashoffset: 0 }}
                              transition={{ duration: 3, repeat: Infinity, ease: "linear", delay: idx * 0.3 }} 
                            />
                        )}
                    </g>
                );
            }

            if (mode === 'controls') {
                return (
                    <g 
                        key={linkKey} 
                        onMouseEnter={() => setHoveredLink(linkKey)}
                        onMouseLeave={() => setHoveredLink(null)}
                        style={{ pointerEvents: 'auto' }} 
                    >
                        <path 
                          d={path} 
                          fill="none" 
                          stroke="transparent" 
                          strokeWidth="30" 
                          strokeLinecap="round"
                          style={{ cursor: isUnlinkingMode ? 'not-allowed' : 'pointer' }}
                        />
                        <AnimatePresence>
                            {showTriggers && (
                                <g transform={`translate(${midX}, ${midY})`}>
                                    <foreignObject x="-20" y="-20" width="40" height="40" style={{ overflow: 'visible', pointerEvents: 'auto' }}>
                                        <motion.button
                                            initial={{ scale: 0, opacity: 0 }}
                                            animate={{ scale: 1, opacity: 1 }}
                                            exit={{ scale: 0, opacity: 0 }}
                                            whileHover={{ scale: 1.1 }}
                                            whileTap={{ scale: 0.9 }}
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                e.preventDefault(); 
                                                if(onRemoveLink) onRemoveLink(event.id, sourceId);
                                            }}
                                            className={cn(
                                                "w-10 h-10 rounded-full border shadow-sm flex items-center justify-center transition-all cursor-pointer relative z-[100] backdrop-blur-sm",
                                                isUnlinkingMode 
                                                    ? "bg-white/95 border-red-300 text-red-500 shadow-md ring-2 ring-red-100" 
                                                    : "bg-white border-slate-200 text-slate-400 hover:text-red-600 hover:border-red-200 hover:shadow-md"
                                            )}
                                        >
                                            <Scissors className="w-5 h-5" />
                                        </motion.button>
                                    </foreignObject>
                                </g>
                            )}
                        </AnimatePresence>
                    </g>
                );
            }
            
            return null;
        });
      })}
    </svg>
  );
}
--- FILE: ./app/(main)/calendar/_components/CalendarGrid.tsx ---
"use client";

import { useMemo } from "react";
import { format, startOfMonth, endOfMonth, startOfWeek, endOfWeek, addDays, isSameMonth, isToday } from "date-fns";
import { cn } from "@/lib/utils";
import { CalendarEvent, getLayoutForWeek } from "./types";
import DraggableEventCard from "./DraggableEventCard";

interface CalendarGridProps {
  currentDate: Date;
  events: CalendarEvent[];
  isStamping: boolean; 
  onDragEnd: (id: string, offsetDays: number) => void;
  onSelectEvent: (event: CalendarEvent) => void;
  onStamp?: (eventId: string) => void;
}

export default function CalendarGrid({
  currentDate,
  events,
  isStamping,
  onDragEnd,
  onSelectEvent,
  onStamp
}: CalendarGridProps) {
  
  const startDate = startOfWeek(startOfMonth(currentDate));
  const endDate = endOfWeek(endOfMonth(currentDate));

  const calendarWeeks = useMemo(() => {
    const weeks = [];
    let day = startDate;
    while (day <= endDate) {
      const week = [];
      for (let i = 0; i < 7; i++) { 
        week.push(day); 
        day = addDays(day, 1); 
      }
      weeks.push(week);
    }
    return weeks;
  }, [currentDate, startDate, endDate]);

  const handleCardClick = (event: CalendarEvent) => {
      // PRIORITY: STAMPING
      if (isStamping && onStamp) {
          onStamp(event.id);
      } else {
          onSelectEvent(event);
      }
  };

  return (
    <div className="flex-1 bg-white min-w-[800px] select-none pb-20">
      <div className="grid grid-cols-7 border-b border-slate-200 bg-white sticky top-0 z-30 shadow-sm">
        {["SUN", "MON", "TUE", "WED", "THU", "FRI", "SAT"].map((d) => (
          <div key={d} className="py-4 text-center text-[10px] font-black text-slate-400 tracking-widest border-r border-slate-50 last:border-0 bg-slate-50/30">
            {d}
          </div>
        ))}
      </div>

      <div className="flex-1">
        {calendarWeeks.map((week, wIdx) => {
          const { placedItems, totalSlots } = getLayoutForWeek(week[0], events);
          
          // COMPACT LAYOUT: Reduced multiplier from 50 to 40, and base height from 160 to 120
          const dynamicHeight = Math.max(120, (totalSlots * 40) + 60);

          return (
            <div key={wIdx} className="grid grid-cols-7 border-b border-slate-100 last:border-0 relative group" style={{ height: dynamicHeight }}>
              
              {week.map(day => (
                  <div 
                    key={day.toString()}
                    data-date={format(day, "yyyy-MM-dd")} 
                    className={cn(
                      "relative border-r border-slate-100 last:border-0 p-2 transition-colors duration-200 z-0 h-full",
                      !isSameMonth(day, currentDate) && "bg-slate-50/60",
                      isToday(day) && "bg-blue-50/10"
                    )}
                  >
                    <span className={cn(
                      "absolute top-2 left-2 w-7 h-7 flex items-center justify-center rounded-lg text-xs font-bold transition-all pointer-events-none",
                      isToday(day) ? "bg-[#004F71] text-white shadow-md" : "text-slate-400",
                    )}>
                      {format(day, "d")}
                    </span>
                  </div>
              ))}

              <div className="absolute inset-0 grid grid-cols-7 mt-10 z-20 pointer-events-none">
                  {placedItems.map((item) => {
                      const segmentDate = addDays(week[0], item.col - 1);

                      return (
                        <DraggableEventCard
                            key={`${item.event.id}-${wIdx}`}
                            {...item}
                            segmentDate={segmentDate}
                            isDragging={false}
                            isStamping={isStamping}
                            onDragEnd={onDragEnd}
                            onClick={handleCardClick}
                        />
                      );
                  })}
              </div>
            </div>
          )
        })}
      </div>
    </div>
  );
}
--- FILE: ./app/(main)/calendar/_components/types.ts ---
import { 
  startOfDay, 
  addDays, 
  differenceInCalendarDays, 
  max, 
  min,
  isValid
} from "date-fns";
import { 
  Layers, 
  GraduationCap, 
  Utensils, 
  Star, 
  Briefcase, 
  Crown 
} from "lucide-react";

// --- 1. SHARED BASE TYPES ---

export type EventType = "Training" | "Goal" | "Deadline" | "Operation" | "OneOnOne" | "Award" | "Vote";
export type Priority = "Low" | "Medium" | "High";
export type StickerType = "star" | "alert" | "fire" | "party" | "check";
export type Department = "FOH" | "BOH" | "Unassigned";

export type Status = 
  | "Admin"              // Level 4 (System Owner)
  | "Director"           // Level 3 (Store Manager)
  | "Assistant Director" // Level 2
  | "Team Leader"        // Level 1
  | "Team Member"        // Level 0
  | "Training" 
  | "Onboarding";

// --- 2. TEAM & PERFORMANCE TYPES ---

export interface Goal {
    id: string;
    label: string;
    progress: number;
    status: "In Progress" | "Completed" | "At Risk";
    dueDate: string;
    priority: Priority;
}

export interface Subtask {
  id: string;
  label: string;
  isCompleted: boolean;
}

export interface TeamMember {
  id: string;
  name: string;
  role: string;
  dept: Department;
  status: Status;
  email: string;
  phone: string;
  joined: string;
  image: string;
  level: number;
  progress: number; 
  completedTaskIds?: string[];
  badges?: any[]; 
  tags?: { label: string; color: string }[];
  stats?: {
    speed: number;
    accuracy: number;
    hospitality: number;
    knowledge: number;
    leadership: number;
  };
  performance?: number[]; 
  goals?: Goal[];
  pairing?: { id: string; name: string; image?: string; role: string }; 
  promotionDates?: Record<string, string>; 
  curriculum?: {
    currentModule: string;
    moduleProgress: number;
    tasks: { id: string; label: string; completed: boolean }[];
  };
  hasLogin?: boolean;
}

// --- 3. CALENDAR EVENT TYPES ---

export interface CalendarEvent {
  id: string;
  title: string;
  assignee: string; 
  assigneeName: string;
  teamMemberId?: string;
  teamMemberName?: string;
  
  startDate: Date;
  endDate: Date;
  type: EventType;
  status: "To Do" | "In Progress" | "Done";
  priority: Priority;
  description?: string;
  isGhost?: boolean;
  stickers?: StickerType[];
  subtasks?: Subtask[]; 
  
  linkedEventIds?: string[]; 
  createdAt?: any;
  updatedAt?: any;

  // NEW: Metadata for dynamic linking (Training Modules, Badges, etc)
  metadata?: {
    taskId?: string;
    originalTitle?: string;
    hex?: string;
    iconId?: string;
    [key: string]: any;
  };
}

export type DraftEvent = Omit<CalendarEvent, "id" | "status">;

export interface LayoutItem {
    event: CalendarEvent;
    col: number;
    span: number;
    slot: number;
    continuesBefore: boolean;
    continuesAfter: boolean;
}

// --- 4. DOMAIN CONSTANTS ---

export const EVENT_TYPES: EventType[] = ["Training", "Goal", "Deadline", "Operation", "OneOnOne", "Award", "Vote"];
export const PRIORITIES: Priority[] = ["High", "Medium", "Low"];

export const STICKERS: { id: StickerType; icon: string; label: string; color: string }[] = [
  { id: "star", icon: "⭐️", label: "Focus", color: "bg-amber-100 border-amber-200" },
  { id: "alert", icon: "❗️", label: "Urgent", color: "bg-red-100 border-red-200" },
  { id: "fire", icon: "🔥", label: "Hot", color: "bg-orange-100 border-orange-200" },
  { id: "party", icon: "🎉", label: "Event", color: "bg-purple-100 border-purple-200" },
  { id: "check", icon: "✅", label: "Verify", color: "bg-emerald-100 border-emerald-200" },
];

export const STAGES: { id: Status; title: string; icon: any }[] = [
    { id: "Onboarding", title: "Onboarding", icon: Layers },
    { id: "Training", title: "Training", icon: GraduationCap },
    { id: "Team Member", title: "Team Member", icon: Utensils },
    { id: "Team Leader", title: "Team Leader", icon: Star },
    { id: "Assistant Director", title: "Asst. Director", icon: Briefcase },
    { id: "Director", title: "Director", icon: Crown },
];

export const getEventLabel = (type: EventType) => {
  switch (type) {
    case "Training": return "Training Module";
    case "Goal": return "Strategic Goal";
    case "Deadline": return "Hard Deadline";
    case "Operation": return "Unit Operation";
    case "OneOnOne": return "1-on-1 Session";
    case "Award": return "Certification"; 
    case "Vote": return "Community Ballot"; 
    default: return type;
  }
};

export const getTypeColor = (type: EventType, isGhost: boolean = false) => {
  if (isGhost) {
      return "bg-white/80 border-2 border-dashed border-[#004F71] text-[#004F71] shadow-xl z-50 backdrop-blur-sm mix-blend-multiply";
  }
  switch (type) {
    case "Training": return "bg-blue-50 text-blue-700 border-blue-100";
    case "Goal": return "bg-emerald-50 text-emerald-700 border-emerald-100";
    case "Deadline": return "bg-red-50 text-red-700 border-red-100";
    case "Operation": return "bg-slate-100 text-slate-700 border-slate-200";
    case "OneOnOne": return "bg-purple-50 text-purple-700 border-purple-100";
    case "Award": return "bg-amber-50 text-amber-700 border-amber-100"; 
    case "Vote": return "bg-gray-50 text-gray-500 border-gray-200"; 
    default: return "bg-gray-50 text-gray-700 border-gray-200";
  }
};

export const ROLE_HIERARCHY: Record<string, number> = {
  "Admin": 4,              
  "Director": 3,           
  "Assistant Director": 2, 
  "Team Leader": 1,        
  "Team Member": 0,        
  "Training": 0,
  "Onboarding": 0
};

export interface PermissionSet {
    canCreateEvents: boolean;
    canEditEvents: boolean;
    canDeleteEvents: boolean;
    canViewFullRoster: boolean;
    canCreateUsers: boolean;
    canEditUsers: boolean;
    canPromoteUsers: boolean;
    canViewSensitiveDocs: boolean;
    canViewAnalytics: boolean;
    canAccessSettings: boolean;
}

export const DEFAULT_PERMISSIONS: Record<Status, PermissionSet> = {
    "Admin": {
        canCreateEvents: true, canEditEvents: true, canDeleteEvents: true,
        canViewFullRoster: true, canCreateUsers: true, canEditUsers: true, canPromoteUsers: true,
        canViewSensitiveDocs: true, canViewAnalytics: true, canAccessSettings: true
    },
    "Director": {
        canCreateEvents: true, canEditEvents: true, canDeleteEvents: true,
        canViewFullRoster: true, canCreateUsers: true, canEditUsers: true, canPromoteUsers: true,
        canViewSensitiveDocs: true, canViewAnalytics: true, canAccessSettings: true
    },
    "Assistant Director": {
        canCreateEvents: true, canEditEvents: true, canDeleteEvents: true,
        canViewFullRoster: true, canCreateUsers: true, canEditUsers: true, canPromoteUsers: false,
        canViewSensitiveDocs: true, canViewAnalytics: true, canAccessSettings: false
    },
    "Team Leader": {
        canCreateEvents: true, canEditEvents: false, canDeleteEvents: false,
        canViewFullRoster: true, canCreateUsers: false, canEditUsers: false, canPromoteUsers: false,
        canViewSensitiveDocs: false, canViewAnalytics: false, canAccessSettings: false
    },
    "Team Member": {
        canCreateEvents: false, canEditEvents: false, canDeleteEvents: false,
        canViewFullRoster: true, canCreateUsers: false, canEditUsers: false, canPromoteUsers: false,
        canViewSensitiveDocs: false, canViewAnalytics: false, canAccessSettings: false
    },
    "Training": {
        canCreateEvents: false, canEditEvents: false, canDeleteEvents: false,
        canViewFullRoster: false, canCreateUsers: false, canEditUsers: false, canPromoteUsers: false,
        canViewSensitiveDocs: false, canViewAnalytics: false, canAccessSettings: false
    },
    "Onboarding": {
        canCreateEvents: false, canEditEvents: false, canDeleteEvents: false,
        canViewFullRoster: false, canCreateUsers: false, canEditUsers: false, canPromoteUsers: false,
        canViewSensitiveDocs: false, canViewAnalytics: false, canAccessSettings: false
    }
};

export const canPerformAction = (userRole: string, requiredLevel: number) => {
  const level = ROLE_HIERARCHY[userRole] || 0;
  return level >= requiredLevel;
};

// ... (Layout Logic) ...
const normalizeDate = (d: Date) => startOfDay(isValid(d) ? d : new Date());

const calculateSpan = (event: CalendarEvent, weekStartDay: Date) => {
    const eStart = normalizeDate(event.startDate);
    const rawEnd = normalizeDate(event.endDate);
    const eEnd = addDays(rawEnd, 1); 

    const wStart = normalizeDate(weekStartDay);
    const wEnd = addDays(wStart, 7); 

    if (eEnd <= wStart || eStart >= wEnd) {
        return { col: 0, span: 0, continuesBefore: false, continuesAfter: false };
    }

    const visualStart = max([eStart, wStart]);
    const visualEnd = min([eEnd, wEnd]);

    const colOffset = differenceInCalendarDays(visualStart, wStart);
    const span = differenceInCalendarDays(visualEnd, visualStart);
    const col = colOffset + 1;

    const continuesBefore = eStart < wStart;
    const continuesAfter = eEnd > wEnd;

    return { col, span, continuesBefore, continuesAfter };
}

export const getLayoutForWeek = (weekStart: Date, events: CalendarEvent[]) => {
  const weekStartDay = normalizeDate(weekStart);
  
  const weekItems = events.map(e => {
      const spanData = calculateSpan(e, weekStartDay);
      return { event: e, ...spanData };
  }).filter(item => item.span > 0);

  weekItems.sort((a,b) => {
      if (a.col !== b.col) return a.col - b.col;
      if (a.span !== b.span) return b.span - a.span;
      return a.event.id.localeCompare(b.event.id);
  });

  const slots: CalendarEvent[][] = []; 
  const placedItems: LayoutItem[] = [];

  weekItems.forEach(item => {
      let slot = 0;
      while(true) {
          if (!slots[slot]) slots[slot] = [];
          
          const collision = slots[slot].some(s => {
              const sProps = calculateSpan(s, weekStartDay);
              const itemStart = item.col;
              const itemEnd = item.col + item.span;
              const slotStart = sProps.col;
              const slotEnd = sProps.col + sProps.span;
              return (itemStart < slotEnd) && (itemEnd > slotStart);
          });

          if (!collision) {
              slots[slot].push(item.event);
              placedItems.push({ 
                  event: item.event, 
                  col: item.col, 
                  span: item.span, 
                  slot, 
                  continuesBefore: item.continuesBefore, 
                  continuesAfter: item.continuesAfter 
              });
              break;
          }
          slot++;
      }
  });

  return { placedItems, totalSlots: slots.length, occupiedSlots: slots };
};
--- FILE: ./app/(main)/calendar/_components/OneOnOneSessionModal.tsx ---
"use client";

import { useState, useEffect } from "react";
import { format, differenceInMinutes, addWeeks } from "date-fns";
import { motion, AnimatePresence } from "framer-motion";
import { cn } from "@/lib/utils";
import { CalendarEvent, Subtask } from "./types";
import { useAppStore } from "@/lib/store/useStore";
import { 
  X, Save, Trash2, PenLine, CheckSquare, 
  MessageSquare, User, Target, 
  ListTodo, ArrowUp, Flag, RefreshCcw,
  Zap, Clock, Timer, Calendar
} from "lucide-react";
import ClientPortal from "@/components/core/ClientPortal";

interface Props {
  event: CalendarEvent;
  onClose: () => void;
  onUpdate: (updatedEvent: CalendarEvent) => void;
}

// Added 'as const' to fix TypeScript type inference for Framer Motion
const TRANSITION_SPRING = { type: "spring", damping: 30, stiffness: 300, mass: 0.8 } as const;

export default function OneOnOneSessionModal({ event, onClose, onUpdate }: Props) {
  const { team } = useAppStore();
  const sessionUser = team.find(u => u.id === event.assignee);
  const sessionDuration = differenceInMinutes(event.endDate, event.startDate);

  // Lock body scroll on mount
  useEffect(() => {
    document.body.style.overflow = "hidden";
    return () => {
      document.body.style.overflow = "unset";
    };
  }, []);

  const [sessionNotes, setSessionNotes] = useState(() => {
      return event.description?.split(/\[SESSION SUMMARY\]|\[KEY OUTCOMES\]|\[FOLLOW UP SCHEDULED:/)[0].trim() || "";
  });
  
  const [keyTakeaways, setKeyTakeaways] = useState(() => {
      let match = event.description?.match(/\[SESSION SUMMARY\]([\s\S]*?)(?=\[FOLLOW UP|$)/);
      if (!match) {
          match = event.description?.match(/\[KEY OUTCOMES\]([\s\S]*?)(?=\[FOLLOW UP|$)/);
      }
      return match ? match[1].trim() : "";
  });

  const [nextSteps, setNextSteps] = useState<Subtask[]>(event.subtasks || []);
  const [newStepText, setNewStepText] = useState("");
  
  const [followUpDate, setFollowUpDate] = useState<Date | null>(null);
  const [isUrgentFollowUp, setIsUrgentFollowUp] = useState(false);

  const handleAddStep = () => {
      if (!newStepText.trim()) return;
      const newStep: Subtask = { id: Math.random().toString(36).substr(2, 9), label: newStepText, isCompleted: false };
      setNextSteps([...nextSteps, newStep]);
      setNewStepText("");
  };

  const handleToggleStep = (id: string) => {
      setNextSteps(nextSteps.map(s => s.id === id ? { ...s, isCompleted: !s.isCompleted } : s));
  };

  const handleCompleteSession = () => {
      let finalDescription = sessionNotes;
      if (keyTakeaways) {
          finalDescription += `\n\n[SESSION SUMMARY]\n${keyTakeaways}`;
      }
      if (followUpDate) {
          finalDescription += `\n\n[FOLLOW UP SCHEDULED: ${format(followUpDate, 'MMM do')}]`;
      }

      const updatedEvent: CalendarEvent = {
          ...event,
          status: "Done",
          description: finalDescription,
          subtasks: nextSteps,
      };
      onUpdate(updatedEvent);
      onClose();
  };

  // FIX: Helper to safely check image validity
  const hasValidImage = sessionUser?.image && sessionUser.image.trim() !== "";

  return (
    <ClientPortal>
        <div className="fixed inset-0 z-[200] flex items-end md:items-center justify-center md:p-6 p-0">
            {/* BACKDROP */}
            <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="absolute inset-0 bg-[#0F172A]/90 backdrop-blur-md" onClick={onClose} />
            
            {/* MAIN MODAL CARD */}
            <motion.div 
                initial={{ y: "100%" }} animate={{ y: 0 }} exit={{ y: "100%" }} transition={TRANSITION_SPRING}
                className="bg-white w-full h-[92vh] md:h-[85vh] md:max-w-5xl rounded-t-[40px] md:rounded-[48px] shadow-2xl relative overflow-hidden flex flex-col border border-white/20"
            >
                {/* --- HEADER (Fixed Height) --- */}
                <div className="bg-[#E51636] relative shrink-0 overflow-hidden">
                    <div className="absolute inset-0 opacity-10 bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:16px_16px]" />
                    <div className="absolute top-0 right-0 p-8 opacity-10"><MessageSquare className="w-64 h-64 rotate-12" /></div>
                    
                    <div className="relative z-10 px-6 pt-8 pb-8 md:px-10 md:pt-10 md:pb-10">
                        <div className="flex justify-between items-start">
                            <div className="flex-1 pr-4">
                                <div className="flex items-center gap-3 mb-3 md:mb-4">
                                    <div className="px-3 py-1 bg-white/10 rounded-full border border-white/20 backdrop-blur-xl flex items-center gap-2">
                                        <span className="text-[8px] font-black uppercase tracking-[0.4em] text-white">Session Intelligence</span>
                                    </div>
                                </div>
                                <h2 className="text-3xl md:text-5xl font-black text-white tracking-tight leading-none mb-2">{event.title}</h2>
                                <p className="text-white/60 text-xs md:text-sm font-medium">Recorded for {sessionUser?.role || "Team Member"}</p>
                            </div>
                            
                            <div className="flex flex-col items-center gap-2">
                                <div className="w-16 h-16 md:w-20 md:h-20 rounded-[20px] md:rounded-[28px] bg-white p-1 shadow-xl rotate-3 shrink-0">
                                    {hasValidImage ? (
                                        <img src={sessionUser!.image} className="w-full h-full rounded-[16px] md:rounded-[24px] object-cover" alt="" />
                                    ) : (
                                        <div className="w-full h-full bg-slate-100 rounded-[16px] md:rounded-[24px] flex items-center justify-center font-black text-slate-300 text-2xl">
                                            {sessionUser?.name.charAt(0) || <User className="w-8 h-8 text-slate-300" />}
                                        </div>
                                    )}
                                </div>
                                <span className="px-2 py-0.5 md:px-3 md:py-1 bg-white text-[#E51636] rounded-full text-[8px] md:text-[9px] font-black uppercase tracking-widest shadow-lg -mt-3 md:-mt-4 relative z-10">
                                    {sessionUser?.name.split(" ")[0]}
                                </span>
                            </div>
                        </div>
                        
                        {/* Close Button */}
                        <button onClick={onClose} className="absolute top-6 right-6 p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all text-white active:scale-90 border border-white/10">
                            <X className="w-5 h-5" />
                        </button>
                    </div>
                </div>

                {/* --- SCROLLABLE CONTENT BODY --- */}
                {/* Added min-h-0 to allow flex container to shrink and show scrollbar */}
                <div className="flex-1 bg-[#F8FAFC] overflow-y-auto custom-scrollbar flex flex-col md:flex-row relative min-h-0">
                    
                    {/* LEFT COLUMN: Notes & Summary */}
                    <div className="flex-1 p-6 md:p-10 border-b md:border-b-0 md:border-r border-slate-200 flex flex-col gap-6 md:gap-8 bg-white md:bg-transparent">
                        
                        {/* 1. 1-on-1 Goal */}
                        <div className="flex flex-col min-h-[160px] md:min-h-[200px]">
                            <div className="flex items-center gap-2 text-slate-400 mb-3 md:mb-4">
                                <PenLine className="w-3.5 h-3.5 md:w-4 md:h-4" />
                                <span className="text-[9px] font-black uppercase tracking-[0.2em]">1-on-1 Goal</span>
                            </div>
                            <textarea 
                                value={sessionNotes} 
                                onChange={e => setSessionNotes(e.target.value)}
                                className="w-full flex-1 bg-transparent text-xl md:text-2xl font-medium text-slate-800 outline-none resize-none placeholder:text-slate-300 leading-relaxed p-0 tracking-tight" 
                                placeholder="What is the primary objective or observation for this session?" 
                            />
                        </div>

                        {/* 2. Key Outcomes */}
                        <div className="pt-6 md:pt-8 border-t border-slate-100">
                                <div className="flex items-center justify-between mb-3 md:mb-4">
                                <div className="flex items-center gap-2 text-slate-400">
                                    <Zap className="w-3.5 h-3.5 md:w-4 md:h-4" />
                                    <span className="text-[9px] font-black uppercase tracking-[0.2em]">Key Outcomes</span>
                                </div>
                                </div>

                                <div className="bg-slate-50/50 rounded-[24px] p-4 md:p-6 border border-slate-200/60 shadow-inner flex flex-col gap-3 group focus-within:bg-white focus-within:shadow-md transition-all">
                                    <div className="flex items-center gap-3 text-slate-700">
                                        <div className="p-2 bg-emerald-50 text-emerald-600 rounded-lg border border-emerald-100 shadow-sm">
                                            <Target className="w-4 h-4" />
                                        </div>
                                        <div>
                                            <p className="text-xs font-black uppercase tracking-wide text-slate-900">Session Summary</p>
                                            <p className="text-[10px] text-slate-400 font-medium mt-0.5">What went down?</p>
                                        </div>
                                    </div>
                                    
                                    <textarea 
                                    value={keyTakeaways}
                                    onChange={e => setKeyTakeaways(e.target.value)}
                                    className="w-full bg-transparent text-sm font-medium text-slate-600 outline-none resize-none placeholder:text-slate-400 mt-2 min-h-[80px] leading-relaxed"
                                    placeholder="Summarize the outcome, decisions made, or key feedback delivered..."
                                    />
                                </div>
                        </div>
                    </div>

                    {/* RIGHT COLUMN: Tasks & Follow Up */}
                    <div className="w-full md:w-[420px] bg-slate-50 p-6 md:p-10 flex flex-col border-l border-white shadow-[inset_4px_0_24px_rgba(0,0,0,0.02)]">
                        
                        {/* 1. Tactical Directives */}
                        <div className="flex items-center gap-2 text-slate-400 mb-4 md:mb-6">
                            <ListTodo className="w-3.5 h-3.5 md:w-4 md:h-4" />
                            <span className="text-[9px] font-black uppercase tracking-[0.2em]">Tactical Directives</span>
                        </div>

                        <div className="space-y-3 md:space-y-3 flex-1 overflow-y-auto max-h-[300px] no-scrollbar">
                            <AnimatePresence mode="popLayout">
                                {nextSteps.map((step) => (
                                    <motion.div 
                                        layout
                                        key={step.id} 
                                        onClick={() => handleToggleStep(step.id)}
                                        className={cn(
                                            "group flex items-center gap-4 p-4 rounded-2xl border transition-all cursor-pointer relative overflow-hidden shadow-sm active:scale-[0.98]",
                                            step.isCompleted 
                                                ? "bg-emerald-50/50 border-emerald-100 opacity-60" 
                                                : "bg-white border-slate-200 hover:border-[#004F71]/30"
                                        )}
                                    >
                                        <div className={cn(
                                            "w-5 h-5 rounded-md border-2 flex items-center justify-center shrink-0 transition-colors duration-300", 
                                            step.isCompleted 
                                                ? "bg-emerald-500 border-emerald-500 shadow-md shadow-emerald-500/20" 
                                                : "border-slate-300 bg-slate-50 group-hover:border-[#004F71] group-hover:bg-white"
                                        )}>
                                            <CheckSquare className={cn("w-3 h-3 text-white transition-transform", step.isCompleted ? "scale-100" : "scale-0")} />
                                        </div>
                                        <span className={cn("text-xs font-bold leading-snug select-none flex-1 break-words", step.isCompleted ? "text-emerald-700 line-through" : "text-slate-700")}>
                                            {step.label}
                                        </span>
                                        <button 
                                            onClick={(e) => { e.stopPropagation(); setNextSteps(nextSteps.filter(s => s.id !== step.id)); }}
                                            className="p-1.5 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg md:opacity-0 md:group-hover:opacity-100 transition-all active:scale-90"
                                        >
                                            <Trash2 className="w-3.5 h-3.5" />
                                        </button>
                                    </motion.div>
                                ))}
                            </AnimatePresence>
                            
                            {nextSteps.length === 0 && (
                                <div className="py-6 flex flex-col items-center justify-center text-slate-300 border-2 border-dashed border-slate-200 rounded-[20px]">
                                    <Target className="w-6 h-6 mb-2 opacity-50" />
                                    <p className="text-[9px] font-bold uppercase tracking-widest">No directives set</p>
                                </div>
                            )}

                            {/* Input Bubble */}
                            <div className="relative group mt-2">
                                <input 
                                    value={newStepText} onChange={e => setNewStepText(e.target.value)}
                                    onKeyDown={e => e.key === 'Enter' && handleAddStep()}
                                    className="w-full pl-5 pr-12 py-3 bg-white border border-slate-200 rounded-full text-xs font-bold outline-none focus:border-[#004F71] focus:ring-4 focus:ring-blue-500/10 transition-all shadow-sm focus:shadow-md placeholder:text-slate-300" 
                                    placeholder="Add directive..." 
                                />
                                <button 
                                    onClick={handleAddStep} 
                                    className="absolute right-1 top-1 bottom-1 aspect-square bg-[#004F71] text-white rounded-full shadow-md active:scale-95 transition-all flex items-center justify-center"
                                >
                                    <ArrowUp className="w-3.5 h-3.5" />
                                </button>
                            </div>
                        </div>

                        {/* 2. Follow-Up Protocol */}
                        <div className="mt-8 pt-8 border-t border-slate-200/60">
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex items-center gap-2 text-slate-400">
                                    <RefreshCcw className="w-3.5 h-3.5 md:w-4 md:h-4" />
                                    <span className="text-[9px] font-black uppercase tracking-[0.2em]">Follow-Up Protocol</span>
                                </div>
                                {followUpDate && <span className="text-[9px] font-bold text-[#004F71] bg-blue-50 px-2 py-0.5 rounded-md border border-blue-100">Active</span>}
                            </div>

                            <div className={cn(
                                "bg-white p-4 rounded-[20px] border transition-all duration-300 shadow-sm group",
                                followUpDate ? "border-[#004F71] ring-4 ring-blue-50" : "border-slate-200 hover:border-slate-300"
                            )}>
                                <div className="flex items-center justify-between mb-4">
                                    <div>
                                        <p className="text-xs font-bold text-slate-900">Next Sync</p>
                                        <p className="text-[10px] font-medium text-slate-400 mt-0.5">
                                            {followUpDate ? format(followUpDate, "MMMM do, yyyy") : "Not scheduled"}
                                        </p>
                                    </div>
                                    <button 
                                        onClick={() => setIsUrgentFollowUp(!isUrgentFollowUp)}
                                        className={cn(
                                            "p-2 rounded-xl transition-all border",
                                            isUrgentFollowUp 
                                                ? "bg-red-50 text-[#E51636] border-red-100 shadow-sm" 
                                                : "bg-slate-50 text-slate-300 border-transparent hover:bg-slate-100"
                                        )}
                                    >
                                        <Flag className="w-4 h-4 fill-current" />
                                    </button>
                                </div>
                                
                                <div className="grid grid-cols-2 gap-2">
                                    {[1, 2, 4].map(weeks => (
                                        <button 
                                            key={weeks}
                                            onClick={() => setFollowUpDate(addWeeks(new Date(), weeks))}
                                            className={cn(
                                                "py-2 rounded-lg text-[9px] font-bold uppercase tracking-wide border transition-all",
                                                followUpDate && differenceInMinutes(followUpDate, addWeeks(new Date(), weeks)) < 60 // fuzzy match
                                                    ? "bg-[#004F71] text-white border-[#004F71]"
                                                    : "bg-slate-50 text-slate-500 border-slate-100 hover:bg-white hover:border-slate-300 hover:shadow-sm"
                                            )}
                                        >
                                            {weeks} {weeks === 1 ? 'Week' : 'Weeks'}
                                        </button>
                                    ))}
                                    <button 
                                        onClick={() => setFollowUpDate(null)}
                                        className="py-2.5 rounded-lg text-[9px] font-bold uppercase tracking-wide border border-transparent text-slate-400 hover:text-red-500 hover:bg-red-50 transition-all"
                                    >
                                        Clear
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                {/* FOOTER - Fixed Height */}
                <div className="shrink-0 p-6 md:p-8 bg-white border-t border-slate-100 flex justify-between items-center z-20">
                    <button onClick={onClose} className="px-6 py-4 text-xs font-black uppercase text-slate-400 hover:text-slate-600 transition-all">Discard</button>
                    <button 
                        onClick={handleCompleteSession}
                        className="px-8 md:px-12 py-4 bg-[#E51636] text-white rounded-2xl font-black uppercase text-[10px] tracking-[0.2em] shadow-xl shadow-red-900/20 flex items-center gap-3 hover:scale-[1.02] active:scale-95 transition-all"
                    >
                        <Save className="w-4 h-4" /> Save Record
                    </button>
                </div>
            </motion.div>
        </div>
    </ClientPortal>
  );
}
--- FILE: ./app/(main)/calendar/_components/TimelineBoard.tsx ---
"use client";

import { useMemo, useState, useEffect } from "react";
import { format, addDays, isToday, isWeekend, eachDayOfInterval, differenceInCalendarDays, startOfWeek } from "date-fns";
import { Link2, X, Activity, Layers, Settings2, Link as LinkIcon } from "lucide-react";
import { cn } from "@/lib/utils";
import { useAppStore } from "@/lib/store/useStore";
import { db } from "@/lib/firebase";
import { updateDoc, doc, arrayUnion, arrayRemove } from "firebase/firestore";
import toast from "react-hot-toast";
import { motion, AnimatePresence } from "framer-motion"; 

import { CalendarEvent, EVENT_TYPES, getEventLabel } from "./types";
import TimelineEventCard from "./TimelineEventCard";
import TimelineConnections from "./TimelineConnections";
import { TacticalSidebarRow } from "./TacticalSidebarRow";

interface Props {
  currentDate: Date;
  events: CalendarEvent[];
  isStamping: boolean;
  onDragEnd: (id: string, offsetDays: number) => void;
  onSelectEvent: (event: CalendarEvent) => void;
  onStamp?: (eventId: string) => void;
}

export default function TimelineBoard({ currentDate, events, isStamping, onDragEnd, onSelectEvent, onStamp }: Props) {
  const { team } = useAppStore();
  
  const [isLinkingMode, setIsLinkingMode] = useState(false);
  const [isUnlinkingMode, setIsUnlinkingMode] = useState(false);
  const [linkSourceId, setLinkSourceId] = useState<string | null>(null);
  const [draggingId, setDraggingId] = useState<string | null>(null);
  
  // --- RESPONSIVE DIMENSIONS ---
  const [isMobile, setIsMobile] = useState(false);

  useEffect(() => {
    const checkMobile = () => setIsMobile(window.innerWidth < 768);
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  const DAY_WIDTH = isMobile ? 46 : 60;
  const ROW_HEIGHT = isMobile ? 56 : 60;
  const GROUP_HEADER_HEIGHT = isMobile ? 40 : 60;
  const GRID_HEADER_HEIGHT = isMobile ? 48 : 56;
  const SIDEBAR_WIDTH = isMobile ? 100 : 280; 
  const CARD_MARGIN = 8;

  // --- 1. CALCULATE DATE RANGE ---
  const timelineDays = useMemo(() => {
    const start = startOfWeek(currentDate); 
    return eachDayOfInterval({ start, end: addDays(start, 45) });
  }, [currentDate]);
  
  const timelineStart = timelineDays[0];
  const timelineEnd = timelineDays[timelineDays.length - 1];
  const totalDays = timelineDays.length;
  const totalBoardWidth = SIDEBAR_WIDTH + (totalDays * DAY_WIDTH);

  const { groupedEvents, eventCoordinates, totalHeight, sourceIds, visibleEvents } = useMemo(() => {
    const groups: Record<string, CalendarEvent[]> = {};
    const coords = new Map<string, { xStart: number; xEnd: number; y: number }>();
    const sources = new Set<string>();
    const visibleSet = new Set<string>();
    
    let currentY = GRID_HEADER_HEIGHT; 

    // First pass: Group and calculate Y positions for VISIBLE events
    EVENT_TYPES.forEach(type => {
        // FILTER 1: Match Type
        let typeEvents = events.filter(e => e.type === type);
        
        // FILTER 2: DATE RANGE CHECK (CRITICAL FIX)
        // Only calculate coordinates for events that are actually rendered within the timeline window
        typeEvents = typeEvents.filter(event => {
            return !(event.endDate < timelineStart || event.startDate > timelineEnd);
        });

        groups[type] = typeEvents;
        
        if (typeEvents.length > 0) {
            currentY += GROUP_HEADER_HEIGHT;
            typeEvents.forEach(event => {
                visibleSet.add(event.id); 
                
                // Calculate coordinates
                const effectiveStart = event.startDate < timelineStart ? timelineStart : event.startDate;
                const effectiveEnd = event.endDate > timelineEnd ? timelineEnd : event.endDate;
                
                if (effectiveStart <= effectiveEnd) {
                    const startDiff = differenceInCalendarDays(effectiveStart, timelineStart);
                    const duration = differenceInCalendarDays(effectiveEnd, effectiveStart) + 1;
                    
                    const xStart = (startDiff * DAY_WIDTH) + SIDEBAR_WIDTH; 
                    const xEnd = xStart + (duration * DAY_WIDTH) - CARD_MARGIN; 
                    const y = currentY + (ROW_HEIGHT / 2);
                    coords.set(event.id, { xStart, xEnd, y });
                }
                currentY += ROW_HEIGHT;
            });
        }
    });

    // Second pass: Identify valid sources for connections
    events.forEach(e => { 
        if (e.linkedEventIds && visibleSet.has(e.id)) {
             e.linkedEventIds.forEach(sourceId => {
                 if (visibleSet.has(sourceId)) {
                     sources.add(sourceId);
                 }
             });
        } 
    });
    
    return { 
        groupedEvents: groups, 
        eventCoordinates: coords, 
        totalHeight: currentY + 200, 
        sourceIds: sources,
        visibleEvents: events 
    };
  }, [events, timelineStart, timelineEnd, DAY_WIDTH, ROW_HEIGHT, GRID_HEADER_HEIGHT, GROUP_HEADER_HEIGHT, SIDEBAR_WIDTH]);

  const handleEventClick = async (event: CalendarEvent) => {
    if (isStamping && onStamp) { onStamp(event.id); return; }
    if (isLinkingMode) { 
        if (!linkSourceId) { setLinkSourceId(event.id); toast(`Source: ${event.title}`, { icon: '🔗' }); } 
        else { if (linkSourceId === event.id) { setLinkSourceId(null); return; } if (event.linkedEventIds?.includes(linkSourceId)) { toast.error("Already linked"); return; } const loadToast = toast.loading("Connecting..."); try { await updateDoc(doc(db, "events", event.id), { linkedEventIds: arrayUnion(linkSourceId) }); toast.success("Connected", { id: loadToast }); } catch (e) { toast.error("Fail", { id: loadToast }); } }
        return;
    }
    onSelectEvent(event);
  };

  const handleRemoveLink = async (targetId: string, sourceId: string) => { const loadToast = toast.loading("Severing link..."); try { await updateDoc(doc(db, "events", targetId), { linkedEventIds: arrayRemove(sourceId) }); toast.success("Link Cut", { id: loadToast }); } catch (error) { toast.error("Could not cut link", { id: loadToast }); } };
  const toggleLinking = () => { setIsLinkingMode(!isLinkingMode); setIsUnlinkingMode(false); setLinkSourceId(null); };
  const toggleUnlinking = () => { setIsUnlinkingMode(!isUnlinkingMode); setIsLinkingMode(false); };

  return (
    <div className="flex-1 overflow-hidden relative flex flex-col bg-slate-50/50 h-full">
         
         {/* FLOATING CONTROLS */}
         <div className="absolute top-4 right-4 md:top-24 md:right-8 z-[70] flex gap-2 md:gap-3">
            <button onClick={toggleLinking} className={cn("flex items-center justify-center gap-2 rounded-full font-black text-[10px] uppercase tracking-widest transition-all shadow-xl hover:scale-105 active:scale-95", isMobile ? "w-10 h-10 p-0" : "px-5 py-3", isLinkingMode ? "bg-[#0F172A] text-white" : "bg-white text-slate-500 hover:text-[#E51636]")}>
                {isLinkingMode ? <X className="w-4 h-4" /> : <LinkIcon className="w-4 h-4" />}
                {!isMobile && (isLinkingMode ? "Exit Linking" : "Chain Missions")}
            </button>
            <button onClick={toggleUnlinking} className={cn("flex items-center justify-center gap-2 rounded-full font-black text-[10px] uppercase tracking-widest transition-all shadow-xl hover:scale-105 active:scale-95", isMobile ? "w-10 h-10 p-0" : "px-5 py-3", isUnlinkingMode ? "bg-red-50 text-[#E51636] ring-2 ring-[#E51636]" : "bg-white text-slate-500 hover:text-[#E51636]")}>
                {isUnlinkingMode ? <X className="w-4 h-4" /> : <Settings2 className="w-4 h-4" />}
                {!isMobile && (isUnlinkingMode ? "Done" : "Manage Links")}
            </button>
         </div>

         {/* MAIN SCROLL AREA */}
         <div className="flex-1 overflow-auto relative custom-scrollbar m-2 md:m-4 rounded-[24px] md:rounded-[32px] shadow-xl border border-slate-200 bg-white">
            <div className="relative min-w-max" style={{ height: totalHeight, width: totalBoardWidth }}>
                
                {/* GRID BACKGROUND */}
                <div className="absolute inset-0 z-0 pointer-events-none opacity-[0.03]" style={{ backgroundImage: `linear-gradient(#004F71 1px, transparent 1px), linear-gradient(90deg, #004F71 1px, transparent 1px)`, backgroundSize: `${DAY_WIDTH}px ${ROW_HEIGHT}px`, backgroundPosition: `${SIDEBAR_WIDTH}px ${GRID_HEADER_HEIGHT}px` }} />

                {/* CONNECTIONS (FIXED: Passed visibleEvents instead of all events) */}
                <div className="absolute inset-0 z-0">
                    <TimelineConnections events={visibleEvents} eventCoordinates={eventCoordinates} mode="cables" draggingId={draggingId} isUnlinkingMode={isUnlinkingMode} />
                </div>

                {/* STICKY HEADER */}
                <div className="sticky top-0 z-[60] flex bg-white border-b border-slate-200 shadow-sm" style={{ height: GRID_HEADER_HEIGHT }}>
                    <div className="sticky left-0 z-[70] bg-white border-r border-slate-200 px-3 md:px-6 flex items-center justify-between font-black text-[9px] text-slate-400 uppercase tracking-[0.3em] shrink-0" style={{ width: SIDEBAR_WIDTH }}>
                         <div className="flex items-center gap-2 md:gap-3"><div className="p-1.5 bg-red-50 text-[#E51636] rounded-lg"><Activity className="w-3.5 h-3.5" /></div>{!isMobile && "Mission Logs"}</div>
                         <div className="h-4 w-px bg-slate-200" />
                    </div>
                    <div className="flex">
                        {timelineDays.map(day => (
                            <div key={day.toString()} className={cn("flex-shrink-0 flex flex-col items-center justify-center border-r border-slate-100", isWeekend(day) && "bg-slate-50/40")} style={{ width: DAY_WIDTH }}>
                                <span className="text-[7px] md:text-[8px] font-bold text-slate-300 uppercase">{format(day, "EEE")}</span>
                                <span className={cn("text-[9px] md:text-[10px] font-black w-5 h-5 md:w-6 md:h-6 flex items-center justify-center rounded-lg mt-0.5 transition-all", isToday(day) ? "bg-[#004F71] text-white shadow-lg shadow-blue-900/20 scale-110" : "text-slate-700")}>{format(day, "d")}</span>
                            </div>
                        ))}
                    </div>
                </div>

                {/* EVENTS LAYER */}
                <div className="relative z-10">
                    <AnimatePresence initial={false}>
                        {EVENT_TYPES.map((type) => {
                            const typeEvents = groupedEvents[type] || [];
                            if (typeEvents.length === 0) return null;
                            return (
                                <motion.div key={type} layout initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="relative group/category">
                                    <div className="relative z-10 flex items-center" style={{ height: GROUP_HEADER_HEIGHT }}>
                                         <div className="sticky left-0 z-[50] bg-white/95 backdrop-blur-sm border-r border-slate-200 px-3 md:px-6 flex items-center shrink-0" style={{ width: SIDEBAR_WIDTH }}>
                                             {isMobile ? (
                                                 <div className="flex items-center gap-2"><div className="w-1.5 h-1.5 rounded-full bg-slate-300" /><span className="text-[9px] font-black uppercase text-slate-500 truncate">{getEventLabel(type)}</span></div>
                                             ) : (
                                                 <div className="flex items-center gap-3 bg-white border border-slate-200 text-slate-700 shadow-sm rounded-full px-4 py-1.5"><div className="p-1 bg-slate-100 rounded-full"><Layers className="w-3 h-3 text-slate-500" /></div><span className="text-[9px] font-black uppercase tracking-[0.2em]">{getEventLabel(type)}</span><div className="h-3 w-px bg-slate-200" /><span className="text-[8px] font-bold text-slate-400">{typeEvents.length} Active</span></div>
                                             )}
                                         </div>
                                         <div className="absolute top-1/2 left-[100px] md:left-[280px] right-0 h-px bg-slate-100 z-0" />
                                    </div>
                                    <AnimatePresence initial={false}>
                                        {typeEvents.map((event) => {
                                            const isSource = sourceIds.has(event.id);
                                            const isTarget = event.linkedEventIds && event.linkedEventIds.length > 0;
                                            // The off-screen check is now redundant here since we filtered groupedEvents above, 
                                            // but keeping it harmless.
                                            return (
                                                <motion.div key={event.id} layout initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: ROW_HEIGHT }} exit={{ opacity: 0, height: 0 }} transition={{ type: "spring", stiffness: 500, damping: 30 }} className={cn("flex relative transition-colors group/row hover:bg-blue-50/10")} style={{ height: ROW_HEIGHT }}>
                                                    <div className="sticky left-0 z-[40] shrink-0 border-r border-slate-200 bg-white" style={{ width: SIDEBAR_WIDTH }}>
                                                        <TacticalSidebarRow event={event} isMobile={isMobile} />
                                                    </div>
                                                    <div className="relative flex flex-1">
                                                        {timelineDays.map(day => <div key={day.toString()} className={cn("flex-shrink-0 border-r border-slate-100/60 h-full", isWeekend(day) && "bg-slate-50/30")} style={{ width: DAY_WIDTH }} />)}
                                                        <TimelineEventCard event={event} timelineStart={timelineStart} timelineEnd={timelineEnd} dayWidth={DAY_WIDTH} isStamping={isStamping} isLinking={isLinkingMode} isSource={isSource} isTarget={isTarget} onDragEnd={onDragEnd} onClick={() => handleEventClick(event)} onDragStart={() => setDraggingId(event.id)} onDragComplete={() => setDraggingId(null)} />
                                                    </div>
                                                </motion.div>
                                            );
                                        })}
                                    </AnimatePresence>
                                </motion.div>
                            );
                        })}
                    </AnimatePresence>
                </div>

                <div className="absolute inset-0 z-50 pointer-events-none">
                    <TimelineConnections events={visibleEvents} eventCoordinates={eventCoordinates} mode="controls" draggingId={draggingId} onRemoveLink={handleRemoveLink} isUnlinkingMode={isUnlinkingMode} />
                </div>
            </div>
         </div>
    </div>
  );
}
--- FILE: ./app/(main)/calendar/_components/TacticalSidebarRow.tsx ---
"use client";

import { CalendarEvent, STICKERS } from "./types";
import { format } from "date-fns";
import { cn } from "@/lib/utils";
import { useAppStore } from "@/lib/store/useStore";
import { Clock, User } from "lucide-react";

// Updated Interface to accept optional isMobile
interface SidebarRowProps {
    event: CalendarEvent;
    isMobile?: boolean;
}

export const TacticalSidebarRow = ({ event, isMobile = false }: SidebarRowProps) => {
  const { team } = useAppStore();
  const leader = team.find(m => m.id === event.assignee);
  const participant = team.find(m => m.id === event.teamMemberId);

  return (
    <div className={cn(
        "w-full h-full flex flex-col justify-center border-r border-slate-100 bg-white/50 backdrop-blur-sm hover:bg-white transition-colors group relative overflow-hidden",
        isMobile ? "px-3" : "px-6"
    )}>
      
      {/* Active Marker Indicator (Left Border) */}
      <div className={cn(
          "absolute left-0 top-0 bottom-0 w-1 transition-all duration-300",
          event.status === "Done" ? "bg-emerald-500" : event.priority === "High" ? "bg-[#E51636]" : "bg-transparent group-hover:bg-[#004F71]"
      )} />

      {/* MOBILE COMPACT VIEW */}
      {isMobile ? (
          <div className="flex items-center gap-2">
              <div className={cn("w-7 h-7 rounded-lg flex items-center justify-center text-[8px] font-black text-white shadow-sm shrink-0", leader?.dept === 'FOH' ? 'bg-[#004F71]' : 'bg-[#E51636]')}>
                  {leader?.name.charAt(0) || "L"}
              </div>
              <div className="flex flex-col min-w-0">
                  <span className="text-[9px] font-bold text-slate-800 truncate leading-tight">{event.title}</span>
                  <span className="text-[7px] font-bold text-slate-400 uppercase tracking-tight truncate">{participant?.name || "Team"}</span>
              </div>
          </div>
      ) : (
          /* DESKTOP FULL VIEW */
          <>
            <div className="flex items-center gap-3 mb-1.5 min-w-0">
                <div className={cn("w-1.5 h-1.5 rounded-full shadow-[0_0_8px_current] shrink-0", 
                event.status === "Done" ? "bg-emerald-500 text-emerald-500" : 
                event.priority === "High" ? "bg-red-500 text-red-500" : "bg-blue-500 text-blue-500"
                )} />
                <span className="text-xs font-black text-slate-700 truncate tracking-tight">{event.title}</span>
            </div>

            <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                    <div className="flex items-center gap-1.5 text-[9px] font-bold text-slate-400 bg-slate-50 px-2 py-1 rounded-md border border-slate-100">
                        <Clock className="w-3 h-3" />
                        <span>{format(event.startDate, "MMM d")}</span>
                    </div>
                    {event.stickers && event.stickers.length > 0 && (
                        <div className="flex items-center gap-1">
                            {event.stickers.map(stickerId => {
                                const sticker = STICKERS.find(s => s.id === stickerId);
                                if (!sticker) return null;
                                return (
                                    <div key={sticker.id} className={cn("w-5 h-5 rounded-full flex items-center justify-center text-[10px] shadow-sm border", sticker.color)}>
                                        {sticker.icon}
                                    </div>
                                );
                            })}
                        </div>
                    )}
                </div>

                <div className="flex items-center -space-x-2">
                    <div className={cn("w-6 h-6 rounded-lg flex items-center justify-center text-[8px] font-black text-white shadow-sm ring-2 ring-white z-10", leader?.dept === 'FOH' ? 'bg-[#004F71]' : 'bg-[#E51636]')}>
                        {leader?.name.charAt(0) || "L"}
                    </div>
                    {participant ? (
                        <div className={cn("w-6 h-6 rounded-lg flex items-center justify-center text-[8px] font-black text-white shadow-sm ring-2 ring-white", participant.dept === 'FOH' ? 'bg-[#004F71]' : 'bg-[#E51636]')}>
                            {participant.name.charAt(0)}
                        </div>
                    ) : (
                        <div className="w-6 h-6 rounded-lg bg-slate-50 border border-dashed border-slate-300 flex items-center justify-center ring-2 ring-white">
                            <User className="w-3 h-3 text-slate-300" />
                        </div>
                    )}
                </div>
            </div>
          </>
      )}
    </div>
  );
};
--- FILE: ./app/(main)/calendar/_components/EventDetailSheet.tsx ---
"use client";

import { useState, useEffect } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { 
  X, Calendar, Clock, User, Shield, Target, Zap, Activity, 
  MessageSquare, Trash2, CheckCircle2, ShieldAlert, 
  Terminal, Sparkles, Quote, Trophy, Vote, Medal, Sticker, Flag, Lock, Link2
} from "lucide-react";
import { format } from "date-fns";
import { cn } from "@/lib/utils";
import { CalendarEvent, getEventLabel, STICKERS, StickerType } from "./types";
import { useAppStore } from "@/lib/store/useStore";
import ClientPortal from "@/components/core/ClientPortal";
import { useTaskMap } from "@/lib/hooks/useTaskMap"; 

interface Props {
  event: CalendarEvent;
  onClose: () => void;
  onUpdate: (id: string, updates: any) => void;
  onDelete?: (id: string) => void;
  isSystemEvent?: boolean;
}

const TRANSITION_SPRING = { type: "spring" as const, damping: 30, stiffness: 300, mass: 0.8 };

function ConfirmationModal({ isOpen, onClose, onConfirm, title, message }: any) {
    return (
        <AnimatePresence>
            {isOpen && (
                <div className="fixed inset-0 z-[200] flex items-center justify-center p-6">
                    <motion.div 
                        initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
                        className="absolute inset-0 bg-slate-950/60 backdrop-blur-md"
                        onClick={onClose}
                    />
                    <motion.div 
                        initial={{ scale: 0.95, opacity: 0, y: 20 }} animate={{ scale: 1, opacity: 1, y: 0 }} exit={{ scale: 0.95, opacity: 0, y: 20 }}
                        className="relative bg-white w-full max-w-sm rounded-[40px] shadow-2xl overflow-hidden border border-white/20 p-8 flex flex-col items-center text-center"
                    >
                        <button onClick={onClose} className="absolute top-5 right-5 p-2 text-slate-300 hover:text-slate-500 hover:bg-slate-50 rounded-full transition-all active:scale-90"><X className="w-5 h-5" /></button>
                        <div className="w-16 h-16 rounded-3xl bg-red-50 flex items-center justify-center mb-6 relative shadow-inner"><ShieldAlert className="w-8 h-8 text-[#E51636]" /></div>
                        <div className="space-y-3 mb-8">
                            <span className="text-[10px] font-black text-red-400 uppercase tracking-[0.3em]">Critical Action</span>
                            <h3 className="text-2xl font-black text-slate-900 tracking-tight leading-none">{title}</h3>
                            <p className="text-xs font-medium text-slate-500 leading-relaxed px-2">{message}</p>
                        </div>
                        <div className="w-full space-y-3">
                            <button onClick={onConfirm} className="w-full py-4 bg-[#E51636] text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-xl shadow-red-500/20 hover:scale-[1.02] active:scale-95 transition-all">Confirm Decommission</button>
                            <button onClick={onClose} className="w-full py-4 bg-slate-50 text-slate-500 rounded-2xl font-black uppercase text-[10px] tracking-widest hover:bg-slate-100 transition-all active:scale-95">Abort Protocol</button>
                        </div>
                    </motion.div>
                </div>
            )}
        </AnimatePresence>
    );
}

export default function EventDetailSheet({ event, onClose, onUpdate, onDelete, isSystemEvent }: Props) {
  const { team } = useAppStore();
  const [isConfirmOpen, setIsConfirmOpen] = useState(false);

  // Initialize Dynamic Task Map
  const taskMap = useTaskMap();

  // Resolve Dynamic Title
  const displayTitle = (event.metadata?.taskId && taskMap[event.metadata.taskId])
      ? `Module Verified: ${taskMap[event.metadata.taskId]}`
      : event.title;

  useEffect(() => {
    document.body.style.overflow = "hidden";
    return () => { document.body.style.overflow = "unset"; };
  }, []);

  const leader = team.find(m => m.id === event.assignee);
  const participant = team.find(m => m.id === event.teamMemberId);

  // --- STYLE RESOLVER ---
  let brandBg = 'bg-[#004F71]';
  let HeaderIcon = Terminal; 
  let headerPattern = "[radial-gradient(#fff_1px,transparent_1px)]";

  if (event.type === 'Deadline') { brandBg = 'bg-[#E51636]'; HeaderIcon = Zap; }
  else if (event.type === 'Award') { brandBg = 'bg-amber-500'; HeaderIcon = Trophy; headerPattern = "[radial-gradient(circle_at_center,rgba(255,255,255,0.2)_0,transparent_100%)]"; }
  else if (event.type === 'Vote') { brandBg = 'bg-slate-800'; HeaderIcon = Vote; }
  else if (event.type === 'Goal') { brandBg = 'bg-emerald-600'; HeaderIcon = Target; }
  else if (displayTitle === 'Mentorship Uplink') { brandBg = 'bg-indigo-600'; HeaderIcon = Link2; }

  // --- PARSE INTELLIGENT LOGS ---
  const isSystemLog = event.description?.startsWith("[SYSTEM LOG:") || event.description?.startsWith("[OFFICIAL ANNOUNCEMENT]") || event.type === 'Award' || event.type === 'Vote';
  const isDocLog = event.description?.startsWith("[DOCUMENT LOG:");
  const isSystemAgent = event.assigneeName === "System" || isSystemEvent; 
  
  const isMentorshipLink = displayTitle === "Mentorship Uplink";
  
  // DETERMINE IMMUTABILITY
  const isImmutable = isSystemLog || isDocLog || isSystemAgent || isMentorshipLink;

  let logTitle = "Operational Context";
  let cleanDescription = event.description || "";

  if (isSystemLog) {
      logTitle = event.description?.split(']')[0].replace('[SYSTEM LOG: ', '').replace('[', '') || "System Event";
      let rawBody = event.description?.split(']').slice(1).join(']').trim() || "";
      cleanDescription = rawBody.replace(/Module ID:.*$/gm, "").trim();
  } else if (isDocLog) {
      logTitle = event.description?.split(']')[0].replace('[DOCUMENT LOG: ', '').replace(']', '') || "Document";
      cleanDescription = event.description?.split(']').slice(1).join(']').trim() || "";
  } else if (isMentorshipLink) {
      logTitle = "Mentorship Protocol";
  }

  const toggleSticker = (stickerId: StickerType) => {
      const currentStickers = event.stickers || [];
      const newStickers = currentStickers.includes(stickerId) ? currentStickers.filter(id => id !== stickerId) : [...currentStickers, stickerId];
      onUpdate(event.id, { stickers: newStickers });
  };

  const getPriorityBadge = (p: string) => {
     if (p === 'High') return <div className="flex items-center gap-1.5 px-3 py-1.5 bg-red-50 border border-red-100 rounded-lg text-[#E51636] font-black text-[9px] uppercase tracking-wider"><Flag className="w-3 h-3 fill-current" /> High</div>;
     if (p === 'Medium') return <div className="flex items-center gap-1.5 px-3 py-1.5 bg-amber-50 border border-amber-100 rounded-lg text-amber-600 font-black text-[9px] uppercase tracking-wider"><Flag className="w-3 h-3 fill-current" /> Medium</div>;
     return <div className="flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 border border-blue-100 rounded-lg text-[#004F71] font-black text-[9px] uppercase tracking-wider"><Flag className="w-3 h-3 fill-current" /> Low</div>;
  };

  return (
    <ClientPortal>
      <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm" onClick={onClose} />
      
      <motion.div 
        initial={{ y: "100%" }} animate={{ y: 0 }} exit={{ y: "100%" }} 
        transition={TRANSITION_SPRING} 
        className="fixed inset-x-0 bottom-0 top-12 md:top-0 md:left-auto md:right-0 md:w-full md:max-w-2xl z-[110] bg-white shadow-2xl flex flex-col overflow-hidden rounded-t-[40px] md:rounded-l-[56px] md:rounded-tr-none md:h-full md:border-l border-white/20"
      >
        {/* --- HEADER --- */}
        <div className={cn("p-8 md:p-12 text-white relative shrink-0 overflow-hidden transition-colors duration-500", brandBg)}>
            <div className={cn("absolute inset-0 opacity-10", headerPattern)} style={{ backgroundSize: '20px 20px' }} />
            <div className="absolute -top-10 -right-10 w-64 h-64 bg-white/10 rounded-full blur-3xl pointer-events-none" />
            
            <HeaderIcon className="absolute top-6 right-6 w-32 h-32 opacity-10 rotate-12 pointer-events-none" />
            
            <div className="relative z-10 space-y-6">
                <div className="flex items-center justify-between">
                    <div className="px-3 py-1.5 bg-white/10 rounded-full border border-white/20 backdrop-blur-md flex items-center gap-2">
                        {isImmutable ? (
                             <Lock className="w-3 h-3 text-white/80" />
                        ) : (
                             <div className="w-1.5 h-1.5 rounded-full bg-white animate-pulse" />
                        )}
                        <span className="text-[9px] font-black uppercase tracking-[0.3em]">
                            {isImmutable ? "Permanent Record" : "Mission Brief"}
                        </span>
                    </div>
                    <button onClick={onClose} className="p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all active:scale-90 border border-white/10"><X className="w-5 h-5" /></button>
                </div>
                
                <div className="space-y-3">
                    {/* Use resolved title */}
                    <h2 className="text-3xl md:text-5xl font-[1000] tracking-tighter leading-tight">{displayTitle}</h2>
                    <div className="flex flex-wrap items-center gap-3">
                        <div className="px-3 py-1 bg-white text-slate-900 rounded-lg text-[10px] font-black uppercase tracking-widest shadow-sm">{getEventLabel(event.type)}</div>
                        <div className="flex items-center gap-2 text-white/80 text-[10px] font-bold uppercase tracking-widest bg-black/20 px-3 py-1 rounded-lg border border-white/10">
                            <Clock className="w-3.5 h-3.5" /> 
                            {format(event.startDate, "MMM do")} {event.endDate && `— ${format(event.endDate, "d")}`}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {/* --- CONTENT --- */}
        <div className="flex-1 overflow-y-auto custom-scrollbar p-6 md:p-10 space-y-8 md:space-y-12 bg-white relative">
            
            {/* Personnel Grid */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                <div className="p-5 bg-slate-50 rounded-[28px] border border-slate-100 shadow-sm flex items-center gap-4 relative overflow-hidden group">
                    <div className={cn("w-12 h-12 rounded-2xl flex items-center justify-center text-white font-black text-lg shadow-lg relative z-10", leader?.dept === 'FOH' ? 'bg-[#004F71]' : event.type === 'Award' ? 'bg-amber-500' : 'bg-[#E51636]')}>
                        {leader?.name.charAt(0) || "S"}
                    </div>
                    <div className="relative z-10">
                        <p className="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5">Mission Lead</p>
                        <p className="text-sm font-bold text-slate-900">{event.assigneeName}</p>
                    </div>
                    <div className="absolute right-0 top-0 bottom-0 w-16 bg-gradient-to-l from-white/50 to-transparent pointer-events-none" />
                </div>

                <div className="p-5 bg-slate-50 rounded-[28px] border border-slate-100 shadow-sm flex items-center gap-4 relative overflow-hidden group">
                    <div className={cn("w-12 h-12 rounded-2xl flex items-center justify-center text-white font-black text-lg shadow-lg relative z-10", participant ? (participant.dept === 'FOH' ? 'bg-[#004F71]' : 'bg-[#E51636]') : (event.type === 'Award' ? 'bg-amber-500' : 'bg-slate-300'))}>
                        {event.teamMemberName?.charAt(0) || '?'}
                    </div>
                    <div className="relative z-10">
                        <p className="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5">Participant</p>
                        <p className="text-sm font-bold text-slate-900">{event.teamMemberName || "Unassigned"}</p>
                    </div>
                </div>
            </div>

            {/* Sticker Rack */}
            <div className="space-y-3">
                <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest px-1 flex items-center gap-2">
                    <Sticker className="w-3.5 h-3.5" /> Tactical Markers
                </span>
                <div className="flex gap-3 overflow-x-auto no-scrollbar pb-2">
                    {STICKERS.map(sticker => {
                        const isActive = event.stickers?.includes(sticker.id);
                        return (
                            <button
                                key={sticker.id}
                                onClick={() => toggleSticker(sticker.id)}
                                className={cn(
                                    "flex flex-col items-center justify-center gap-1 min-w-[64px] h-16 rounded-2xl transition-all border-2 active:scale-95",
                                    isActive ? "bg-white border-[#E51636] shadow-md scale-105" : "bg-slate-50 border-transparent opacity-50 grayscale hover:grayscale-0 hover:opacity-100"
                                )}
                            >
                                <span className="text-xl drop-shadow-sm">{sticker.icon}</span>
                                <span className="text-[7px] font-black uppercase text-slate-500">{sticker.label}</span>
                            </button>
                        )
                    })}
                </div>
            </div>

            {/* Intel Card */}
            <div className="space-y-3">
                <div className="flex items-center justify-between px-1">
                    <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2"><MessageSquare className="w-3.5 h-3.5" /> Operational Intel</span>
                    {getPriorityBadge(event.priority)}
                </div>
                
                <div className="p-6 md:p-8 bg-slate-50/50 border border-slate-200 rounded-[32px] relative overflow-hidden group min-h-[160px]">
                    <Quote className="absolute top-4 right-4 w-10 h-10 text-slate-200 rotate-12" />
                    
                    {(isSystemLog || isDocLog || isSystemAgent || isMentorshipLink) && (
                        <div className="flex items-center gap-3 mb-4 pb-4 border-b border-slate-200/60">
                            <div className={cn("p-2 rounded-xl shadow-sm border", isSystemLog || isMentorshipLink ? "bg-amber-50 text-amber-600 border-amber-100" : "bg-white border-slate-100")}>
                                {isSystemLog ? <Medal className="w-5 h-5" /> : isMentorshipLink ? <Link2 className="w-5 h-5" /> : <ShieldAlert className="w-5 h-5 text-red-500" />}
                            </div>
                            <div className="flex flex-col">
                                <span className="text-[8px] font-black uppercase tracking-[0.2em] text-slate-400">
                                    {isSystemLog ? "SYSTEM LOG" : isMentorshipLink ? "NETWORK UPLINK" : isSystemAgent ? "SYSTEM RECORD" : "OFFICIAL RECORD"}
                                </span>
                                <span className="text-sm font-bold text-slate-900">{logTitle}</span>
                            </div>
                        </div>
                    )}

                    <p className="text-sm md:text-base font-medium text-slate-600 leading-relaxed whitespace-pre-wrap relative z-10">
                        {cleanDescription || "No specific operational context provided."}
                    </p>
                </div>
            </div>
        </div>

        {/* --- FOOTER ACTIONS --- */}
        <div className="p-6 md:p-10 border-t border-slate-100 bg-white flex items-center justify-between gap-4 shrink-0 pb-10 md:pb-10">
             
             {isImmutable ? (
                 <div className="flex items-center gap-2 px-4 py-3 bg-slate-50 text-slate-400 rounded-xl border border-slate-100 cursor-not-allowed opacity-60">
                    <Lock className="w-4 h-4" />
                    <span className="text-[9px] font-black uppercase tracking-widest hidden md:inline">Log Locked</span>
                 </div>
             ) : (
                 onDelete && (
                    <button onClick={() => setIsConfirmOpen(true)} className="flex items-center gap-2 px-4 py-3 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-xl transition-all active:scale-95">
                        <Trash2 className="w-5 h-5" />
                        <span className="text-[10px] font-black uppercase tracking-widest hidden md:inline">Decommission</span>
                    </button>
                 )
             )}

             {event.status !== 'Done' && (
                <button onClick={() => onUpdate(event.id, { status: "Done" })} className="flex-1 md:flex-none flex items-center justify-center gap-3 px-8 py-4 bg-[#004F71] text-white rounded-[20px] font-black uppercase text-[10px] tracking-widest shadow-xl shadow-blue-900/20 hover:scale-[1.02] active:scale-95 transition-all">
                    <CheckCircle2 className="w-4 h-4" /> <span>Complete Mission</span>
                </button>
             )}
        </div>

        <ConfirmationModal isOpen={isConfirmOpen} onClose={() => setIsConfirmOpen(false)} onConfirm={() => { setIsConfirmOpen(false); if(onDelete) onDelete(event.id); }} title="Terminate Mission" message="Confirm permanent decommissioning." />
      </motion.div>
    </ClientPortal>
  );
}
--- FILE: ./app/(main)/calendar/_components/OneOnOneView.tsx ---
"use client";

import { useMemo, useState } from "react";
import { format, isFuture, isPast } from "date-fns";
import { motion, AnimatePresence } from "framer-motion";
import { CalendarEvent } from "./types";
import { useAppStore } from "@/lib/store/useStore";
import { 
  ChevronRight, Clock, CalendarDays, Archive, 
  MessageSquare, User, Sparkles
} from "lucide-react";
import OneOnOneSessionModal from "./OneOnOneSessionModal";

interface Props {
  events: CalendarEvent[];
  onSelectEvent: (event: CalendarEvent | null) => void;
  onUpdateEvent?: (updatedEvent: CalendarEvent) => void; 
  selectedUserId?: string | null; 
}

export default function OneOnOneView({ events: initialEvents, onSelectEvent, onUpdateEvent, selectedUserId }: Props) {
  const { team } = useAppStore();
  const [activeSession, setActiveSession] = useState<CalendarEvent | null>(null);

  const filteredEvents = useMemo(() => {
    let list = initialEvents.filter(e => e.type === "OneOnOne");
    if (selectedUserId) {
        list = list.filter(e => e.assignee === selectedUserId || e.teamMemberId === selectedUserId);
    }
    return list;
  }, [initialEvents, selectedUserId]);

  const { upcoming, historyGroups } = useMemo(() => {
    const upcoming = filteredEvents
        .filter(e => e.status !== "Done" && isFuture(e.startDate))
        .sort((a, b) => a.startDate.getTime() - b.startDate.getTime());

    const history = filteredEvents
        .filter(e => e.status === "Done" || isPast(e.startDate))
        .sort((a, b) => b.startDate.getTime() - a.startDate.getTime());

    const groupsMap = new Map<string, CalendarEvent[]>();
    history.forEach((event) => {
        const key = format(event.startDate, "MMMM yyyy");
        if (!groupsMap.has(key)) groupsMap.set(key, []);
        groupsMap.get(key)!.push(event);
    });

    const historyGroups = Array.from(groupsMap.entries()).map(([label, events]) => ({ label, events }));

    return { upcoming, historyGroups };
  }, [filteredEvents]);

  const handleUpdate = (updatedEvent: CalendarEvent) => {
      if (onUpdateEvent) onUpdateEvent(updatedEvent);
      setActiveSession(null);
  };

  return (
    <div className="h-full bg-[#F8FAFC] overflow-y-auto custom-scrollbar p-6 md:p-12 relative pb-32">
        <div className="max-w-5xl mx-auto space-y-10 md:space-y-16">
            
            {/* HERO HEADER */}
             <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>
                <div className="flex items-center gap-3 mb-4">
                    <div className="p-2 bg-[#E51636]/10 text-[#E51636] rounded-xl border border-[#E51636]/20">
                        <Sparkles className="w-5 h-5" />
                    </div>
                    <span className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">Development Pipeline</span>
                </div>
                <h1 className="text-4xl md:text-6xl font-black text-slate-900 tracking-tighter leading-none mb-3 md:mb-4">
                    {selectedUserId ? team.find(u => u.id === selectedUserId)?.name : "Talent Overview"}
                </h1>
                <p className="text-slate-500 font-medium max-w-2xl text-base md:text-lg leading-relaxed">
                    {selectedUserId 
                        ? `Viewing performance history and growth path for ${team.find(u => u.id === selectedUserId)?.role}.`
                        : "Monitor system-wide leadership sessions, coaching notes, and tactical growth progress."}
                </p>
            </motion.div>

            {/* --- UPCOMING SECTION --- */}
            <section className="space-y-6 md:space-y-8">
                <div className="flex items-center gap-4">
                    <h3 className="text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 shrink-0">
                        <CalendarDays className="w-4 h-4 text-[#E51636]" /> Scheduled Sessions
                    </h3>
                    <div className="h-px flex-1 bg-slate-100" />
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                    {upcoming.length > 0 ? upcoming.map(event => {
                        const eventUser = team.find(u => u.id === event.assignee);
                        // FIX: Ensure image is not empty before rendering img tag
                        const hasImage = eventUser?.image && eventUser.image.trim() !== "";

                        return (
                            <motion.div 
                                key={event.id}
                                layoutId={event.id}
                                onClick={() => setActiveSession(event)}
                                className="group bg-white p-5 md:p-6 rounded-[28px] md:rounded-[32px] border border-slate-200 shadow-sm hover:shadow-xl hover:border-red-100 transition-all cursor-pointer relative overflow-hidden active:scale-[0.98]"
                            >
                                <div className="absolute top-0 right-0 p-6 opacity-[0.03] group-hover:rotate-12 transition-transform">
                                    <Clock className="w-20 h-20" />
                                </div>
                                <div className="flex justify-between items-start mb-6">
                                    <div className="flex items-center gap-3">
                                        {hasImage ? (
                                            <img src={eventUser!.image} className="w-12 h-12 rounded-2xl object-cover shadow-sm ring-2 ring-slate-50" alt="" />
                                        ) : (
                                            <div className="w-12 h-12 rounded-2xl bg-slate-100 flex items-center justify-center font-black text-slate-400 text-sm">
                                                {eventUser ? eventUser.name.charAt(0) : <User className="w-6 h-6 text-slate-300" />}
                                            </div>
                                        )}
                                        <div>
                                            <p className="text-base font-black text-slate-900 leading-tight mb-1">{event.title}</p>
                                            <p className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{eventUser?.name || "Unassigned"}</p>
                                        </div>
                                    </div>
                                </div>
                                <div className="pt-4 border-t border-slate-50 flex items-center justify-between">
                                    <span className="text-[10px] font-black text-slate-400 uppercase flex items-center gap-1.5"><Clock className="w-3.5 h-3.5" /> {format(event.startDate, "MMM do @ h:mm a")}</span>
                                    <span className="text-[10px] font-black text-[#E51636] uppercase tracking-widest md:opacity-0 md:group-hover:opacity-100 transition-opacity flex items-center gap-1">Begin <ChevronRight className="w-3 h-3" /></span>
                                </div>
                            </motion.div>
                        );
                    }) : (
                        <div className="col-span-full py-16 bg-white rounded-[32px] border-2 border-dashed border-slate-200 flex flex-col items-center justify-center text-slate-400">
                            <Clock className="w-10 h-10 mb-4 opacity-20" />
                            <p className="text-sm font-bold uppercase tracking-widest">No sessions scheduled</p>
                        </div>
                    )}
                </div>
            </section>

            {/* --- HISTORY ARCHIVE --- */}
            <section className="space-y-6 md:space-y-8">
                <div className="flex items-center gap-4">
                    <h3 className="text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 shrink-0">
                        <Archive className="w-4 h-4 text-[#004F71]" /> Past Performance Archive
                    </h3>
                    <div className="h-px flex-1 bg-slate-100" />
                </div>

                <div className="space-y-8 md:space-y-12">
                    {historyGroups.map(group => (
                        <div key={group.label} className="space-y-4">
                            <h4 className="text-[11px] font-black text-slate-900 uppercase tracking-[0.2em] px-2">{group.label}</h4>
                            <div className="bg-white rounded-[32px] border border-slate-200 overflow-hidden divide-y divide-slate-100 shadow-sm">
                                {group.events.map(event => (
                                    <div 
                                        key={event.id} 
                                        onClick={() => setActiveSession(event)}
                                        className="p-5 md:p-6 flex items-center justify-between hover:bg-slate-50 transition-colors cursor-pointer group active:bg-slate-100"
                                    >
                                        <div className="flex items-center gap-4 md:gap-6">
                                            <div className="w-10 h-10 md:w-12 md:h-12 rounded-2xl bg-slate-100 flex flex-col items-center justify-center text-slate-400 group-hover:bg-[#004F71] group-hover:text-white transition-all shrink-0">
                                                <span className="text-[8px] md:text-[9px] font-black uppercase leading-none mb-1">{format(event.startDate, "MMM")}</span>
                                                <span className="text-base md:text-lg font-black leading-none">{format(event.startDate, "d")}</span>
                                            </div>
                                            <div className="min-w-0">
                                                <h5 className="text-sm md:text-base font-bold text-slate-900 group-hover:text-[#004F71] transition-colors truncate pr-4">{event.title}</h5>
                                                <div className="flex items-center gap-3 mt-1">
                                                    <span className="text-[10px] font-bold text-slate-400 uppercase flex items-center gap-1 truncate"><User className="w-3 h-3" /> {event.assigneeName}</span>
                                                    {event.description && <span className="text-[10px] font-bold text-emerald-500 uppercase flex items-center gap-1 hidden md:flex"><MessageSquare className="w-3 h-3" /> Notes Saved</span>}
                                                </div>
                                            </div>
                                        </div>
                                        <div className="flex items-center gap-2 md:gap-4 shrink-0">
                                            {event.status === "Done" && <span className="px-2 py-1 md:px-3 md:py-1 rounded-full bg-emerald-50 text-emerald-600 text-[8px] md:text-[9px] font-black uppercase tracking-widest border border-emerald-100">Done</span>}
                                            <ChevronRight className="w-4 h-4 md:w-5 md:h-5 text-slate-200 group-hover:text-[#004F71] transition-all" />
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            </section>
        </div>

        {/* --- REUSABLE SESSION COMPLETION MODAL --- */}
        <AnimatePresence>
            {activeSession && (
                <OneOnOneSessionModal 
                    event={activeSession} 
                    onClose={() => setActiveSession(null)} 
                    onUpdate={handleUpdate} 
                />
            )}
        </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/(main)/calendar/_components/TimelineEventCard.tsx ---
"use client";

import { useRef, memo, useState } from "react"; 
import { motion, PanInfo, AnimatePresence } from "framer-motion";
import { CalendarEvent, STICKERS } from "./types";
import { cn } from "@/lib/utils";
import { differenceInCalendarDays, isValid, format, isSameDay, isSameMonth, max } from "date-fns";
import { Link2, Clock, Calendar as CalendarIcon, ChevronLeft, ChevronRight, Flag } from "lucide-react";
import { useAppStore } from "@/lib/store/useStore";

interface Props {
  event: CalendarEvent;
  timelineStart: Date;
  timelineEnd: Date;
  dayWidth: number;
  isStamping: boolean;
  isLinking: boolean;
  isSource?: boolean;
  isTarget?: boolean;
  onDragEnd: (id: string, daysMoved: number) => void;
  onClick: () => void;
  onDragStart?: () => void;
  onDragComplete?: () => void;
}

const TerminalNode = ({ type }: { type: 'input' | 'output' }) => (
  <div className={cn(
    "absolute top-1/2 -translate-y-1/2 w-3 h-3 rounded-full border-[2px] border-white shadow-md z-30 flex items-center justify-center bg-[#004F71] transition-transform scale-0 group-hover/card:scale-100",
    type === 'input' ? "-left-1.5" : "-right-1.5" 
  )} />
);

const TimelineEventCard = ({
  event, timelineStart, timelineEnd, dayWidth, isStamping, isLinking, isSource, isTarget, onDragEnd, onClick, onDragStart, onDragComplete
}: Props) => {
  const { team } = useAppStore();
  const cardRef = useRef<HTMLDivElement>(null);
  const isDraggingRef = useRef(false);
  const [isLocalDragging, setIsLocalDragging] = useState(false);

  if (!isValid(event.startDate) || !isValid(event.endDate) || !isValid(timelineStart)) return null;

  // Visual Bounds Logic
  const visualStart = max([event.startDate, timelineStart]);
  const isContinuesLeft = event.startDate < timelineStart;
  const isContinuesRight = event.endDate > timelineEnd;

  const startDiff = differenceInCalendarDays(visualStart, timelineStart);
  const duration = differenceInCalendarDays(event.endDate, visualStart) + 1;
  
  const leftPos = (startDiff * dayWidth);
  const width = Math.max(duration * dayWidth - 8, dayWidth - 8); 
  const isCompact = width < 60;
  
  const leader = team.find(u => u.id === event.assignee);
  const participant = team.find(u => u.id === event.teamMemberId);
  const isMultiDay = !isSameDay(event.startDate, event.endDate);

  let dateLabel = format(event.startDate, "h:mm a");
  if (isMultiDay) {
      dateLabel = isSameMonth(event.startDate, event.endDate) 
        ? `${format(event.startDate, "MMM d")} - ${format(event.endDate, "d")}`
        : `${format(event.startDate, "MMM d")} - ${format(event.endDate, "MMM d")}`;
  } else {
      // Single Day: Just show the date, NO time
      dateLabel = format(event.startDate, "MMM d");
  }

  const getStyles = (type: string) => {
    switch (type) {
      case "Training": return { bar: "bg-[#004F71]", bg: "bg-white", text: "text-[#004F71]" };
      case "Goal": return { bar: "bg-emerald-500", bg: "bg-white", text: "text-emerald-700" };
      case "Deadline": return { bar: "bg-[#E51636]", bg: "bg-white", text: "text-[#E51636]" };
      case "OneOnOne": return { bar: "bg-purple-600", bg: "bg-white", text: "text-purple-700" };
      default: return { bar: "bg-slate-500", bg: "bg-white", text: "text-slate-600" };
    }
  };
  const styles = getStyles(event.type);

  const getPriorityColor = (p: string) => {
      switch(p) {
          case 'High': return "text-[#E51636]";
          case 'Medium': return "text-amber-500";
          case 'Low': return "text-[#004F71]";
          default: return "text-slate-400";
      }
  }

  return (
    <motion.div
      className="absolute top-2 h-[40px] md:h-[44px] z-20 group/card" 
      style={{ left: leftPos, width: width }}
      layout
      // UPDATED TRANSITION: Critical Damping (No Bounce)
      transition={{ type: "spring", stiffness: 400, damping: 50, mass: 1 }}
    >
      <motion.div
        ref={cardRef}
        drag={!isLinking && !isStamping ? "x" : false}
        dragMomentum={false} 
        dragElastic={0.1} // Reduced elasticity for tighter control
        dragSnapToOrigin={true}
        onDragStart={() => { 
            isDraggingRef.current = true; 
            setIsLocalDragging(true);
            if (onDragStart) onDragStart(); 
        }}
        onDragEnd={(_, info) => {
          if (onDragComplete) onDragComplete(); 
          
          const movedSlots = Math.round(info.offset.x / dayWidth);
          
          if (movedSlots !== 0) {
            onDragEnd(event.id, movedSlots);
          }
          
          setIsLocalDragging(false);
          setTimeout(() => { isDraggingRef.current = false; }, 150);
        }}
        onClick={(e) => { e.stopPropagation(); if (isDraggingRef.current) return; onClick(); }}
        
        whileHover={{ y: -2, scale: 1.02, zIndex: 50 }}
        whileDrag={{ 
            scale: 1.05, 
            opacity: 0.95, 
            zIndex: 100,
            cursor: "grabbing",
            boxShadow: "0 20px 40px -10px rgba(0,0,0,0.2)", 
        }}
        
        className={cn(
            "w-full h-full border overflow-hidden transition-colors relative select-none shadow-sm", 
            styles.bg,
            isLinking ? "cursor-alias border-dashed border-[#004F71]" : "cursor-grab border-slate-200/80",
            (isSource || isTarget) && "border-[#004F71]/30 shadow-md ring-2 ring-[#004F71]/5",
            isStamping && "cursor-crosshair opacity-80",
            isCompact ? "p-1" : "px-2 md:px-3 flex flex-col justify-center",
            isContinuesLeft ? "rounded-l-none border-l-0" : "rounded-l-[12px]",
            isContinuesRight ? "rounded-r-none border-r-0" : "rounded-r-[12px]",
            isLocalDragging && "border-[#004F71] ring-2 ring-[#004F71]/10"
        )}
      >
        {isTarget && <TerminalNode type="input" />}
        {isSource && <TerminalNode type="output" />}

        {!isContinuesLeft && <div className={cn("absolute left-0 top-0 bottom-0 w-1", styles.bar)} />}
        {!isContinuesRight && <div className={cn("absolute right-0 top-0 bottom-0 w-1", styles.bar)} />}
        
        {isContinuesLeft && <div className="absolute left-0 top-0 bottom-0 w-4 bg-gradient-to-r from-slate-100 to-transparent z-10 flex items-center justify-start pl-0.5"><ChevronLeft className="w-3 h-3 text-slate-400" /></div>}
        {isContinuesRight && <div className="absolute right-0 top-0 bottom-0 w-4 bg-gradient-to-l from-slate-100 to-transparent z-10 flex items-center justify-end pr-0.5"><ChevronRight className="w-3 h-3 text-slate-400" /></div>}

        {isCompact ? (
            <div className="flex flex-col justify-center h-full w-full pl-1.5 overflow-hidden">
                 <div className="flex items-center gap-1">
                    <Flag className={cn("w-2 h-2 fill-current shrink-0", getPriorityColor(event.priority))} />
                    <span className={cn("text-[8px] font-black truncate leading-tight", styles.text)}>{event.title}</span>
                 </div>
            </div>
        ) : (
            <div className="flex items-center justify-between w-full relative z-20 gap-2 pl-1">
                <div className="flex-1 min-w-0 flex flex-col justify-center">
                    <div className="flex items-center gap-1.5">
                        {isSource && !isLinking && <Link2 className="w-2.5 h-2.5 text-slate-400" />}
                        <Flag className={cn("w-2.5 h-2.5 fill-current shrink-0", getPriorityColor(event.priority))} />
                        <span className={cn("text-[9px] md:text-[10px] font-black truncate tracking-tight leading-tight", styles.text)}>{event.title}</span>
                        {event.stickers?.slice(0, 3).map(s => {
                            const st = STICKERS.find(x => x.id === s);
                            return st ? <div key={s} className="w-3.5 h-3.5 rounded-full flex items-center justify-center text-[7px] bg-white border border-slate-100 shadow-sm z-10 hidden md:flex">{st.icon}</div> : null;
                        })}
                    </div>
                    <div className="flex items-center gap-1.5 mt-0.5 opacity-60">
                        <CalendarIcon className="w-2 h-2" />
                        <span className="text-[7px] md:text-[8px] font-bold text-slate-500">{dateLabel}</span>
                    </div>
                </div>
                <div className="flex items-center -space-x-1.5 shrink-0 pl-1">
                      <div className={cn("w-4 h-4 md:w-5 md:h-5 rounded-md flex items-center justify-center text-[6px] md:text-[7px] font-black text-white shadow-sm ring-1 ring-white z-10", leader?.dept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]")}>{leader?.name.charAt(0) || '?'}</div>
                      {participant && <div className={cn("w-4 h-4 md:w-5 md:h-5 rounded-md flex items-center justify-center text-[6px] md:text-[7px] font-black text-white shadow-sm ring-1 ring-white", participant.dept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]")}>{participant.name.charAt(0)}</div>}
                </div>
            </div>
        )}

        <AnimatePresence>
            {isLocalDragging && (
                <motion.div 
                    initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
                    className="absolute inset-0 bg-white/50 backdrop-blur-[1px] pointer-events-none z-50 flex items-center justify-center"
                >
                    <div className="w-1.5 h-1.5 rounded-full bg-[#004F71] animate-pulse" />
                </motion.div>
            )}
        </AnimatePresence>
      </motion.div>
    </motion.div>
  );
};

export default memo(TimelineEventCard);
--- FILE: ./app/(main)/calendar/_components/DraggableEventCard.tsx ---
"use client";

import { useRef, memo, useState } from "react";
import { motion, PanInfo, AnimatePresence } from "framer-motion";
import { CalendarEvent, TeamMember, STICKERS } from "./types";
import { cn } from "@/lib/utils";
import { GripVertical, Flag, Clock, Calendar as CalendarIcon, Users } from "lucide-react";
import { useAppStore } from "@/lib/store/useStore";
import { differenceInCalendarDays, parse, format, isSameDay, isSameMonth } from "date-fns";

interface Props {
  event: CalendarEvent;
  col: number;
  span: number;
  slot: number;
  segmentDate: Date; 
  continuesBefore: boolean;
  continuesAfter: boolean;
  isDragging: boolean;
  isStamping: boolean; 
  onDragEnd: (id: string, daysMoved: number) => void;
  onClick: (event: CalendarEvent) => void;
}

const DraggableEventCard = ({
  event, col, span, slot, segmentDate, continuesBefore, continuesAfter,
  isStamping, onDragEnd, onClick
}: Props) => {
  
  const cardRef = useRef<HTMLDivElement>(null);
  const wasDragged = useRef(false);
  const { team } = useAppStore();
  const [isLocalDragging, setIsLocalDragging] = useState(false);

  if (span <= 0) return null;

  // --- RESOLVE PERSONNEL ---
  const leader = team.find((u: TeamMember) => u.id === event.assignee);
  const participant = team.find((u: TeamMember) => u.id === event.teamMemberId);

  const handleDragStart = () => {
    setIsLocalDragging(true);
    wasDragged.current = false;
  };

  const handleDragUpdate = () => {
    wasDragged.current = true;
  };

  const handleDragEnd = (e: any, info: PanInfo) => {
    if (isStamping) {
        setIsLocalDragging(false);
        return;
    }

    const clientX = e.clientX || e.changedTouches?.[0]?.clientX;
    const clientY = e.clientY || e.changedTouches?.[0]?.clientY;

    if (clientX && clientY) {
      if (cardRef.current) cardRef.current.style.visibility = "hidden";
      const elementsBelow = document.elementsFromPoint(clientX, clientY);
      if (cardRef.current) cardRef.current.style.visibility = "visible";

      const dateCell = elementsBelow.find(el => el.hasAttribute("data-date"));
      
      if (dateCell) {
        const dateStr = dateCell.getAttribute("data-date");
        if (dateStr) {
          const targetDate = parse(dateStr, "yyyy-MM-dd", new Date());
          const daysDiff = differenceInCalendarDays(targetDate, segmentDate);
          if (daysDiff !== 0) onDragEnd(event.id, daysDiff);
        }
      }
    }

    setTimeout(() => {
        setIsLocalDragging(false);
    }, 10);
  };

  const getStyles = (type: string) => {
    switch (type) {
      case "Training": return { bar: "bg-[#004F71]", bg: "bg-white" };
      case "Goal": return { bar: "bg-emerald-500", bg: "bg-white" };
      case "Deadline": return { bar: "bg-[#E51636]", bg: "bg-white" };
      case "OneOnOne": return { bar: "bg-purple-600", bg: "bg-white" };
      default: return { bar: "bg-slate-500", bg: "bg-white" };
    }
  };
  
  const styles = getStyles(event.type);
  const isMultiDay = !isSameDay(event.startDate, event.endDate);

  // --- UPDATED DATE LABEL LOGIC (NO TIME) ---
  let dateLabel = "";
  
  if (isMultiDay) {
      const sameMonth = isSameMonth(event.startDate, event.endDate);
      if (sameMonth) {
          dateLabel = `${format(event.startDate, "MMM d")} - ${format(event.endDate, "d")}`;
      } else {
          dateLabel = `${format(event.startDate, "MMM d")} - ${format(event.endDate, "MMM d")}`;
      }
  } else {
      // Single Day: Just show the date, NO time
      dateLabel = format(event.startDate, "MMM d");
  }

  // --- PRIORITY COLOR LOGIC ---
  const getPriorityColor = (p: string) => {
      switch(p) {
          case 'High': return "bg-red-50 text-[#E51636] border-red-100";
          case 'Medium': return "bg-amber-50 text-amber-500 border-amber-100";
          case 'Low': return "bg-blue-50 text-[#004F71] border-blue-100";
          default: return "bg-slate-50 text-slate-400 border-slate-100";
      }
  }

  return (
    <motion.div 
      layout
      data-event-id={event.id}
      style={{ 
        gridColumnStart: col, 
        gridColumnEnd: `span ${span}`, 
        top: slot * 40, 
        left: 0, 
        right: 0,
        zIndex: isLocalDragging ? 1000 : 20,
        willChange: "transform, opacity",
      }}
      className="absolute h-[36px] mb-1 px-1 pointer-events-auto touch-none"
    >
      <motion.div
        ref={cardRef}
        drag={!isStamping} 
        dragMomentum={false} 
        dragElastic={0.01} 
        dragSnapToOrigin={true}
        onDragStart={handleDragStart}
        onDrag={handleDragUpdate}
        onDragEnd={handleDragEnd}
        onTap={() => { if (!wasDragged.current) onClick(event); }}
        
        whileHover={{ y: -1, scale: 1.01 }}
        whileDrag={{ 
            scale: 1.05, 
            opacity: 0.9,
            rotate: 1,
            boxShadow: "0 25px 50px -12px rgba(0,0,0,0.25)",
            cursor: "grabbing"
        }}
        
        className={cn(
          "h-full w-full flex flex-col justify-center px-2 border select-none overflow-hidden relative rounded-lg transition-colors duration-300",
          styles.bg,
          isLocalDragging ? "border-[#E51636]" : "border-slate-200/60 shadow-sm",
          continuesBefore ? "rounded-l-none border-l-0 pl-3" : "rounded-l-lg",
          continuesAfter ? "rounded-r-none border-r-0 pr-3" : "rounded-r-lg",
          isStamping ? "cursor-crosshair" : "cursor-grab"
        )}
      >
        {!continuesBefore && <div className={cn("absolute left-0 top-0 bottom-0 w-1 rounded-l-lg", styles.bar)} />}
        {!continuesAfter && <div className={cn("absolute right-0 top-0 bottom-0 w-1 rounded-r-lg", styles.bar)} />}
        
        <div className="flex items-center w-full h-full relative z-20">
            <div className="flex-1 min-w-0 mr-1.5 flex flex-col justify-center">
                <div className="flex items-center justify-between w-full">
                    <p className="truncate text-[10px] font-bold text-slate-800 leading-none tracking-tight flex items-center gap-1.5 flex-1 min-w-0">
                        {event.title}
                        {event.stickers && event.stickers.length > 0 && (
                            <span className="flex items-center gap-0.5 shrink-0">
                                {event.stickers.map(s => {
                                    const st = STICKERS.find(x => x.id === s);
                                    return st ? <span key={s} className="text-[8px]">{st.icon}</span> : null
                                })}
                            </span>
                        )}
                    </p>
                </div>
                
                {/* DATE DISPLAY */}
                <div className="flex items-center gap-1 opacity-60 mt-0.5">
                    {/* Always show Calendar Icon since we removed Time */}
                    <CalendarIcon className="w-2.5 h-2.5 shrink-0" />
                    <span className="text-[7px] font-black uppercase tracking-wider tabular-nums truncate">
                        {dateLabel}
                    </span>
                </div>
            </div>

            <div className="flex items-center gap-1.5 shrink-0">
                 {/* PRIORITY FLAG - VISIBLE ON ALL */}
                 <div className={cn("p-1 rounded-[4px] border", getPriorityColor(event.priority))}>
                     <Flag className="w-2 h-2 fill-current" />
                 </div>

                 {!continuesAfter && (
                    <div className="flex -space-x-1">
                        <div className={cn(
                            "w-3.5 h-3.5 rounded flex items-center justify-center text-[6px] font-black text-white shadow-sm ring-1 ring-white", 
                            leader?.dept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]"
                        )}>
                            {leader?.name.charAt(0) || 'L'}
                        </div>

                        {participant && (
                            <div className={cn(
                                "w-3.5 h-3.5 rounded flex items-center justify-center text-[6px] font-black text-white shadow-sm ring-1 ring-white transition-transform group-hover:translate-x-0.5", 
                                participant?.dept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]"
                            )}>
                                {participant.name.charAt(0)}
                            </div>
                        )}
                     </div>
                 )}
            </div>
        </div>

        <AnimatePresence>
            {isLocalDragging && (
                <motion.div 
                    initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
                    className="absolute inset-0 bg-red-500/5 pointer-events-none" 
                />
            )}
        </AnimatePresence>
      </motion.div>
    </motion.div>
  );
};

export default memo(DraggableEventCard);
--- FILE: ./app/(main)/calendar/_components/ConflictResolutionModal.tsx ---
"use client";

import { motion } from "framer-motion";
import { CalendarEvent } from "./types";
import { format, addDays, differenceInCalendarDays } from "date-fns";
import { ArrowRight, ArrowLeftRight, CalendarClock, Scissors, AlertTriangle, X } from "lucide-react";
import { cn } from "@/lib/utils";

interface Props {
  source: CalendarEvent;
  target: CalendarEvent;
  onResolve: (action: 'push' | 'swap' | 'sever') => void;
  onClose: () => void;
}

export default function ConflictResolutionModal({ source, target, onResolve, onClose }: Props) {
  // INTELLIGENCE: Calculate the perfect "Safe Date" (Source End + 1 Day)
  const safeDate = addDays(source.endDate, 1);
  const shiftAmount = differenceInCalendarDays(safeDate, target.startDate);

  return (
    <div className="fixed inset-0 z-[100] flex items-center justify-center p-4">
      <motion.div 
        initial={{ opacity: 0 }} 
        animate={{ opacity: 1 }} 
        exit={{ opacity: 0 }} 
        className="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" 
        onClick={onClose}
      />
      
      <motion.div 
        initial={{ scale: 0.9, y: 20, opacity: 0 }} 
        animate={{ scale: 1, y: 0, opacity: 1 }} 
        exit={{ scale: 0.9, y: 20, opacity: 0 }}
        className="bg-white w-full max-w-lg rounded-[40px] shadow-2xl overflow-hidden border border-white/20 relative z-10"
      >
        {/* HEADER: Critical State */}
        <div className="bg-[#7f1d1d] p-8 pb-12 relative overflow-hidden">
            <div className="absolute top-0 right-0 p-6 opacity-10"><AlertTriangle className="w-32 h-32 text-white" /></div>
            <div className="relative z-10">
                <div className="flex items-center gap-3 mb-4">
                    <div className="px-3 py-1 bg-black/30 rounded-full border border-white/10 flex items-center gap-2 backdrop-blur-md">
                        <div className="w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse" />
                        <span className="text-[9px] font-black uppercase tracking-[0.3em] text-white">Temporal Paradox Detected</span>
                    </div>
                </div>
                <h2 className="text-3xl font-black text-white tracking-tight leading-none mb-2">Resolve Conflict</h2>
                <p className="text-red-200 text-xs font-medium">
                    Mission <span className="font-bold text-white">"{target.title}"</span> attempts to start before <span className="font-bold text-white">"{source.title}"</span> concludes.
                </p>
            </div>
        </div>

        {/* BODY: The Solutions */}
        <div className="p-8 -mt-6 bg-white rounded-t-[40px] relative space-y-4">
            
            {/* OPTION 1: TIME WARP (Smart Reschedule) */}
            <button 
                onClick={() => onResolve('push')}
                className="w-full group p-5 rounded-[28px] border-2 border-slate-100 hover:border-[#004F71] bg-slate-50 hover:bg-blue-50/50 transition-all flex items-center gap-5 text-left relative overflow-hidden"
            >
                <div className="w-12 h-12 rounded-2xl bg-white shadow-sm flex items-center justify-center border border-slate-100 group-hover:scale-110 transition-transform">
                    <CalendarClock className="w-6 h-6 text-[#004F71]" />
                </div>
                <div className="flex-1 relative z-10">
                    <h4 className="text-sm font-black text-slate-900 uppercase tracking-wide mb-1">Time Shift (Recommended)</h4>
                    <p className="text-xs text-slate-500 font-medium">
                        Push <strong>{target.title}</strong> forward {shiftAmount} days to start on <strong>{format(safeDate, "MMM do")}</strong>.
                    </p>
                </div>
                <ArrowRight className="w-5 h-5 text-slate-300 group-hover:text-[#004F71] group-hover:translate-x-1 transition-all" />
            </button>

            {/* OPTION 2: REVERSE POLARITY */}
            <button 
                onClick={() => onResolve('swap')}
                className="w-full group p-5 rounded-[28px] border-2 border-slate-100 hover:border-amber-400 bg-white hover:bg-amber-50/50 transition-all flex items-center gap-5 text-left"
            >
                <div className="w-12 h-12 rounded-2xl bg-amber-100/50 flex items-center justify-center text-amber-600 group-hover:scale-110 transition-transform">
                    <ArrowLeftRight className="w-6 h-6" />
                </div>
                <div className="flex-1">
                    <h4 className="text-sm font-black text-slate-900 uppercase tracking-wide mb-1">Reverse Direction</h4>
                    <p className="text-xs text-slate-500 font-medium">
                        Make <strong>{target.title}</strong> the source (Parent) instead.
                    </p>
                </div>
            </button>

            {/* OPTION 3: SEVER */}
            <button 
                onClick={() => onResolve('sever')}
                className="w-full group p-4 rounded-[24px] border border-transparent hover:bg-red-50 text-slate-400 hover:text-red-600 transition-all flex items-center justify-center gap-2 text-xs font-bold uppercase tracking-widest mt-2"
            >
                <Scissors className="w-4 h-4" /> Sever Connection
            </button>

        </div>
      </motion.div>
    </div>
  );
}
--- FILE: ./app/(main)/calendar/page.tsx ---
"use client";

import { useState, useCallback, useEffect, useMemo } from "react";
import { format, addDays, differenceInCalendarDays } from "date-fns";
import { AnimatePresence, motion, LayoutGroup } from "framer-motion";
import { 
  Plus, Search, Loader2, Calendar as CalendarIcon, 
  RotateCcw, ChevronDown, Layers, ShieldCheck, UserCheck, 
  Sticker, Check, Flag, Zap, X, Coffee, Flame, Server,
  Filter, SlidersHorizontal, LayoutGrid, ListEnd, MessageSquare,
  ChevronLeft, ChevronRight, PanelLeftClose, PanelLeftOpen,
  Target, Shield, Activity, Info
} from "lucide-react";
import { cn } from "@/lib/utils";

// Firebase & Store
import { db } from "@/lib/firebase";
import { collection, addDoc, updateDoc, doc, deleteDoc, serverTimestamp, arrayUnion } from "firebase/firestore";
import { useAppStore } from "@/lib/store/useStore";
import toast from "react-hot-toast";

// Types & Components
import { 
  CalendarEvent, EventType, EVENT_TYPES, PRIORITIES, Priority, 
  getEventLabel, DraftEvent, Department, Status, STAGES, STICKERS, StickerType
} from "./_components/types";
import CalendarGrid from "./_components/CalendarGrid";
import TimelineBoard from "./_components/TimelineBoard";
import OneOnOneView from "./_components/OneOnOneView";
import AdvancedCreateModal from "./_components/AdvancedCreateModal";
import EventDetailSheet from "./_components/EventDetailSheet";
import ClientPortal from "@/components/core/ClientPortal";
import { useTaskMap } from "@/lib/hooks/useTaskMap"; 

// --- NEW SMOOTH ACCORDION COMPONENT ---
function TacticalSidebarAccordion({ 
    id, 
    title, 
    icon: Icon, 
    isOpen, 
    onToggle, 
    children, 
    activeCount, 
    totalCount 
}: any) {
    const isFiltered = activeCount < totalCount;

    return (
        <motion.div layout className="relative overflow-hidden">
            <motion.button 
                layout="position"
                onClick={() => onToggle(isOpen ? null : id)}
                className={cn(
                    "w-full py-4 px-6 flex items-center justify-between group outline-none transition-all duration-300 rounded-2xl mx-2 my-1",
                    isOpen ? "bg-white shadow-lg shadow-slate-200/50" : "hover:bg-slate-100/50"
                )}
                style={{ width: "calc(100% - 16px)" }}
            >
                <div className="flex items-center gap-3">
                    <div className={cn(
                        "p-2 rounded-xl transition-all duration-500 shadow-sm relative z-10",
                        isOpen ? "bg-[#004F71] text-white" : "bg-white border border-slate-100 text-slate-400 group-hover:text-slate-600 group-hover:scale-110"
                    )}>
                        <Icon className="w-3.5 h-3.5" />
                    </div>
                    <div className="flex flex-col items-start leading-none gap-0.5">
                        <span className={cn(
                            "text-[9px] font-black uppercase tracking-[0.2em] transition-colors",
                            isOpen ? "text-[#004F71]" : "text-slate-400 group-hover:text-slate-600"
                        )}>{title}</span>
                        {isFiltered && !isOpen && (
                            <span className="text-[8px] font-bold text-[#E51636] uppercase tracking-wider">Filtered</span>
                        )}
                    </div>
                </div>
                <div className={cn("transition-transform duration-500", isOpen && "rotate-180")}>
                    <ChevronDown className={cn("w-3.5 h-3.5", isOpen ? "text-[#004F71]" : "text-slate-300")} />
                </div>
            </motion.button>
            
            <AnimatePresence>
                {isOpen && (
                    <motion.div 
                        initial={{ height: 0, opacity: 0 }}
                        animate={{ height: "auto", opacity: 1 }}
                        exit={{ height: 0, opacity: 0 }}
                        transition={{ type: "spring", stiffness: 300, damping: 30 }}
                        className="overflow-hidden"
                    >
                        <div className="px-4 pb-4 pt-1 space-y-2">
                            <div className="p-3 bg-slate-50/50 rounded-3xl border border-slate-100/60 shadow-inner">
                                {children}
                            </div>
                        </div>
                    </motion.div>
                )}
            </AnimatePresence>
        </motion.div>
    );
}

function SystemClock() {
    const [time, setTime] = useState(new Date());
    useEffect(() => {
        const timer = setInterval(() => setTime(new Date()), 1000);
        return () => clearInterval(timer);
    }, []);
    return <span className="tabular-nums font-black text-[#004F71]">{format(time, "h:mm a")}</span>;
}

// --- UNIFIED DYNAMIC LEGEND ISLAND ---
function DynamicLegendIsland() {
    const [isMobileExpanded, setIsMobileExpanded] = useState(false);

    // Desktop View (Wide Pill)
    const DesktopLegend = () => (
        <motion.div 
            initial={{ y: 100, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ type: "spring", stiffness: 300, damping: 30 }}
            className="hidden lg:flex fixed bottom-8 left-1/2 -translate-x-1/2 z-50 items-center gap-6 bg-white/95 backdrop-blur-2xl border border-slate-200/60 px-8 py-3 rounded-full shadow-[0_20px_50px_-12px_rgba(0,0,0,0.15)] ring-1 ring-black/5 hover:scale-[1.02] transition-transform duration-300"
        >
            <div className="flex items-center gap-6">
                {[
                    { label: "Training", color: "bg-[#004F71]" },
                    { label: "Goal", color: "bg-emerald-500" },
                    { label: "Deadline", color: "bg-[#E51636]" },
                    { label: "Operation", color: "bg-slate-500" },
                    { label: "1-on-1", color: "bg-purple-500" },
                ].map((item, i) => (
                    <div key={i} className="flex items-center gap-2 group cursor-default">
                        <div className={cn("w-2 h-2 rounded-full shadow-[0_0_8px_rgba(0,0,0,0.2)]", item.color)} />
                        <span className="text-[9px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-900 transition-colors">{item.label}</span>
                    </div>
                ))}
            </div>

            <div className="w-px h-5 bg-slate-200" />

            <div className="flex items-center gap-4">
                {[
                    { label: "High", color: "text-[#E51636]" },
                    { label: "Med", color: "text-amber-500" },
                    { label: "Low", color: "text-blue-400" },
                ].map((p, i) => (
                    <div key={i} className="flex items-center gap-1.5 text-slate-400 group cursor-default">
                        <Flag className={cn("w-3 h-3 fill-current", p.color)} />
                        <span className="text-[8px] font-bold uppercase tracking-wider group-hover:text-slate-600 transition-colors">{p.label}</span>
                    </div>
                ))}
            </div>
        </motion.div>
    );

    // Mobile View (Collapsed Fab)
    const MobileLegend = () => (
        <>
            <motion.button 
                onClick={() => setIsMobileExpanded(!isMobileExpanded)}
                className="lg:hidden fixed bottom-28 left-6 z-50 w-12 h-12 bg-white text-slate-500 rounded-full shadow-[0_10px_30px_-10px_rgba(0,0,0,0.15)] flex items-center justify-center border border-slate-200 active:scale-95 transition-transform"
            >
                {isMobileExpanded ? <X className="w-5 h-5" /> : <Info className="w-5 h-5" />}
            </motion.button>

            <AnimatePresence>
                {isMobileExpanded && (
                    <motion.div 
                        initial={{ opacity: 0, scale: 0.9, y: 20 }}
                        animate={{ opacity: 1, scale: 1, y: 0 }}
                        exit={{ opacity: 0, scale: 0.9, y: 20 }}
                        className="lg:hidden fixed bottom-44 left-6 z-50 bg-white/95 backdrop-blur-xl border border-slate-200 p-5 rounded-[24px] shadow-2xl flex flex-col gap-4 min-w-[200px]"
                    >
                        <div className="space-y-3">
                            <span className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] block">Classifications</span>
                            {[
                                { label: "Training", color: "bg-[#004F71]" },
                                { label: "Goal", color: "bg-emerald-500" },
                                { label: "Deadline", color: "bg-[#E51636]" },
                                { label: "Operation", color: "bg-slate-500" },
                                { label: "1-on-1", color: "bg-purple-500" },
                            ].map((item, i) => (
                                <div key={i} className="flex items-center gap-3">
                                    <div className={cn("w-2 h-2 rounded-full", item.color)} />
                                    <span className="text-[10px] font-bold text-slate-700 uppercase tracking-wide">{item.label}</span>
                                </div>
                            ))}
                        </div>
                        <div className="h-px w-full bg-slate-100" />
                        <div className="space-y-3">
                            <span className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] block">Priorities</span>
                            {[
                                { label: "High Priority", color: "text-[#E51636]" },
                                { label: "Medium Priority", color: "text-amber-500" },
                                { label: "Low Priority", color: "text-blue-400" },
                            ].map((p, i) => (
                                <div key={i} className="flex items-center gap-3">
                                    <Flag className={cn("w-3 h-3 fill-current", p.color)} />
                                    <span className="text-[10px] font-bold text-slate-700 uppercase tracking-wide">{p.label}</span>
                                </div>
                            ))}
                        </div>
                    </motion.div>
                )}
            </AnimatePresence>
        </>
    );

    return (
        <>
            <DesktopLegend />
            <MobileLegend />
        </>
    );
}

// --- MAIN PAGE ---
export default function CalendarPage() {
  const { events, team, subscribeEvents, subscribeTeam, loading } = useAppStore();
  
  // -- View & Data States --
  const [currentDate, setCurrentDate] = useState(new Date());
  const [viewMode, setViewMode] = useState<"calendar" | "timeline" | "oneonone">("calendar");
  const [isCreatorOpen, setIsCreatorOpen] = useState(false);
  const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
  
  // -- DYNAMIC TITLE MAP --
  const taskMap = useTaskMap(); // Initialize hook

  // -- DESKTOP SIDEBAR STATE --
  const [isSidebarOpen, setIsSidebarOpen] = useState(true);

  // -- MOBILE SPECIFIC STATES --
  const [isFilterSheetOpen, setIsFilterSheetOpen] = useState(false);

  // -- STAMPING STATE --
  const [activeSticker, setActiveSticker] = useState<StickerType | null>(null);
  const [openSection, setOpenSection] = useState<string | null>('stickers'); 
  
  // -- FILTER STATES --
  const [activeTypes, setActiveTypes] = useState<EventType[]>(EVENT_TYPES);
  const [activePriorities, setActivePriorities] = useState<Priority[]>(PRIORITIES);
  // FIX: Added Unassigned to default so new members show up
  const [activeDepts, setActiveDepts] = useState<Department[]>(["FOH", "BOH", "Unassigned"]);
  const [activeRoles, setActiveRoles] = useState<Status[]>(STAGES.map(s => s.id));
  const [showSystemLogs, setShowSystemLogs] = useState(false); 

  useEffect(() => {
    const unsubEvents = subscribeEvents();
    const unsubTeam = subscribeTeam();
    return () => { unsubEvents(); unsubTeam(); };
  }, [subscribeEvents, subscribeTeam]);

  // -- FILTER & TRANSFORM EVENTS --
  const displayEvents = useMemo(() => {
    return events.filter(e => {
        const isSystemLog = e.assignee === "System";
        if (isSystemLog && !showSystemLogs) return false;
        
        const typeMatch = activeTypes.includes(e.type);
        const priorityMatch = activePriorities.includes(e.priority);
        
        // Find user to check their department
        const user = team.find(m => m.id === e.teamMemberId || m.id === e.assignee);
        const deptMatch = user ? activeDepts.includes(user.dept) : true;
        const roleMatch = user ? activeRoles.includes(user.status) : true;
        
        return typeMatch && priorityMatch && deptMatch && roleMatch;
    }).map(e => {
        // DYNAMIC TITLE OVERRIDE
        if (e.metadata?.taskId && taskMap[e.metadata.taskId]) {
            return { ...e, title: `Module Verified: ${taskMap[e.metadata.taskId]}` };
        }
        return e;
    });
  }, [events, team, activeTypes, activePriorities, activeDepts, activeRoles, showSystemLogs, taskMap]);

  const handleDragEnd = useCallback(async (id: string, offsetDays: number) => {
    const event = events.find(ev => ev.id === id);
    if (!event) return;
    const newStart = addDays(event.startDate, offsetDays);
    const newEnd = addDays(newStart, differenceInCalendarDays(event.endDate, event.startDate));
    try { await updateDoc(doc(db, "events", id), { startDate: newStart, endDate: newEnd, updatedAt: serverTimestamp() }); } catch (e) { toast.error("Sync Error"); }
  }, [events]);

  const handleEventStamp = async (eventId: string) => {
      if (!activeSticker) return;
      const loadToast = toast.loading("Applying Marker...");
      try {
          await updateDoc(doc(db, "events", eventId), {
              stickers: arrayUnion(activeSticker)
          });
          toast.success("Marker Applied", { id: loadToast });
      } catch (err) {
          toast.error("Failed to Apply", { id: loadToast });
      }
  };

  const toggle = (list: any[], item: any, setter: any) => setter(list.includes(item) ? list.filter(i => i !== item) : [...list, item]);
  
  const resetFilters = () => {
    setActiveTypes(EVENT_TYPES);
    setActivePriorities(PRIORITIES);
    setActiveDepts(["FOH", "BOH", "Unassigned"]);
    setActiveRoles(STAGES.map(s => s.id));
    setShowSystemLogs(false); 
  };

  // --- COMPONENT: Sidebar Content ---
  const SidebarContent = () => (
    <div className="flex flex-col h-full bg-[#F8FAFC]">
        {/* Header */}
        <div className="p-6 pb-4 border-b border-slate-100 bg-white/50 backdrop-blur-sm sticky top-0 z-20">
            <div className="flex items-center justify-between mb-2">
                <h1 className="text-lg font-[1000] text-slate-900 tracking-tight uppercase">Ops Center</h1>
                <div className="flex gap-2">
                    <button onClick={resetFilters} className="p-2 hover:bg-white hover:shadow-sm rounded-lg text-slate-400 hover:text-[#E51636] transition-all border border-transparent hover:border-slate-100" title="Reset Filters">
                        <RotateCcw className="w-3.5 h-3.5" />
                    </button>
                    {/* Hide on mobile, show on desktop */}
                    <button onClick={() => setIsSidebarOpen(false)} className="hidden lg:flex p-2 hover:bg-white hover:shadow-sm rounded-lg text-slate-400 hover:text-[#004F71] transition-all border border-transparent hover:border-slate-100">
                        <PanelLeftClose className="w-3.5 h-3.5" />
                    </button>
                </div>
            </div>
            <div className="flex items-center gap-2">
                <div className="bg-white border border-slate-200 px-2 py-0.5 rounded-md text-[9px] shadow-sm"><SystemClock /></div>
                <span className="text-[8px] font-bold text-slate-300 uppercase tracking-widest">Live Command</span>
            </div>
        </div>

        {/* Scrollable Content */}
        <div className="flex-1 overflow-y-auto custom-scrollbar p-2 space-y-1">
            <LayoutGroup>
                {/* 0. SYSTEM LOGS (Simple Toggle) */}
                <motion.button 
                    layout="position"
                    onClick={() => setShowSystemLogs(!showSystemLogs)} 
                    className={cn(
                        "w-full flex items-center justify-between py-4 px-6 rounded-2xl text-[9px] font-black uppercase tracking-[0.2em] transition-all border mx-2 my-1",
                        showSystemLogs 
                            ? "bg-white border-[#E51636]/20 text-[#E51636] shadow-lg shadow-red-500/10" 
                            : "bg-transparent border-transparent text-slate-400 hover:bg-slate-100/50 hover:text-slate-600"
                    )}
                    style={{ width: "calc(100% - 16px)" }}
                >
                    <div className="flex items-center gap-3">
                        <Server className={cn("w-3.5 h-3.5", showSystemLogs && "text-[#E51636]")} />
                        <span>System Logs</span>
                    </div>
                    <div className={cn("w-1.5 h-1.5 rounded-full transition-all duration-500", showSystemLogs ? "bg-[#E51636] shadow-[0_0_8px_#E51636] scale-125" : "bg-slate-200")} />
                </motion.button>

                {/* 1. TACTICAL MARKERS */}
                <TacticalSidebarAccordion id="stickers" title="Tactical Markers" icon={Sticker} isOpen={openSection === 'stickers'} onToggle={setOpenSection} activeCount={0} totalCount={0}>
                    <div className="grid grid-cols-4 gap-2">
                        {STICKERS.map(s => {
                            const isActive = activeSticker === s.id;
                            return (
                                <button key={s.id} onClick={() => setActiveSticker(isActive ? null : s.id)} className={cn("aspect-square rounded-2xl flex items-center justify-center text-lg shadow-sm border transition-all active:scale-95", s.color, isActive ? "ring-4 ring-offset-2 ring-[#004F71] scale-110 z-10" : "grayscale opacity-60 hover:grayscale-0 hover:opacity-100 bg-white hover:scale-105")}>
                                    {s.icon}
                                </button>
                            )
                        })}
                    </div>
                    {activeSticker && (
                        <div className="mt-3 text-center">
                            <button onClick={() => setActiveSticker(null)} className="text-[8px] font-black text-[#E51636] uppercase tracking-widest hover:underline">Clear Selection</button>
                        </div>
                    )}
                </TacticalSidebarAccordion>

                {/* 2. CLASSIFICATION */}
                <TacticalSidebarAccordion id="classification" title="Classification" icon={Layers} isOpen={openSection === 'classification'} onToggle={setOpenSection} activeCount={activeTypes.length} totalCount={EVENT_TYPES.length}>
                    <div className="space-y-1.5">
                        {EVENT_TYPES.map(type => {
                            const isSelected = activeTypes.includes(type);
                            return (
                                <button key={type} onClick={() => toggle(activeTypes, type, setActiveTypes)} className={cn("w-full flex items-center justify-between py-2.5 px-4 rounded-xl text-[9px] font-black uppercase tracking-widest transition-all border", isSelected ? `bg-white border-slate-200 text-slate-900 shadow-sm` : "bg-transparent border-transparent text-slate-400 hover:bg-slate-100")}>
                                    <div className="flex items-center gap-2"><div className={cn("w-1.5 h-1.5 rounded-full", isSelected ? "bg-[#004F71]" : "bg-slate-300")} /><span>{getEventLabel(type)}</span></div>
                                    {isSelected && <Check className="w-3 h-3 text-[#004F71]" />}
                                </button>
                            )
                        })}
                    </div>
                </TacticalSidebarAccordion>

                {/* 3. DEPLOYMENT ZONE */}
                <TacticalSidebarAccordion id="deployment" title="Deployment Zone" icon={ShieldCheck} isOpen={openSection === 'deployment'} onToggle={setOpenSection} activeCount={activeDepts.length} totalCount={3}>
                    <div className="grid grid-cols-2 gap-2">
                        {[{ id: "FOH", label: "Front House", icon: Coffee, color: "text-blue-600", bg: "bg-blue-50", border: "border-blue-100" }, { id: "BOH", label: "Back House", icon: Flame, color: "text-red-600", bg: "bg-red-50", border: "border-red-100" }].map(dept => {
                            const isSelected = activeDepts.includes(dept.id as Department);
                            return (
                                <button key={dept.id} onClick={() => toggle(activeDepts, dept.id as Department, setActiveDepts)} className={cn("flex flex-col items-center gap-2 p-3 rounded-2xl border transition-all h-24 justify-center relative overflow-hidden", isSelected ? "bg-white border-slate-200 shadow-md" : "bg-slate-50 border-transparent opacity-60 hover:opacity-100")}>
                                    {isSelected && <div className={cn("absolute inset-0 opacity-10", dept.bg)} />}
                                    <div className={cn("p-2 rounded-xl shadow-sm bg-white", dept.color)}><dept.icon className="w-4 h-4" /></div>
                                    <span className={cn("text-[8px] font-black uppercase tracking-widest", isSelected ? "text-slate-900" : "text-slate-400")}>{dept.id}</span>
                                    {isSelected && <div className={cn("absolute top-2 right-2 w-1.5 h-1.5 rounded-full", dept.bg.replace('bg-', 'bg-').replace('50', '500'))} />}
                                </button>
                            )
                        })}
                        {/* Unassigned Toggle */}
                         <button onClick={() => toggle(activeDepts, "Unassigned", setActiveDepts)} className={cn("col-span-2 flex items-center justify-between p-3 rounded-2xl border transition-all h-12 relative overflow-hidden", activeDepts.includes("Unassigned") ? "bg-white border-slate-200 shadow-md" : "bg-slate-50 border-transparent opacity-60 hover:opacity-100")}>
                             <span className="text-[9px] font-black uppercase tracking-widest text-slate-500 pl-2">Include Unassigned</span>
                             {activeDepts.includes("Unassigned") && <Check className="w-4 h-4 text-emerald-500" />}
                         </button>
                    </div>
                </TacticalSidebarAccordion>

                {/* 4. IMPACT PRIORITY */}
                <TacticalSidebarAccordion id="priority" title="Impact Priority" icon={Zap} isOpen={openSection === 'priority'} onToggle={setOpenSection} activeCount={activePriorities.length} totalCount={PRIORITIES.length}>
                    <div className="space-y-1.5">
                        {PRIORITIES.map(p => {
                            const isSelected = activePriorities.includes(p);
                            return (
                                <button key={p} onClick={() => toggle(activePriorities, p, setActivePriorities)} className={cn("w-full flex items-center justify-between py-2.5 px-4 rounded-xl text-[9px] font-black uppercase tracking-widest transition-all border", isSelected ? `bg-white border-slate-200 text-slate-900 shadow-sm` : "bg-transparent border-transparent text-slate-400 hover:bg-slate-100")}>
                                    <div className="flex items-center gap-2">
                                        <div className={cn("w-1.5 h-1.5 rounded-full", isSelected ? (p === 'High' ? "bg-[#E51636]" : p === 'Medium' ? "bg-amber-500" : "bg-blue-500") : "bg-slate-300")} />
                                        <span>{p} Priority</span>
                                    </div>
                                    {isSelected && <Check className="w-3 h-3 text-[#004F71]" />}
                                </button>
                            )
                        })}
                    </div>
                </TacticalSidebarAccordion>
            </LayoutGroup>
        </div>
    </div>
  );

  return (
    <div className="flex flex-col lg:flex-row h-[calc(100vh-6rem)] md:h-[calc(100vh-5rem)] rounded-[32px] md:rounded-[48px] overflow-hidden bg-white shadow-[0_40px_100px_-20px_rgba(0,0,0,0.15)] border border-slate-200/60 ring-4 md:ring-8 ring-slate-100/50 relative mt-2 md:mt-0">
      
      {/* --- DESKTOP COLLAPSIBLE SIDEBAR --- */}
      <motion.div 
        animate={{ width: isSidebarOpen ? 300 : 0, opacity: isSidebarOpen ? 1 : 0 }}
        transition={{ type: "spring", stiffness: 300, damping: 30 }}
        className="hidden lg:flex bg-[#F8FAFC] border-r border-slate-200/60 flex-col shrink-0 relative z-20 overflow-hidden"
      >
         <div className="w-[300px] h-full flex flex-col">
            <SidebarContent />
         </div>
      </motion.div>

      {/* --- MAIN INTERFACE AREA --- */}
      <div className="flex-1 flex flex-col relative overflow-hidden bg-white">
        
        {/* --- DESKTOP HEADER (Modified) --- */}
        <div className="hidden lg:flex h-20 bg-white border-b border-slate-100 items-center justify-between px-8 shrink-0 z-30 relative shadow-sm">
            <div className="flex items-center gap-6 group cursor-default">
              
              {!isSidebarOpen && (
                  <motion.button 
                    initial={{ opacity: 0, scale: 0.5 }} 
                    animate={{ opacity: 1, scale: 1 }}
                    onClick={() => setIsSidebarOpen(true)}
                    className="p-3 bg-slate-50 rounded-xl border border-slate-200 text-slate-400 hover:text-[#004F71] hover:bg-white hover:shadow-md transition-all"
                  >
                      <PanelLeftOpen className="w-5 h-5" />
                  </motion.button>
              )}

              <div className="p-3 bg-white rounded-[24px] border-2 border-slate-50 shadow-lg group-hover:border-[#E51636] transition-all duration-500">
                  <CalendarIcon className="w-6 h-6 text-[#E51636]" />
              </div>
              <div className="flex flex-col leading-none">
                  <span className="text-[8px] font-black text-slate-300 uppercase tracking-[0.4em] mb-1 pl-0.5 text-left">Identity Command</span>
                  <div className="flex items-baseline gap-2">
                      <span className="text-4xl font-[1000] text-slate-900 tracking-tighter uppercase">{format(currentDate, "MMMM")}</span>
                      <span className="text-4xl font-light text-slate-200 tracking-tighter">{format(currentDate, "yyyy")}</span>
                  </div>
              </div>
           </div>

           {/* CENTERED VIEW SWITCHER */}
           <div className="absolute left-1/2 -translate-x-1/2 flex bg-slate-50 p-1.5 rounded-2xl border border-slate-200 shadow-inner">
                <button onClick={() => setViewMode("calendar")} className={cn("px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2", viewMode === "calendar" ? "bg-[#E51636] text-white shadow-lg shadow-red-500/20" : "text-slate-400 hover:text-slate-600 hover:bg-white")}>
                    <LayoutGrid className="w-3.5 h-3.5" /> Grid View
                </button>
                <div className="w-px bg-slate-200 my-2 mx-1" />
                <button onClick={() => setViewMode("timeline")} className={cn("px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2", viewMode === "timeline" ? "bg-[#E51636] text-white shadow-lg shadow-red-500/20" : "text-slate-400 hover:text-slate-600 hover:bg-white")}>
                    <ListEnd className="w-3.5 h-3.5" /> Timeline
                </button>
                <div className="w-px bg-slate-200 my-2 mx-1" />
                <button onClick={() => setViewMode("oneonone")} className={cn("px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2", viewMode === "oneonone" ? "bg-[#E51636] text-white shadow-lg shadow-red-500/20" : "text-slate-400 hover:text-slate-600 hover:bg-white")}>
                    <MessageSquare className="w-3.5 h-3.5" /> 1-on-1s
                </button>
            </div>

           <div className="flex items-center gap-4">
                <button onClick={() => setIsCreatorOpen(true)} className="flex items-center gap-2 bg-[#E51636] text-white px-8 py-3.5 rounded-[20px] text-[10px] font-black uppercase shadow-[0_15px_30px_-10px_rgba(229,22,54,0.4)] hover:bg-[#c4122d] active:scale-95 group transition-all tracking-widest border-b-4 border-red-800">
                    <Plus className="w-4 h-4 transition-transform group-hover:rotate-90" /> <span>Deploy Mission</span>
                </button>
           </div>
        </div>

        {/* --- MOBILE HEADER CONTROLS --- */}
        <div className="lg:hidden flex items-center justify-between p-4 border-b border-slate-100 bg-white z-30 sticky top-0">
            <div className="flex items-center gap-3">
                <button onClick={() => setIsFilterSheetOpen(true)} className="p-2.5 bg-slate-50 border border-slate-200 rounded-xl text-slate-500 hover:text-[#004F71] active:scale-95 transition-all">
                    <SlidersHorizontal className="w-5 h-5" />
                </button>
                <div className="flex flex-col">
                    <span className="text-[9px] font-black uppercase tracking-widest text-slate-400">View</span>
                    <span className="text-sm font-bold text-slate-900">{format(currentDate, "MMMM yyyy")}</span>
                </div>
            </div>
            
            <div className="flex bg-slate-100 p-1 rounded-xl">
                <button onClick={() => setViewMode("calendar")} className={cn("p-2 rounded-lg transition-all", viewMode === "calendar" ? "bg-white shadow-sm text-[#E51636]" : "text-slate-400")}><LayoutGrid className="w-4 h-4" /></button>
                <button onClick={() => setViewMode("timeline")} className={cn("p-2 rounded-lg transition-all", viewMode === "timeline" ? "bg-white shadow-sm text-[#E51636]" : "text-slate-400")}><ListEnd className="w-4 h-4" /></button>
                <button onClick={() => setViewMode("oneonone")} className={cn("p-2 rounded-lg transition-all", viewMode === "oneonone" ? "bg-white shadow-sm text-[#E51636]" : "text-slate-400")}><MessageSquare className="w-4 h-4" /></button>
            </div>
        </div>

        <div className="flex-1 relative overflow-hidden bg-white">
            {loading && <div className="absolute inset-0 bg-white/50 backdrop-blur-[2px] z-50 flex items-center justify-center"><Loader2 className="animate-spin text-[#E51636] w-12 h-12" /></div>}
            
            <AnimatePresence mode="wait">
                <motion.div key={viewMode} initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }} className="h-full">
                    {viewMode === "calendar" ? (
                        <div className="h-full overflow-y-auto no-scrollbar">
                            <CalendarGrid 
                                currentDate={currentDate} 
                                events={displayEvents} // Pass dynamic events
                                onDragEnd={handleDragEnd} 
                                onSelectEvent={setSelectedEvent} 
                                isStamping={!!activeSticker} 
                                onStamp={handleEventStamp}
                            />
                        </div>
                    ) : viewMode === "timeline" ? (
                        <div className="h-full">
                            <TimelineBoard 
                                currentDate={currentDate} 
                                events={displayEvents} // Pass dynamic events
                                onDragEnd={handleDragEnd} 
                                onSelectEvent={setSelectedEvent} 
                                isStamping={!!activeSticker} 
                                onStamp={handleEventStamp}
                            />
                        </div>
                    ) : (
                        <OneOnOneView events={events} onSelectEvent={setSelectedEvent} selectedUserId={null} />
                    )}
                </motion.div>
            </AnimatePresence>
        </div>
      </div>

      {/* --- MOBILE FAB --- */}
      <button 
        onClick={() => setIsCreatorOpen(true)}
        className="lg:hidden fixed bottom-28 right-6 w-14 h-14 bg-[#E51636] text-white rounded-full shadow-[0_10px_30px_-10px_rgba(229,22,54,0.5)] flex items-center justify-center z-50 active:scale-90 transition-transform border-4 border-white"
      >
        <Plus className="w-7 h-7" />
      </button>

      {/* --- FILTER SHEET (Mobile Only) --- */}
      <AnimatePresence>
        {isFilterSheetOpen && (
            <ClientPortal>
                <div className="fixed inset-0 z-[200] lg:hidden">
                    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" onClick={() => setIsFilterSheetOpen(false)} />
                    <motion.div 
                        initial={{ y: "100%" }} animate={{ y: 0 }} exit={{ y: "100%" }} transition={{ type: "spring", damping: 25, stiffness: 300 }}
                        className="absolute bottom-0 left-0 right-0 h-[85vh] bg-[#F8FAFC] rounded-t-[32px] overflow-hidden flex flex-col"
                    >
                        <div className="flex justify-center pt-3 pb-1"><div className="w-12 h-1.5 bg-slate-300 rounded-full" /></div>
                        <div className="flex justify-between items-center px-6 py-4 border-b border-slate-200">
                            <h2 className="text-lg font-black text-slate-900">Tactical Filters</h2>
                            <button onClick={() => setIsFilterSheetOpen(false)} className="p-2 bg-slate-100 rounded-full"><X className="w-5 h-5 text-slate-500" /></button>
                        </div>
                        <div className="flex-1 overflow-y-auto no-scrollbar">
                            <SidebarContent />
                        </div>
                        <div className="p-6 bg-white border-t border-slate-200 safe-area-pb">
                            <button onClick={() => setIsFilterSheetOpen(false)} className="w-full py-4 bg-[#004F71] text-white rounded-2xl font-black uppercase tracking-widest shadow-lg active:scale-95 transition-transform">Apply Filters</button>
                        </div>
                    </motion.div>
                </div>
            </ClientPortal>
        )}
      </AnimatePresence>

      {/* --- UNIFIED DYNAMIC LEGEND ISLAND --- */}
      <DynamicLegendIsland />

      {/* --- FLOATING STICKER TOOL --- */}
      <AnimatePresence>
          {activeSticker && (
              <motion.div 
                  initial={{ y: 100, opacity: 0, x: "-50%" }} 
                  animate={{ y: 0, opacity: 1, x: "-50%" }} 
                  exit={{ y: 100, opacity: 0, x: "-50%" }}
                  className="fixed bottom-12 left-1/2 z-[100] flex items-center gap-6 bg-[#0F172A] text-white px-8 py-4 rounded-[32px] shadow-2xl border border-white/10 backdrop-blur-2xl w-[90%] md:w-auto justify-between md:justify-start"
              >
                  <div className="flex items-center gap-4">
                      <div className={cn("w-10 h-10 rounded-xl flex items-center justify-center text-xl shadow-lg border-2 border-white/20", STICKERS.find(s => s.id === activeSticker)?.color)}>
                          {STICKERS.find(s => s.id === activeSticker)?.icon}
                      </div>
                      <div className="flex flex-col">
                          <span className="text-[10px] font-black uppercase tracking-[0.2em] text-blue-400">Stamping Active</span>
                          <span className="text-sm font-bold text-white">Click any mission to apply</span>
                      </div>
                  </div>
                  <div className="h-8 w-px bg-white/10 hidden md:block" />
                  <button onClick={() => setActiveSticker(null)} className="p-3 bg-white/10 hover:bg-red-500/20 text-slate-400 hover:text-red-400 rounded-full transition-all active:scale-90"><X className="w-5 h-5" /></button>
              </motion.div>
          )}
      </AnimatePresence>

      <AnimatePresence>{isCreatorOpen && <AdvancedCreateModal isOpen={isCreatorOpen} onClose={() => setIsCreatorOpen(false)} />}</AnimatePresence>
      <AnimatePresence>
          {selectedEvent && (
              <EventDetailSheet 
                  event={selectedEvent} 
                  onClose={() => setSelectedEvent(null)} 
                  onDelete={async (id) => { const loadToast = toast.loading("Decommissioning..."); try { await deleteDoc(doc(db, "events", id)); toast.success("Terminated", { id: loadToast }); setSelectedEvent(null); } catch (e) { toast.error("Error", { id: loadToast }); } }} 
                  onUpdate={async (id, updates) => { const loadToast = toast.loading("Updating..."); try { await updateDoc(doc(db, "events", id), { ...updates, updatedAt: serverTimestamp() }); toast.success("Synced", { id: loadToast }); setSelectedEvent(null); } catch (e) { toast.error("Error", { id: loadToast }); } }} 
                  isSystemEvent={selectedEvent.assigneeName === "System"}
              />
          )}
      </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/(main)/goals/page.tsx ---
"use client";

import { useState, useEffect, useMemo } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { 
  Plus, Target, MoreHorizontal, ArrowRight, CheckCircle2, 
  Clock, Sparkles, X, Loader2, Search
} from "lucide-react";
import { cn } from "@/lib/utils";

// Firebase & Global Store
import { db } from "@/lib/firebase";
import { collection, addDoc, updateDoc, doc, serverTimestamp } from "firebase/firestore";
import { useAppStore } from "@/lib/store/useStore";
import { CalendarEvent, Priority, TeamMember } from "../calendar/_components/types";

const COLUMNS = [
  { id: "To Do", label: "Future Vision", color: "bg-slate-300" },
  { id: "In Progress", label: "In Progress", color: "bg-blue-500" },
  { id: "Done", label: "Accomplished", color: "bg-emerald-500" },
];

export default function GoalsBoardPage() {
  const { events, team, subscribeEvents, subscribeTeam, loading } = useAppStore();
  const [isCreateOpen, setIsCreateOpen] = useState(false);
  const [newGoalTitle, setNewGoalTitle] = useState("");

  useEffect(() => {
    const unsubEvents = subscribeEvents();
    const unsubTeam = subscribeTeam();
    return () => { unsubEvents(); unsubTeam(); };
  }, [subscribeEvents, subscribeTeam]);

  // Filter only "Goal" type events
  const goals = useMemo(() => events.filter(e => e.type === "Goal"), [events]);

  const handleCreate = async () => {
    if (!newGoalTitle.trim()) return;
    await addDoc(collection(db, "events"), {
      title: newGoalTitle,
      type: "Goal",
      status: "To Do",
      priority: "Medium",
      startDate: new Date(),
      endDate: addDoc, // Default logic
      assignee: team[0]?.id || "System",
      assigneeName: team[0]?.name || "Director",
      createdAt: serverTimestamp()
    });
    setNewGoalTitle("");
    setIsCreateOpen(false);
  };

  const moveGoal = async (id: string, newStatus: string) => {
    await updateDoc(doc(db, "events", id), { status: newStatus });
  };

  return (
    <div className="min-h-screen bg-[#F8FAFC] p-8 font-sans">
      <div className="max-w-[1800px] mx-auto space-y-8 mt-20">
        <div className="flex justify-between items-end pb-6 border-b border-slate-200">
           <div>
              <h1 className="text-5xl font-black text-[#004F71]">Strategic Board</h1>
              <p className="mt-2 text-slate-500 font-medium">Manage high-level objectives. Synced with Operations Schedule.</p>
           </div>
           <button onClick={() => setIsCreateOpen(true)} className="h-12 px-6 bg-[#E51636] text-white rounded-xl font-black uppercase text-xs shadow-lg flex items-center gap-2">
              <Plus className="w-4 h-4" /> New Goal
           </button>
        </div>

        {loading ? (
            <div className="flex justify-center py-20"><Loader2 className="animate-spin text-slate-300" /></div>
        ) : (
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {COLUMNS.map((col) => (
                    <div key={col.id} className="flex flex-col gap-4">
                        <div className="flex items-center gap-2 px-2">
                            <div className={cn("w-3 h-3 rounded-full", col.color)} />
                            <h3 className="text-sm font-black text-slate-700 uppercase">{col.label}</h3>
                        </div>
                        <div className="flex-1 rounded-[24px] p-2 bg-slate-50/50 border border-dashed border-slate-200 min-h-[500px]">
                            <div className="space-y-3">
                                {goals.filter(g => g.status === col.id).map((goal) => (
                                    <motion.div layoutId={goal.id} key={goal.id} className="bg-white p-5 rounded-[20px] shadow-sm border border-slate-100 group">
                                        <div className="flex justify-between items-start mb-3">
                                            <span className="px-2 py-1 rounded-md bg-blue-50 text-blue-600 text-[9px] font-black uppercase tracking-wider">Goal</span>
                                            {col.id !== "Done" && (
                                                <button onClick={() => moveGoal(goal.id, "Done")} className="opacity-0 group-hover:opacity-100 p-1.5 hover:bg-emerald-50 text-emerald-500 rounded-md transition-all">
                                                    <CheckCircle2 className="w-4 h-4" />
                                                </button>
                                            )}
                                        </div>
                                        <h4 className="text-sm font-bold text-slate-800 leading-snug mb-4">{goal.title}</h4>
                                        <div className="flex items-center justify-between border-t pt-3">
                                            <div className="flex items-center gap-1.5 text-[10px] font-bold text-slate-400">
                                                <Clock className="w-3 h-3" /> Targeted
                                            </div>
                                            <div className="w-7 h-7 rounded-full bg-[#004F71] flex items-center justify-center text-[8px] font-black text-white">
                                                {goal.assignee.substring(0, 2).toUpperCase()}
                                            </div>
                                        </div>
                                    </motion.div>
                                ))}
                            </div>
                        </div>
                    </div>
                ))}
            </div>
        )}

        <AnimatePresence>
            {isCreateOpen && (
               <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                  <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="absolute inset-0 bg-[#004F71]/40 backdrop-blur-sm" onClick={() => setIsCreateOpen(false)} />
                  <motion.div initial={{ scale: 0.95, y: 20 }} animate={{ scale: 1, y: 0 }} className="relative w-full max-w-lg bg-white rounded-[32px] p-8 shadow-2xl">
                        <h2 className="text-2xl font-black mb-6">Create New Goal</h2>
                        <input autoFocus value={newGoalTitle} onChange={e => setNewGoalTitle(e.target.value)} className="w-full text-lg font-bold border-b-2 outline-none mb-8 focus:border-[#E51636]" placeholder="Improve speed of service..." />
                        <button onClick={handleCreate} className="w-full py-4 bg-[#004F71] text-white rounded-xl font-black uppercase shadow-lg">Launch Objective</button>
                  </motion.div>
               </div>
            )}
        </AnimatePresence>
      </div>
    </div>
  );
}
--- FILE: ./app/(main)/training/page.tsx ---
"use client";

import { useState, useRef, useEffect, useMemo, useCallback } from "react";
import { 
  motion, AnimatePresence, useDragControls, LayoutGroup, Transition, Reorder 
} from "framer-motion";
import { 
  Plus, Trash2, GripVertical, Eye, Settings, X, Utensils, Coffee, 
  Cloud, Maximize2, CalendarClock, BookOpen, Loader2, 
  ChevronDown, Hash, ChevronRight, ChevronUp, Filter, Minimize2, CheckCircle2,
  Expand, AlignLeft, ArrowLeft, Clock, FileText, Sparkles, AlertTriangle, Target
} from "lucide-react";
import { cn } from "@/lib/utils";

// Firebase & Store imports
import { db, storage } from "@/lib/firebase";
import { 
  collection, query, where, onSnapshot, addDoc, updateDoc, deleteDoc, serverTimestamp, doc
} from "firebase/firestore";
import { ref, uploadBytes, getDownloadURL } from "firebase/storage";
import ClientPortal from "@/components/core/ClientPortal";

// --- TYPES ---
import { Department } from "../calendar/_components/types";

interface Task {
  id: string;
  title: string;
  image?: string;
  duration?: string;
  type?: 'task' | 'subject'; 
  color?: string; 
}

interface Section {
  id: string;
  title: string;
  duration: string;
  pageStart: number;
  pageEnd: number;
  tasks: Task[];
  dept: Department;
  order: number;
}

const CANVA_LINKS: Record<string, string> = {
  FOH: "https://www.canva.com/design/DAG7sot3RWY/Sv-7Y3IEyBqUUFB999JiPA/view",
  BOH: "https://www.canva.com/design/DAG7ssYg444/FFZwbb8mLfLGiGrP2VeHiA/view",
  Unassigned: "https://www.canva.com/design/DAG7sot3RWY/Sv-7Y3IEyBqUUFB999JiPA/view" 
};

// --- PRESET COLORS FOR SUBJECTS ---
const SUBJECT_COLORS = [
    { id: "slate", hex: "#f8fafc", bg: "bg-slate-50", text: "text-slate-500", border: "border-slate-200", dot: "bg-slate-400" }, 
    { id: "navy", hex: "#f0f9ff", bg: "bg-[#004F71]/10", text: "text-[#004F71]", border: "border-[#004F71]/20", dot: "bg-[#004F71]" }, 
    { id: "red", hex: "#fff1f2", bg: "bg-[#E51636]/10", text: "text-[#E51636]", border: "border-[#E51636]/20", dot: "bg-[#E51636]" }, 
    { id: "amber", hex: "#fffbeb", bg: "bg-amber-50", text: "text-amber-600", border: "border-amber-200", dot: "bg-amber-400" },
];

const SPRING_TRANSITION: Transition = {
  type: "spring",
  stiffness: 350,
  damping: 30,
  mass: 0.8
};

// --- UTILS ---
function debounce<T extends (...args: any[]) => void>(func: T, wait: number): T {
    let timeout: NodeJS.Timeout;
    return ((...args: any[]) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func(...args), wait);
    }) as T;
}

// --- COMPONENTS ---

// 1. Ambient Background
function AmbientBackground({ activeDept }: { activeDept: Department }) {
    return (
        <div className="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
            <motion.div animate={{ background: activeDept === "FOH" ? "radial-gradient(circle at 10% 10%, rgba(0, 79, 113, 0.12) 0%, transparent 60%)" : "radial-gradient(circle at 10% 10%, rgba(229, 22, 54, 0.12) 0%, transparent 60%)" }} className="absolute top-[-20%] left-[-10%] w-[80vw] h-[80vw] transition-all duration-1000 blur-[100px]" />
            <motion.div animate={{ background: activeDept === "FOH" ? "radial-gradient(circle at 90% 90%, rgba(0, 79, 113, 0.08) 0%, transparent 60%)" : "radial-gradient(circle at 90% 90%, rgba(229, 22, 54, 0.08) 0%, transparent 60%)" }} className="absolute bottom-[-20%] right-[-10%] w-[80vw] h-[80vw] transition-all duration-1000 blur-[100px]" />
            <div className="absolute inset-0 opacity-[0.015] bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-repeat" />
        </div>
    );
}

// 2. Page Range Selector
function PageRangeSelector({ start, end, onUpdate, readOnly }: any) {
    if (readOnly) {
        return (
             <div className="flex items-center gap-1.5 px-2.5 py-1 bg-white/50 backdrop-blur-sm rounded-lg border border-slate-200/60 shadow-sm">
                <Hash className="w-3.5 h-3.5 text-slate-400" />
                <span className="text-[10px] font-bold text-slate-600 uppercase tracking-wide">Pg {start}-{end}</span>
            </div>
        );
    }
    const adjust = (field: 'pageStart' | 'pageEnd', amount: number) => {
        const currentVal = field === 'pageStart' ? start : end;
        const newVal = Math.max(1, (currentVal || 0) + amount);
        onUpdate({ [field]: newVal });
    };
    return (
        <div className="flex items-center bg-white/90 backdrop-blur-md border border-slate-200 rounded-full p-1 shadow-lg ring-1 ring-black/5" onClick={(e) => e.stopPropagation()}>
            <div className="px-2 md:px-3 flex items-center gap-2 border-r border-slate-200/60"><Hash className="w-3 h-3 md:w-3.5 md:h-3.5 text-[#004F71]" /><span className="text-[9px] md:text-[10px] font-black uppercase text-slate-500 tracking-widest hidden md:inline">Pages</span></div>
            <div className="flex items-center px-1.5 md:px-2 group/page relative min-w-[28px] md:min-w-[36px] justify-center"><span className="text-xs md:text-sm font-black text-slate-900 tabular-nums">{start || 1}</span><div className="flex flex-col ml-1 opacity-0 group-hover/page:opacity-100 transition-opacity absolute -top-8 bg-white shadow-md rounded-lg p-1 pointer-events-none group-hover/page:pointer-events-auto"><button onClick={() => adjust('pageStart', 1)} className="text-slate-400 hover:text-[#004F71]"><ChevronUp className="w-3 h-3" /></button><button onClick={() => adjust('pageStart', -1)} className="text-slate-400 hover:text-[#004F71]"><ChevronDown className="w-3 h-3" /></button></div></div>
            <div className="text-slate-300 font-bold px-0.5 opacity-40 text-[10px] md:text-xs">—</div>
            <div className="flex items-center px-1.5 md:px-2 group/page relative min-w-[28px] md:min-w-[36px] justify-center"><span className="text-xs md:text-sm font-black text-slate-900 tabular-nums">{end || 2}</span><div className="flex flex-col ml-1 opacity-0 group-hover/page:opacity-100 transition-opacity absolute -top-8 bg-white shadow-md rounded-lg p-1 pointer-events-none group-hover/page:pointer-events-auto"><button onClick={() => adjust('pageEnd', 1)} className="text-slate-400 hover:text-[#004F71]"><ChevronUp className="w-3 h-3" /></button><button onClick={() => adjust('pageEnd', -1)} className="text-slate-400 hover:text-[#004F71]"><ChevronDown className="w-3 h-3" /></button></div></div>
        </div>
    );
}

// 3. Dynamic Island
function TrainingDynamicIsland({ activeDept, setActiveDept, activePhaseIndex, activePhaseTitle, previewMode, setPreviewMode, viewMode, onBack }: any) {
    const [isOpen, setIsOpen] = useState(false);
    const containerRef = useRef<HTMLDivElement>(null);
    useEffect(() => {
        const handleClickOutside = (event: MouseEvent) => { if (containerRef.current && !containerRef.current.contains(event.target as Node)) setIsOpen(false); };
        document.addEventListener("mousedown", handleClickOutside);
        return () => document.removeEventListener("mousedown", handleClickOutside);
    }, []);
    const brandColor = activeDept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]";
    const brandShadow = activeDept === "FOH" ? "shadow-blue-500/20" : "shadow-red-500/20";
    const activeEditorClass = activeDept === "FOH" ? "bg-[#004F71] border-[#004F71] shadow-lg shadow-blue-900/20" : "bg-[#E51636] border-[#E51636] shadow-lg shadow-red-900/20";

    return (
        <div className="fixed top-24 left-0 right-0 z-[90] flex justify-center pointer-events-none px-4">
            <LayoutGroup>
                <motion.div ref={containerRef} layout initial={false} transition={SPRING_TRANSITION} onClick={() => !isOpen && setIsOpen(true)} className={cn("pointer-events-auto bg-white/80 backdrop-blur-xl border shadow-[0_20px_50px_-12px_rgba(0,0,0,0.1)] flex flex-col ring-1 ring-black/5 transform-gpu origin-top relative overflow-hidden", isOpen ? "rounded-[32px] w-full max-w-[420px] border-white/60" : "rounded-full w-auto border-white/40 cursor-pointer hover:scale-[1.02] hover:bg-white/90")}>
                    <AnimatePresence mode="popLayout" initial={false}>
                        {!isOpen ? (
                            <motion.div key="collapsed" layout="position" initial={{ opacity: 0, filter: "blur(4px)" }} animate={{ opacity: 1, filter: "blur(0px)" }} exit={{ opacity: 0, filter: "blur(4px)", transition: { duration: 0.15 } }} className="flex items-center gap-3 px-1.5 py-1.5 pr-4 h-14 relative w-full">
                                <motion.div layoutId="icon-container">
                                    {viewMode === 'detail' ? (
                                        <button onClick={(e) => { e.stopPropagation(); onBack(); }} className={cn("w-10 h-10 rounded-full flex items-center justify-center text-white shadow-md shrink-0 transition-transform hover:scale-110 active:scale-95", brandColor, brandShadow)}><ArrowLeft className="w-5 h-5" /></button>
                                    ) : (
                                        <div className={cn("w-10 h-10 rounded-full flex items-center justify-center text-white shadow-md shrink-0 transition-colors", brandColor, brandShadow)}>{activeDept === "FOH" ? <Coffee className="w-5 h-5" /> : <Utensils className="w-5 h-5" />}</div>
                                    )}
                                </motion.div>
                                <motion.div layout="position" className="flex flex-col justify-center min-w-[120px]">
                                    <motion.span layoutId="title-text" className="text-[11px] font-black uppercase tracking-widest text-slate-800 leading-tight whitespace-nowrap">{viewMode === 'grid' ? "Training Dashboard" : `Phase ${String(activePhaseIndex + 1).padStart(2, '0')}`}</motion.span>
                                    <motion.span layoutId="subtitle-text" className="text-[9px] font-bold text-slate-400 whitespace-nowrap truncate max-w-[140px]">{viewMode === 'grid' ? "Select a phase to edit" : activePhaseTitle || "Curriculum Loading..."}</motion.span>
                                </motion.div>
                                <motion.div layoutId="chevron" className="opacity-40 pl-1 border-l border-slate-200 ml-1"><ChevronDown className="w-4 h-4 ml-2" /></motion.div>
                            </motion.div>
                        ) : (
                            <motion.div key="expanded" layout="position" initial={{ opacity: 0, filter: "blur(4px)" }} animate={{ opacity: 1, filter: "blur(0px)" }} exit={{ opacity: 0, filter: "blur(4px)", transition: { duration: 0.15 } }} className="flex flex-col p-3 gap-4 w-full">
                                <div className="flex items-center justify-between px-2"><div className="flex items-center gap-3"><motion.div layoutId="icon-container" className="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center text-slate-500"><Filter className="w-4 h-4" /></motion.div><motion.span layoutId="title-text" className="text-[10px] font-black uppercase tracking-widest text-slate-400">Configuration</motion.span></div><motion.button layoutId="chevron" onClick={(e) => { e.stopPropagation(); setIsOpen(false); }} className="w-8 h-8 flex items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200 transition-colors"><X className="w-4 h-4" /></motion.button></div>
                                <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="bg-slate-50 p-1 rounded-[20px] flex relative border border-slate-100">
                                    {(["FOH", "BOH"] as const).map((dept) => { const isActive = activeDept === dept; return (<button key={dept} onClick={() => setActiveDept(dept)} className={cn("flex-1 py-3 rounded-[16px] text-[10px] font-black uppercase tracking-widest relative z-10 transition-colors duration-200 flex items-center justify-center gap-1.5", isActive ? "text-white" : "text-slate-400 hover:text-slate-600")}>{isActive && (<motion.div layoutId="activeFilterBg" className={cn("absolute inset-0 rounded-[16px] shadow-sm", dept === "FOH" ? "bg-[#004F71] shadow-blue-500/20" : "bg-[#E51636] shadow-red-500/20")} transition={SPRING_TRANSITION} />)}<span className="relative z-10 flex items-center gap-2">{dept === "FOH" ? <Coffee className="w-3.5 h-3.5" /> : <Utensils className="w-3.5 h-3.5" />}{dept} Training</span></button>); })}
                                </motion.div>
                                <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="h-px bg-slate-100 w-full" />
                                <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="px-1 pb-1"><button onClick={() => setPreviewMode(!previewMode)} className={cn("w-full flex items-center justify-between px-4 py-3.5 rounded-2xl border transition-all duration-200 text-left group relative overflow-hidden", !previewMode ? cn("text-white", activeEditorClass) : "bg-white border-slate-100 hover:border-slate-200 text-slate-500 hover:bg-slate-50")}><div className="flex items-center gap-3">{!previewMode ? <Settings className="w-4 h-4 text-white" /> : <Eye className="w-4 h-4" />}<span className="text-[10px] font-bold uppercase tracking-wider">{!previewMode ? "Editor Active" : "Preview Mode Active"}</span></div><div className={cn("w-2 h-2 rounded-full", !previewMode ? "bg-white animate-pulse" : "bg-slate-300")} /></button></motion.div>
                            </motion.div>
                        )}
                    </AnimatePresence>
                </motion.div>
            </LayoutGroup>
        </div>
    );
}

// 4. Draggable Task
const DraggableTask = ({ task, activeDept, previewMode, handleFileUpload, updateSection, saveSection, setViewingImage, section, onInteract }: any) => {
    const controls = useDragControls();
    const isSubject = task.type === 'subject';
    const colorTheme = SUBJECT_COLORS.find(c => c.id === task.color) || SUBJECT_COLORS[0];
    const subjectClasses = isSubject ? cn(colorTheme.bg, colorTheme.text, "rounded-xl border", colorTheme.border, "shadow-sm") : "bg-slate-50/50 rounded-xl md:rounded-2xl border border-transparent hover:border-slate-200 hover:bg-white";

    return (
        <Reorder.Item value={task} dragListener={false} dragControls={controls} className="relative">
            <motion.div layout className={cn("group transition-all flex flex-col gap-3 relative p-3 md:p-4", isSubject ? "mt-4 mb-2" : "", subjectClasses)}>
                <div className="flex items-center gap-3 md:gap-4">
                    <div className="shrink-0 cursor-grab active:cursor-grabbing touch-none" onPointerDown={(e) => !previewMode && controls.start(e)}>{isSubject ? <div className="w-6 h-6 flex items-center justify-center bg-white/50 rounded-lg"><AlignLeft className={cn("w-3.5 h-3.5", colorTheme.text)} /></div> : !previewMode ? <GripVertical className="w-4 h-4 text-slate-200 hover:text-slate-400 transition-colors" /> : <CheckCircle2 className="w-4 h-4 text-slate-300" />}</div>
                    <div className="flex-1">
                        {previewMode ? <p className={cn("whitespace-pre-wrap break-words", isSubject ? cn("text-xs font-[900] uppercase tracking-[0.2em]", colorTheme.text) : "text-sm font-medium text-slate-700")}>{task.title || (isSubject ? "UNNAMED SUBJECT" : "Untitled Objective")}</p> : 
                        <textarea value={task.title} onChange={e => { const val = e.target.value; const newTasks = section.tasks.map((t: Task) => t.id === task.id ? { ...t, title: val } : t); updateSection(section.id, { tasks: newTasks }); saveSection(section.id, { tasks: newTasks }); e.target.style.height = 'auto'; e.target.style.height = `${e.target.scrollHeight}px`; }} onFocus={() => onInteract(true, section.id)} onBlur={() => onInteract(false)} className={cn("w-full bg-transparent outline-none resize-none overflow-hidden", isSubject ? cn("text-xs font-[900] uppercase tracking-[0.2em] placeholder:opacity-50", colorTheme.text) : "text-sm font-bold text-slate-700 placeholder:text-slate-300")} placeholder={isSubject ? "SUBJECT HEADER..." : "Enter objective..."} rows={1} onClick={(e) => e.stopPropagation()} ref={(el) => { if (el) { el.style.height = 'auto'; el.style.height = `${el.scrollHeight}px`; } }} />}
                    </div>
                    <AnimatePresence>{!previewMode && (<motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="flex items-center gap-2 self-start pt-1">{isSubject && (<div className="flex gap-1.5 bg-white/60 p-1.5 rounded-lg border border-slate-200/50 shadow-sm backdrop-blur-sm">{SUBJECT_COLORS.map(c => (<button key={c.id} onClick={(e) => { e.stopPropagation(); const newTasks = section.tasks.map((t: Task) => t.id === task.id ? { ...t, color: c.id } : t); updateSection(section.id, { tasks: newTasks }); saveSection(section.id, { tasks: newTasks }); }} className={cn("w-3.5 h-3.5 rounded-full transition-transform hover:scale-125 border border-black/5", c.dot, task.color === c.id ? "ring-2 ring-slate-400 scale-110" : "")} title={c.id} />))}</div>)}{!isSubject && (<label onClick={(e) => e.stopPropagation()} className="cursor-pointer p-2 hover:bg-blue-50 text-slate-300 hover:text-blue-50 rounded-lg transition-all shrink-0"><Cloud className="w-4 h-4" /><input type="file" className="hidden" accept="image/*" onChange={e => handleFileUpload(section, task.id, e)} /></label>)}<button onClick={(e) => { e.stopPropagation(); const newTasks = section.tasks.filter((t: Task) => t.id !== task.id); updateSection(section.id, { tasks: newTasks }); saveSection(section.id, { tasks: newTasks }); }} className="p-2 text-slate-300 hover:text-red-500 shrink-0"><X className="w-4 h-4" /></button></motion.div>)}</AnimatePresence>
                </div>
                {!isSubject && task.image && <motion.div layoutId={`image-${task.id}`} onClick={() => setViewingImage({ id: task.id, url: task.image! })} className={cn("relative w-full overflow-hidden rounded-xl border shadow-sm cursor-zoom-in group/img transition-all bg-slate-100", "aspect-[16/9] md:aspect-[21/9]", activeDept === "FOH" ? "border-[#004F71]/10 hover:border-[#004F71]/40" : "border-[#E51636]/10 hover:border-[#E51636]/40")}><img src={task.image} alt="" className="absolute inset-0 w-full h-full object-cover blur-2xl scale-125 opacity-40 saturate-200" /><motion.img src={task.image} className="relative z-10 w-full h-full object-contain transition-transform duration-700 group-hover/img:scale-[1.02]" /><div className="absolute inset-0 z-20 bg-black/0 group-hover/img:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover/img:opacity-100 pointer-events-none"><div className="bg-white/20 backdrop-blur-md p-2.5 rounded-full text-white border border-white/40 shadow-lg"><Expand className="w-5 h-5" /></div></div></motion.div>}
            </motion.div>
        </Reorder.Item>
    );
};

// --- MAIN PAGE ---
export default function TrainingBuilderPage() {
  const [sections, setSections] = useState<Section[]>([]);
  const [activeDept, setActiveDept] = useState<Department>("FOH");
  const [previewMode, setPreviewMode] = useState(false);
  const [viewMode, setViewMode] = useState<'grid' | 'detail'>('grid');
  const [activeSectionId, setActiveSectionId] = useState<string | null>(null);
  const [iframeLoading, setIframeLoading] = useState(false);
  const [isProcessing, setIsProcessing] = useState(false);
  const [viewingImage, setViewingImage] = useState<{ id: string, url: string } | null>(null);
  const [mobileViewerOpen, setMobileViewerOpen] = useState(false);
  const [deletingId, setDeletingId] = useState<string | null>(null); // For Delete Modal

  // SEPARATE LOCKS
  const isTypingRef = useRef(false); // Blocks data snapshot
  const isScrollLockedRef = useRef(false); // Blocks scroll spy

  const sectionsRef = useRef<Section[]>([]);
  const dragControls = useDragControls();

  const debouncedSaveSection = useMemo(() => debounce(async (id: string, updates: Partial<Section>) => {
      await updateDoc(doc(db, "curriculum", id), updates);
  }, 1000), []);

  const optimisticUpdateSection = (id: string, updates: Partial<Section>) => {
      setSections(prev => {
          const next = prev.map(s => s.id === id ? { ...s, ...updates } : s);
          sectionsRef.current = next; 
          return next;
      });
  };

  useEffect(() => {
    const q = query(collection(db, "curriculum"), where("dept", "==", activeDept));
    const unsubscribe = onSnapshot(q, (snapshot) => {
      // FIX: Only block snapshot if TYPING. Do NOT block if we just added a section.
      if (isTypingRef.current) return;

      const data = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })) as Section[];
      const sortedData = data.sort((a, b) => (a.order || 0) - (b.order || 0));
      setSections(sortedData);
      sectionsRef.current = sortedData; 
    });
    return () => unsubscribe();
  }, [activeDept]);

  const activeIndex = sections.findIndex(s => s.id === activeSectionId);
  const activeSection = useMemo(() => sections.find(s => s.id === activeSectionId), [sections, activeSectionId]);

  const handleInteraction = useCallback((isTyping: boolean, sectionId?: string) => {
      isTypingRef.current = isTyping; // Lock Data Sync
      if (isTyping && sectionId) {
          isScrollLockedRef.current = true; // Lock Scroll Spy
      } else {
          setTimeout(() => { isScrollLockedRef.current = false; }, 800);
      }
  }, []);

  // Helper for ADD buttons - blocks Scroll Spy ONLY
  const lockScrollOnly = () => {
      isScrollLockedRef.current = true;
      setTimeout(() => { isScrollLockedRef.current = false; }, 1000);
  };

  const getEmbedUrl = () => {
    if (!activeSection || !activeSection.pageStart) return null;
    const link = CANVA_LINKS[activeDept] || CANVA_LINKS.FOH;
    const base = link.split('?')[0];
    return `${base}?embed#${activeSection.pageStart}`;
  };

  const addSection = async () => {
    lockScrollOnly(); // Stop scroll spy from jumping
    const nextOrder = sections.length > 0 ? (sections[sections.length - 1].order || 0) + 1 : 0;
    const lastPage = sections.length > 0 ? (Number(sections[sections.length - 1].pageEnd) || 0) : 0;
    
    // OPTIMISTIC ADD
    const tempId = `temp-${Date.now()}`;
    const newSection: Section = { id: tempId, title: "New Training Phase", duration: "Day 1", pageStart: lastPage + 1, pageEnd: lastPage + 2, tasks: [], dept: activeDept, order: nextOrder };
    
    setSections(prev => {
        const next = [...prev, newSection];
        sectionsRef.current = next;
        return next;
    });

    // Real DB Add (Snapshot will eventually replace tempId with real ID)
    await addDoc(collection(db, "curriculum"), {
        title: "New Training Phase", duration: "Day 1", pageStart: lastPage + 1, pageEnd: lastPage + 2,
        tasks: [], dept: activeDept, order: nextOrder, createdAt: serverTimestamp()
    });
  };

  const confirmDelete = async () => {
      if(!deletingId) return;
      // Optimistic Delete
      const remaining = sections.filter(s => s.id !== deletingId);
      setSections(remaining);
      sectionsRef.current = remaining;
      
      await deleteDoc(doc(db, "curriculum", deletingId));
      
      setDeletingId(null);
      if(activeSectionId === deletingId) exitPhase();
  };

  const handleFileUpload = async (section: Section, taskId: string, e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;
    setIsProcessing(true);
    try {
      const storageRef = ref(storage, `curriculum/${activeDept}/${section.id}/${taskId}`);
      const snapshot = await uploadBytes(storageRef, file);
      const url = await getDownloadURL(snapshot.ref);
      const newTasks = section.tasks.map(t => t.id === taskId ? { ...t, image: url } : t);
      optimisticUpdateSection(section.id, { tasks: newTasks });
      await updateDoc(doc(db, "curriculum", section.id), { tasks: newTasks });
    } catch (error) { console.error(error); } finally { setIsProcessing(false); }
  };

  const enterPhase = (id: string) => { setActiveSectionId(id); setViewMode('detail'); window.scrollTo({ top: 0, behavior: 'smooth' }); };
  const exitPhase = () => { setViewMode('grid'); setActiveSectionId(null); };

  // --- DYNAMIC BRAND COLOR ---
  const brandColor = activeDept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]";

  return (
    <div className="min-h-screen bg-[#F8FAFC] pb-32 font-sans relative">
      <AmbientBackground activeDept={activeDept} />

      <TrainingDynamicIsland 
        activeDept={activeDept}
        setActiveDept={setActiveDept}
        activePhaseIndex={activeIndex !== -1 ? activeIndex : 0}
        activePhaseTitle={activeSection?.title || "Overview"}
        previewMode={previewMode}
        setPreviewMode={setPreviewMode}
        viewMode={viewMode}
        onBack={exitPhase}
      />

      <div className="max-w-[1800px] mx-auto px-4 md:px-6 pt-40 md:pt-48 pb-32 relative z-10">
         {viewMode === 'grid' && (
             <motion.div 
                initial={{ opacity: 0 }} 
                animate={{ opacity: 1 }} 
                exit={{ opacity: 0 }} 
                className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"
             >
                 {sections.map((section, idx) => {
                     // Dynamic Color Logic based on Dept
                     const isFoh = activeDept === "FOH";
                     const accentColor = isFoh ? "text-[#004F71]" : "text-[#E51636]";
                     const gradientBg = isFoh 
                        ? "from-blue-50/80 via-white/40 to-cyan-50/30" 
                        : "from-red-50/80 via-white/40 to-orange-50/30";
                     const glowColor = isFoh ? "group-hover:shadow-blue-900/20" : "group-hover:shadow-red-900/20";
                     const ringColor = isFoh ? "group-hover:ring-[#004F71]/20" : "group-hover:ring-[#E51636]/20";

                     return (
                         <motion.div 
                            key={section.id} 
                            layoutId={`card-${section.id}`} 
                            onClick={() => enterPhase(section.id)} 
                            className={cn(
                                "relative overflow-hidden rounded-[40px] h-[340px] cursor-pointer group transition-all duration-500",
                                "bg-gradient-to-br border border-white/60 shadow-[0_20px_40px_-12px_rgba(0,0,0,0.08)]",
                                "hover:-translate-y-2 hover:scale-[1.02]", 
                                gradientBg, glowColor, ringColor,
                                "ring-1 ring-transparent backdrop-blur-xl"
                            )}
                         >
                            {/* 1. BACKGROUND ART */}
                            <div className="absolute inset-0 z-0">
                                {/* Huge Watermark Number */}
                                <span className={cn(
                                    "absolute -right-6 -bottom-16 text-[220px] font-[1000] leading-none tracking-tighter opacity-5 transition-transform duration-700 group-hover:scale-110 group-hover:-rotate-6 select-none",
                                    isFoh ? "text-blue-900" : "text-red-900"
                                )}>
                                    {idx + 1}
                                </span>
                                
                                {/* Noise Texture */}
                                <div className="absolute inset-0 opacity-[0.03] bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]" />
                                
                                {/* Ambient Blob */}
                                <div className={cn(
                                    "absolute top-0 right-0 w-64 h-64 blur-[80px] opacity-0 group-hover:opacity-40 transition-opacity duration-700",
                                    isFoh ? "bg-cyan-400" : "bg-rose-400"
                                )} />
                            </div>

                            {/* 2. CARD CONTENT */}
                            <div className="relative z-10 p-8 h-full flex flex-col justify-between">
                                
                                {/* Top: Header */}
                                <div className="flex justify-between items-start">
                                    <div className={cn(
                                        "h-12 px-4 rounded-2xl flex items-center gap-2 font-black text-xs uppercase tracking-widest shadow-sm border border-white/50 bg-white/60 backdrop-blur-md",
                                        accentColor
                                    )}>
                                        <Target className="w-3.5 h-3.5" />
                                        <span>Phase {String(idx + 1).padStart(2, '0')}</span>
                                    </div>
                                    
                                    <button 
                                        onClick={(e) => { e.stopPropagation(); setDeletingId(section.id); }} 
                                        className="w-10 h-10 rounded-full flex items-center justify-center bg-white/40 hover:bg-white text-slate-400 hover:text-red-500 transition-all shadow-sm border border-white/20 active:scale-90"
                                    >
                                        <Trash2 className="w-4 h-4" />
                                    </button>
                                </div>

                                {/* Middle: Title */}
                                <div className="space-y-3">
                                    <h3 className="text-3xl md:text-4xl font-[1000] text-slate-900 tracking-tighter leading-[0.95] line-clamp-3 group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-br from-slate-900 to-slate-600 transition-all">
                                        {section.title}
                                    </h3>
                                    <div className="w-12 h-1 rounded-full bg-slate-900/10 group-hover:w-24 group-hover:bg-slate-900/20 transition-all duration-500" />
                                </div>

                                {/* Bottom: HUD Stats */}
                                <div className="grid grid-cols-2 gap-3 pt-4">
                                    <div className="flex flex-col justify-center p-3 rounded-2xl bg-white/50 border border-white/60 shadow-sm backdrop-blur-md group-hover:bg-white/80 transition-colors">
                                        <div className="flex items-center gap-1.5 text-[9px] font-black uppercase text-slate-400 tracking-widest mb-1">
                                            <Clock className="w-3 h-3" /> Est. Time
                                        </div>
                                        <span className="text-sm font-black text-slate-800">{section.duration}</span>
                                    </div>

                                    <div className="flex flex-col justify-center p-3 rounded-2xl bg-white/50 border border-white/60 shadow-sm backdrop-blur-md group-hover:bg-white/80 transition-colors">
                                        <div className="flex items-center gap-1.5 text-[9px] font-black uppercase text-slate-400 tracking-widest mb-1">
                                            <BookOpen className="w-3 h-3" /> Manual
                                        </div>
                                        <span className="text-sm font-black text-slate-800">Pg {section.pageStart}-{section.pageEnd}</span>
                                    </div>
                                </div>

                                {/* Hover Action Overlay (Mobile: Always visible, Desktop: Hover) */}
                                <div className="absolute inset-x-8 bottom-8 translate-y-4 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 hidden md:flex items-center justify-center">
                                    <div className={cn(
                                        "w-full py-4 rounded-2xl flex items-center justify-center gap-2 text-xs font-black uppercase tracking-[0.2em] text-white shadow-xl",
                                        isFoh ? "bg-[#004F71]" : "bg-[#E51636]"
                                    )}>
                                        <Sparkles className="w-3.5 h-3.5 fill-current" />
                                        <span>Enter Phase</span>
                                    </div>
                                </div>
                            </div>
                         </motion.div>
                     );
                 })}

                 {/* --- THE "ADD NEW" BLUEPRINT CARD --- */}
                 <button 
                    onClick={addSection} 
                    className="relative group h-[340px] rounded-[40px] border-4 border-dashed border-slate-200 hover:border-[#004F71]/30 bg-slate-50/50 hover:bg-[#004F71]/5 transition-all duration-300 flex flex-col items-center justify-center gap-6 overflow-hidden"
                 >
                     {/* Animated Grid Background */}
                     <div className="absolute inset-0 opacity-10 bg-[radial-gradient(#004F71_1px,transparent_1px)] [background-size:24px_24px] group-hover:opacity-20 transition-opacity" />
                     
                     <div className="relative z-10 w-24 h-24 rounded-3xl bg-white shadow-xl flex items-center justify-center group-hover:scale-110 group-hover:rotate-90 transition-all duration-500 border border-slate-100">
                        <Plus className="w-10 h-10 text-slate-300 group-hover:text-[#004F71] transition-colors" />
                     </div>
                     <div className="relative z-10 text-center">
                         <h3 className="text-lg font-black text-slate-400 uppercase tracking-widest group-hover:text-[#004F71] transition-colors">Initialize Phase</h3>
                         <p className="text-[10px] font-bold text-slate-300 uppercase tracking-widest mt-1 group-hover:text-slate-500">Create new learning module</p>
                     </div>
                 </button>
             </motion.div>
         )}

         {viewMode === 'detail' && activeSection && (
             <div className="flex flex-col-reverse md:grid md:grid-cols-12 gap-6 md:gap-12 animate-in fade-in zoom-in-95 duration-300 pb-32 md:pb-0">
                 
                 {/* --- LEFT COLUMN: TASK LIST --- */}
                 <div className="md:col-span-12 lg:col-span-7 space-y-6">
                     {/* Removed Redundant "Back to Grid" Button here */}
                     
                     <div className="relative">
                        {/* Desktop-only Badge */}
                        <div className={cn("hidden md:flex absolute -left-[69px] top-0 w-12 h-12 rounded-2xl flex-col items-center justify-center font-black text-white shadow-lg border-4 border-[#F8FAFC] z-20", activeDept === "FOH" ? "bg-[#004F71] scale-110" : "bg-[#E51636] scale-110")}><span className="text-[8px] opacity-60 uppercase font-black">Ph</span><span className="text-base">{activeIndex + 1}</span></div>
                        
                        <div className="bg-white rounded-[32px] p-4 md:p-8 border border-slate-200 shadow-xl ring-1 ring-black/5 relative z-10">
                             {/* UPDATED HEADER LAYOUT FOR MOBILE COMPATIBILITY */}
                             <div className="flex flex-col-reverse md:flex-row justify-between items-start mb-6 md:mb-8 gap-4 md:gap-6">
                                <div className="flex-1 space-y-3 w-full">
                                   <div className="flex items-center gap-3">
                                       <div className="flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-slate-50 border border-slate-100 text-[10px] font-black uppercase text-slate-400 shadow-inner">
                                           <CalendarClock className="w-3.5 h-3.5" />
                                           {previewMode ? <span className="font-black text-slate-600">{activeSection.duration}</span> : <input value={activeSection.duration} onChange={e => { optimisticUpdateSection(activeSection.id, { duration: e.target.value }); debouncedSaveSection(activeSection.id, { duration: e.target.value }); }} className="bg-transparent border-none focus:outline-none w-16 md:w-20 p-0 font-black" />}
                                       </div>
                                       <span className="text-[10px] font-bold text-slate-300 uppercase tracking-widest">{activeSection.tasks.length} Modules</span>
                                   </div>
                                   {previewMode ? (<h3 className="text-2xl md:text-3xl font-black text-slate-900 tracking-tighter leading-tight">{activeSection.title}</h3>) : (<textarea value={activeSection.title} onChange={(e) => { const val = e.target.value; optimisticUpdateSection(activeSection.id, { title: val }); debouncedSaveSection(activeSection.id, { title: val }); e.target.style.height = 'auto'; e.target.style.height = `${e.target.scrollHeight}px`; }} className="text-2xl md:text-3xl font-black text-slate-900 bg-transparent w-full outline-none border-none focus:ring-0 p-0 tracking-tighter resize-none overflow-hidden" rows={1} ref={(el) => { if (el) { el.style.height = 'auto'; el.style.height = `${el.scrollHeight}px`; } }} />)}
                                </div>
                                <div className="flex items-center justify-between md:justify-start w-full md:w-auto gap-3 shrink-0">
                                    <PageRangeSelector start={activeSection.pageStart} end={activeSection.pageEnd} onUpdate={(u: any) => { optimisticUpdateSection(activeSection.id, u); debouncedSaveSection(activeSection.id, u); }} readOnly={previewMode} />
                                    <AnimatePresence>{!previewMode && (<motion.button initial={{ opacity: 0, scale: 0.5 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.5 }} onClick={() => setDeletingId(activeSection.id)} className="p-3 text-slate-300 hover:text-red-500 transition-all bg-slate-50 rounded-2xl border border-slate-200 hover:shadow-md active:scale-90"><Trash2 className="w-4 h-4" /></motion.button>)}</AnimatePresence>
                                </div>
                             </div>
                             
                             <div className="space-y-2.5">
                                <Reorder.Group axis="y" values={activeSection.tasks} onReorder={(newOrder) => { optimisticUpdateSection(activeSection.id, { tasks: newOrder }); debouncedSaveSection(activeSection.id, { tasks: newOrder }); }} className="space-y-2">{activeSection.tasks.map(task => (<DraggableTask key={task.id} task={task} activeDept={activeDept} previewMode={previewMode} handleFileUpload={handleFileUpload} updateSection={optimisticUpdateSection} saveSection={debouncedSaveSection} setViewingImage={setViewingImage} section={activeSection} onInteract={handleInteraction} />))}</Reorder.Group>
                                <AnimatePresence>{!previewMode && (<motion.div initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: "auto" }} exit={{ opacity: 0, height: 0 }} className="flex gap-2 pt-4"><button onClick={(e) => { e.stopPropagation(); lockScrollOnly(); const newTask: Task = { id: Math.random().toString(36).substr(2, 9), title: "", duration: "15m", type: "task" }; optimisticUpdateSection(activeSection.id, { tasks: [...activeSection.tasks, newTask] }); debouncedSaveSection(activeSection.id, { tasks: [...activeSection.tasks, newTask] }); }} className="flex-1 py-3.5 border-2 border-dashed border-slate-200 rounded-2xl text-[10px] font-black uppercase text-slate-400 hover:border-[#004F71] hover:text-[#004F71] transition-all flex items-center justify-center gap-2 group"><Plus className="w-4 h-4 group-hover:rotate-90 transition-transform" /> Add Logic Block</button><button onClick={(e) => { e.stopPropagation(); lockScrollOnly(); const newSubject: Task = { id: Math.random().toString(36).substr(2, 9), title: "", type: "subject", color: "slate" }; optimisticUpdateSection(activeSection.id, { tasks: [...activeSection.tasks, newSubject] }); debouncedSaveSection(activeSection.id, { tasks: [...activeSection.tasks, newSubject] }); }} className="w-16 flex items-center justify-center border-2 border-dashed border-slate-200 rounded-2xl text-slate-400 hover:border-slate-400 hover:text-slate-600 transition-all group" title="Add Subject Heading"><AlignLeft className="w-4 h-4" /></button></motion.div>)}</AnimatePresence>
                             </div>
                        </div>
                     </div>
                 </div>

                 {/* --- RIGHT COLUMN: PREVIEW HUB --- */}
                 {/* On Mobile: Hidden behind floating button */}
                 <div className="hidden lg:block col-span-5 relative h-full">
                    <div className="sticky top-28 z-40 transition-all duration-500 h-fit">
                       <div className={cn("absolute inset-0 bg-gradient-to-br opacity-40 blur-[120px] transition-colors duration-1000 -z-10", activeDept === "FOH" ? "from-blue-200" : "from-red-200")} />
                       <div className="h-[calc(100vh-8rem)] bg-white rounded-[44px] border border-slate-200/80 shadow-[0_20px_60px_-15px_rgba(0,0,0,0.1)] overflow-hidden flex flex-col relative ring-1 ring-black/5">
                          <div className="px-7 py-5 border-b border-slate-100 flex justify-between items-center bg-white/80 backdrop-blur-xl shrink-0 z-20"><div className="flex items-center gap-3"><div className={cn("p-2 rounded-xl text-white shadow-md transition-colors", activeDept === "FOH" ? "bg-[#004F71]" : "bg-[#E51636]")}><BookOpen className="w-4 h-4" /></div><span className="text-[10px] font-black uppercase tracking-[0.2em] text-slate-900">Preview Hub</span></div><div className="flex items-center gap-3"><span className="text-[9px] font-black text-slate-400 uppercase tracking-widest">Pages {activeSection.pageStart}—{activeSection.pageEnd}</span><div className="w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_#10b981]" /></div></div>
                          <div className="flex-1 bg-slate-50 relative group isolate overflow-hidden">
                             <AnimatePresence mode="wait">{iframeLoading && (<motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="absolute inset-0 z-50 bg-white flex flex-col items-center justify-center p-12 text-center"><Loader2 className={cn("w-10 h-10 animate-spin mb-6", activeDept === "FOH" ? "text-[#004F71]" : "text-[#E51636]")} /><h3 className="text-sm font-black text-slate-900 uppercase tracking-tighter mb-1 leading-none">Syncing Intelligence</h3><p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed mt-2">Loading Page {activeSection.pageStart}...</p></motion.div>)}</AnimatePresence>
                             {getEmbedUrl() ? (<iframe src={getEmbedUrl()!} className="w-full h-full border-none mix-blend-multiply transition-opacity duration-1000" loading="lazy" onLoad={() => setIframeLoading(false)} />) : (<div className="w-full h-full flex flex-col items-center justify-center text-slate-300 gap-2"><BookOpen className="w-8 h-8 opacity-20" /><p className="text-[10px] font-bold uppercase tracking-widest">Phase data required</p></div>)}
                          </div>
                          <div className="px-7 py-4 bg-white/80 border-t border-slate-100 flex justify-between items-center shrink-0 z-20 backdrop-blur-md"><span className="text-[9px] font-bold uppercase text-slate-300 tracking-widest leading-none">Trainingbook Command v4.0</span><a href={CANVA_LINKS[activeDept] || CANVA_LINKS.FOH} target="_blank" className="flex items-center gap-2 text-[10px] font-black text-blue-600 hover:underline uppercase tracking-widest transition-all"><Maximize2 className="w-3 h-3" /> Fullscreen</a></div>
                       </div>
                    </div>
                 </div>
             </div>
         )}

         {/* --- MOBILE FLOATING ACTION BUTTON --- */}
         {/* MOVED OUTSIDE CONDITIONAL BLOCK so it floats globally, 
             but we only render it if there is an activeSection (i.e. Detail View) */}
         {viewMode === 'detail' && activeSection && (
             <div className="lg:hidden fixed bottom-28 left-1/2 -translate-x-1/2 z-50 w-[90%] max-w-sm">
                  <button 
                    onClick={() => { setMobileViewerOpen(true); setIframeLoading(true); }}
                    className="w-full bg-[#004F71] text-white py-4 rounded-[24px] shadow-[0_20px_50px_-10px_rgba(0,79,113,0.5)] flex items-center justify-between px-6 border border-white/20 active:scale-95 transition-transform"
                  >
                      <div className="flex items-center gap-3">
                          <BookOpen className="w-5 h-5" />
                          <div className="flex flex-col items-start">
                              <span className="text-[10px] font-black uppercase tracking-widest opacity-80">Manual Viewer</span>
                              <span className="text-xs font-bold">Open Pages {activeSection.pageStart}-{activeSection.pageEnd}</span>
                          </div>
                      </div>
                      <div className="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center"><ChevronRight className="w-4 h-4" /></div>
                  </button>
             </div>
         )}
      </div>

      {/* --- MODALS --- */}
      <AnimatePresence>{mobileViewerOpen && (<ClientPortal><div className="fixed inset-0 z-[200] lg:hidden flex items-end justify-center pointer-events-none"><motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} onClick={() => setMobileViewerOpen(false)} className="absolute inset-0 bg-slate-900/60 backdrop-blur-sm pointer-events-auto" /><motion.div initial={{ y: "100%" }} animate={{ y: 0 }} exit={{ y: "100%" }} transition={{ type: "spring", damping: 25, stiffness: 300 }} drag="y" dragControls={dragControls} dragListener={false} dragConstraints={{ top: 0, bottom: 0 }} dragElastic={0.05} onDragEnd={(_, info) => { if (info.offset.y > 100) setMobileViewerOpen(false); }} className="pointer-events-auto bg-white w-full h-[92vh] rounded-t-[40px] shadow-2xl relative flex flex-col overflow-hidden"><div className="absolute top-0 left-0 right-0 h-10 flex justify-center items-center z-50 bg-white/80 backdrop-blur-sm cursor-grab active:cursor-grabbing touch-none" onPointerDown={(e) => dragControls.start(e)}><div className="w-12 h-1.5 bg-slate-300 rounded-full" /></div><div className="px-6 py-4 pt-10 border-b border-slate-100 flex justify-between items-center shrink-0 bg-white z-40"><div className="flex flex-col"><span className="text-[9px] font-black uppercase text-slate-400 tracking-[0.2em] mb-1">{activeSection?.title || "Manual"}</span><div className="flex items-center gap-2"><div className="w-2 h-2 rounded-full" style={{ backgroundColor: brandColor === 'bg-[#004F71]' ? '#004F71' : '#E51636' }} /><span className="text-lg font-bold text-slate-900 leading-none">Pages {activeSection?.pageStart || "?"} - {activeSection?.pageEnd || "?"}</span></div></div><button onClick={() => setMobileViewerOpen(false)} className="p-2.5 bg-slate-100 rounded-full active:scale-95 transition-all"><Minimize2 className="w-5 h-5 text-slate-500" /></button></div><div className="flex-1 relative bg-slate-50 overflow-y-auto no-scrollbar touch-pan-y">{iframeLoading && (<div className="absolute inset-0 z-50 flex flex-col items-center justify-center bg-slate-50"><Loader2 className={cn("w-10 h-10 animate-spin mb-4", activeDept === "FOH" ? "text-[#004F71]" : "text-[#E51636]")} /><span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Loading Manual...</span></div>)}{getEmbedUrl() ? (<iframe src={getEmbedUrl()!} className="w-full h-full border-none" loading="lazy" onLoad={() => setIframeLoading(false)} />) : (<div className="w-full h-full flex flex-col items-center justify-center text-slate-300"><BookOpen className="w-12 h-12 opacity-20 mb-2" /><p>No content available</p></div>)}</div><div className="absolute bottom-8 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 w-full justify-center px-4"><div className="flex-1 max-w-[280px]"><PageRangeSelector start={activeSection?.pageStart} end={activeSection?.pageEnd} onUpdate={(u: any) => { if(activeSectionId) { optimisticUpdateSection(activeSectionId, u); debouncedSaveSection(activeSectionId, u); }}} readOnly={true} /></div><a href={CANVA_LINKS[activeDept] || CANVA_LINKS.FOH} target="_blank" className="p-3.5 bg-white/90 backdrop-blur-md border border-white/40 rounded-full text-slate-600 shadow-lg hover:text-slate-900 active:scale-95 transition-all"><Maximize2 className="w-5 h-5" /></a></div></motion.div></div></ClientPortal>)}</AnimatePresence>
      
      {/* DELETE CONFIRMATION MODAL */}
      <AnimatePresence>
          {deletingId && (
              <div className="fixed inset-0 z-[200] flex items-center justify-center p-4">
                  <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} onClick={() => setDeletingId(null)} className="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" />
                  <motion.div initial={{ scale: 0.95, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0.95, opacity: 0 }} className="relative bg-white rounded-3xl p-6 md:p-8 w-full max-w-md shadow-2xl border border-white/50">
                      <div className="w-12 h-12 rounded-full bg-red-50 flex items-center justify-center text-red-500 mb-4 mx-auto"><AlertTriangle className="w-6 h-6" /></div>
                      <h3 className="text-xl font-black text-center text-slate-900 mb-2">Delete Training Phase?</h3>
                      <p className="text-center text-slate-500 text-sm mb-8 font-medium">This action cannot be undone. All modules and tasks within this phase will be permanently removed.</p>
                      <div className="flex gap-3">
                          <button onClick={() => setDeletingId(null)} className="flex-1 py-3.5 bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold rounded-xl transition-colors">Cancel</button>
                          <button onClick={confirmDelete} className="flex-1 py-3.5 bg-[#E51636] hover:bg-red-700 text-white font-bold rounded-xl shadow-lg shadow-red-500/20 transition-all">Delete Phase</button>
                      </div>
                  </motion.div>
              </div>
          )}
      </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/(main)/dashboard/_components/StrategicVisionModal.tsx ---
"use client";

import { useState, useMemo } from "react";
import { motion, AnimatePresence, LayoutGroup } from "framer-motion";
import { 
  X, Target, Zap, Rocket, Mountain, 
  Gauge, Users, DollarSign, Trophy, PenLine, 
  Minus, Plus, Save, SlidersHorizontal,
  Activity, Percent, Hash, Layers, Check
} from "lucide-react";
import { cn } from "@/lib/utils";
import ClientPortal from "@/components/core/ClientPortal";
import { doc, setDoc, serverTimestamp } from "firebase/firestore";
import { db } from "@/lib/firebase";
import toast from "react-hot-toast";
import { useAppStore } from "@/lib/store/useStore"; 
import { isSameMonth } from "date-fns"; 

// --- TYPES ---
export type MetricSource = 
    | 'manual' 
    | 'system_1on1' 
    | 'system_training_avg' 
    | 'system_active_goals' 
    | 'system_leaders'
    | 'system_member_progress';

export interface VisionPillar {
    id: string;
    title: string;
    subtitle: string;
    current: number; 
    target: number;
    unit: "%" | "Count" | "Currency";
    icon: string;
    color: string;
    source: MetricSource; 
    linkedMemberId?: string; 
}

interface Props {
  isOpen: boolean;
  onClose: () => void;
  currentPillars: VisionPillar[];
}

const ICONS: any = { Zap, Mountain, Target, Gauge, Users, DollarSign, Trophy };
const COLOR_MAP: any = { 
    cyan: "#06b6d4", 
    emerald: "#10b981", 
    red: "#ef4444", 
    amber: "#f59e0b", 
    violet: "#8b5cf6", 
    rose: "#f43f5e",
    slate: "#64748b"
};

// --- HELPER: NUMBER STEPPER ---
const NumberStepper = ({ value, onChange, label, unit }: { value: number | string, onChange: (val: number | string) => void, label: string, unit?: string }) => {
    return (
        <div className="flex-1 bg-slate-50 hover:bg-white focus-within:bg-white focus-within:ring-2 focus-within:ring-[#004F71]/20 rounded-xl p-1 border border-slate-200 transition-all flex items-center justify-between group h-14 md:h-12">
            <button 
                onClick={() => onChange(Math.max(0, (Number(value) || 0) - 1))} 
                className="w-10 h-full text-slate-400 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-all flex items-center justify-center active:scale-90"
            >
                <Minus className="w-4 h-4" />
            </button>
            
            <div className="flex flex-col items-center justify-center flex-1 leading-none">
                <span className="text-[7px] font-black text-slate-400 uppercase tracking-widest mb-0.5">{label}</span>
                <div className="flex items-center gap-0.5">
                    <input 
                        type="number" 
                        value={value} 
                        onChange={(e) => onChange(e.target.value === '' ? '' : parseFloat(e.target.value))}
                        className="bg-transparent text-center font-[1000] text-base md:text-sm text-slate-900 outline-none w-12 appearance-none [&::-webkit-inner-spin-button]:appearance-none p-0"
                    />
                    {unit && <span className="text-[9px] font-bold text-slate-400">{unit}</span>}
                </div>
            </div>
            
            <button 
                onClick={() => onChange((Number(value) || 0) + 1)} 
                className="w-10 h-full text-slate-400 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-all flex items-center justify-center active:scale-90"
            >
                <Plus className="w-4 h-4" />
            </button>
        </div>
    );
};

// --- COMPONENT: SMALL CARD (GRID VIEW) ---
const VisionCardSmall = ({ pillar, onOpen, isHidden }: any) => {
    const { team, events } = useAppStore();
    const Icon = ICONS[pillar.icon] || Target;
    
    const liveValue = useMemo(() => {
        if (pillar.source === 'manual') return pillar.current;
        switch (pillar.source) {
            case 'system_1on1': return events.filter(e => e.type === "OneOnOne" && e.status === "Done" && isSameMonth(e.startDate, new Date())).length;
            case 'system_active_goals': return events.filter(e => e.type === "Goal" && e.status !== "Done").length;
            case 'system_leaders': return team.filter(m => ["Team Leader", "Director", "Assistant Director"].includes(m.status)).length;
            case 'system_training_avg': return team.length > 0 ? Math.round(team.reduce((acc, curr) => acc + (curr.progress || 0), 0) / team.length) : 0;
            case 'system_member_progress': 
                 if (pillar.linkedMemberId) return team.find(m => m.id === pillar.linkedMemberId)?.progress || 0;
                 return 0;
            default: return 0;
        }
    }, [pillar, team, events]);

    const activeColor = COLOR_MAP[pillar.color];
    const target = pillar.target || 100;
    const progress = Math.min(100, Math.max(0, (liveValue / target) * 100));

    return (
        <motion.div 
            layoutId={`card-${pillar.id}`}
            onClick={onOpen}
            className={cn(
                "relative flex flex-col rounded-[24px] md:rounded-[32px] overflow-hidden bg-white shadow-[0_4px_24px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_32px_-8px_rgba(0,0,0,0.1)] border border-slate-100 hover:border-slate-200 h-[240px] md:h-[280px] cursor-pointer group transition-colors",
                isHidden && "opacity-0 pointer-events-none"
            )}
        >
             {/* Background Watermark Icon */}
             <div className="absolute top-[-20px] right-[-20px] p-6 opacity-[0.03] pointer-events-none transform rotate-12 transition-transform group-hover:scale-110 duration-700">
                <Icon className="w-48 h-48" style={{ color: activeColor }} />
            </div>

            {/* Header */}
            <div className="flex justify-between items-start p-5 md:p-6 relative z-10">
                <div className="flex items-center gap-4">
                     <motion.div 
                        layoutId={`icon-box-${pillar.id}`}
                        className="w-12 h-12 md:w-14 md:h-14 rounded-2xl flex items-center justify-center text-white shadow-lg"
                        style={{ backgroundColor: activeColor }}
                     >
                         <Icon className="w-6 h-6 md:w-7 md:h-7" />
                     </motion.div>
                     <div>
                         <motion.span layoutId={`subtitle-${pillar.id}`} className="inline-block text-[8px] md:text-[9px] font-black uppercase tracking-widest text-slate-400 mb-0.5">
                            {pillar.subtitle || "METRIC"}
                         </motion.span>
                         <motion.h3 layoutId={`title-${pillar.id}`} className="text-lg md:text-xl font-[1000] text-slate-900 leading-tight">
                             {pillar.title}
                         </motion.h3>
                     </div>
                </div>
                <motion.div layoutId={`btn-${pillar.id}`} className="p-2.5 bg-slate-50 text-slate-400 group-hover:bg-[#004F71] group-hover:text-white rounded-full transition-colors">
                     <SlidersHorizontal className="w-4 h-4" />
                </motion.div>
            </div>

            {/* Metric */}
            <div className="relative z-10 text-center py-2 flex-1 flex flex-col justify-center">
                <div className="flex items-baseline justify-center gap-1">
                    <span className="text-5xl md:text-6xl font-[1000] tracking-tighter drop-shadow-sm" style={{ color: activeColor }}>
                        {liveValue}
                    </span>
                    <span className="text-xs md:text-sm font-bold text-slate-400 uppercase">
                        / {target} {pillar.unit === '%' && '%'}
                    </span>
                </div>
            </div>

            {/* Footer */}
            <div className="relative z-10 p-5 md:p-6 pt-0">
                <div className="flex justify-between text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-2">
                    <span>Progress</span>
                    <span>{Math.round(progress)}%</span>
                </div>
                <div className="h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                    <motion.div 
                        initial={{ width: 0 }}
                        animate={{ width: `${progress}%` }}
                        className="h-full rounded-full"
                        style={{ backgroundColor: activeColor }}
                    />
                </div>
            </div>
        </motion.div>
    );
};

// --- COMPONENT: EXPANDED EDITOR (OVERLAY) ---
const VisionCardExpanded = ({ pillar, onUpdate, onClose }: any) => {
    const Icon = ICONS[pillar.icon] || Target;
    const activeColor = COLOR_MAP[pillar.color];

    return (
        <motion.div 
            layoutId={`card-${pillar.id}`}
            className="w-full h-full md:h-auto md:max-w-2xl bg-white md:rounded-[32px] shadow-2xl overflow-hidden flex flex-col md:max-h-[85vh] ring-1 ring-black/5"
        >
            {/* Header */}
            <div className="flex justify-between items-center p-6 border-b border-slate-100 bg-white z-10 relative shrink-0">
                 <div className="flex items-center gap-4">
                     <motion.div 
                        layoutId={`icon-box-${pillar.id}`}
                        className="w-10 h-10 rounded-2xl flex items-center justify-center text-white shadow-md"
                        style={{ backgroundColor: activeColor }}
                     >
                         <Icon className="w-5 h-5" />
                     </motion.div>
                     <div>
                         <motion.span layoutId={`subtitle-${pillar.id}`} className="text-[9px] font-black uppercase tracking-widest text-slate-400 block mb-0.5">
                            Configuration
                         </motion.span>
                         <motion.h3 layoutId={`title-${pillar.id}`} className="text-lg font-[1000] text-slate-900 leading-none">
                             Editing: {pillar.title}
                         </motion.h3>
                     </div>
                 </div>
                 <motion.button 
                    layoutId={`btn-${pillar.id}`}
                    onClick={onClose}
                    className="p-2 hover:bg-slate-100 text-slate-400 rounded-full transition-colors"
                 >
                     <X className="w-6 h-6" />
                 </motion.button>
            </div>

            {/* Scrollable Form */}
            <motion.div 
                initial={{ opacity: 0 }} 
                animate={{ opacity: 1, transition: { delay: 0.2 } }}
                exit={{ opacity: 0, transition: { duration: 0.1 } }}
                className="flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8 bg-slate-50/50 pb-32 md:pb-6"
            >
                {/* 1. Identity */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-1.5">
                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-widest pl-1">Title</label>
                        <input 
                            value={pillar.title} 
                            onChange={e => onUpdate(pillar.id, 'title', e.target.value)} 
                            className="w-full bg-white border border-slate-200 rounded-xl px-4 py-3.5 text-sm font-bold text-slate-900 outline-none focus:border-blue-400 transition-colors shadow-sm"
                        />
                    </div>
                    <div className="space-y-1.5">
                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-widest pl-1">Subtitle</label>
                        <input 
                            value={pillar.subtitle} 
                            onChange={e => onUpdate(pillar.id, 'subtitle', e.target.value)} 
                            className="w-full bg-white border border-slate-200 rounded-xl px-4 py-3.5 text-sm font-bold text-slate-900 outline-none focus:border-blue-400 transition-colors shadow-sm"
                        />
                    </div>
                </div>

                {/* 2. Source */}
                <div className="space-y-3">
                    <label className="text-[9px] font-black uppercase text-slate-400 tracking-widest pl-1">Data Source</label>
                    <div className="grid grid-cols-2 gap-3">
                        <button onClick={() => onUpdate(pillar.id, 'source', 'manual')} className={cn("py-3.5 rounded-xl border text-[10px] font-bold uppercase tracking-wider flex items-center justify-center gap-2 transition-all shadow-sm", pillar.source === 'manual' ? "bg-white text-[#004F71] border-[#004F71] ring-1 ring-[#004F71]/10" : "bg-white text-slate-400 border-slate-200 hover:border-slate-300")}>
                            <PenLine className="w-3.5 h-3.5" /> Manual Input
                        </button>
                        <button onClick={() => onUpdate(pillar.id, 'source', 'system_1on1')} className={cn("py-3.5 rounded-xl border text-[10px] font-bold uppercase tracking-wider flex items-center justify-center gap-2 transition-all shadow-sm", pillar.source !== 'manual' ? "bg-[#004F71] text-white border-[#004F71] shadow-lg shadow-blue-900/20" : "bg-white text-slate-400 border-slate-200 hover:border-slate-300")}>
                            <Activity className="w-3.5 h-3.5" /> Live System
                        </button>
                    </div>
                    
                    {pillar.source !== 'manual' && (
                        <div className="p-2 bg-slate-200/40 rounded-2xl flex flex-col gap-1 border border-slate-200/60">
                            {[
                                { id: 'system_1on1', label: 'Monthly 1-on-1 Sessions' },
                                { id: 'system_active_goals', label: 'Active Strategic Goals' },
                                { id: 'system_leaders', label: 'Certified Leaders Count' },
                                { id: 'system_training_avg', label: 'Average Training Completion' },
                            ].map(opt => (
                                <button
                                    key={opt.id}
                                    onClick={() => onUpdate(pillar.id, 'source', opt.id)}
                                    className={cn("px-4 py-3 rounded-xl text-[10px] font-bold uppercase tracking-wider text-left transition-all", pillar.source === opt.id ? "bg-white text-[#004F71] shadow-sm" : "text-slate-500 hover:bg-slate-100/50")}
                                >
                                    {opt.label}
                                </button>
                            ))}
                        </div>
                    )}
                </div>

                {/* 3. Targets & Style */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-2">
                        <div className="flex justify-between items-center pl-1 pr-1">
                            <label className="text-[9px] font-black uppercase text-slate-400 tracking-widest">Target Goals</label>
                            {/* Unit Switcher */}
                            <div className="flex bg-slate-200/60 p-0.5 rounded-lg">
                                <button onClick={() => onUpdate(pillar.id, 'unit', 'Count')} className={cn("px-2 py-0.5 rounded-md text-[8px] font-black uppercase transition-all", pillar.unit === 'Count' ? "bg-white text-slate-900 shadow-sm" : "text-slate-400")}>#</button>
                                <button onClick={() => onUpdate(pillar.id, 'unit', '%')} className={cn("px-2 py-0.5 rounded-md text-[8px] font-black uppercase transition-all", pillar.unit === '%' ? "bg-white text-slate-900 shadow-sm" : "text-slate-400")}>%</button>
                            </div>
                        </div>
                        
                        <div className="flex gap-2">
                            {pillar.source === 'manual' && (
                                <NumberStepper label="Current Value" value={pillar.current} onChange={(v) => onUpdate(pillar.id, 'current', v)} unit={pillar.unit} />
                            )}
                            <NumberStepper label="Target Goal" value={pillar.target} onChange={(v) => onUpdate(pillar.id, 'target', v)} unit={pillar.unit} />
                        </div>
                    </div>

                    <div className="space-y-2">
                        <label className="text-[9px] font-black uppercase text-slate-400 tracking-widest pl-1">Theme Color</label>
                        <div className="grid grid-cols-4 gap-2">
                            {Object.entries(COLOR_MAP).map(([key, hex]: any) => (
                                <button key={key} onClick={() => onUpdate(pillar.id, 'color', key)} className={cn("aspect-square rounded-full transition-all flex items-center justify-center", pillar.color === key ? "scale-110 ring-4 ring-slate-100 shadow-inner" : "opacity-40 hover:opacity-100")} style={{ backgroundColor: hex }}>
                                    {pillar.color === key && <Check className="w-4 h-4 text-white drop-shadow-md" />}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            </motion.div>

            {/* Footer */}
            <div className="p-6 border-t border-slate-100 bg-white flex justify-end shrink-0 md:rounded-b-[32px]">
                 <button onClick={onClose} className="w-full md:w-auto px-8 py-4 bg-[#0F172A] text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:scale-105 transition-transform shadow-xl shadow-slate-900/20">
                     Apply Changes
                 </button>
            </div>
        </motion.div>
    );
};


// --- MAIN MODAL CONTROLLER ---

export default function StrategicVisionModal({ isOpen, onClose, currentPillars }: Props) {
  const [pillars, setPillars] = useState<VisionPillar[]>(currentPillars);
  const [editingId, setEditingId] = useState<string | null>(null);
  const [isSaving, setIsSaving] = useState(false);

  const handleSave = async () => {
      setIsSaving(true);
      try {
          const sanitizedPillars = pillars.map(p => ({
              ...p,
              current: Number(p.current) || 0,
              target: Number(p.target) || 0
          }));
          await setDoc(doc(db, "vision", "current"), {
              pillars: sanitizedPillars,
              updatedAt: serverTimestamp()
          });
          toast.success("Strategic Vision Updated");
          onClose();
      } catch (e) {
          toast.error("Failed to deploy updates");
      } finally {
          setIsSaving(false);
      }
  };

  const initPillarsIfNeeded = () => {
      const defaults: VisionPillar[] = [
         { id: "1", title: "Speed of Service", subtitle: "Weekly", current: 0, target: 80, unit: "%", icon: "Zap", color: "cyan", source: "manual" },
         { id: "2", title: "New Leaders", subtitle: "Monthly", current: 0, target: 5, unit: "Count", icon: "Target", color: "emerald", source: "system_leaders" },
         { id: "3", title: "Hospitality Score", subtitle: "North Star", current: 0, target: 20, unit: "%", icon: "Mountain", color: "red", source: "manual" }
      ];
      setPillars(defaults);
  };

  const updatePillar = (id: string, field: keyof VisionPillar, value: any) => {
      setPillars(pillars.map(p => {
          if (p.id !== id) return p;
          const updated = { ...p, [field]: value };
          
          if (field === 'source') {
             if (['system_leaders', 'system_1on1', 'system_active_goals'].includes(value)) {
                 updated.unit = 'Count';
                 if (updated.target === 100) updated.target = 5; 
             }
             else if (['system_training_avg', 'system_member_progress'].includes(value)) {
                 updated.unit = '%';
                 if (updated.target <= 20) updated.target = 100;
             }
          }
          return updated;
      }));
  };

  if (!isOpen) return null;

  return (
    <ClientPortal>
        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="fixed inset-0 z-[200] bg-[#0F172A]/90 backdrop-blur-md flex items-end md:items-center justify-center p-0 md:p-8">
            <motion.div 
                initial={{ scale: 0.95, y: 20 }} animate={{ scale: 1, y: 0 }} exit={{ scale: 0.95, y: 20 }} 
                className="w-full h-full md:max-w-7xl md:h-[90vh] bg-[#F8FAFC] md:rounded-[48px] shadow-2xl flex flex-col overflow-hidden relative ring-0 md:ring-8 ring-white/10"
            >
                {/* --- HEADER --- */}
                <div className="bg-white px-6 md:px-12 py-6 md:py-8 border-b border-slate-200 flex justify-between items-start shrink-0 relative z-20 pt-16 md:pt-8">
                     <div className="flex gap-4 md:gap-6 items-center">
                         <div className="w-12 h-12 md:w-16 md:h-16 rounded-[16px] md:rounded-[20px] bg-[#004F71] flex items-center justify-center text-white shadow-xl shadow-blue-900/20">
                             <Rocket className="w-6 h-6 md:w-8 md:h-8" />
                         </div>
                         <div>
                             <div className="flex items-center gap-3 mb-1">
                                 <span className="px-3 py-1 rounded-full bg-blue-50 text-[#004F71] text-[9px] md:text-[10px] font-black uppercase tracking-[0.25em] border border-blue-100">System Config</span>
                                 <div className="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse" />
                             </div>
                             <h2 className="text-2xl md:text-4xl font-[1000] text-slate-900 tracking-tighter uppercase leading-none">Directives</h2>
                             <p className="text-slate-400 font-medium mt-1 text-xs md:text-sm">Configure strategic pillars.</p>
                         </div>
                     </div>
                     
                     <div className="flex items-center gap-3">
                         <button onClick={onClose} className="p-3 md:p-4 bg-slate-50 text-slate-400 hover:text-slate-900 rounded-2xl hover:bg-slate-100 transition-all border border-slate-200">
                             <X className="w-5 h-5 md:w-6 md:h-6" />
                         </button>
                     </div>
                </div>

                {/* --- SCROLLABLE GRID --- */}
                <div className="flex-1 overflow-y-auto custom-scrollbar p-6 md:p-12 relative bg-slate-50/50 pb-32">
                     {pillars.length > 0 ? (
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                            <LayoutGroup>
                                 {pillars.map(pillar => (
                                     <VisionCardSmall 
                                         key={pillar.id}
                                         pillar={pillar}
                                         onOpen={() => setEditingId(pillar.id)}
                                         isHidden={editingId === pillar.id}
                                     />
                                 ))}
                            </LayoutGroup>
                        </div>
                     ) : (
                        <div className="flex flex-col items-center justify-center h-full min-h-[300px]">
                            <div className="p-6 bg-white rounded-full shadow-lg mb-6">
                                <Layers className="w-12 h-12 text-slate-300" />
                            </div>
                            <h3 className="text-2xl font-black text-slate-900 mb-2">Initialize Command Center</h3>
                            <button 
                                onClick={initPillarsIfNeeded}
                                className="px-10 py-4 bg-[#004F71] text-white rounded-full font-black text-xs uppercase tracking-widest shadow-xl hover:scale-105 transition-transform"
                            >
                                Generate Standard Protocol
                            </button>
                        </div>
                     )}
                </div>

                {/* --- EXPANDED EDITOR OVERLAY (Full Screen on Mobile) --- */}
                <AnimatePresence>
                    {editingId && (
                        <div className="absolute inset-0 z-50 flex items-end md:items-center justify-center md:p-4 pointer-events-none">
                            <motion.div 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }} 
                                onClick={() => setEditingId(null)}
                                className="absolute inset-0 bg-slate-900/40 backdrop-blur-sm pointer-events-auto" 
                            />
                            <div className="pointer-events-auto relative w-full h-full md:h-auto flex justify-center items-end md:items-center">
                                <VisionCardExpanded 
                                    pillar={pillars.find(p => p.id === editingId)}
                                    onUpdate={updatePillar}
                                    onClose={() => setEditingId(null)}
                                />
                            </div>
                        </div>
                    )}
                </AnimatePresence>

                {/* --- FOOTER --- */}
                <div className="absolute bottom-0 left-0 right-0 p-6 md:p-8 bg-gradient-to-t from-white via-white/90 to-transparent z-30 flex justify-center pointer-events-none">
                     <button 
                        onClick={handleSave} 
                        disabled={isSaving}
                        className="pointer-events-auto w-full md:w-auto px-12 py-5 bg-[#E51636] text-white rounded-full font-[900] text-sm uppercase tracking-[0.2em] shadow-[0_20px_50px_-12px_rgba(229,22,54,0.5)] hover:scale-105 active:scale-95 transition-all flex items-center justify-center gap-4 disabled:opacity-70 disabled:scale-100 hover:bg-red-600"
                     >
                        {isSaving ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
                        {isSaving ? "Deploying..." : "Save Configuration"}
                     </button>
                </div>
            </motion.div>
        </motion.div>
    </ClientPortal>
  );
}

// Simple loader
function Loader2({ className }: { className?: string }) {
    return (
        <svg className={cn("animate-spin", className)} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
    )
}
--- FILE: ./app/(main)/dashboard/page.tsx ---
"use client";

import { useState, useEffect, useMemo, useRef } from "react";
import { motion, AnimatePresence, LayoutGroup, Variants } from "framer-motion"; 
import { 
  Users, Clock, AlertCircle, 
  Target, CheckSquare, X,
  Trophy, CalendarRange, ChevronRight,
  Activity, CalendarDays,
  ArrowRight, GraduationCap,
  BookOpen, Sparkles, User, Plus, Edit3, Trash2, FileText, CheckCircle2, Loader2,
  Zap, Shield, MessageSquare, Flag, Mountain, Rocket, Crosshair, LayoutList, Search,
  Gauge, DollarSign, Percent, Hash, Layers, Award, Vote, Star
} from "lucide-react";
import { cn } from "@/lib/utils";
import { format, isSameMonth, formatDistanceToNow, isFuture } from "date-fns";

// Firebase & Store Integration
import { useAppStore } from "@/lib/store/useStore";
import { db } from "@/lib/firebase";
import { collection, query, orderBy, limit, onSnapshot, deleteDoc, doc, updateDoc, serverTimestamp } from "firebase/firestore";
import toast from "react-hot-toast";

// Shared Types & Components
import { CalendarEvent, TeamMember, EventType, getEventLabel } from "../calendar/_components/types";
import EventDetailSheet from "../calendar/_components/EventDetailSheet";
import OneOnOneSessionModal from "../calendar/_components/OneOnOneSessionModal";
import ClientPortal from "@/components/core/ClientPortal";
import { TeamCard } from "../team/_components/TeamCard"; 
import { MemberDetailSheet } from "../team/_components/MemberDetailSheet"; 
import StrategicVisionModal, { VisionPillar } from "./_components/StrategicVisionModal"; 
import { useTaskMap } from "@/lib/hooks/useTaskMap";

// --- HELPER: LIVE TIME AGO ---
const TimeAgo = ({ date }: { date: Date }) => {
  const [label, setLabel] = useState("");
  useEffect(() => {
    const update = () => setLabel(formatDistanceToNow(date, { addSuffix: true }));
    update();
    const timer = setInterval(update, 60000); // Update every minute
    return () => clearInterval(timer);
  }, [date]);
  return <span className="text-[9px] font-bold text-slate-400 uppercase tracking-wide">{label}</span>;
};

// --- HELPER: CONTEXTUAL ICONS ---
const FeedIcon = ({ type, priority }: { type: string, priority: string }) => {
  const config = useMemo(() => {
    switch (type) {
      case "Training": return { icon: Shield, bg: "bg-blue-50", text: "text-blue-600", ring: "ring-blue-100" };
      case "Goal": return { icon: Target, bg: "bg-emerald-50", text: "text-emerald-600", ring: "ring-emerald-100" };
      case "Deadline": return { icon: Zap, bg: "bg-red-50", text: "text-red-600", ring: "ring-red-100" };
      case "OneOnOne": return { icon: MessageSquare, bg: "bg-purple-50", text: "text-purple-600", ring: "ring-purple-100" };
      case "Award": return { icon: Trophy, bg: "bg-amber-50", text: "text-amber-600", ring: "ring-amber-100" };
      case "Vote": return { icon: Vote, bg: "bg-slate-100", text: "text-slate-500", ring: "ring-slate-200" };
      default: return { icon: Activity, bg: "bg-slate-50", text: "text-slate-500", ring: "ring-slate-100" };
    }
  }, [type]);

  const Icon = config.icon;

  return (
    <div className={cn(
      "relative z-10 w-10 h-10 rounded-xl flex items-center justify-center shadow-sm transition-all duration-300 ring-4 ring-white",
      config.bg, config.text,
      priority === 'High' && "ring-red-50 ring-offset-2 ring-offset-white"
    )}>
      <Icon className="w-5 h-5" />
      {priority === 'High' && (
        <span className="absolute -top-1 -right-1 flex h-2.5 w-2.5">
          <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
          <span className="relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500"></span>
        </span>
      )}
    </div>
  );
};

// --- COMPONENT: KPI CARD ---
const KPICard = ({ kpi, onClick }: { kpi: any, onClick: () => void }) => {
  return (
      <motion.div 
          whileHover={{ y: -4, scale: 1.01 }}
          onClick={onClick}
          className="relative flex flex-col rounded-[24px] md:rounded-[32px] overflow-hidden bg-white border border-slate-100 shadow-sm hover:shadow-xl hover:border-slate-200 transition-all duration-300 h-[160px] md:h-[220px] cursor-pointer group"
      >
           {/* Background Watermark */}
           <div className={cn("absolute top-[-20px] right-[-20px] p-6 opacity-[0.03] pointer-events-none transform rotate-12 transition-transform group-hover:scale-110 duration-700", kpi.color)}>
              <kpi.icon className="w-24 h-24 md:w-48 md:h-48" />
          </div>

          {/* Header */}
          <div className="flex justify-between items-start p-4 md:p-6 relative z-10">
              <div className="flex flex-col md:flex-row items-start md:items-center gap-3 md:gap-4 w-full">
                   <div className={cn("w-8 h-8 md:w-12 md:h-12 rounded-xl md:rounded-2xl flex items-center justify-center text-white shadow-lg shrink-0", kpi.modalColor)}>
                       <kpi.icon className="w-4 h-4 md:w-6 md:h-6" />
                   </div>
                   
                   <div className="min-w-0 w-full">
                       <span className="block text-[7px] md:text-[9px] font-black uppercase tracking-widest text-slate-400 mb-0.5 truncate w-full">
                          {kpi.trend}
                       </span>
                       <h3 className="text-[10px] md:text-lg font-[1000] text-slate-900 leading-tight w-full line-clamp-2 md:line-clamp-1 break-words">
                           {kpi.label}
                       </h3>
                   </div>
              </div>
              <div className="hidden md:block p-2 rounded-full bg-slate-50 text-slate-300 group-hover:bg-[#004F71] group-hover:text-white transition-colors shrink-0">
                   <ChevronRight className="w-4 h-4" />
              </div>
          </div>

          {/* Metric */}
          <div className="relative z-10 pl-4 md:pl-6 flex-1 flex flex-col justify-center">
               <div className="flex items-baseline gap-1">
                  <span className={cn("text-3xl md:text-5xl font-[1000] tracking-tighter", kpi.color)}>
                      {kpi.value}
                  </span>
              </div>
          </div>

          {/* Footer / Status Bar */}
          <div className="relative z-10 px-4 md:px-6 pb-4 md:pb-6 mt-auto">
               <div className="h-1 md:h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                    <motion.div 
                      initial={{ width: 0 }} 
                      animate={{ width: "65%" }} 
                      transition={{ duration: 1.5, ease: "circOut" }}
                      className={cn("h-full rounded-full", kpi.modalColor)} 
                    />
               </div>
               <div className="hidden md:flex justify-between mt-2">
                   <span className="text-[8px] md:text-[9px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1"><Activity className="w-3 h-3" /> Live System Data</span>
               </div>
          </div>
      </motion.div>
  )
}

// --- COMPONENT: KPI MODAL (DRILLDOWN) ---
interface KPIModalProps {
    title: string;
    items: { id: string; title: string; subtitle: string; icon?: any; status?: string, rawEvent?: CalendarEvent }[];
    onClose: () => void;
    color: string;
    icon: any;
    onItemClick?: (item: any) => void;
}

const KPIModal = ({ title, items, onClose, color, icon: Icon, onItemClick }: KPIModalProps) => {
    // --- DYNAMIC THEME ENGINE ---
    const getThemeStyles = (bgClass: string) => {
        if (bgClass.includes("#004F71")) return { 
            gradient: "from-[#004F71] to-[#003855]", 
            iconText: "text-[#004F71]", 
            border: "group-hover:border-[#004F71]/30",
            hoverBg: "group-hover:bg-[#004F71]",
            lightBg: "bg-blue-50"
        };
        if (bgClass.includes("purple")) return { 
            gradient: "from-purple-600 to-indigo-700", 
            iconText: "text-purple-600",
            border: "group-hover:border-purple-200",
            hoverBg: "group-hover:bg-purple-600",
            lightBg: "bg-purple-50"
        };
        if (bgClass.includes("#E51636")) return { 
            gradient: "from-[#E51636] to-[#b30f28]", 
            iconText: "text-[#E51636]",
            border: "group-hover:border-[#E51636]/30",
            hoverBg: "group-hover:bg-[#E51636]",
            lightBg: "bg-red-50"
        };
        if (bgClass.includes("emerald")) return { 
            gradient: "from-emerald-600 to-teal-700", 
            iconText: "text-emerald-600",
            border: "group-hover:border-emerald-200",
            hoverBg: "group-hover:bg-emerald-600",
            lightBg: "bg-emerald-50"
        };
        return { 
            gradient: "from-slate-700 to-slate-900", 
            iconText: "text-slate-600",
            border: "group-hover:border-slate-200",
            hoverBg: "group-hover:bg-slate-600",
            lightBg: "bg-slate-50"
        };
    };

    const theme = getThemeStyles(color);
    const [search, setSearch] = useState("");

    const filteredItems = items.filter(i => 
        i.title.toLowerCase().includes(search.toLowerCase()) || 
        i.subtitle.toLowerCase().includes(search.toLowerCase())
    );

    const backdropVariants: Variants = {
        hidden: { opacity: 0 },
        visible: { opacity: 1, transition: { duration: 0.2 } },
        exit: { opacity: 0, transition: { duration: 0.2, delay: 0.1 } } 
    };

    const modalVariants: Variants = {
        hidden: { y: "100%", opacity: 1 },
        visible: { y: 0, opacity: 1, transition: { type: "spring", damping: 25, stiffness: 300 } },
        exit: { y: "100%", opacity: 1, transition: { duration: 0.2 } }
    };

    return (
        <ClientPortal>
            <div className="fixed inset-0 z-[200] flex items-end md:items-center justify-center p-0 md:p-4 isolate">
                <motion.div 
                    variants={backdropVariants}
                    initial="hidden"
                    animate="visible"
                    exit="exit"
                    className="absolute inset-0 bg-[#0F172A]/60 backdrop-blur-md -z-10 pointer-events-auto" 
                    onClick={onClose} 
                />
                
                <motion.div 
                    variants={modalVariants}
                    initial="hidden"
                    animate="visible"
                    exit="exit"
                    className="pointer-events-auto bg-[#F8FAFC] w-full md:w-[95%] max-w-2xl rounded-t-[40px] md:rounded-[48px] shadow-2xl relative overflow-hidden flex flex-col h-[90vh] md:max-h-[85vh] border border-white/20 ring-1 ring-black/5 z-10"
                >
                    {/* --- HEADER --- */}
                    <div className={cn("p-8 pt-10 text-white relative overflow-hidden shrink-0 bg-gradient-to-br", theme.gradient)}>
                        {/* Noise Texture */}
                        <div className="absolute inset-0 opacity-[0.08] bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-repeat mix-blend-overlay" />
                        <div className="absolute -top-20 -right-20 w-64 h-64 bg-white/10 rounded-full blur-[80px] pointer-events-none" />
                        
                        <div className="relative z-10">
                            <div className="flex items-start justify-between mb-8">
                                <div className="inline-flex items-center gap-2 px-3 py-1 bg-white/10 rounded-full border border-white/20 backdrop-blur-md">
                                    <div className="w-1.5 h-1.5 rounded-full bg-white animate-pulse" />
                                    <span className="text-[9px] font-black uppercase tracking-[0.3em] text-white/90">System Record</span>
                                </div>
                                <button 
                                    onClick={onClose} 
                                    className="p-3 bg-white/10 hover:bg-white/20 rounded-full transition-all text-white border border-white/10 active:scale-90"
                                >
                                    <X className="w-5 h-5" />
                                </button>
                            </div>

                            <div className="flex items-center gap-6">
                                <div className="w-16 h-16 rounded-[24px] bg-white/20 border border-white/30 backdrop-blur-md shadow-2xl flex items-center justify-center shrink-0">
                                    <Icon className="w-8 h-8 text-white drop-shadow-md" />
                                </div>
                                <div>
                                    <h2 className="text-3xl md:text-4xl font-[1000] tracking-tighter leading-none mb-1">{title}</h2>
                                    <p className="text-white/70 font-bold text-xs md:text-sm uppercase tracking-wider">{items.length} Active Entries</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* --- SEARCH --- */}
                    <div className="px-6 py-4 bg-white border-b border-slate-100 flex items-center gap-3 sticky top-0 z-20 shadow-sm">
                        <Search className="w-5 h-5 text-slate-400" />
                        <input 
                            autoFocus
                            value={search}
                            onChange={(e) => setSearch(e.target.value)}
                            type="text" 
                            placeholder={`Search in ${title}...`} 
                            className="w-full bg-transparent text-base font-bold text-slate-700 outline-none placeholder:text-slate-300" 
                        />
                    </div>

                    {/* --- LIST --- */}
                    <div className="flex-1 overflow-y-auto p-4 md:p-6 space-y-3 bg-[#F8FAFC] custom-scrollbar">
                        {filteredItems.length > 0 ? (
                            <AnimatePresence mode="popLayout">
                                {filteredItems.map((item, i) => (
                                    <motion.div 
                                        initial={{ opacity: 0, y: 10 }} 
                                        animate={{ opacity: 1, y: 0 }} 
                                        exit={{ opacity: 0, scale: 0.95 }}
                                        transition={{ delay: i * 0.03 }}
                                        key={item.id} 
                                        onClick={() => onItemClick && onItemClick(item)}
                                        className={cn(
                                            "group bg-white p-4 rounded-[24px] border border-slate-100 shadow-sm flex items-center gap-4 hover:shadow-lg transition-all relative overflow-hidden",
                                            onItemClick && "cursor-pointer active:scale-[0.98]",
                                            theme.border
                                        )}
                                    >
                                        <div className={cn("w-12 h-12 rounded-2xl flex items-center justify-center font-black text-lg shadow-inner shrink-0 transition-transform group-hover:scale-110", theme.lightBg)}>
                                            <span className={cn("relative z-10", theme.iconText)}>
                                                {item.icon ? <item.icon className="w-6 h-6" /> : item.title.charAt(0)}
                                            </span>
                                        </div>

                                        <div className="flex-1 min-w-0">
                                            <div className="flex items-center gap-2 mb-0.5">
                                                <p className="text-sm md:text-base font-[800] text-slate-900 truncate group-hover:text-slate-700 transition-colors">{item.title}</p>
                                                {item.status && (
                                                    <span className={cn(
                                                        "px-2 py-0.5 rounded-lg text-[8px] font-black uppercase tracking-wider border",
                                                        theme.lightBg, theme.iconText, "border-transparent"
                                                    )}>
                                                        {item.status}
                                                    </span>
                                                )}
                                            </div>
                                            <p className="text-[10px] md:text-xs font-bold text-slate-400 truncate uppercase tracking-wide flex items-center gap-1.5">
                                                {item.subtitle}
                                            </p>
                                        </div>

                                        {onItemClick && (
                                            <div className={cn("w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center transition-colors shadow-sm", theme.hoverBg, "group-hover:text-white")}>
                                                <ChevronRight className="w-5 h-5 text-slate-300 group-hover:text-white" />
                                            </div>
                                        )}
                                    </motion.div>
                                ))}
                            </AnimatePresence>
                        ) : (
                            <div className="flex flex-col items-center justify-center h-64 text-slate-400 border-2 border-dashed border-slate-200 rounded-[32px] mx-2 bg-slate-50/50">
                                <div className="p-4 bg-slate-100 rounded-full mb-3"><Activity className="w-6 h-6 opacity-30" /></div>
                                <p className="text-xs font-bold uppercase tracking-widest">No entries found</p>
                            </div>
                        )}
                    </div>
                    
                    {/* --- FOOTER --- */}
                    <div className="p-4 bg-white border-t border-slate-100 flex justify-between items-center text-[9px] md:text-[10px] font-bold text-slate-400 uppercase tracking-widest px-6 md:px-8 shrink-0">
                        <span>Synced: {new Date().toLocaleTimeString()}</span>
                        <span>v4.2.0</span>
                    </div>
                </motion.div>
            </div>
        </ClientPortal>
    );
};

// --- COMPONENT: STRATEGIC VISION BOARD ---
const StrategicVisionBoard = ({ pillars, onUpdate }: { pillars: VisionPillar[], onUpdate: () => void }) => {
    // EXPANDED ICON LIST FOR THE BOARD
    const ICONS: any = { 
        Zap, Mountain, Target, Gauge, Users, DollarSign, Trophy, 
        MessageSquare, Shield, Activity, Rocket, Sparkles, Star
    };
    
    const getColors = (color: string) => {
        const map: any = {
            cyan: { text: "text-cyan-300", bg: "bg-cyan-500/10", border: "border-cyan-500/20", bar: "from-cyan-400 to-blue-500" },
            emerald: { text: "text-emerald-300", bg: "bg-emerald-500/10", border: "border-emerald-500/20", bar: "from-emerald-400 to-emerald-600" },
            red: { text: "text-red-300", bg: "bg-red-500/10", border: "border-red-500/20", bar: "from-red-500 to-orange-500" },
            amber: { text: "text-amber-300", bg: "bg-amber-500/10", border: "border-amber-500/20", bar: "from-amber-400 to-yellow-500" },
            violet: { text: "text-violet-300", bg: "bg-violet-500/10", border: "border-violet-500/20", bar: "from-violet-400 to-fuchsia-500" },
            rose: { text: "text-rose-300", bg: "bg-rose-500/10", border: "border-rose-500/20", bar: "from-rose-400 to-pink-500" },
            slate: { text: "text-slate-300", bg: "bg-slate-500/10", border: "border-slate-500/20", bar: "from-slate-400 to-slate-600" }
        };
        return map[color] || map.cyan;
    };

    return (
        <motion.div 
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6, ease: "easeOut" }}
            className="bg-[#004F71] rounded-[32px] md:rounded-[40px] p-6 md:p-8 text-white shadow-2xl relative overflow-hidden group isolate"
        >
            <div className="absolute -top-[150px] -right-[150px] w-[400px] md:w-[600px] h-[400px] md:h-[600px] bg-gradient-to-b from-[#E51636] via-[#E51636]/40 to-transparent opacity-30 blur-[100px] md:blur-[120px] rounded-full pointer-events-none mix-blend-screen animate-pulse duration-[5000ms]" />
            <div className="absolute -bottom-[200px] -left-[100px] w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-[#06b6d4] opacity-10 blur-[80px] md:blur-[100px] rounded-full pointer-events-none mix-blend-screen" />
            
            <div className="relative z-10 flex flex-col h-full justify-between space-y-8">
                <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div className="flex items-center gap-4">
                        <div className="p-3 bg-white/10 rounded-2xl border border-white/20 backdrop-blur-md shadow-[0_0_20px_rgba(255,255,255,0.1)] flex items-center justify-center shrink-0">
                            <Rocket className="w-6 h-6 text-white drop-shadow-md" />
                        </div>
                        <div className="space-y-1">
                            <h2 className="text-2xl md:text-3xl font-[1000] tracking-tighter leading-none text-white drop-shadow-sm">Strategic Vision</h2>
                            <div className="flex items-center gap-2">
                                <div className="w-8 h-0.5 bg-gradient-to-r from-[#E51636] to-transparent rounded-full" />
                                <p className="text-[10px] font-bold text-blue-100 uppercase tracking-[0.3em]">Command Directives</p>
                            </div>
                        </div>
                    </div>
                    <button onClick={onUpdate} className="flex group/btn relative px-5 py-2.5 bg-white/10 hover:bg-white/20 rounded-full text-[9px] font-black uppercase tracking-widest border border-white/10 transition-all overflow-hidden items-center gap-2 hover:border-white/30 hover:scale-105 active:scale-95">
                        <span className="relative z-10">{pillars.length > 0 ? "Update Vision" : "Initialize"}</span>
                        <ChevronRight className="w-3 h-3 relative z-10 group-hover/btn:translate-x-1 transition-transform" />
                    </button>
                </div>

                {pillars.length > 0 ? (
                    // --- UPDATED: 3 CARDS FIT ON MOBILE ---
                    <div className="flex overflow-x-auto snap-x snap-mandatory gap-4 no-scrollbar -mx-6 px-6 md:grid md:grid-cols-2 lg:grid-cols-3 md:mx-0 md:px-0 md:overflow-visible">
                        {pillars.map(pillar => {
                            const style = getColors(pillar.color);
                            // Fallback to Target if icon not found
                            const Icon = ICONS[pillar.icon] || Target;
                            const target = pillar.target || 100;
                            const progress = Math.min(100, Math.max(0, (pillar.current / target) * 100));

                            return (
                                <motion.div 
                                    key={pillar.id} 
                                    className="relative bg-white/5 border border-white/10 rounded-[32px] overflow-hidden backdrop-blur-sm hover:bg-white/10 transition-colors group/card h-[160px] md:h-[220px] min-w-[38vw] md:min-w-0 snap-center shrink-0 flex flex-col justify-between p-4 md:p-6"
                                >
                                    <div className="flex justify-between items-start">
                                        <div className="flex items-center gap-3">
                                            <div className={cn("w-10 h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center text-white shadow-lg", style.bg, style.border)}>
                                                {/* REMOVED FILL-CURRENT to avoid white circle blobs on certain icons */}
                                                <Icon className="w-5 h-5 md:w-6 md:h-6" />
                                            </div>
                                            <div>
                                                <span className="inline-block text-[8px] font-black uppercase tracking-widest text-blue-200 mb-0.5">
                                                    {pillar.subtitle || "METRIC"}
                                                </span>
                                                <h3 className="text-sm md:text-lg font-[1000] text-white leading-tight line-clamp-2">
                                                    {pillar.title}
                                                </h3>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="text-center">
                                        <div className="flex items-baseline justify-center gap-1">
                                            <span className="text-3xl md:text-5xl font-[1000] tracking-tighter drop-shadow-sm text-white">
                                                {pillar.current}
                                            </span>
                                            <span className="text-[10px] md:text-xs font-bold text-blue-200 uppercase">
                                                / {target} {pillar.unit === '%' && '%'}
                                            </span>
                                        </div>
                                    </div>
                                    <div>
                                        <div className="h-1.5 w-full bg-white/10 rounded-full overflow-hidden">
                                            <motion.div 
                                                initial={{ width: 0 }}
                                                animate={{ width: `${progress}%` }}
                                                transition={{ duration: 1.5, ease: "circOut" }}
                                                className={cn("h-full rounded-full relative bg-gradient-to-r", style.bar)}
                                            />
                                        </div>
                                    </div>
                                </motion.div>
                            );
                        })}
                    </div>
                ) : (
                    <div className="flex flex-col items-center justify-center py-12 border-2 border-dashed border-white/10 rounded-[32px] bg-white/5">
                        <div className="p-4 bg-white/10 rounded-full mb-4 shadow-lg animate-pulse">
                            <Layers className="w-8 h-8 text-white" />
                        </div>
                        <h3 className="text-xl font-black text-white mb-2">No Active Directives</h3>
                        <p className="text-blue-200 text-xs font-bold uppercase tracking-widest mb-6 text-center max-w-xs">
                            System is currently awaiting strategic configuration.
                        </p>
                        <button 
                            onClick={onUpdate}
                            className="px-8 py-3 bg-white text-[#004F71] rounded-full font-black text-[10px] uppercase tracking-[0.2em] hover:scale-105 transition-transform shadow-xl"
                        >
                            Initialize System
                        </button>
                    </div>
                )}
            </div>
        </motion.div>
    );
};

// --- MAIN PAGE ---

export default function DashboardPage() {
  const { events, team, loading, subscribeEvents, subscribeTeam, currentUser } = useAppStore();
  const [currentTime, setCurrentTime] = useState(new Date());
  
  // DYNAMIC TASK TITLE LOOKUP
  const taskMap = useTaskMap();
  
  // Modals & State
  const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
  const [selected1on1, setSelected1on1] = useState<CalendarEvent | null>(null);
  const [activeKPI, setActiveKPI] = useState<{ title: string; items: any[]; color: string; icon: any } | null>(null);
  
  const [visionPillars, setVisionPillars] = useState<VisionPillar[]>([]);
  const [isVisionModalOpen, setIsVisionModalOpen] = useState(false);
  const [selectedMember, setSelectedMember] = useState<TeamMember | null>(null);
  const [activeTab, setActiveTab] = useState<"overview" | "curriculum" | "performance" | "documents">("overview");

  // Mobile Tabs
  const [mobileTab, setMobileTab] = useState<'live' | 'next'>('live');
  const scrollRef = useRef<HTMLDivElement>(null);
  const feedRef = useRef<HTMLDivElement>(null);
  const nextRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const unsubEvents = subscribeEvents();
    const unsubTeam = subscribeTeam();
    const timer = setInterval(() => setCurrentTime(new Date()), 1000);
    
    const unsubVision = onSnapshot(doc(db, "vision", "current"), (docSnap) => {
        if (docSnap.exists()) {
            const data = docSnap.data();
            if (data.pillars) setVisionPillars(data.pillars);
        } else {
             setVisionPillars([]);
        }
    });

    return () => { unsubEvents(); unsubTeam(); unsubVision(); clearInterval(timer); };
  }, [subscribeEvents, subscribeTeam]);

  // SCROLL SPY FOR MOBILE TABS
  useEffect(() => {
    const container = scrollRef.current;
    if (!container) return;

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            if (entry.target === feedRef.current) setMobileTab('live');
            if (entry.target === nextRef.current) setMobileTab('next');
          }
        });
      },
      {
        root: container,
        threshold: 0.5 // 50% visibility triggers the tab switch
      }
    );

    if (feedRef.current) observer.observe(feedRef.current);
    if (nextRef.current) observer.observe(nextRef.current);

    return () => observer.disconnect();
  }, []);

  // CALCULATE LIVE METRICS
  const calculatedPillars = useMemo(() => {
    const currentMonth1on1s = events.filter(e => e.type === "OneOnOne" && e.status === "Done" && isSameMonth(e.startDate, new Date())).length;
    const activeGoalsCount = events.filter(e => e.type === "Goal" && e.status !== "Done").length;
    const leaderCount = team.filter(m => m.status === "Team Leader" || m.status === "Director" || m.status === "Assistant Director").length;
    const totalProgress = team.reduce((acc, curr) => acc + (curr.progress || 0), 0);
    const avgTraining = team.length > 0 ? Math.round(totalProgress / team.length) : 0;

    return visionPillars.map(p => {
        let liveVal = p.current;
        if (p.source === 'system_1on1') liveVal = currentMonth1on1s;
        if (p.source === 'system_active_goals') liveVal = activeGoalsCount;
        if (p.source === 'system_leaders') liveVal = leaderCount;
        if (p.source === 'system_training_avg') liveVal = avgTraining;
        if (p.source === 'system_member_progress' && p.linkedMemberId) {
            const member = team.find(m => m.id === p.linkedMemberId);
            if (member) liveVal = member.progress || 0;
        }
        return { ...p, current: liveVal };
    });
  }, [visionPillars, events, team]);

  const kpis = useMemo(() => {
    const certifiedLeaders = team.filter(m => m.status === "Director" || m.status === "Assistant Director");
    const monthlyOneOnOnes = events.filter(e => e.type === "OneOnOne" && isSameMonth(e.startDate, new Date()));
    const activeGoals = events.filter(e => e.type === "Goal" && e.status !== "Done");

    return [
      { id: "leaders", label: "Certified Leaders", value: certifiedLeaders.length.toString(), icon: GraduationCap, color: "text-[#004F71]", modalColor: "bg-[#004F71]", trend: "Live Count", data: certifiedLeaders.map(l => ({ id: l.id, title: l.name, subtitle: l.role, icon: User, status: l.dept })) },
      { id: "1on1s", label: "1-on-1s (MTD)", value: monthlyOneOnOnes.length.toString(), icon: Users, color: "text-purple-600", modalColor: "bg-purple-600", trend: "Monthly Cadence", data: monthlyOneOnOnes.map(e => ({ id: e.id, title: e.title, subtitle: `with ${e.teamMemberName}`, icon: MessageSquare, status: e.status, rawEvent: e })) },
      { id: "goals", label: "Active Goals", value: activeGoals.length.toString(), icon: Target, color: "text-[#E51636]", modalColor: "bg-[#E51636]", trend: "Strategic Focus", data: activeGoals.map(g => ({ id: g.id, title: g.title, subtitle: `Assigned to ${g.assigneeName}`, icon: Target, status: g.priority, rawEvent: g })) },
      { id: "roster", label: "Total Roster", value: team.length.toString(), icon: Activity, color: "text-emerald-600", modalColor: "bg-emerald-600", trend: "Headcount", data: team.map(t => ({ id: t.id, title: t.name, subtitle: t.role, icon: User, status: t.dept })) },
    ];
  }, [team, events]);
  
  // DYNAMIC TITLE LOGIC: Replaces raw task titles with live names from builder
  const activityFeed = useMemo(() => {
      return [...events].sort((a, b) => {
          const aCreated = (a as any).createdAt;
          const bCreated = (b as any).createdAt;
          const dateA = aCreated?.toDate ? aCreated.toDate() : new Date(a.startDate);
          const dateB = bCreated?.toDate ? bCreated.toDate() : new Date(b.startDate);
          return dateB.getTime() - dateA.getTime();
      }).slice(0, 8).map(event => {
          let displayTitle = event.title;
          
          if (event.metadata?.taskId && taskMap[event.metadata.taskId]) {
              displayTitle = `Module Verified: ${taskMap[event.metadata.taskId]}`;
          }

          return { ...event, title: displayTitle };
      });
  }, [events, taskMap]);

  const nextSession = useMemo(() => {
    return events.filter(e => e.type === "OneOnOne" && isFuture(e.startDate)).sort((a, b) => a.startDate.getTime() - b.startDate.getTime())[0];
  }, [events]);

  const handleDeleteEvent = async (id: string) => { const loadToast = toast.loading("Decommissioning..."); try { await deleteDoc(doc(db, "events", id)); toast.success("Terminated", { id: loadToast }); setSelectedEvent(null); } catch (e) { toast.error("Error", { id: loadToast }); } };
  const handleUpdateEvent = async (id: string, updates: any) => { const loadToast = toast.loading("Updating..."); try { await updateDoc(doc(db, "events", id), { ...updates, updatedAt: serverTimestamp() }); toast.success("Synced", { id: loadToast }); setSelectedEvent(null); } catch (e) { toast.error("Error", { id: loadToast }); } };
  const handleUpdate1on1 = async (updatedEvent: CalendarEvent) => { const loadToast = toast.loading("Updating Session..."); try { await updateDoc(doc(db, "events", updatedEvent.id), { description: updatedEvent.description, subtasks: updatedEvent.subtasks, status: updatedEvent.status, updatedAt: serverTimestamp() }); toast.success("Session Updated", { id: loadToast }); setSelected1on1(null); } catch (e) { toast.error("Error", { id: loadToast }); } };
  const handleKPIItemClick = (item: any) => { if (item.rawEvent) { if (item.rawEvent.type === "OneOnOne") { setSelected1on1(item.rawEvent); } else { setSelectedEvent(item.rawEvent); } } };
  
  const scrollToSection = (section: 'live' | 'next') => {
      if (!scrollRef.current) return;
      // Manually set state to feel instant, even if scrollspy triggers later
      setMobileTab(section);
      if (section === 'live') {
          feedRef.current?.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
      } else {
          nextRef.current?.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
      }
  };

  const myProfile = useMemo(() => {
    return team.find(m => m.id === currentUser?.uid);
  }, [team, currentUser]);

  if (currentUser?.role === "Team Member") {
    return (
        <div className="min-h-screen bg-[#F8FAFC] p-6 flex flex-col items-center justify-center">
            <div className="text-center mb-8 animate-fade-in">
                <h1 className="text-3xl font-[1000] text-slate-900 tracking-tighter mb-2">Welcome Back</h1>
                <p className="text-sm font-bold text-slate-400 uppercase tracking-widest">TrainingBook Operative</p>
            </div>
            {myProfile ? (
                 <div className="w-full max-w-sm perspective-1000">
                     <TeamCard 
                        member={myProfile} 
                        onClick={() => setSelectedMember(myProfile)} 
                        onAssignClick={() => {}} 
                        onDragStart={() => {}}
                        onDragEnd={() => {}}
                        isDragging={false}
                     />
                 </div>
            ) : (
                <div className="p-8 bg-white rounded-3xl shadow-sm text-center border border-slate-100">
                    <Loader2 className="w-8 h-8 text-[#E51636] animate-spin mx-auto mb-4" />
                    <p className="text-slate-400 font-bold uppercase tracking-widest text-xs">Profile Synchronizing...</p>
                </div>
            )}
            <AnimatePresence>
                {selectedMember && (
                    <MemberDetailSheet 
                        member={selectedMember} 
                        onClose={() => setSelectedMember(null)}
                        activeTab={activeTab}
                        setActiveTab={setActiveTab}
                    />
                )}
            </AnimatePresence>
        </div>
    );
  }
  
  if (loading && team.length === 0) return <div className="h-screen flex flex-col items-center justify-center bg-[#F8FAFC] gap-4"><Loader2 className="w-10 h-10 animate-spin text-[#E51636]" /><p className="text-xs font-black text-slate-400 uppercase tracking-[0.2em]">Synchronizing Operations...</p></div>;

  return (
    <div className="min-h-screen bg-[#F8FAFC] p-4 md:p-6 pb-32 font-sans text-slate-900 relative overflow-hidden">
        <div className="fixed inset-0 pointer-events-none">
            <div className="absolute top-[-20%] left-[-10%] w-[800px] md:w-[1400px] h-[800px] md:h-[1400px] bg-gradient-to-br from-blue-50/40 via-purple-50/20 to-transparent rounded-full blur-[100px] md:blur-[150px]" />
            <div className="absolute bottom-[-10%] right-[-10%] w-[600px] md:w-[1000px] h-[600px] md:h-[1000px] bg-gradient-to-tl from-red-50/30 to-transparent rounded-full blur-[100px] md:blur-[150px]" />
        </div>

        <div className="max-w-[1400px] mx-auto relative z-10 space-y-6 md:space-y-8 mt-4 md:mt-12">
            <div className="flex flex-col md:flex-row md:items-end justify-between gap-6 pb-1">
                <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>
                    <div className="flex flex-col md:flex-row md:items-center gap-3 mb-2">
                        <div className="px-3 py-1 bg-white border border-slate-100 rounded-full text-[10px] font-black uppercase tracking-widest text-slate-500 shadow-sm flex items-center justify-center md:justify-start gap-2 w-fit">
                            <CalendarDays className="w-3 h-3 text-[#E51636]" />
                            {format(currentTime, "EEEE, MMMM do")}
                            <div className="w-px h-3 bg-slate-200 mx-1 hidden md:block" />
                            <span className="tabular-nums text-slate-900">{format(currentTime, "h:mm aa")}</span>
                        </div>
                        <span className="flex items-center gap-1.5 px-2.5 py-1 bg-[#004F71] border border-[#004F71] rounded-full text-[9px] font-black uppercase tracking-widest text-white shadow-lg shadow-blue-900/20 w-fit">
                            <Sparkles className="w-2.5 h-2.5 fill-current" />
                            Command Center
                        </span>
                    </div>
                    <h1 className="text-4xl md:text-5xl font-black tracking-tighter text-slate-900 leading-tight">
                        Ops<span className="text-[#E51636]">Overview</span>
                    </h1>
                </motion.div>
            </div>
            
            <StrategicVisionBoard pillars={calculatedPillars} onUpdate={() => setIsVisionModalOpen(true)} />

            <div className="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
                {kpis.map((kpi, idx) => (
                    <KPICard 
                        key={idx} 
                        kpi={kpi} 
                        onClick={() => setActiveKPI({ title: kpi.label, items: kpi.data, color: kpi.modalColor, icon: kpi.icon })} 
                    />
                ))}
            </div>

            <div className="flex lg:hidden items-center gap-6 px-1 mb-2">
                <button onClick={() => scrollToSection('live')} className={cn("text-lg font-black transition-colors relative", mobileTab === 'live' ? "text-slate-900" : "text-slate-300")}>
                    Live Feed
                    {mobileTab === 'live' && <motion.div layoutId="mobileTab" className="absolute -bottom-1 left-0 right-0 h-1 bg-[#E51636] rounded-full" />}
                </button>
                <button onClick={() => scrollToSection('next')} className={cn("text-lg font-black transition-colors relative", mobileTab === 'next' ? "text-slate-900" : "text-slate-300")}>
                    Up Next
                    {mobileTab === 'next' && <motion.div layoutId="mobileTab" className="absolute -bottom-1 left-0 right-0 h-1 bg-[#E51636] rounded-full" />}
                </button>
            </div>

            {/* --- CONTAINER: LIVE FEED & UP NEXT --- */}
            <div 
                ref={scrollRef}
                className="flex lg:grid lg:grid-cols-12 gap-6 md:gap-8 overflow-x-auto lg:overflow-visible snap-x snap-mandatory no-scrollbar -mx-4 px-4 pb-8 lg:mx-0 lg:px-0 lg:pb-0"
            >
            
            {/* =========================================================
                1. LIVE OPERATIONAL FEED (Tactical Timeline)
               ========================================================= */}
            <div ref={feedRef} className="min-w-[90vw] md:min-w-[45vw] lg:min-w-0 col-span-12 lg:col-span-8 flex flex-col gap-5 snap-center h-fit shrink-0">
                
                {/* Section Header */}
                <div className="flex items-center justify-between px-1">
                    <div className="flex items-center gap-3">
                        <div className="p-2 bg-[#E51636] text-white rounded-lg shadow-lg shadow-red-500/20">
                            <LayoutList className="w-4 h-4" />
                        </div>
                        <div>
                            <h3 className="text-lg font-[1000] text-slate-900 tracking-tight leading-none">Live Ops</h3>
                            <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-0.5">Real-time Intelligence</p>
                        </div>
                    </div>
                    <div className="hidden md:flex items-center gap-2 px-3 py-1.5 bg-white border border-slate-100 rounded-full shadow-sm">
                        <div className="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse" />
                        <span className="text-[9px] font-black uppercase tracking-widest text-slate-500">System Active</span>
                    </div>
                </div>

                {/* Feed Card Container */}
                <div className="relative pl-4 md:pl-0">
                    {/* The Timeline Vertical Line */}
                    <div className="absolute left-[39px] top-6 bottom-6 w-0.5 bg-gradient-to-b from-slate-200 via-slate-100 to-transparent hidden md:block" />

                    <div className="space-y-4">
                        <AnimatePresence mode="popLayout">
                            {activityFeed.map((event, i) => {
                                const isDone = event.status === "Done";
                                const isSystem = event.assigneeName === "System";

                                return (
                                    <motion.div 
                                        key={event.id}
                                        layout
                                        initial={{ opacity: 0, y: 20 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        exit={{ opacity: 0, scale: 0.95 }}
                                        transition={{ duration: 0.3, delay: i * 0.05 }}
                                        onClick={() => { if(event.type === 'OneOnOne') setSelected1on1(event); else setSelectedEvent(event); }}
                                        className="relative group cursor-pointer"
                                    >
                                        <div className="flex gap-4 md:gap-6 items-start">
                                            
                                            {/* Icon Column (Desktop) */}
                                            <div className="hidden md:flex shrink-0">
                                                <FeedIcon type={event.type} priority={event.priority} />
                                            </div>

                                            {/* Main Card */}
                                            <div className={cn(
                                                "flex-1 relative overflow-hidden rounded-[20px] md:rounded-[24px] border transition-all duration-300",
                                                "bg-white shadow-sm hover:shadow-lg hover:-translate-y-0.5",
                                                event.priority === 'High' ? "border-l-[4px] border-l-red-500 border-y-slate-100 border-r-slate-100" : "border-slate-100"
                                            )}>
                                                {/* Card Content */}
                                                <div className="p-4 md:p-5 flex flex-col gap-2 relative z-10">
                                                    
                                                    {/* Top Row: Meta */}
                                                    <div className="flex items-center justify-between">
                                                        <div className="flex items-center gap-2">
                                                            {/* Mobile Icon */}
                                                            <div className="md:hidden"><FeedIcon type={event.type} priority={event.priority} /></div>
                                                            <div className="flex flex-col md:flex-row md:items-center gap-0.5 md:gap-2">
                                                                <span className="text-[9px] font-black uppercase tracking-widest text-slate-400">{getEventLabel(event.type)}</span>
                                                                {isDone && <span className="hidden md:inline text-emerald-500 text-[9px] font-black">• Completed</span>}
                                                            </div>
                                                        </div>
                                                        <TimeAgo date={event.createdAt?.toDate ? event.createdAt.toDate() : event.startDate} />
                                                    </div>

                                                    {/* Middle: Title */}
                                                    <h4 className={cn(
                                                        "text-sm md:text-base font-bold leading-snug group-hover:text-[#004F71] transition-colors line-clamp-2",
                                                        isSystem ? "text-slate-600 font-medium italic" : "text-slate-900"
                                                    )}>
                                                        {event.title}
                                                    </h4>

                                                    {/* Bottom: Assignees */}
                                                    <div className="flex items-center gap-3 mt-1 pt-3 border-t border-slate-50">
                                                        <div className="flex items-center gap-2">
                                                            <div className="w-5 h-5 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-[9px] font-black text-slate-500 uppercase">
                                                                {event.assigneeName.charAt(0)}
                                                            </div>
                                                            <span className="text-[10px] font-bold text-slate-500">{event.assigneeName}</span>
                                                        </div>
                                                        
                                                        <ArrowRight className="w-3 h-3 text-slate-300" />
                                                        
                                                        <div className="flex items-center gap-2">
                                                            <div className={cn(
                                                                "w-5 h-5 rounded-md border flex items-center justify-center text-[9px] font-black uppercase",
                                                                event.teamMemberName === "Command" ? "bg-slate-800 text-white border-slate-800" : "bg-slate-50 text-slate-500 border-slate-200"
                                                            )}>
                                                                {event.teamMemberName ? event.teamMemberName.charAt(0) : "T"}
                                                            </div>
                                                            <span className="text-[10px] font-bold text-slate-500">{event.teamMemberName || "Team"}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </motion.div>
                                );
                            })}
                        </AnimatePresence>
                    </div>
                </div>
            </div>

            {/* =========================================================
                2. UP NEXT HUD (Mission Card)
               ========================================================= */}
            <div ref={nextRef} className="min-w-[85vw] md:min-w-[40vw] lg:min-w-0 col-span-12 lg:col-span-4 lg:col-start-9 flex flex-col gap-5 lg:sticky lg:top-24 snap-center h-fit shrink-0">
                
                <div className="flex items-center justify-between px-1">
                    <div className="flex items-center gap-2">
                        <Clock className="w-4 h-4 text-[#004F71]" />
                        <h3 className="text-lg font-[1000] text-slate-900 tracking-tight">On Deck</h3>
                    </div>
                </div>
                
                {nextSession ? (
                    <motion.div 
                        initial={{ opacity: 0, scale: 0.95 }}
                        animate={{ opacity: 1, scale: 1 }}
                        className="relative w-full rounded-[32px] overflow-hidden shadow-2xl group"
                    >
                        {/* 1. Dynamic Background */}
                        <div className="absolute inset-0 bg-[#004F71]">
                            <div className="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]" />
                            <div className="absolute top-0 right-0 w-64 h-64 bg-[#E51636] rounded-full blur-[100px] opacity-40 mix-blend-screen -translate-y-1/2 translate-x-1/2 group-hover:opacity-60 transition-opacity duration-700" />
                        </div>

                        {/* 2. Glass Overlay Content */}
                        <div className="relative z-10 p-6 md:p-8 flex flex-col h-full text-white">
                            
                            {/* Top Badges */}
                            <div className="flex justify-between items-start mb-8">
                                <div className="p-3 bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-lg">
                                    <BookOpen className="w-6 h-6 text-white" />
                                </div>
                                <div className="flex flex-col items-end">
                                    <span className="px-3 py-1 bg-[#E51636] rounded-full text-[9px] font-black uppercase tracking-widest shadow-lg shadow-red-900/20 border border-white/10 mb-1">
                                        Priority
                                    </span>
                                    <span className="text-[10px] font-bold text-blue-200">
                                        {formatDistanceToNow(nextSession.startDate, { addSuffix: true })}
                                    </span>
                                </div>
                            </div>

                            {/* Main Info */}
                            <div className="space-y-1 mb-8">
                                <p className="text-[10px] font-black uppercase text-blue-300 tracking-[0.2em]">Next Directive</p>
                                <h2 className="text-3xl md:text-4xl font-[1000] leading-[0.9] tracking-tighter drop-shadow-sm">
                                    {nextSession.assigneeName}
                                </h2>
                                <div className="flex items-center gap-2 mt-2 opacity-90">
                                    <span className="text-xs font-medium text-blue-100">Mentoring</span>
                                    <div className="flex items-center gap-1.5 px-2 py-0.5 bg-white/10 rounded-lg border border-white/10">
                                        <User className="w-3 h-3" />
                                        <span className="text-xs font-bold uppercase">{nextSession.teamMemberName || "Team"}</span>
                                    </div>
                                </div>
                            </div>

                            {/* Time Slot HUD */}
                            <div className="grid grid-cols-2 gap-px bg-white/10 border border-white/20 rounded-2xl overflow-hidden mb-6">
                                <div className="p-4 flex flex-col items-center justify-center bg-white/5 backdrop-blur-sm">
                                    <span className="text-2xl font-[1000] leading-none">{format(nextSession.startDate, "d")}</span>
                                    <span className="text-[9px] font-black uppercase text-blue-200">{format(nextSession.startDate, "MMM")}</span>
                                </div>
                                <div className="p-4 flex flex-col items-center justify-center bg-white/5 backdrop-blur-sm border-l border-white/10">
                                    <span className="text-xl font-[1000] leading-none">{format(nextSession.startDate, "h:mm")}</span>
                                    <span className="text-[9px] font-black uppercase text-blue-200">{format(nextSession.startDate, "aa")}</span>
                                </div>
                            </div>

                            {/* Action Button */}
                            <button 
                                onClick={() => setSelected1on1(nextSession)} 
                                className="w-full py-4 bg-white text-[#004F71] rounded-2xl font-black uppercase text-[10px] tracking-[0.25em] shadow-xl hover:shadow-2xl hover:scale-[1.02] active:scale-95 transition-all flex items-center justify-center gap-3 group/btn"
                            >
                                Launch Prep <ArrowRight className="w-3.5 h-3.5 group-hover/btn:translate-x-1 transition-transform" />
                            </button>
                        </div>
                    </motion.div>
                ) : (
                    <div className="p-8 border-2 border-dashed border-slate-200 rounded-[32px] flex flex-col items-center justify-center text-center bg-white/50 h-[300px]">
                        <div className="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4">
                            <CheckCircle2 className="w-8 h-8 text-slate-300" />
                        </div>
                        <h4 className="text-sm font-black text-slate-900 uppercase tracking-widest mb-1">All Clear</h4>
                        <p className="text-xs text-slate-400 font-medium">No immediate sessions scheduled.</p>
                    </div>
                )}
            </div>
            
            </div>
        </div>

        <AnimatePresence>
            {selectedEvent && (
                <EventDetailSheet 
                    event={selectedEvent} 
                    onClose={() => setSelectedEvent(null)} 
                    onDelete={selectedEvent.assigneeName === "System" ? undefined : handleDeleteEvent}
                    onUpdate={handleUpdateEvent} 
                    isSystemEvent={selectedEvent.assigneeName === "System"}
                />
            )}
        </AnimatePresence>
        <AnimatePresence>{selected1on1 && <OneOnOneSessionModal event={selected1on1} onClose={() => setSelected1on1(null)} onUpdate={handleUpdate1on1} />}</AnimatePresence>
        <AnimatePresence>{activeKPI && <KPIModal title={activeKPI.title} items={activeKPI.items} color={activeKPI.color} icon={activeKPI.icon} onClose={() => setActiveKPI(null)} onItemClick={handleKPIItemClick} />}</AnimatePresence>
        
        <AnimatePresence>
            {isVisionModalOpen && (
                <StrategicVisionModal 
                    isOpen={isVisionModalOpen} 
                    onClose={() => setIsVisionModalOpen(false)} 
                    currentPillars={visionPillars} 
                />
            )}
        </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/(main)/team/_components/tabs/OverviewTab.tsx ---
"use client";

import { useMemo } from "react";
import { 
  Zap, Users, Check, Award, Command, Activity, Target, 
  ShieldAlert, CalendarClock, MessageSquare, Lightbulb, Goal, 
  BookOpen, FileText, Star, StickyNote, File, ArrowLeftRight, 
  UserPlus, Crown
} from "lucide-react";
import { cn, getProbationStatus } from "@/lib/utils";
import { TeamMember, STAGES, CalendarEvent } from "../../../calendar/_components/types";
import { useAppStore } from "@/lib/store/useStore";
import { format, formatDistanceToNow, isValid, isToday } from "date-fns";
import { TACTICAL_ICONS } from "@/lib/icon-library";
import { motion } from "framer-motion";
import { useTaskMap } from "@/lib/hooks/useTaskMap"; 

interface Props {
  member: TeamMember;
}

const getCategoryStyle = (type: string) => {
    switch (type) {
        case 'GOAL': return 'bg-emerald-50 text-emerald-700 border-emerald-100';
        case '1-ON-1': return 'bg-purple-50 text-purple-700 border-purple-100';
        case 'AWARD': return 'bg-amber-50 text-amber-700 border-amber-100'; 
        case 'VOTE': return 'bg-slate-100 text-slate-600 border-slate-200'; 
        
        case 'PROMOTION': return 'bg-indigo-50 text-indigo-700 border-indigo-100';
        case 'TRANSFER': return 'bg-cyan-50 text-cyan-700 border-cyan-100';
        case 'ASSIGNMENT': return 'bg-sky-50 text-sky-700 border-sky-100';
        case 'WINNER': return 'bg-amber-100 text-amber-800 border-amber-200';

        case 'INCIDENT': return 'bg-red-50 text-red-700 border-red-100';
        case 'COMMENDATION': return 'bg-amber-50 text-amber-700 border-amber-100';
        case 'REVIEW': return 'bg-blue-50 text-blue-700 border-blue-100';
        case 'NOTE': return 'bg-slate-100 text-slate-600 border-slate-200';
        
        case 'MODULE': return 'bg-indigo-50 text-indigo-700 border-indigo-100';
        default: return 'bg-slate-100 text-slate-600 border-slate-200';
    }
};

const getSmartDate = (date: Date) => {
    if (isToday(date)) {
        return formatDistanceToNow(date, { addSuffix: true }).replace("about ", "");
    }
    return format(date, "MMM d");
};

export function OverviewTab({ member }: Props) {
  const { events, curriculum } = useAppStore();
  const probation = useMemo(() => getProbationStatus(member.joined), [member.joined]);
  const taskMap = useTaskMap();

  // --- ACTIVITY DATA ---
  const timelineData = useMemo(() => {
    const history: any[] = [];
    
    // Filter events where this member is the SUBJECT (teamMemberId) or the Assignee (if it's a Goal they own)
    const assignedEvents = events.filter(e => 
        e.teamMemberId === member.id || (e.assignee === member.id && e.type === 'Goal')
    );
    
    assignedEvents.forEach(e => {
        let category = 'MISSION';
        let desc = e.description || "";
        let title = e.title;

        // DYNAMIC TITLE
        if (e.metadata?.taskId && taskMap[e.metadata.taskId]) {
            title = `Module Verified: ${taskMap[e.metadata.taskId]}`;
        }

        // --- IMPROVED DOCUMENT PARSING ---
        // Check if description starts with the tag OR contains the tag (for safety)
        if (desc.includes("[DOCUMENT LOG:")) {
             // Extract type
             const match = desc.match(/\[DOCUMENT LOG: (.*?)\]/);
             const docType = match ? match[1] : 'Note';
             
             if (docType.includes("Incident")) category = 'INCIDENT';
             else if (docType.includes("Commendation")) category = 'COMMENDATION';
             else if (docType.includes("Review")) category = 'REVIEW';
             else if (docType.includes("Note")) category = 'NOTE';
             else category = 'DOCUMENT';

             // Clean description for display: Remove the tag and following newlines
             desc = desc.replace(/\[DOCUMENT LOG: .*?\](\n\n)?/, "").trim();
        }
        else if (e.type === 'Goal') category = 'GOAL';
        else if (e.type === 'OneOnOne') category = '1-ON-1';
        else if (e.type === 'Award') {
             if (title.startsWith("EOTM Winners")) {
                 category = 'WINNER';
             } else {
                 category = 'AWARD';
             }
        }
        else if (e.type === 'Vote') category = 'VOTE';
        else if (e.title === "Mentorship Uplink") category = 'SYSTEM';

        // SYSTEM LOGS
        if (desc.includes("[SYSTEM LOG: PROMOTION]")) category = 'PROMOTION';
        else if (desc.includes("[SYSTEM LOG: TRANSFER]")) category = 'TRANSFER';
        else if (desc.includes("[SYSTEM LOG: ASSIGNMENT]")) category = 'ASSIGNMENT';

        // Clean System Logs
        if (desc.startsWith("[SYSTEM LOG:") || desc.startsWith("[OFFICIAL")) {
             desc = desc.replace(/\[.*?\]\n/, "").trim();
        }

        history.push({ 
            id: e.id, 
            date: e.createdAt?.toDate ? e.createdAt.toDate() : e.startDate, // Prefer createdAt for stream accuracy
            title: title, 
            category, 
            description: desc, 
            rawEvent: e, 
            mentorName: e.assigneeName 
        });
    });

    if (member.completedTaskIds && member.completedTaskIds.length > 0) {
        let completedNames: string[] = [];
        curriculum.forEach(section => {
             section.tasks?.forEach((t: any) => {
                 if (member.completedTaskIds?.includes(t.id)) completedNames.push(t.title);
             });
        });
        // Only push summary if we don't have individual events for these (legacy support)
        // But since we generate events now, we might not need this. Keeping as fallback.
    }

    return history.sort((a, b) => b.date.getTime() - a.date.getTime()).slice(0, 8); 
  }, [events, member.id, curriculum, member.completedTaskIds, taskMap]);

  const recentGoals = useMemo(() => {
      return timelineData.filter(i => i.category === 'GOAL' || i.category === '1-ON-1').slice(0, 3);
  }, [timelineData]);

  return (
    <div className="p-5 lg:p-10 space-y-6 lg:space-y-8 pb-32 h-full overflow-y-auto custom-scrollbar bg-[#F8FAFC]">
        
        {/* --- PROBATION --- */}
        {probation && probation.isActive && (
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6">
                <div className="bg-gradient-to-br from-amber-50 to-orange-50 p-4 lg:p-5 rounded-[24px] lg:rounded-[28px] border border-amber-100 shadow-sm relative overflow-hidden">
                    <div className="flex justify-between items-start mb-2 relative z-10">
                        <div className="flex items-center gap-2">
                            <div className="p-1.5 bg-amber-100 rounded-lg text-amber-600">
                                <ShieldAlert className="w-4 h-4" />
                            </div>
                            <div>
                                <h4 className="text-xs font-black text-amber-900 uppercase tracking-wide">Probation</h4>
                                <p className="text-[10px] font-medium text-amber-600/80">30-Day Period</p>
                            </div>
                        </div>
                        <div className="text-right">
                            <span className="text-2xl font-black text-amber-500 leading-none">{probation.daysRemaining}</span>
                            <span className="text-[8px] font-bold text-amber-400 block uppercase">Left</span>
                        </div>
                    </div>
                    <div className="h-1.5 w-full bg-amber-200/50 rounded-full overflow-hidden relative z-10">
                        <motion.div initial={{ width: 0 }} animate={{ width: `${probation.percentage}%` }} className="h-full bg-amber-500 rounded-full" />
                    </div>
                    <CalendarClock className="absolute -bottom-4 -right-4 w-24 h-24 text-amber-500/5 rotate-12" />
                </div>
            </div>
        )}

        {/* --- DEPLOYMENT STATUS --- */}
        <div className="bg-white p-6 lg:p-10 rounded-[32px] border border-slate-200 shadow-sm overflow-hidden">
            <h4 className="text-[10px] font-black text-slate-400 uppercase tracking-[0.25em] mb-6 text-center">Unit Deployment Status</h4>
            <div className="overflow-x-auto no-scrollbar pt-12 pb-6 -mx-6 px-6 scroll-smooth snap-x">
                <div className="flex items-center gap-4 px-4 min-w-max mx-auto relative">
                    <div className="absolute left-10 right-10 top-[1.25rem] h-0.5 bg-slate-100 -z-10" />
                    {STAGES.map((s, i) => { 
                        const currentIdx = STAGES.findIndex(x => x.id === member.status); 
                        const isDone = i < currentIdx; const isCurrent = i === currentIdx; 
                        let dateStr = "";
                        if (s.id === "Onboarding" && member.joined) dateStr = format(new Date(member.joined), "MMM yyyy");
                        else if (member.promotionDates?.[s.id]) { const d = new Date(member.promotionDates[s.id]); if (isValid(d)) dateStr = format(d, "MMM yyyy"); } else if (isCurrent) dateStr = "Current"; else if (isDone) dateStr = "Completed";
                        return (
                            <div key={s.id} className="relative z-10 flex flex-col items-center gap-3 group snap-center min-w-[90px]">
                                <div className={cn("w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all shadow-lg bg-white relative", isDone ? "bg-emerald-500 border-emerald-400 text-white" : isCurrent ? "bg-white border-[#E51636] text-[#E51636] ring-4 ring-red-50 scale-125 shadow-xl" : "bg-white border-slate-100 text-slate-200")}>{isDone ? <Check className="w-5 h-5" /> : <span className="font-black text-xs">{i + 1}</span>}</div>
                                <div className="flex flex-col items-center gap-0.5 text-center"><span className={cn("text-[9px] font-bold uppercase tracking-widest whitespace-nowrap transition-colors leading-none", isCurrent ? "text-slate-900" : "text-slate-300")}>{s.title}</span><span className={cn("text-[8px] font-bold uppercase tracking-wide", isCurrent ? "text-[#E51636]" : isDone ? "text-emerald-500" : "text-slate-300 opacity-0")}>{dateStr}</span></div>
                            </div>
                        ) 
                    })}
                </div>
            </div>
        </div>

        {/* --- ACCOLADES --- */}
        <div className="space-y-3">
            <div className="flex items-center gap-3 px-2">
                <Award className="w-4 h-4 text-amber-500" />
                <span className="text-[10px] font-black uppercase tracking-widest text-slate-900">Validated Accolades</span>
            </div>
            <div className="flex gap-3 overflow-x-auto no-scrollbar pb-2 pl-2 snap-x">
                {member.badges && member.badges.length > 0 ? member.badges.map((badge: any, i: number) => { 
                    const Icon = TACTICAL_ICONS.find(ic => ic.id === badge.iconId)?.icon || Award; 
                    
                    let subText = "";
                    if (badge.label === "Employee of the Month" && badge.desc) {
                         subText = badge.desc.replace("Employee of the Month - ", "");
                    }

                    return (
                        <div key={i} className="min-w-[140px] p-4 rounded-[20px] bg-white border border-slate-100 shadow-sm flex flex-col items-center text-center gap-2 hover:shadow-md transition-all snap-center">
                            <div className="p-2.5 rounded-xl shadow-inner" style={{ backgroundColor: `${badge.hex}15`, color: badge.hex }}><Icon className="w-5 h-5" /></div>
                            <div className="flex flex-col gap-0.5">
                                <span className="text-[9px] font-bold text-slate-800 uppercase tracking-tight line-clamp-1">{badge.label}</span>
                                {subText && (
                                    <span className="text-[8px] font-bold text-slate-400 uppercase tracking-widest">{subText}</span>
                                )}
                            </div>
                        </div>
                    ) 
                }) : (
                    <div className="w-full text-center py-6 border-2 border-dashed border-slate-200 rounded-[20px] text-slate-300 bg-slate-50/50"><p className="text-[9px] font-bold uppercase tracking-widest">No badges awarded</p></div>
                )}
            </div>
        </div>

        {/* --- INTELLIGENCE --- */}
        <div className="bg-white p-5 lg:p-8 rounded-[32px] border border-slate-200 shadow-sm space-y-6">
            <div className="flex items-center gap-3">
                <div className="p-2 bg-[#004F71] text-white rounded-xl shadow-md"><Command className="w-4 h-4" /></div>
                <div><span className="text-[9px] font-black uppercase tracking-[0.2em] text-slate-300 block">Command Center</span><span className="text-base lg:text-lg font-bold text-slate-900 leading-none">Intelligence</span></div>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
                {/* COLUMN 1: ACTIVITY STREAM */}
                <div className="lg:col-span-7 space-y-5 relative pl-4 border-l-2 border-slate-100">
                    <div className="flex items-center gap-2 mb-1"><Activity className="w-3.5 h-3.5 text-[#E51636]" /><span className="text-[9px] font-black uppercase tracking-[0.2em] text-slate-400">Activity Stream</span></div>
                    {timelineData.length > 0 ? timelineData.map((item, idx) => (
                        <div key={idx} className="relative group">
                            <div className="absolute -left-[21px] top-1.5 w-3 h-3 rounded-full border-[3px] border-white bg-slate-200 group-hover:bg-[#E51636] transition-all shadow-sm z-10" />
                            <div className="space-y-1">
                                <div className="flex flex-wrap items-center gap-2">
                                    <span className={cn("px-2 py-0.5 rounded-md text-[8px] font-black uppercase border", getCategoryStyle(item.category))}>{item.category}</span>
                                    <span className="text-[8px] font-bold text-slate-300 uppercase">{getSmartDate(item.date)}</span>
                                </div>
                                <p className="text-xs lg:text-sm font-bold text-slate-800 leading-tight">{item.title}</p>
                                {item.description && <p className="text-[10px] text-slate-500 line-clamp-1">{item.description}</p>}
                            </div>
                        </div>
                    )) : (
                        <div className="p-4 bg-slate-50 rounded-xl text-center text-slate-400 border border-slate-100 border-dashed"><p className="text-[10px] font-bold uppercase tracking-widest">No recent activity detected.</p></div>
                    )}
                </div>

                {/* COLUMN 2: KEY OBJECTIVES */}
                <div className="lg:col-span-5 space-y-4">
                    <div className="flex items-center gap-2 mb-1"><Target className="w-3.5 h-3.5 text-[#004F71]" /><span className="text-[9px] font-black uppercase tracking-[0.2em] text-slate-400">Key Objectives</span></div>
                    {recentGoals.length > 0 ? recentGoals.map((goal, idx) => (
                        <div key={idx} className="p-4 bg-slate-50 border border-slate-100 rounded-[20px] shadow-sm flex items-start gap-3">
                            <div className={cn("p-2 rounded-lg shrink-0", goal.category === '1-ON-1' ? "bg-purple-100 text-purple-600" : "bg-emerald-100 text-emerald-600")}>{goal.category === '1-ON-1' ? <Lightbulb className="w-4 h-4" /> : <Goal className="w-4 h-4" />}</div>
                            <div>
                                <h5 className="text-xs font-bold text-slate-900 leading-snug">{goal.title}</h5>
                                <p className="text-[10px] text-slate-500 mt-1 line-clamp-2">{goal.description || "No specific details logged."}</p>
                                <div className="mt-2 flex items-center gap-2">
                                    <span className="text-[8px] font-black uppercase tracking-widest text-slate-400">{getSmartDate(goal.date)}</span>
                                </div>
                            </div>
                        </div>
                    )) : (
                        <div className="p-8 border-2 border-dashed border-slate-100 rounded-[24px] flex flex-col items-center justify-center text-slate-300 bg-slate-50/50"><Target className="w-8 h-8 mb-2 opacity-50" /><span className="text-[9px] font-bold uppercase tracking-widest text-center">No Active Goals</span></div>
                    )}
                </div>
            </div>
        </div>
    </div>
  );
}
--- FILE: ./app/(main)/team/_components/tabs/CurriculumTab.tsx ---
"use client";

import { useMemo, useState, useEffect } from "react";
import { 
  Check, HardDrive, BookOpen, Loader2, Maximize2, 
  Minimize2, AlertTriangle, Play, ArrowLeft, ChevronRight, CheckCircle2, Expand, AlignLeft, X
} from "lucide-react";
import { cn } from "@/lib/utils";
import { TeamMember } from "../../../calendar/_components/types";
import { useAppStore } from "@/lib/store/useStore";
import { doc, setDoc, serverTimestamp, arrayUnion, arrayRemove, addDoc, collection } from "firebase/firestore";
import { db } from "@/lib/firebase";
import toast from "react-hot-toast";
import { motion, AnimatePresence, useDragControls, PanInfo } from "framer-motion";
import ClientPortal from "@/components/core/ClientPortal";

// --- COLOR MAP ---
const SUBJECT_COLORS = [
    { id: "slate", hex: "#f8fafc", bg: "bg-slate-50", text: "text-slate-500", border: "border-slate-200" }, 
    { id: "navy", hex: "#f0f9ff", bg: "bg-[#004F71]/10", text: "text-[#004F71]", border: "border-[#004F71]/20" }, 
    { id: "red", hex: "#fff1f2", bg: "bg-[#E51636]/10", text: "text-[#E51636]", border: "border-[#E51636]/20" }, 
    { id: "amber", hex: "#fffbeb", bg: "bg-amber-50", text: "text-amber-600", border: "border-amber-200" },
];

// --- MANUAL VIEWER MODAL ---
function ManualViewerModal({ url, title, pages, onClose, color }: { url: string, title: string, pages: string, onClose: () => void, color: string }) {
    const [loading, setLoading] = useState(true);
    const dragControls = useDragControls();

    return (
        <ClientPortal>
            <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="fixed inset-0 z-[200] bg-slate-900/60 backdrop-blur-sm" onClick={onClose} />
            <motion.div 
                initial={{ y: "100%" }} animate={{ y: 0 }} exit={{ y: "100%" }}
                transition={{ type: "spring", damping: 25, stiffness: 300 }}
                drag="y" dragControls={dragControls} dragListener={false} dragConstraints={{ top: 0, bottom: 0 }} dragElastic={0.05}
                onDragEnd={(_, info: PanInfo) => { if (info.offset.y > 100) onClose(); }}
                className="fixed bottom-0 left-0 right-0 z-[210] h-[92vh] bg-white rounded-t-[40px] shadow-2xl overflow-hidden flex flex-col pointer-events-auto"
            >
                <div className="absolute top-0 left-0 right-0 h-14 z-50 flex items-start justify-center pt-3 cursor-grab active:cursor-grabbing touch-none bg-gradient-to-b from-white via-white to-transparent" onPointerDown={(e) => dragControls.start(e)}>
                    <div className="w-12 h-1.5 bg-slate-200 rounded-full" />
                </div>
                <div className="flex items-center justify-between px-6 md:px-8 pt-8 md:pt-10 pb-4 border-b border-slate-100 bg-white shrink-0 relative z-40">
                    <div>
                        <div className="flex items-center gap-2 mb-1"><span className={cn("w-2 h-2 rounded-full", color === 'bg-[#004F71]' ? 'bg-[#004F71]' : 'bg-[#E51636]')} /><p className="text-[10px] font-black uppercase text-slate-400 tracking-[0.2em]">Manual Viewer</p></div>
                        <h3 className="text-lg md:text-xl font-black text-slate-900 leading-none tracking-tight">{title}</h3>
                    </div>
                    <button onClick={onClose} className="p-2.5 bg-slate-50 rounded-full hover:bg-slate-100 transition-all border border-slate-100"><Minimize2 className="w-5 h-5 text-slate-500" /></button>
                </div>
                <div className="relative flex-1 bg-slate-50 overflow-hidden">
                    {loading && <div className="absolute inset-0 flex flex-col items-center justify-center gap-3 z-0"><Loader2 className={cn("w-10 h-10 animate-spin", color === 'bg-[#004F71]' ? "text-[#004F71]" : "text-[#E51636]")} /><p className="text-xs font-bold text-slate-400 uppercase tracking-widest">Retrieving Data...</p></div>}
                    <iframe src={url} className="w-full h-full border-none relative z-10" onLoad={() => setLoading(false)} />
                </div>
            </motion.div>
        </ClientPortal>
    );
}

const CANVA_LINKS: Record<string, string> = {
  FOH: "https://www.canva.com/design/DAG7sot3RWY/Sv-7Y3IEyBqUUFB999JiPA/view",
  BOH: "https://www.canva.com/design/DAG7ssYg444/FFZwbb8mLfLGiGrP2VeHiA/view",
  Unassigned: "https://www.canva.com/design/DAG7sot3RWY/Sv-7Y3IEyBqUUFB999JiPA/view"
};

// --- SKELETON LOADER ---
const CurriculumSkeleton = () => (
    <div className="space-y-4 animate-pulse">
        <div className="flex justify-between items-center mb-6 px-1">
            <div className="flex gap-3 items-center">
                <div className="w-10 h-10 bg-slate-200 rounded-2xl" />
                <div className="space-y-2">
                    <div className="w-32 h-5 bg-slate-200 rounded-lg" />
                    <div className="w-20 h-3 bg-slate-100 rounded-full" />
                </div>
            </div>
        </div>
        <div className="grid grid-cols-1 gap-4">
            {[1, 2, 3].map((i) => (
                <div key={i} className="bg-white border border-slate-100 rounded-[32px] p-6 h-32 shadow-sm flex items-center justify-between">
                    <div className="flex items-center gap-5">
                         <div className="w-14 h-14 rounded-2xl bg-slate-100 shrink-0" />
                         <div className="space-y-3">
                             <div className="w-16 h-3 bg-slate-100 rounded-full" />
                             <div className="w-48 h-6 bg-slate-200 rounded-lg" />
                             <div className="w-12 h-3 bg-slate-100 rounded-full" />
                         </div>
                    </div>
                    <div className="w-10 h-10 rounded-full bg-slate-50" />
                </div>
            ))}
        </div>
    </div>
);

interface Props {
  member: TeamMember;
}

export function CurriculumTab({ member }: Props) {
  const { curriculum, updateMemberLocal, loading: globalLoading } = useAppStore();
  const [activeSection, setActiveSection] = useState<any | null>(null);
  const [manualSection, setManualSection] = useState<any | null>(null);
  const [viewingImage, setViewingImage] = useState<string | null>(null);
  
  const [isInitializing, setIsInitializing] = useState(true);

  useEffect(() => {
     if (!globalLoading && curriculum.length > 0) {
         const timer = setTimeout(() => setIsInitializing(false), 500);
         return () => clearTimeout(timer);
     } else if (!globalLoading && curriculum.length === 0) {
         setIsInitializing(false);
     }
  }, [globalLoading, curriculum]);

  const filteredCurriculum = useMemo(() => {
      if (member.dept === "Unassigned") return [];
      const targetDept = member.dept;
      return curriculum.filter(s => s.dept?.toUpperCase() === targetDept?.toUpperCase());
  }, [curriculum, member.dept]);
  
  const globalTotalTasks = useMemo(() => {
      return filteredCurriculum.reduce((acc, curr) => {
          const taskCount = curr.tasks?.filter((t: any) => t.type !== 'subject').length || 0;
          return acc + taskCount;
      }, 0);
  }, [filteredCurriculum]);

  // --- CORE LOGIC: VERIFICATION WITH DYNAMIC LINKING ---
  const handleVerifyTask = async (taskId: string, taskTitle: string) => {
      const currentIds = member.completedTaskIds || [];
      const wasCompleted = currentIds.includes(taskId);
      
      const newCompletedIds = wasCompleted ? currentIds.filter(id => id !== taskId) : [...currentIds, taskId];
      const newProgress = globalTotalTasks > 0 ? Math.round((newCompletedIds.length / globalTotalTasks) * 100) : 0;

      // 1. Optimistic Update
      updateMemberLocal(member.id, { completedTaskIds: newCompletedIds, progress: newProgress });

      try {
          // 2. Update Member Profile
          const memberRef = doc(db, "profileOverrides", member.id);
          await setDoc(memberRef, { 
              completedTaskIds: wasCompleted ? arrayRemove(taskId) : arrayUnion(taskId), 
              progress: newProgress,
              updatedAt: serverTimestamp() 
          }, { merge: true });
          
          // 3. Create Event Log with Metadata for Dynamic Updates
          if (!wasCompleted) {
              await addDoc(collection(db, "events"), {
                  title: `Module Verified: ${taskTitle}`, // Fallback title
                  type: "Training",
                  status: "Done",
                  priority: "Medium", // CHANGED FROM "Normal" to "Medium" TO FIX CALENDAR VISIBILITY
                  assignee: "System",
                  assigneeName: "System",
                  teamMemberId: member.id,
                  teamMemberName: member.name,
                  description: `Completed training module: ${taskTitle}`,
                  createdAt: serverTimestamp(),
                  metadata: {
                      taskId: taskId,
                      originalTitle: taskTitle
                  }
              });
              toast.success("Module Verified");
          }
      } catch (e) {
          toast.error("Sync Failed");
          updateMemberLocal(member.id, { completedTaskIds: currentIds }); // Revert on error
      }
  };

  const getEmbedUrl = () => {
    if (!manualSection) return null;
    const link = CANVA_LINKS[member.dept] || CANVA_LINKS.FOH;
    const base = link.split('?')[0];
    return `${base}?embed#${manualSection.pageStart}`;
  };

  const isFOH = member.dept === "FOH";
  const brandBg = isFOH ? 'bg-[#004F71]' : 'bg-[#E51636]';

  // --- RENDER ---

  if (member.dept === "Unassigned") {
      return (
          <div className="h-full flex flex-col items-center justify-center text-slate-400 gap-4 p-8 text-center animate-fade-in">
              <div className="p-4 bg-amber-50 rounded-full border border-amber-100 animate-pulse"><AlertTriangle className="w-8 h-8 text-amber-500" /></div>
              <div><h3 className="text-sm font-black text-slate-900 uppercase tracking-wide mb-1">Unit Assignment Required</h3><p className="text-xs text-slate-400 font-medium">Please assign this member to FOH or BOH.</p></div>
          </div>
      );
  }

  if (globalLoading || isInitializing) {
     return (
        <div className="p-6 md:p-8">
             <CurriculumSkeleton />
        </div>
     );
  }

  if (filteredCurriculum.length === 0) {
      return (
          <div className="h-full flex flex-col items-center justify-center text-slate-300 gap-4 animate-fade-in">
              <div className="p-4 bg-slate-50 rounded-full border border-slate-100"><BookOpen className="w-10 h-10 opacity-20" /></div>
              <p className="text-xs font-bold uppercase tracking-widest">No Curriculum Found</p>
          </div>
      );
  }

  return (
    <div className="p-6 md:p-8 space-y-6 md:space-y-8 pb-32 h-full overflow-y-auto custom-scrollbar relative bg-[#F8FAFC]">
        
        {/* HEADER AREA */}
        <motion.div 
            initial={{ opacity: 0, y: -10 }} 
            animate={{ opacity: 1, y: 0 }} 
            className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-2"
        >
            <div className="flex items-center gap-3">
                <div className={cn("p-2.5 md:p-3 rounded-2xl text-white shadow-lg transition-colors", brandBg)}>
                    <HardDrive className="w-4 h-4 md:w-5 md:h-5" />
                </div>
                <div>
                    <h3 className="text-lg md:text-2xl font-[900] text-slate-900 tracking-tight leading-none">Active Curriculum</h3>
                    <p className="text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-widest mt-0.5 md:mt-1">{member.dept} Training Path</p>
                </div>
            </div>
            
            {activeSection && (
                <button 
                    onClick={() => setActiveSection(null)}
                    className="self-start md:self-auto flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 hover:bg-slate-50 text-slate-500 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all shadow-sm"
                >
                    <ArrowLeft className="w-3.5 h-3.5" /> Return
                </button>
            )}
        </motion.div>

        <AnimatePresence mode="wait">
            {!activeSection ? (
                /* VIEW 1: PHASE SELECTION GRID */
                <motion.div 
                    key="phase-grid"
                    initial={{ opacity: 0, x: -20 }}
                    animate={{ opacity: 1, x: 0 }}
                    exit={{ opacity: 0, x: -20 }}
                    transition={{ duration: 0.25, ease: "easeOut" }}
                    className="grid grid-cols-1 gap-4"
                >
                    {filteredCurriculum.map((section, i) => {
                        const totalTasks = section.tasks?.filter((t: any) => t.type !== 'subject').length || 0;
                        const completedCount = section.tasks?.filter((t: any) => t.type !== 'subject' && (member.completedTaskIds || []).includes(t.id)).length || 0;
                        const percent = totalTasks > 0 ? Math.round((completedCount / totalTasks) * 100) : 0;
                        const isComplete = percent === 100 && totalTasks > 0;

                        return (
                            <motion.div 
                                key={section.id}
                                initial={{ opacity: 0, y: 10 }}
                                animate={{ opacity: 1, y: 0 }}
                                transition={{ delay: i * 0.05 }}
                                onClick={() => setActiveSection(section)}
                                className={cn(
                                    "group relative bg-white border rounded-[28px] md:rounded-[32px] p-5 md:p-6 cursor-pointer transition-all hover:scale-[1.01] hover:shadow-lg overflow-hidden",
                                    isComplete ? "border-emerald-100" : "border-slate-200 hover:border-[#004F71]/30"
                                )}
                            >
                                <span className="absolute -right-4 -bottom-8 text-[100px] md:text-[120px] font-[1000] text-slate-50 opacity-50 pointer-events-none group-hover:scale-110 transition-transform duration-500">
                                    {i + 1}
                                </span>

                                <div className="relative z-10 flex items-center justify-between">
                                    <div className="flex items-center gap-4 md:gap-5">
                                        <div className={cn(
                                            "w-12 h-12 md:w-14 md:h-14 rounded-2xl flex items-center justify-center font-black text-lg md:text-xl shadow-sm border transition-colors shrink-0",
                                            isComplete ? "bg-emerald-500 text-white border-emerald-400" : "bg-white text-slate-900 border-slate-100 group-hover:border-slate-200"
                                        )}>
                                            {isComplete ? <Check className="w-6 h-6 md:w-7 md:h-7" /> : `0${i + 1}`}
                                        </div>
                                        <div className="min-w-0">
                                            <span className="text-[8px] md:text-[9px] font-black uppercase tracking-[0.25em] text-slate-400 mb-1 block truncate">Phase {i + 1}</span>
                                            <h4 className="text-base md:text-xl font-black text-slate-900 truncate leading-tight">{section.title}</h4>
                                            <div className="flex items-center gap-2 mt-2">
                                                <div className="h-1.5 w-16 md:w-24 bg-slate-100 rounded-full overflow-hidden">
                                                    <div className={cn("h-full rounded-full transition-all duration-700", isComplete ? "bg-emerald-500" : brandBg)} style={{ width: `${percent}%` }} />
                                                </div>
                                                <span className="text-[9px] font-bold text-slate-400">{percent}%</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="h-8 w-8 md:h-10 md:w-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-300 group-hover:bg-[#004F71] group-hover:text-white transition-all shrink-0 ml-2">
                                        <ChevronRight className="w-4 h-4 md:w-5 md:h-5" />
                                    </div>
                                </div>
                            </motion.div>
                        );
                    })}
                </motion.div>
            ) : (
                /* VIEW 2: TASK MODULES (DETAIL) */
                <motion.div 
                    key="phase-detail"
                    initial={{ opacity: 0, x: 20 }}
                    animate={{ opacity: 1, x: 0 }}
                    exit={{ opacity: 0, x: 20 }}
                    transition={{ duration: 0.25, ease: "easeOut" }}
                    className="space-y-4 md:space-y-6"
                >
                    {/* Header Card */}
                    <div className="bg-white border border-slate-200 rounded-[24px] md:rounded-[32px] p-5 md:p-6 shadow-sm flex flex-col gap-4">
                        <div className="flex justify-between items-start">
                            <div>
                                <span className="text-[8px] md:text-[9px] font-black uppercase tracking-[0.25em] text-slate-400 mb-1 block">Phase Overview</span>
                                <h2 className="text-xl md:text-2xl font-[1000] text-slate-900 leading-tight">{activeSection.title}</h2>
                            </div>
                            <button 
                                onClick={() => setManualSection(activeSection)}
                                className="flex items-center gap-2 px-4 py-2 md:px-6 md:py-3 bg-slate-900 text-white rounded-xl md:rounded-2xl text-[9px] md:text-[10px] font-black uppercase tracking-widest hover:scale-105 active:scale-95 transition-all shadow-lg shrink-0"
                            >
                                <BookOpen className="w-3 h-3 md:w-3.5 md:h-3.5" /> <span className="hidden md:inline">Manual</span>
                            </button>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                        {activeSection.tasks?.map((task: any, index: number) => {
                             const isSubject = task.type === 'subject';
                             
                             if (isSubject) {
                                 const colorTheme = SUBJECT_COLORS.find(c => c.id === task.color) || SUBJECT_COLORS[0];
                                 return (
                                     <motion.div 
                                        key={task.id} 
                                        initial={{ opacity: 0, y: 10 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        transition={{ delay: index * 0.05 }}
                                        className={cn("col-span-1 md:col-span-2 mt-4 mb-2 flex items-center gap-3 px-2 py-3 rounded-xl border", colorTheme.bg, colorTheme.border)}
                                     >
                                         <div className={cn("p-1.5 rounded-lg bg-white/50", colorTheme.text)}>
                                             <AlignLeft className="w-4 h-4" />
                                         </div>
                                         <h4 className={cn("text-xs font-[900] uppercase tracking-[0.2em]", colorTheme.text)}>
                                             {task.title}
                                         </h4>
                                     </motion.div>
                                 );
                             }

                             const isCompleted = (member.completedTaskIds || []).includes(task.id);
                             const hasImage = !!task.image;

                             return (
                                 <motion.button 
                                    key={task.id}
                                    layout
                                    initial={{ opacity: 0, y: 10 }}
                                    animate={{ opacity: 1, y: 0 }}
                                    transition={{ delay: index * 0.03 }}
                                    onClick={() => handleVerifyTask(task.id, task.title)}
                                    whileTap={{ scale: 0.98 }}
                                    className={cn(
                                        "relative overflow-hidden flex flex-col gap-3 p-4 md:p-5 rounded-[20px] md:rounded-[24px] border text-left group transition-all duration-300 min-h-[100px]",
                                        // Card Base Styles
                                        isCompleted 
                                            ? "bg-emerald-500 border-emerald-500 shadow-xl shadow-emerald-500/20" 
                                            : "bg-white border-slate-200 hover:border-slate-300 hover:shadow-lg"
                                    )}
                                 >
                                     <div className="flex items-center gap-4 md:gap-5 w-full relative z-10">
                                         <div className={cn(
                                             "w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center border-[3px] shrink-0 transition-all duration-300 backdrop-blur-sm",
                                             isCompleted 
                                                ? "bg-white border-white text-emerald-600 scale-110 shadow-sm" 
                                                : "border-slate-200 text-slate-300 bg-slate-50 group-hover:border-slate-300"
                                         )}>
                                             <Check className="w-5 h-5 md:w-6 md:h-6" strokeWidth={4} />
                                         </div>
                                         <div className="flex-1 min-w-0">
                                             <span className={cn(
                                                 "text-[8px] md:text-[9px] font-black uppercase tracking-[0.2em] block mb-1 transition-colors",
                                                 isCompleted ? "text-emerald-100" : "text-slate-400"
                                             )}>
                                                 Module
                                             </span>
                                             <span className={cn(
                                                 "text-sm md:text-base font-bold block transition-colors leading-tight whitespace-pre-wrap break-words",
                                                 isCompleted ? "text-white" : "text-slate-700"
                                             )}>
                                                 {task.title}
                                             </span>
                                         </div>
                                         {!isCompleted && (
                                            <div className="transition-opacity absolute right-0 text-slate-200 group-hover:text-slate-300">
                                                <Play className="w-12 h-12 -rotate-12 opacity-0 group-hover:opacity-100 transition-all duration-300" fill="currentColor" />
                                            </div>
                                         )}
                                     </div>
                                     {hasImage && !isCompleted && (
                                         <motion.div 
                                            layoutId={`image-${task.id}`}
                                            className={cn(
                                                "relative w-full overflow-hidden rounded-xl border shadow-sm cursor-zoom-in group/img transition-all bg-slate-100 mt-2",
                                                "aspect-[16/9] md:aspect-[21/9]",
                                                isFOH ? "border-[#004F71]/10 hover:border-[#004F71]/40" : "border-[#E51636]/10 hover:border-[#E51636]/40"
                                            )}
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                setViewingImage(task.image);
                                            }}
                                         >
                                             <img src={task.image} alt="" className="absolute inset-0 w-full h-full object-cover blur-2xl scale-125 opacity-40 saturate-200" aria-hidden="true" />
                                             <motion.img src={task.image} className="relative z-10 w-full h-full object-contain transition-transform duration-700 group-hover/img:scale-[1.02]" />
                                             <div className="absolute inset-0 z-20 bg-black/0 group-hover/img:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover/img:opacity-100 pointer-events-none">
                                                 <div className="bg-white/20 backdrop-blur-md p-2 rounded-full text-white border border-white/40 shadow-lg"><Expand className="w-4 h-4" /></div>
                                             </div>
                                         </motion.div>
                                     )}
                                     {isCompleted && (
                                         <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-white/20 to-transparent opacity-50 pointer-events-none" />
                                     )}
                                 </motion.button>
                             )
                        })}
                    </div>
                </motion.div>
            )}
        </AnimatePresence>

        <AnimatePresence>
            {manualSection && (
                <ManualViewerModal 
                    url={getEmbedUrl()!} 
                    title={manualSection.title} 
                    pages={`${manualSection.pageStart}-${manualSection.pageEnd}`} 
                    color={brandBg} 
                    onClose={() => setManualSection(null)} 
                />
            )}
        </AnimatePresence>

        <AnimatePresence>
            {viewingImage && (
                <div className="fixed inset-0 z-[200] flex items-center justify-center p-4 md:p-10 pointer-events-none">
                     <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="absolute inset-0 bg-slate-900/90 backdrop-blur-xl cursor-zoom-out pointer-events-auto" onClick={() => setViewingImage(null)} />
                     <motion.div initial={{ scale: 0.9, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0.9, opacity: 0 }} className="relative w-full max-w-6xl max-h-[85vh] md:max-h-[90vh] pointer-events-auto flex items-center justify-center">
                         <img src={viewingImage} className="w-full h-full object-contain rounded-2xl md:rounded-3xl shadow-2xl bg-black/5" />
                         <button onClick={() => setViewingImage(null)} className="absolute -top-12 md:-top-4 md:-right-12 p-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all backdrop-blur-md border border-white/10"><X className="w-6 h-6" /></button>
                     </motion.div>
                </div>
            )}
        </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/(main)/team/_components/tabs/PerformanceTab.tsx ---
"use client";

import { useMemo, useState } from "react";
import { formatDistanceToNow } from "date-fns";
import { 
  ShieldCheck, MessageSquare, Link2, Medal, Zap, Target, Activity, 
  FileText, CheckCircle2, AlertTriangle, BookOpen, Star, StickyNote, File, Trophy, Vote, Crown, ArrowLeftRight, UserPlus
} from "lucide-react";
import { cn } from "@/lib/utils";
import { TeamMember, CalendarEvent } from "../../../calendar/_components/types";
import OneOnOneSessionModal from "../../../calendar/_components/OneOnOneSessionModal";
import { useAppStore } from "@/lib/store/useStore";
import { AnimatePresence, motion } from "framer-motion";
import { doc, updateDoc, serverTimestamp } from "firebase/firestore";
import { db } from "@/lib/firebase";
import toast from "react-hot-toast";
import { useTaskMap } from "@/lib/hooks/useTaskMap"; // Import Hook

interface Props {
  member: TeamMember;
}

// Visual Configuration
const getActivityConfig = (type: string) => {
    switch (type) {
        // Operational
        case 'GOAL': return { icon: Target, color: 'bg-emerald-500', text: 'text-emerald-700', bg: 'bg-emerald-50', border: 'border-emerald-200', accent: 'border-l-emerald-500' };
        case '1-ON-1': return { icon: MessageSquare, color: 'bg-purple-500', text: 'text-purple-700', bg: 'bg-purple-50', border: 'border-purple-200', accent: 'border-l-purple-500' };
        // New System Types
        case 'AWARD': return { icon: Trophy, color: 'bg-amber-500', text: 'text-amber-700', bg: 'bg-amber-50', border: 'border-amber-200', accent: 'border-l-amber-500' };
        case 'WINNER': return { icon: Crown, color: 'bg-amber-400', text: 'text-amber-800', bg: 'bg-amber-100', border: 'border-amber-300', accent: 'border-l-amber-500' }; 
        case 'VOTE': return { icon: Vote, color: 'bg-slate-400', text: 'text-slate-600', bg: 'bg-slate-100', border: 'border-slate-200', accent: 'border-l-slate-400' };
        
        // System Actions
        case 'PROMOTION': return { icon: Crown, color: 'bg-indigo-500', text: 'text-indigo-700', bg: 'bg-indigo-50', border: 'border-indigo-200', accent: 'border-l-indigo-500' };
        case 'TRANSFER': return { icon: ArrowLeftRight, color: 'bg-cyan-500', text: 'text-cyan-700', bg: 'bg-cyan-50', border: 'border-cyan-200', accent: 'border-l-cyan-500' };
        case 'ASSIGNMENT': return { icon: UserPlus, color: 'bg-sky-500', text: 'text-sky-700', bg: 'bg-sky-50', border: 'border-sky-200', accent: 'border-l-sky-500' };
        case 'SYSTEM': return { icon: Link2, color: 'bg-slate-500', text: 'text-slate-700', bg: 'bg-slate-50', border: 'border-slate-200', accent: 'border-l-slate-500' };

        // Documents
        case 'INCIDENT': return { icon: AlertTriangle, color: 'bg-red-500', text: 'text-red-700', bg: 'bg-red-50', border: 'border-red-200', accent: 'border-l-red-500' };
        case 'COMMENDATION': return { icon: Star, color: 'bg-amber-500', text: 'text-amber-700', bg: 'bg-amber-50', border: 'border-amber-200', accent: 'border-l-amber-500' };
        case 'REVIEW': return { icon: FileText, color: 'bg-blue-500', text: 'text-blue-700', bg: 'bg-blue-50', border: 'border-blue-200', accent: 'border-l-blue-500' };
        case 'NOTE': return { icon: StickyNote, color: 'bg-slate-500', text: 'text-slate-700', bg: 'bg-slate-50', border: 'border-slate-200', accent: 'border-l-slate-400' };
        case 'DOCUMENT': return { icon: File, color: 'bg-slate-400', text: 'text-slate-600', bg: 'bg-slate-50', border: 'border-slate-200', accent: 'border-l-slate-300' };
        
        // System
        case 'MODULE': return { icon: BookOpen, color: 'bg-indigo-500', text: 'text-indigo-700', bg: 'bg-indigo-50', border: 'border-indigo-200', accent: 'border-l-indigo-500' };
        default: return { icon: Activity, color: 'bg-slate-400', text: 'text-slate-600', bg: 'bg-slate-50', border: 'border-slate-200', accent: 'border-l-slate-300' };
    }
};

export function PerformanceTab({ member }: Props) {
  const { events, curriculum } = useAppStore();
  const [selectedSession, setSelectedSession] = useState<CalendarEvent | null>(null);
  
  // LIVE TASK LOOKUP
  const taskMap = useTaskMap();

  // --- AGGREGATE TIMELINE DATA ---
  const timelineData = useMemo(() => {
    const history: any[] = [];
    
    // Filter relevant events
    const relevantEvents = events.filter(e => 
        e.teamMemberId === member.id || (e.assignee === member.id && e.type === 'Goal')
    );
    
    relevantEvents.forEach(e => {
        let category = 'MISSION';
        let title = e.title;
        let desc = e.description || "";

        // DYNAMIC TITLE OVERRIDE (For verified modules)
        if (e.metadata?.taskId && taskMap[e.metadata.taskId]) {
            title = `Module Verified: ${taskMap[e.metadata.taskId]}`;
        }

        // Categorize
        if (desc.startsWith("[DOCUMENT LOG:")) {
             const match = desc.match(/\[DOCUMENT LOG: (.*?)\]/);
             const docType = match ? match[1] : 'Note';
             if (docType.includes("Incident")) category = 'INCIDENT';
             else if (docType.includes("Commendation")) category = 'COMMENDATION';
             else if (docType.includes("Review")) category = 'REVIEW';
             else if (docType.includes("Note")) category = 'NOTE';
             else category = 'DOCUMENT';
             desc = desc.replace(/\[DOCUMENT LOG: .*?\]\n\n/, "");
        }
        else if (e.type === 'Goal') category = 'GOAL';
        else if (e.type === 'OneOnOne') category = '1-ON-1';
        else if (e.type === 'Award') {
             if (title.startsWith("EOTM Winners")) {
                 category = 'WINNER';
                 desc = "Awarded Employee of the Month for outstanding performance.";
             } else {
                 category = 'AWARD';
             }
        }
        else if (e.type === 'Vote') category = 'VOTE';
        else if (e.title === "Mentorship Uplink") category = 'SYSTEM';

        // System Logs
        if (desc.includes("[SYSTEM LOG: PROMOTION]")) category = 'PROMOTION';
        else if (desc.includes("[SYSTEM LOG: TRANSFER]")) category = 'TRANSFER';
        else if (desc.includes("[SYSTEM LOG: ASSIGNMENT]")) category = 'ASSIGNMENT';

        if (desc.startsWith("[SYSTEM LOG:") || desc.startsWith("[OFFICIAL")) {
             desc = desc.replace(/\[.*?\]\n/, "").trim();
        }

        history.push({ 
            id: e.id, 
            date: e.createdAt?.toDate ? e.createdAt.toDate() : e.startDate,
            title, 
            category, 
            rawEvent: e, 
            description: desc 
        });
    });

    // CURRICULUM SUMMARY (If any modules completed this session without an event log yet)
    // Note: Usually events handle this now, but keeping as fallback for legacy data
    if (member.completedTaskIds && member.completedTaskIds.length > 0) {
        let completedNames: string[] = [];
        curriculum.forEach(section => {
             section.tasks?.forEach((t: any) => {
                 if (member.completedTaskIds?.includes(t.id)) completedNames.push(t.title);
             });
        });
        // We don't push a generic summary here anymore to avoid duplicates with the individual event logs
        // unless it's a legacy system migration scenario.
    }

    return history.sort((a, b) => b.date.getTime() - a.date.getTime());
  }, [events, member, curriculum, taskMap]); // Depend on taskMap

  const handleUpdateEvent = async (updatedEvent: CalendarEvent) => { 
      try { 
          await updateDoc(doc(db, "events", updatedEvent.id), { 
              description: updatedEvent.description, 
              subtasks: updatedEvent.subtasks, 
              status: updatedEvent.status, 
              updatedAt: serverTimestamp() 
          }); 
          toast.success("Session Updated"); 
          setSelectedSession(null); 
      } catch (e) { 
          toast.error("Update Failed"); 
      } 
  };

  const handleItemClick = (item: any) => {
      if (item.category === '1-ON-1' && item.rawEvent) {
          setSelectedSession(item.rawEvent);
      }
  };

  return (
    <>
        <div className="p-8 pb-32 h-full overflow-y-auto custom-scrollbar bg-[#F8FAFC]">
            <div className="flex items-center gap-3 mb-8">
                <div className="p-3 bg-slate-900 text-white rounded-2xl shadow-lg">
                    <Activity className="w-5 h-5" />
                </div>
                <div>
                    <h3 className="text-2xl font-[900] text-slate-900 tracking-tight leading-none">Performance Log</h3>
                    <p className="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Holistic Operational Data</p>
                </div>
            </div>

            {timelineData.length === 0 ? (
                 <div className="flex flex-col items-center justify-center h-[400px] text-slate-300 border-2 border-dashed border-slate-200 rounded-[32px]">
                     <Activity className="w-12 h-12 opacity-20 mb-4" />
                     <p className="text-xs font-bold uppercase tracking-widest">No Activity Recorded</p>
                 </div>
            ) : (
                <div className="relative pl-6 lg:pl-10 space-y-8">
                    <div className="absolute left-[23px] lg:left-[39px] top-4 bottom-4 w-0.5 bg-slate-200" />

                    {timelineData.map((item, idx) => {
                        const config = getActivityConfig(item.category);
                        const Icon = config.icon;
                        const isInteractive = !!item.rawEvent && item.category === '1-ON-1';

                        return (
                            <motion.div 
                                key={`${item.id}-${idx}`}
                                initial={{ opacity: 0, x: -20 }}
                                animate={{ opacity: 1, x: 0 }}
                                transition={{ delay: idx * 0.05 }}
                                className={cn("relative group", isInteractive && "cursor-pointer")}
                                onClick={() => handleItemClick(item)}
                            >
                                <div className={cn(
                                    "absolute -left-[34px] lg:-left-[54px] top-0 w-8 h-8 lg:w-10 lg:h-10 rounded-full flex items-center justify-center border-4 border-[#F8FAFC] shadow-sm z-10 text-white", 
                                    config.color
                                )}>
                                    <Icon className="w-3.5 h-3.5 lg:w-4 lg:h-4 fill-current" />
                                </div>

                                <div className={cn(
                                    "p-5 lg:p-6 bg-white border rounded-[24px] shadow-sm transition-all relative overflow-hidden",
                                    "border-l-4", config.accent,
                                    config.border,
                                    isInteractive ? "hover:shadow-md active:scale-[0.99]" : ""
                                )}>
                                    <div className="flex justify-between items-start mb-2">
                                        <span className={cn("px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-wider", config.bg, config.text)}>
                                            {item.category}
                                        </span>
                                        <span className="text-[10px] font-bold text-slate-300 whitespace-nowrap">
                                            {formatDistanceToNow(item.date)} ago
                                        </span>
                                    </div>

                                    <h4 className="text-base lg:text-lg font-black text-slate-900 mb-1.5 leading-tight">{item.title}</h4>
                                    
                                    {item.description && (
                                        <p className="text-xs lg:text-sm text-slate-500 font-medium leading-relaxed line-clamp-3 whitespace-pre-wrap">
                                            {item.description}
                                        </p>
                                    )}

                                    {isInteractive && (
                                        <div className="mt-4 pt-3 border-t border-purple-100 flex items-center gap-2 text-purple-600 text-[10px] font-black uppercase tracking-wider">
                                            <MessageSquare className="w-3 h-3" /> View Session Details
                                        </div>
                                    )}
                                </div>
                            </motion.div>
                        );
                    })}
                </div>
            )}
        </div>

        <AnimatePresence>
            {selectedSession && (
                <OneOnOneSessionModal 
                    event={selectedSession} 
                    onClose={() => setSelectedSession(null)} 
                    onUpdate={handleUpdateEvent} 
                />
            )}
        </AnimatePresence>
    </>
  );
}
--- FILE: ./app/(main)/team/_components/MemberProfileHeader.tsx ---
"use client";

import { useRef, useState, useMemo } from "react";
import { Camera, Loader2, Mail, Calendar, ArrowLeftRight, TrendingUp, AlertCircle, Copy, Check, Link2, User } from "lucide-react";
import { cn } from "@/lib/utils";
import { format } from "date-fns";
import { TeamMember } from "../../calendar/_components/types";
import { ref, uploadBytes, getDownloadURL } from "firebase/storage";
import { doc, serverTimestamp, writeBatch, collection, addDoc } from "firebase/firestore";
import { db, storage } from "@/lib/firebase";
import toast from "react-hot-toast";
import { useAppStore } from "@/lib/store/useStore";

interface Props {
  member: TeamMember;
}

export function MemberProfileHeader({ member }: Props) {
  const { updateMemberLocal, team } = useAppStore(); 
  
  const isFOH = member.dept === "FOH";
  const isBOH = member.dept === "BOH";
  const isUnassigned = !isFOH && !isBOH;

  const brandText = isFOH ? 'text-[#004F71]' : isBOH ? 'text-[#E51636]' : 'text-slate-500';
  const brandBg = isFOH ? 'bg-[#004F71]' : isBOH ? 'bg-[#E51636]' : 'bg-slate-500';
  const initials = member.name.split(' ').map(n => n[0]).join('').toUpperCase();
  
  const hasValidImage = member.image && !member.image.includes('ui-avatars.com');
  
  const fileInputRef = useRef<HTMLInputElement>(null);
  const [isUploading, setIsUploading] = useState(false);
  const [copied, setCopied] = useState(false);

  // --- DYNAMIC MENTOR COLOR LOGIC (ROBUST) ---
  const mentorDeptStyle = useMemo(() => {
    if (!member.pairing?.id) return "bg-slate-400 text-white";
    
    // 1. Try finding by ID
    let mentorObj = team.find(m => m.id === member.pairing?.id);
    
    // 2. Fallback: Try finding by Name if ID lookup fails
    if (!mentorObj && member.pairing.name) {
        mentorObj = team.find(m => m.name === member.pairing?.name);
    }
    
    // Fallback if still not found
    if (!mentorObj) return "bg-slate-400 text-white";

    const dept = mentorObj.dept?.toUpperCase();

    if (dept === "FOH") return "bg-[#004F71] text-white";
    if (dept === "BOH") return "bg-[#E51636] text-white";
    
    return "bg-slate-400 text-white";
  }, [member.pairing, team]);

  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
    if (e.target.files && e.target.files[0]) {
      setIsUploading(true);
      const file = e.target.files[0];
      const storageRef = ref(storage, `team-avatars/${member.id}/${file.name}`);
      try {
        await uploadBytes(storageRef, file);
        const url = await getDownloadURL(storageRef);
        
        const batch = writeBatch(db);
        const overrideRef = doc(db, "profileOverrides", member.id);
        const baseRef = doc(db, "teamMembers", member.id);
        
        batch.set(overrideRef, { image: url, updatedAt: serverTimestamp() }, { merge: true });
        batch.update(baseRef, { image: url });
        
        await batch.commit();

        updateMemberLocal(member.id, { image: url });
        toast.success("Identity Updated");
      } catch (error) {
        toast.error("Upload Failed");
      } finally {
        setIsUploading(false);
      }
    }
  };

  const toggleDepartment = async () => {
      const newDept = member.dept === "FOH" ? "BOH" : "FOH";
      const loadToast = toast.loading(`Transferring to ${newDept}...`);
      
      updateMemberLocal(member.id, { dept: newDept });

      try {
          const batch = writeBatch(db);
          const overrideRef = doc(db, "profileOverrides", member.id);
          batch.set(overrideRef, { dept: newDept, updatedAt: serverTimestamp() }, { merge: true });
          const baseRef = doc(db, "teamMembers", member.id);
          batch.update(baseRef, { dept: newDept });
          
          await batch.commit();
          
          await addDoc(collection(db, "events"), {
                title: `Unit Transfer: ${newDept}`,
                type: "Operation",
                status: "Done",
                priority: "Medium",
                startDate: new Date(),
                endDate: new Date(),
                assignee: "System",
                assigneeName: "Command",
                teamMemberId: member.id,
                teamMemberName: member.name,
                description: `[SYSTEM LOG: TRANSFER]\nOperational unit reassignment to ${newDept}.`,
                createdAt: serverTimestamp()
          });

          toast.success(`Unit Updated: ${newDept}`, { id: loadToast });
      } catch(e) {
          console.error(e);
          toast.error("Transfer Failed", { id: loadToast });
          updateMemberLocal(member.id, { dept: member.dept });
      }
  };

  const copyEmail = () => {
      if (member.email) {
          navigator.clipboard.writeText(member.email);
          setCopied(true);
          toast.success("Email copied");
          setTimeout(() => setCopied(false), 2000);
      }
  };

  return (
    <div className="w-full lg:w-[340px] bg-white lg:bg-slate-50 border-b lg:border-b-0 lg:border-r border-slate-200 flex flex-col shrink-0 overflow-y-auto no-scrollbar relative z-30 transition-all duration-300">
        
        <div className="p-5 lg:p-8 flex flex-col items-center w-full">
            
            {/* TOP ROW: AVATAR + IDENTITY */}
            <div className="flex lg:flex-col items-center gap-5 lg:gap-6 w-full mb-6 lg:mb-0">
                
                {/* 1. AVATAR */}
                <div className="relative group/avatar cursor-pointer shrink-0" onClick={() => fileInputRef.current?.click()}>
                    <input type="file" ref={fileInputRef} onChange={handleImageUpload} className="hidden" accept="image/*" />
                    
                    <div className={cn(
                        "w-16 h-16 lg:w-32 lg:h-32 rounded-[20px] lg:rounded-[32px] p-1 shadow-sm lg:shadow-md border border-slate-100 lg:rotate-[-3deg] transition-transform group-hover/avatar:rotate-0 group-hover/avatar:scale-105 bg-white",
                    )}>
                        <div className="w-full h-full rounded-[16px] lg:rounded-[24px] overflow-hidden flex items-center justify-center bg-slate-50 relative">
                            {hasValidImage ? (
                                <img src={member.image} className="w-full h-full object-cover" alt="" />
                            ) : (
                                <span className={cn("text-xl lg:text-4xl font-black", brandText)}>{initials}</span>
                            )}
                            <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity">
                                {isUploading ? <Loader2 className="w-5 h-5 lg:w-8 lg:h-8 text-white animate-spin" /> : <Camera className="w-5 h-5 lg:w-8 lg:h-8 text-white" />}
                            </div>
                        </div>
                    </div>
                </div>

                {/* 2. IDENTITY */}
                <div className="flex-1 min-w-0 flex flex-col lg:items-center justify-center w-full">
                    <h2 className="text-xl lg:text-3xl font-[900] text-slate-900 tracking-tight lg:text-center leading-none mb-1.5 lg:mb-2 truncate w-full">{member.name}</h2>
                    <span className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] lg:mb-4 truncate">{member.role}</span>
                    
                    {/* MOBILE: Progress Bar */}
                    <div className="lg:hidden mt-2 w-full max-w-[200px]">
                        <div className="flex justify-between items-end mb-1">
                            <span className={cn("text-[8px] font-black uppercase tracking-widest", brandText)}>Growth</span>
                            <span className="text-[9px] font-black text-slate-900">{member.progress}%</span>
                        </div>
                        <div className="h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                            <div 
                                className={cn("h-full rounded-full transition-all duration-1000", brandBg)} 
                                style={{ width: `${member.progress}%` }} 
                            />
                        </div>
                    </div>
                </div>

                {/* 3. PROGRESS RING (Desktop) */}
                <div className="hidden lg:flex flex-col items-center gap-2 mt-4">
                    <div className="relative w-24 h-24 flex items-center justify-center">
                        <svg className="w-full h-full -rotate-90">
                            <circle cx="50%" cy="50%" r="40" className="text-slate-200" strokeWidth="8" stroke="currentColor" fill="transparent" />
                            <circle 
                                cx="50%" cy="50%" r="40" 
                                className={cn("transition-all duration-1000", isFOH ? "text-[#004F71]" : isBOH ? "text-[#E51636]" : "text-slate-400")} 
                                strokeWidth="8" strokeLinecap="round" stroke="currentColor" fill="transparent" 
                                strokeDasharray="251.2" 
                                strokeDashoffset={251.2 - (251.2 * (member.progress || 0) / 100)} 
                            />
                        </svg>
                        <span className={cn("text-2xl font-[900] absolute", brandText)}>{member.progress}%</span>
                    </div>
                    <span className="text-[9px] font-black uppercase tracking-widest text-slate-400 flex items-center gap-2">
                        <TrendingUp className="w-3 h-3" /> Growth Trajectory
                    </span>
                </div>
            </div>

            {/* SECOND ROW */}
            <div className="w-full mt-2 lg:mt-8 grid grid-cols-2 gap-3">
                
                {/* Unit Button */}
                <button 
                    onClick={toggleDepartment}
                    className={cn(
                        "col-span-2 flex items-center justify-between px-4 py-2.5 lg:py-3 rounded-xl lg:rounded-2xl border transition-all shadow-sm active:scale-95 group",
                        isFOH 
                            ? "bg-blue-50/50 border-blue-100 text-[#004F71]" 
                            : isBOH 
                                ? "bg-red-50/50 border-red-100 text-[#E51636]"
                                : "bg-slate-50 border-slate-200 text-slate-500"
                    )}
                >
                    <div className="flex items-center gap-3">
                        <div className={cn("w-2 h-2 rounded-full", isFOH ? "bg-[#004F71]" : isBOH ? "bg-[#E51636]" : "bg-slate-400")} />
                        <span className="text-[10px] font-black uppercase tracking-widest">
                            {isUnassigned ? "Unassigned Unit" : `${member.dept} Unit`}
                        </span>
                    </div>
                    <ArrowLeftRight className="w-3.5 h-3.5 opacity-50 group-hover:opacity-100 transition-opacity" />
                </button>

                {/* EMAIL BLOCK */}
                <button 
                    onClick={copyEmail}
                    className="col-span-1 lg:col-span-2 flex flex-col items-start p-3 bg-slate-50 hover:bg-slate-100 border border-slate-100 rounded-xl lg:rounded-2xl transition-colors group text-left relative overflow-hidden h-full justify-center"
                >
                    <div className="flex items-center justify-between w-full mb-1">
                        <span className="text-[7px] lg:text-[8px] font-black uppercase tracking-widest text-slate-400">EMAIL</span>
                        {copied ? <Check className="w-2.5 h-2.5 text-emerald-500" /> : <Copy className="w-2.5 h-2.5 text-slate-300 group-hover:text-[#004F71] opacity-0 group-hover:opacity-100 transition-opacity" />}
                    </div>
                    <span className="text-[9px] lg:text-[11px] font-bold text-slate-700 truncate w-full block" title={member.email}>
                        {member.email || "No Email"}
                    </span>
                </button>

                {/* JOINED BLOCK */}
                <div className="col-span-1 lg:col-span-2 flex flex-col p-3 bg-slate-50 border border-slate-100 rounded-xl lg:rounded-2xl h-full justify-center">
                    <span className="text-[7px] lg:text-[8px] font-black uppercase tracking-widest text-slate-400 mb-1">JOINED</span>
                    <span className="text-[9px] lg:text-[11px] font-bold text-slate-700 truncate">
                        {member.joined ? format(new Date(member.joined), "MMM d, yyyy") : "N/A"}
                    </span>
                </div>
            </div>

            {/* MENTOR CARD (Fixed Color Logic) */}
            <div className="col-span-2 mt-4 group p-3 bg-white border border-slate-100 rounded-xl lg:rounded-2xl shadow-sm hover:shadow-md transition-all flex items-center gap-3 relative overflow-hidden">
                {member.pairing ? (
                    <>
                        <div className={cn("absolute left-0 top-0 bottom-0 w-1", mentorDeptStyle.includes("bg-[#004F71]") ? "bg-[#004F71]" : mentorDeptStyle.includes("bg-[#E51636]") ? "bg-[#E51636]" : "bg-slate-500")} />
                        <div className="w-12 h-12 rounded-xl bg-slate-100 border border-slate-200 shrink-0 overflow-hidden relative shadow-sm">
                            {member.pairing.image ? (
                                <img src={member.pairing.image} alt={member.pairing.name} className="w-full h-full object-cover" />
                            ) : (
                                // APPLYING THE DYNAMIC COLOR HERE
                                <div className={cn("w-full h-full flex items-center justify-center font-black text-sm", mentorDeptStyle)}>
                                    {member.pairing.name.charAt(0)}
                                </div>
                            )}
                        </div>
                        <div className="min-w-0 flex-1">
                            <p className="text-[8px] font-black text-slate-400 uppercase tracking-widest mb-0.5 flex items-center gap-1.5">
                                <Link2 className="w-3 h-3 text-slate-400" /> Assigned Mentor
                            </p>
                            <p className="text-sm font-black text-slate-900 truncate">
                                {member.pairing.name}
                            </p>
                        </div>
                    </>
                ) : (
                     <>
                        <div className="w-12 h-12 rounded-xl bg-slate-50 flex items-center justify-center text-slate-300 shrink-0 border border-dashed border-slate-200">
                            <User className="w-5 h-5" />
                        </div>
                        <div className="min-w-0 flex-1">
                            <p className="text-[8px] font-black text-slate-400 uppercase tracking-widest mb-0.5">Mentorship</p>
                            <p className="text-xs font-bold text-slate-300 italic">Unassigned</p>
                        </div>
                     </>
                )}
            </div>

            {isUnassigned && (
                <div className="mt-4 flex items-center gap-2 text-red-500 bg-red-50 px-3 py-2 rounded-xl border border-red-100 w-full justify-center">
                    <AlertCircle className="w-3.5 h-3.5" />
                    <span className="text-[9px] font-black uppercase tracking-wide">Action Required</span>
                </div>
            )}
        </div>
    </div>
  );
}
--- FILE: ./app/(main)/team/_components/TeamCard.tsx ---
"use client";

import { useState, useRef, memo, useEffect, useMemo } from "react";
import { motion, useMotionValue, useSpring, useTransform, AnimatePresence, PanInfo } from "framer-motion";
import { Camera, Loader2, Link2, UserPlus, Crown, Sparkles, User, Activity, Clock, CheckCircle2, Award, ShieldAlert } from "lucide-react"; 
import { cn, getProbationStatus } from "@/lib/utils";
import { TeamMember } from "../../calendar/_components/types";
import { storage, db } from "@/lib/firebase"; 
import { ref, uploadBytes, getDownloadURL } from "firebase/storage";
// ADDED: writeBatch to update both collections atomically
import { doc, setDoc, serverTimestamp, updateDoc, writeBatch } from "firebase/firestore";
import toast from "react-hot-toast";
import { TACTICAL_ICONS } from "@/lib/icon-library";
import { useAppStore } from "@/lib/store/useStore"; 
import Image from "next/image"; 

interface Props {
  member: TeamMember;
  onClick: (m: TeamMember) => void;
  onAssignClick: (m: TeamMember) => void;
  onDragStart: () => void;
  onDragEnd: (event: MouseEvent | TouchEvent | PointerEvent, info: PanInfo) => void;
  isDragging: boolean;
  isDropTarget?: boolean;
  isWaitingForMentor?: boolean;
}

// 3D Tilt Logic
const TiltWrapper = ({ children, disabled, className, ...props }: any) => {
  const x = useMotionValue(0);
  const y = useMotionValue(0);
  const mouseXSpring = useSpring(x, { stiffness: 120, damping: 25 });
  const mouseYSpring = useSpring(y, { stiffness: 120, damping: 25 });
  const rotateX = useTransform(mouseYSpring, [-0.5, 0.5], ["5deg", "-5deg"]);
  const rotateY = useTransform(mouseXSpring, [-0.5, 0.5], ["-5deg", "5deg"]);

  const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {
    if (disabled) return;
    const rect = e.currentTarget.getBoundingClientRect();
    x.set((e.clientX - rect.left) / rect.width - 0.5);
    y.set((e.clientY - rect.top) / rect.height - 0.5);
  };

  const handleMouseLeave = () => {
    x.set(0);
    y.set(0);
  };

  if (disabled) {
    return <div className={className} {...props}>{children}</div>;
  }

  return (
    <motion.div
      style={{ rotateX, rotateY, transformStyle: "preserve-3d" }}
      onMouseMove={handleMouseMove}
      onMouseLeave={handleMouseLeave}
      className={className}
      {...props}
    >
      {children}
    </motion.div>
  );
};

const TeamCardComponent = ({ 
    member, 
    onClick, 
    onAssignClick, 
    onDragStart, 
    onDragEnd, 
    isDragging, 
    isDropTarget,
    isWaitingForMentor
}: Props) => {
  const { updateMemberLocal, team } = useAppStore(); 
  
  const isFOH = member.dept === "FOH";
  const isBOH = member.dept === "BOH";
  const isUnassigned = !isFOH && !isBOH;
  
  // FIX: Ensure hasImage is true if image string is present and valid
  const hasImage = !!member.image && !member.image.includes('ui-avatars.com');
  
  const fileInputRef = useRef<HTMLInputElement>(null);
  const [isUploading, setIsUploading] = useState(false);
  const [isMobile, setIsMobile] = useState(true);
  
  const probation = useMemo(() => getProbationStatus(member.joined), [member.joined]);
  const progressTicks = Math.round((member.progress || 0) / 10);
  
  const badgeCount = member.badges?.length || 0;
  const lastBadge = badgeCount > 0 ? member.badges![member.badges!.length - 1] : null;
  const LastBadgeIcon = lastBadge ? (TACTICAL_ICONS.find(i => i.id === lastBadge.iconId)?.icon || Award) : null;

  const mentorDeptColor = useMemo(() => {
      if (!member.pairing?.id) return "bg-slate-800 text-white";
      const mentorObj = team.find(m => m.id === member.pairing?.id);
      if (!mentorObj) return "bg-slate-800 text-white";

      return mentorObj.dept === "FOH" 
        ? "bg-[#004F71] text-white" 
        : mentorObj.dept === "BOH" 
            ? "bg-[#E51636] text-white" 
            : "bg-slate-800 text-white";
  }, [member.pairing, team]);

  useEffect(() => {
    const checkMobile = () => setIsMobile(window.matchMedia("(max-width: 768px)").matches);
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
    if (e.target.files && e.target.files[0]) {
        setIsUploading(true);
        const file = e.target.files[0];
        const toastId = toast.loading("Processing Identity...");
        const storageRef = ref(storage, `team-avatars/${member.id}/${file.name}`);
        
        try {
            // 1. Upload to Storage
            await uploadBytes(storageRef, file);
            const url = await getDownloadURL(storageRef);
            
            // 2. Optimistic Update
            updateMemberLocal(member.id, { image: url });

            // 3. Update BOTH collections to ensure listener triggers
            const batch = writeBatch(db);
            const overrideRef = doc(db, "profileOverrides", member.id);
            const baseRef = doc(db, "teamMembers", member.id);

            batch.set(overrideRef, { 
                image: url, 
                updatedAt: serverTimestamp() 
            }, { merge: true });

            batch.update(baseRef, { image: url });

            await batch.commit();
            
            toast.success("Identity Sync Complete", { id: toastId });
        } catch (error) {
            console.error(error);
            toast.error("Upload Failed", { id: toastId });
        } finally {
            setIsUploading(false);
        }
    }
  };

  return (
    <TiltWrapper 
      disabled={isMobile || isDragging} 
      className={cn(
        "relative group w-full aspect-[3/4] perspective-1000 cursor-pointer select-none",
        isMobile ? "touch-auto" : "touch-none",
        isDropTarget && !isDragging && "z-50 scale-[1.03]",
        isWaitingForMentor && "z-50 scale-[1.02]"
      )}
      onClick={() => !isDragging && onClick(member)}
    >
       <motion.div
         drag={!isMobile} 
         dragSnapToOrigin 
         dragElastic={0.1}
         onDragStart={onDragStart}
         onDragEnd={onDragEnd}
         whileDrag={{ scale: 1.05, zIndex: 100, cursor: "grabbing" }} 
         style={{ filter: isDragging ? 'brightness(1.1)' : 'none', zIndex: isDragging ? 100 : 1 }}
         className="h-full w-full relative"
       >
        {/* --- OVERLAYS --- */}
        <AnimatePresence>
            {isDropTarget && (
                <motion.div 
                    initial={{ opacity: 0 }} 
                    animate={{ opacity: 1 }} 
                    exit={{ opacity: 0 }}
                    className="absolute inset-0 z-50 bg-emerald-900/60 backdrop-blur-[2px] flex flex-col items-center justify-center text-white rounded-[32px] pointer-events-none"
                >
                    <motion.div 
                        initial={{ scale: 0.5, opacity: 0 }} 
                        animate={{ scale: 1, opacity: 1 }}
                        transition={{ type: "spring", stiffness: 300, damping: 20 }}
                        className="bg-emerald-500 p-4 rounded-full shadow-xl mb-3 border-4 border-emerald-400"
                    >
                        <Link2 className="w-8 h-8 text-white" />
                    </motion.div>
                    <span className="text-sm font-black uppercase tracking-[0.2em] drop-shadow-md text-emerald-100">Click to Assign</span>
                </motion.div>
            )}
        </AnimatePresence>
        
        <AnimatePresence>
            {isWaitingForMentor && (
                <motion.div 
                    initial={{ opacity: 0 }} 
                    animate={{ opacity: 1 }} 
                    exit={{ opacity: 0 }}
                    className="absolute -inset-1 z-[-1] rounded-[36px] bg-gradient-to-tr from-amber-400 to-orange-500 blur-lg opacity-60 animate-pulse"
                />
            )}
        </AnimatePresence>

        <div className={cn(
          "absolute -inset-2 rounded-[32px] blur-2xl transition-opacity duration-500 pointer-events-none opacity-0 group-hover:opacity-40",
          isFOH ? "bg-[#004F71]" : isBOH ? "bg-[#E51636]" : "bg-slate-500",
          isDropTarget && "opacity-80 bg-emerald-500 duration-300 animate-pulse"
        )} />

        {/* CARD CHASSIS */}
        <div className={cn(
          "relative h-full w-full rounded-[32px] border overflow-hidden flex flex-col transition-all duration-300 transform-gpu",
          hasImage
            ? "bg-[#0F172A] border-white/10 shadow-2xl" 
            : isFOH 
                ? "bg-[#004F71] border-[#004F71] shadow-xl"
                : isBOH 
                    ? "bg-[#E51636] border-[#E51636] shadow-xl"
                    : "bg-slate-800 border-slate-700 shadow-xl", 
          isDragging && "ring-4 ring-white/50 shadow-[0_30px_60px_-15px_rgba(0,0,0,0.5)] scale-105 rotate-2",
          isDropTarget && "ring-4 ring-emerald-500 border-emerald-500 shadow-[0_0_30px_rgba(16,185,129,0.4)]",
          isWaitingForMentor && "ring-4 ring-amber-400 border-amber-400 shadow-2xl"
        )}>
          
          <input type="file" ref={fileInputRef} onChange={handleImageUpload} className="hidden" accept="image/*" />

          {/* BACKGROUND LAYER - STATIC */}
          <div className="absolute inset-0 z-0 cursor-default">
            {hasImage ? (
              <>
                {/* FIX: Added unoptimized to bypass Vercel 502 errors */}
                <Image 
                    src={member.image} 
                    alt={member.name} 
                    fill
                    className="object-cover"
                    sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
                    unoptimized={true} 
                />
                <div className="absolute inset-0 bg-gradient-to-t from-[#0F172A] via-[#0F172A]/20 to-transparent opacity-90 pointer-events-none" />
              </>
            ) : (
                <>
                    <div className="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]" />
                    <div className="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50" />
                    <div className="absolute -bottom-10 -right-10 text-[12rem] font-[1000] text-white/5 rotate-[-15deg] leading-none pointer-events-none select-none">
                        {member.name.charAt(0)}
                    </div>
                </>
            )}
          </div>

          {/* CONTENT LAYER */}
          <div className="relative z-10 h-full p-5 flex flex-col justify-between pointer-events-none">
            <div className="flex justify-between items-start pointer-events-auto">
              <div className="flex flex-wrap gap-2">
                  <div className={cn(
                      "px-2.5 py-1 rounded-lg backdrop-blur-md border text-[8px] font-black uppercase tracking-[0.2em] shadow-sm",
                      isUnassigned ? "bg-slate-500/20 border-slate-500/30 text-slate-300" : "bg-white/10 border-white/10 text-white/90"
                  )}>
                    {member.dept === "Unassigned" ? "NO UNIT" : member.dept}
                  </div>
                  {probation && probation.isActive && (
                     <div className="px-2.5 py-1 rounded-lg bg-amber-500/10 border border-amber-500/20 backdrop-blur-md flex items-center gap-2 shadow-sm text-amber-200">
                        <span className="text-[8px] font-black uppercase tracking-wider">{probation.daysRemaining} Days Left</span>
                     </div>
                  )}
              </div>

              {/* ACTION AREA */}
              <div className="flex items-center gap-2">
                  {badgeCount > 0 && (
                      <div className="flex items-center gap-1.5 px-2 py-1 rounded-lg bg-white/10 backdrop-blur-md border border-white/10 shadow-sm text-amber-200">
                          {LastBadgeIcon && <LastBadgeIcon className="w-3 h-3 text-amber-400" />}
                          <span className="text-[9px] font-black">{badgeCount}</span>
                      </div>
                  )}
                  
                  {/* UPLOAD BUTTON */}
                  {!isDropTarget && (
                    <button onClick={(e) => { e.stopPropagation(); fileInputRef.current?.click(); }} className="p-2 rounded-full bg-white/10 hover:bg-white/20 text-white/70 hover:text-white transition-all backdrop-blur-md opacity-0 group-hover:opacity-100">
                        {isUploading ? <Loader2 className="w-3.5 h-3.5 animate-spin" /> : <Camera className="w-3.5 h-3.5" />}
                    </button>
                  )}
              </div>
            </div>

            <div className="space-y-4 pointer-events-auto">
               <div>
                  {!hasImage && (
                      <div className="w-16 h-16 rounded-2xl bg-white/10 backdrop-blur-md border border-white/10 flex items-center justify-center text-2xl font-[1000] text-white shadow-lg mb-3">
                          {member.name.charAt(0)}
                      </div>
                  )}
                  <h3 className="text-2xl md:text-3xl font-[900] text-white tracking-tighter leading-[0.9] drop-shadow-md mb-1.5">
                    {member.name}
                  </h3>
                  <div className="flex items-center gap-2 mb-3">
                      <span className="text-[9px] font-bold text-white/60 uppercase tracking-widest">{member.role}</span>
                      <div className="w-1 h-1 rounded-full bg-white/30" />
                      <span className="text-[9px] font-bold text-emerald-400 uppercase tracking-widest">{member.progress}% Complete</span>
                  </div>
                  <div className="flex gap-1 mb-2">
                     {Array.from({ length: 10 }).map((_, i) => (
                         <div key={i} className={cn("h-1 flex-1 rounded-full transition-all duration-500", i < progressTicks ? "bg-white/90 shadow-[0_0_8px_rgba(255,255,255,0.5)]" : "bg-white/10")} />
                     ))}
                  </div>
               </div>

               {/* MENTOR DOCK - UPDATED WITH DEPT COLOR & IMAGE FIX */}
               <div 
                    onClick={(e) => { e.stopPropagation(); onAssignClick(member); }}
                    className={cn(
                        "h-12 w-full rounded-xl border backdrop-blur-xl flex items-center px-3 gap-3 transition-all duration-300 relative overflow-hidden group/dock cursor-pointer",
                        isDropTarget 
                            ? "bg-emerald-500 border-emerald-400 shadow-lg justify-center z-50" 
                            : isWaitingForMentor
                                ? "bg-amber-500/20 border-amber-400/50 shadow-inner"
                                : "bg-white/10 border-white/10 hover:bg-white/15"
                    )}
               >
                   <AnimatePresence mode="wait">
                       {member.pairing ? (
                           <motion.div key="paired" className="flex items-center gap-3 w-full">
                               <div className="relative shrink-0 w-8 h-8">
                                   {member.pairing.image ? (
                                        // FIX: Added unoptimized to mentor avatar too
                                        <Image 
                                            src={member.pairing.image} 
                                            fill 
                                            className="rounded-lg object-cover border border-white/20" 
                                            alt={member.pairing.name}
                                            unoptimized={true}
                                        />
                                   ) : (
                                        <div className={cn("w-full h-full rounded-lg flex items-center justify-center text-[10px] font-black border border-white/20", mentorDeptColor)}>
                                            {member.pairing.name.charAt(0)}
                                        </div>
                                   )}
                                   <div className="absolute -bottom-1 -right-1 bg-amber-400 rounded-full p-0.5 border border-black/10"><Crown className="w-2 h-2 text-black fill-current" /></div>
                               </div>
                               
                               <div className="flex flex-col min-w-0">
                                   <span className="text-[7px] font-bold text-white/40 uppercase tracking-wider">Mentored By</span>
                                   <span className="text-[10px] font-black text-white truncate">{member.pairing.name}</span>
                               </div>
                           </motion.div>
                       ) : (
                           <motion.div key="empty" className={cn(
                               "flex items-center gap-2 transition-colors w-full",
                               isWaitingForMentor ? "text-amber-100" : "text-white/40 group-hover/dock:text-white/70"
                           )}>
                               <div className={cn(
                                   "w-8 h-8 rounded-lg border border-dashed flex items-center justify-center",
                                   isWaitingForMentor ? "border-amber-200 bg-amber-500/20" : "border-white/20"
                               )}>
                                    {isWaitingForMentor ? <Loader2 className="w-4 h-4 animate-spin" /> : <UserPlus className="w-4 h-4" />}
                               </div>
                               <span className="text-[9px] font-bold uppercase tracking-widest">
                                   {isWaitingForMentor ? "Select Leader Below..." : "Assign Mentor"}
                               </span>
                           </motion.div>
                       )}
                   </AnimatePresence>
               </div>
            </div>
          </div>
        </div>
      </motion.div>
    </TiltWrapper>
  );
};

export const TeamCard = memo(TeamCardComponent);
--- FILE: ./app/(main)/team/_components/MemberDetailSheet.tsx ---
"use client";

import { useState, useEffect, useMemo } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { 
  X, Mail, CheckCircle2, Award, 
  Activity, Target, FileText, TrendingUp, Plus,
  Shield, Calendar, ChevronDown, Repeat, ChevronLeft,
  Zap, Sparkles, Crown, ArrowRight, Link2, User
} from "lucide-react";
import { format } from "date-fns";
import { cn } from "@/lib/utils";
import { TeamMember } from "../../calendar/_components/types";
import { useAppStore } from "@/lib/store/useStore";
import { db } from "@/lib/firebase";
import { doc, setDoc } from "firebase/firestore"; 
import { useRouter } from "next/navigation";
import ClientPortal from "@/components/core/ClientPortal";
import AdvancedCreateModal from "@/app/(main)/calendar/_components/AdvancedCreateModal";
import toast from "react-hot-toast";

// NEW IMPORTS FOR TABS
import { OverviewTab } from "./tabs/OverviewTab";
import { CurriculumTab } from "./tabs/CurriculumTab";
import { PerformanceTab } from "./tabs/PerformanceTab";
import OperationalDocumentInterface from "./OperationalDocumentInterface";

// --- CONFIGURATION ---
const COLLECTION_NAME = "profileOverrides"; 

interface Props {
  member: TeamMember;
  onClose: () => void;
  activeTab: "overview" | "curriculum" | "performance" | "documents";
  setActiveTab: (tab: "overview" | "curriculum" | "performance" | "documents") => void;
}

const TRANSITION = { type: "spring" as const, damping: 25, stiffness: 300 };

export function MemberDetailSheet({ member, onClose, activeTab, setActiveTab }: Props) {
  const { events, team, currentUser, curriculum } = useAppStore(); 
  
  const router = useRouter(); 
  const [isAddEventOpen, setIsAddEventOpen] = useState(false);
  const [isProfileExpanded, setIsProfileExpanded] = useState(false);
  
  const [currentDept, setCurrentDept] = useState(member.dept);

  useEffect(() => {
    if (member.dept !== currentDept) {
        setCurrentDept(member.dept);
    }
  }, [member.dept]);

  const isFOH = currentDept === 'FOH';
  const themeColorText = isFOH ? 'text-[#004F71]' : 'text-[#E51636]';
  const themeColorBg = isFOH ? 'bg-[#004F71]' : 'bg-[#E51636]';
  const themeRing = isFOH ? 'ring-blue-50' : 'ring-red-50';
  const themeLightIconBg = isFOH ? 'bg-blue-100/50' : 'bg-red-100/50';

  // --- DYNAMIC MENTOR COLOR LOGIC (FIXED) ---
  const mentorDeptStyle = useMemo(() => {
    if (!member.pairing?.id) return "bg-slate-400 text-white";
    
    // Find the mentor in the full team list to get their department
    let mentorObj = team.find(m => m.id === member.pairing?.id);

    // Fallback: Try finding by Name if ID lookup fails
    if (!mentorObj && member.pairing.name) {
        mentorObj = team.find(m => m.name === member.pairing?.name);
    }
    
    if (!mentorObj) return "bg-slate-400 text-white";

    const dept = mentorObj.dept?.toUpperCase();

    if (dept === "FOH") return "bg-[#004F71] text-white";
    if (dept === "BOH") return "bg-[#E51636] text-white";
    
    return "bg-slate-400 text-white";
  }, [member.pairing, team]);

  const displayMember = useMemo(() => {
      if (!curriculum || curriculum.length === 0) return member;

      const relevantSections = curriculum.filter(section => 
          section.dept?.toUpperCase() === member.dept?.toUpperCase()
      );

      const totalTasks = relevantSections.reduce((acc, section) => 
          acc + (section.tasks?.length || 0), 0);

      const completedCount = relevantSections.reduce((acc, section) => {
          const completedInSection = section.tasks?.filter((t: any) => 
              member.completedTaskIds?.includes(t.id)
          ).length || 0;
          return acc + completedInSection;
      }, 0);

      const calculatedProgress = totalTasks > 0 
          ? Math.round((completedCount / totalTasks) * 100) 
          : 0;

      return {
          ...member,
          progress: calculatedProgress
      };
  }, [member, curriculum]);

  const toggleUnit = async () => {
    const newDept = isFOH ? 'BOH' : 'FOH';
    setCurrentDept(newDept); 

    const toastId = toast.loading(`Transferring to ${newDept}...`);

    try {
        const overrideRef = doc(db, COLLECTION_NAME, member.id); 
        await setDoc(overrideRef, { 
            dept: newDept,
            updatedAt: new Date().toISOString()
        }, { merge: true });

        if (team) {
            const updatedTeam = team.map(t => 
                t.id === member.id ? { ...t, dept: newDept as TeamMember["dept"] } : t
            );
            useAppStore.setState({ team: updatedTeam });
        }

        toast.success(`Unit Reassigned: ${newDept}`, { id: toastId });
        router.refresh();
    } catch (error) {
        console.error("Error updating unit:", error);
        toast.error("Transfer failed", { id: toastId });
        setCurrentDept(member.dept);
    }
  };

  useEffect(() => {
    document.body.style.overflow = "hidden";
    return () => { document.body.style.overflow = "unset"; };
  }, []);

  const joinedDate = member.joined ? format(new Date(member.joined), "MMM d, yyyy") : "N/A";

  return (
    <ClientPortal>
      {/* Backdrop */}
      <motion.div 
        initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} 
        className="fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm"
        onClick={onClose}
      />
      
      {/* Sheet Container */}
      <motion.div 
        initial={{ x: "100%" }} animate={{ x: 0 }} exit={{ x: "100%" }} 
        transition={TRANSITION}
        className={cn(
            "fixed inset-y-0 right-0 z-[110] w-full md:w-[95%] lg:w-[1200px] bg-[#F8FAFC] shadow-2xl flex flex-col md:flex-row overflow-hidden",
            "md:rounded-l-[40px] will-change-transform" 
        )}
      >
        
        {/* =========================================================================
            DESKTOP SIDEBAR 
           ========================================================================= */}
        <div className="hidden md:flex w-[380px] bg-white border-r border-slate-100 flex-col h-full shrink-0 relative z-20 shadow-[4px_0_24px_-12px_rgba(0,0,0,0.1)] md:rounded-l-[40px] overflow-hidden">
            <div className="absolute top-0 left-0 right-0 h-64 bg-slate-50/50 -skew-y-6 transform origin-top-left z-0" />
            <div className="absolute inset-0 opacity-[0.03] bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] pointer-events-none z-0" />
            
            <div className="flex-1 p-8 flex flex-col relative z-10 overflow-y-auto custom-scrollbar">
                
                {/* Profile Header */}
                <div className="flex flex-col items-center text-center mb-8">
                    <motion.div layoutId={`member-avatar-${member.id}`} className="relative w-36 h-36 rounded-[40px] bg-white shadow-2xl shadow-slate-200/60 flex items-center justify-center mb-6 ring-4 ring-white">
                        {member.image ? (
                            <img src={member.image} alt={member.name} className="w-full h-full object-cover rounded-[36px]" />
                        ) : (
                            <span className="text-5xl font-[1000] text-slate-900">{member.name.charAt(0)}</span>
                        )}
                        
                        {/* Unit Badge / Toggle */}
                        <button 
                            onClick={toggleUnit}
                            className={cn("absolute -bottom-3 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest text-white border-4 border-white shadow-lg hover:scale-105 active:scale-95 transition-all flex items-center gap-2", themeColorBg)}
                        >
                            {currentDept} UNIT <Repeat className="w-3 h-3 opacity-50" />
                        </button>
                    </motion.div>

                    <h2 className="text-3xl font-[1000] text-slate-900 tracking-tight leading-tight mb-2">{member.name}</h2>
                    <p className="text-xs font-bold text-slate-400 uppercase tracking-[0.2em]">{member.role}</p>
                </div>

                {/* Growth Ring */}
                <div className="flex flex-col items-center mb-10">
                    <div className="relative w-28 h-28">
                        <svg className="w-full h-full -rotate-90 drop-shadow-lg">
                            <circle cx="56" cy="56" r="46" stroke="currentColor" strokeWidth="8" fill="transparent" className="text-slate-100" />
                            <circle 
                                cx="56" cy="56" r="46" 
                                stroke="currentColor" strokeWidth="8" 
                                fill="transparent" 
                                strokeDasharray={289} 
                                strokeDashoffset={289 - (289 * (displayMember.progress || 0) / 100)} 
                                className={themeColorText} 
                                strokeLinecap="round" 
                            />
                        </svg>
                        <div className="absolute inset-0 flex flex-col items-center justify-center">
                            <span className="text-2xl font-[1000] text-slate-900">{displayMember.progress || 0}%</span>
                        </div>
                    </div>
                    <p className="text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-3 flex items-center gap-1.5">
                        <TrendingUp className="w-3 h-3" /> Growth Trajectory
                    </p>
                </div>

                {/* Detailed Info Cards */}
                <div className="grid grid-cols-2 gap-3 w-full">
                    
                    {/* EMAIL */}
                    <div className="col-span-2 group p-4 bg-slate-50 hover:bg-white border border-slate-100 hover:border-slate-200 rounded-2xl transition-all shadow-sm hover:shadow-md flex items-center gap-4">
                        <div className={cn("w-10 h-10 rounded-xl flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform", themeLightIconBg, themeColorText)}>
                            <Mail className="w-5 h-5" />
                        </div>
                        <div className="min-w-0 flex-1">
                            <p className="text-[8px] font-black text-slate-400 uppercase tracking-widest mb-0.5">Contact Email</p>
                            <p className="text-xs font-bold text-slate-900 truncate" title={member.email}>{member.email}</p>
                        </div>
                    </div>

                    {/* JOINED */}
                    <div className="col-span-2 group p-4 bg-slate-50 hover:bg-white border border-slate-100 hover:border-slate-200 rounded-2xl transition-all shadow-sm hover:shadow-md flex items-center gap-4">
                        <div className="w-10 h-10 rounded-xl bg-purple-100/50 flex items-center justify-center text-purple-600 shrink-0 group-hover:scale-110 transition-transform">
                            <Calendar className="w-5 h-5" />
                        </div>
                        <div className="min-w-0 flex-1">
                            <p className="text-[8px] font-black text-slate-400 uppercase tracking-widest mb-0.5">Date Joined</p>
                            <p className="text-xs font-bold text-slate-900">{joinedDate}</p>
                        </div>
                    </div>

                    {/* MENTOR - FIXED COLOR LOGIC HERE */}
                    <div className="col-span-2 group p-3 bg-white border border-slate-100 rounded-2xl shadow-sm hover:shadow-md transition-all flex items-center gap-3 relative overflow-hidden">
                        {member.pairing ? (
                            <>
                                <div className={cn("absolute left-0 top-0 bottom-0 w-1", mentorDeptStyle.includes("bg-[#004F71]") ? "bg-[#004F71]" : mentorDeptStyle.includes("bg-[#E51636]") ? "bg-[#E51636]" : "bg-slate-500")} />
                                <div className="w-12 h-12 rounded-xl bg-slate-100 border border-slate-200 shrink-0 overflow-hidden relative shadow-sm">
                                    {member.pairing.image ? (
                                        <img src={member.pairing.image} alt={member.pairing.name} className="w-full h-full object-cover" />
                                    ) : (
                                        // UPDATED: Use dynamic style
                                        <div className={cn("w-full h-full flex items-center justify-center font-black text-sm", mentorDeptStyle)}>
                                            {member.pairing.name.charAt(0)}
                                        </div>
                                    )}
                                </div>
                                <div className="min-w-0 flex-1">
                                    <p className="text-[8px] font-black text-slate-400 uppercase tracking-widest mb-0.5 flex items-center gap-1.5">
                                        <Link2 className="w-3 h-3 text-slate-400" /> Assigned Mentor
                                    </p>
                                    <p className="text-sm font-black text-slate-900 truncate">
                                        {member.pairing.name}
                                    </p>
                                </div>
                            </>
                        ) : (
                             <>
                                <div className="w-12 h-12 rounded-xl bg-slate-50 flex items-center justify-center text-slate-300 shrink-0 border border-dashed border-slate-200">
                                    <User className="w-5 h-5" />
                                </div>
                                <div className="min-w-0 flex-1">
                                    <p className="text-[8px] font-black text-slate-400 uppercase tracking-widest mb-0.5">Mentorship</p>
                                    <p className="text-xs font-bold text-slate-300 italic">Unassigned</p>
                                </div>
                             </>
                        )}
                    </div>

                </div>
            </div>
        </div>

        {/* =========================================================================
            RIGHT CONTENT AREA 
           ========================================================================= */}
        <div className="flex-1 flex flex-col h-full overflow-hidden bg-[#F8FAFC]">
            
            {/* --- MOBILE COLLAPSIBLE HEADER --- */}
            <div className="md:hidden bg-white border-b border-slate-100 shrink-0 z-30 shadow-sm transition-all duration-300">
                <div className="flex items-center justify-between p-4">
                    
                    {/* LEFT: Back & Mini Profile */}
                    <div className="flex items-center gap-3">
                         <button 
                            onClick={onClose}
                            className="p-2 -ml-2 rounded-full text-slate-400 hover:bg-slate-50 active:scale-90 transition-all"
                         >
                            <ChevronLeft className="w-6 h-6" />
                         </button>

                         <div 
                            className="flex items-center gap-3 cursor-pointer select-none"
                            onClick={() => setIsProfileExpanded(!isProfileExpanded)}
                         >
                             <div className="w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center text-lg font-[1000] text-slate-900 shrink-0 border border-slate-200 overflow-hidden">
                                 {member.image ? (
                                    <img src={member.image} className="w-full h-full object-cover" />
                                 ) : member.name.charAt(0)}
                             </div>
                             <div>
                                 <h2 className="text-base font-[1000] text-slate-900 tracking-tight leading-none mb-1">{member.name}</h2>
                                 <div className="flex items-center gap-2">
                                    <span className={cn("px-1.5 py-0.5 rounded text-[7px] font-black uppercase tracking-widest text-white", themeColorBg)}>
                                        {currentDept}
                                    </span>
                                    <span className="text-[8px] font-bold text-slate-400 uppercase">{member.role}</span>
                                 </div>
                             </div>
                         </div>
                    </div>

                    {/* RIGHT: Progress & Expand */}
                    <div 
                        className="flex items-center gap-3 cursor-pointer"
                        onClick={() => setIsProfileExpanded(!isProfileExpanded)}
                    >
                        {/* Mini Progress Ring */}
                        <div className="relative w-10 h-10">
                            <svg className="w-full h-full -rotate-90">
                                <circle cx="20" cy="20" r="16" stroke="currentColor" strokeWidth="3" fill="transparent" className="text-slate-100" />
                                <circle 
                                    cx="20" cy="20" r="16" 
                                    stroke="currentColor" strokeWidth="3" 
                                    fill="transparent" 
                                    strokeDasharray={100} 
                                    strokeDashoffset={100 - (displayMember.progress || 0)} 
                                    className={themeColorText} 
                                    strokeLinecap="round" 
                                />
                            </svg>
                            <div className="absolute inset-0 flex items-center justify-center">
                                <span className="text-[9px] font-black text-slate-900">{displayMember.progress || 0}%</span>
                            </div>
                        </div>

                        {/* Chevron */}
                        <div className={cn("p-1.5 rounded-full bg-slate-50 text-slate-400 transition-transform duration-300", isProfileExpanded && "rotate-180")}>
                            <ChevronDown className="w-4 h-4" />
                        </div>
                    </div>

                </div>

                {/* Expanded Details Area */}
                <AnimatePresence>
                    {isProfileExpanded && (
                        <motion.div
                            initial={{ height: 0, opacity: 0 }}
                            animate={{ height: "auto", opacity: 1 }}
                            exit={{ height: 0, opacity: 0 }}
                            className="overflow-hidden border-t border-slate-50 bg-slate-50/50"
                        >
                            <div className="p-4 space-y-3">
                                {/* Unit Switcher */}
                                <div className="flex items-center justify-between p-3 bg-white border border-slate-100 rounded-xl shadow-sm">
                                    <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest">Unit Assignment</span>
                                    <button 
                                        onClick={(e) => { e.stopPropagation(); toggleUnit(); }}
                                        className={cn("px-3 py-1.5 rounded-lg text-[9px] font-black uppercase tracking-widest text-white shadow-sm flex items-center gap-2 active:scale-95 transition-all", themeColorBg)}
                                    >
                                        <Repeat className="w-3 h-3" />
                                        Switch to {isFOH ? 'BOH' : 'FOH'}
                                    </button>
                                </div>

                                {/* Info Grid */}
                                <div className="grid grid-cols-1 gap-2">
                                    <div className="flex items-center gap-3 p-3 bg-white rounded-xl border border-slate-100">
                                        <Mail className="w-3.5 h-3.5 text-slate-400" />
                                        <span className="text-[10px] font-bold text-slate-900 break-all">{member.email}</span>
                                    </div>
                                    <div className="flex items-center gap-3 p-3 bg-white rounded-xl border border-slate-100">
                                        <Calendar className="w-3.5 h-3.5 text-slate-400" />
                                        <span className="text-[10px] font-bold text-slate-900">{joinedDate}</span>
                                    </div>
                                    <div className="flex items-center gap-3 p-3 bg-white rounded-xl border border-slate-100">
                                        <Shield className="w-3.5 h-3.5 text-slate-400" />
                                        <span className="text-[10px] font-bold text-slate-400 italic">
                                            {member.pairing ? member.pairing.name : "No Mentor Assigned"}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </motion.div>
                    )}
                </AnimatePresence>
            </div>

            {/* --- SHARED TABS HEADER --- */}
            <div className="px-6 md:px-10 pt-4 md:pt-10 pb-0 bg-white border-b border-slate-100 flex flex-col md:flex-row md:items-end justify-between gap-4 shrink-0 z-10">
                 <button onClick={onClose} className="hidden md:block absolute top-6 right-6 p-2 bg-slate-50 hover:bg-slate-100 rounded-full text-slate-400 transition-colors z-20">
                    <X className="w-5 h-5" />
                 </button>

                <div className="flex items-center gap-6 md:gap-8 overflow-x-auto no-scrollbar w-full md:w-auto pb-0">
                    {(['overview', 'documents', 'curriculum', 'performance'] as const).map((tab) => (
                        <button
                            key={tab}
                            onClick={() => setActiveTab(tab)}
                            className={cn(
                                "pb-4 text-[10px] font-black uppercase tracking-[0.15em] transition-colors relative whitespace-nowrap",
                                activeTab === tab ? "text-slate-900" : "text-slate-300 hover:text-slate-500"
                            )}
                        >
                            {tab}
                            {activeTab === tab && (
                                <motion.div layoutId="activeTabIndicator" className="absolute bottom-0 left-0 right-0 h-0.5 bg-[#E51636]" />
                            )}
                        </button>
                    ))}
                </div>

                <div className="hidden md:block mb-3 mr-12">
                     <button 
                        onClick={() => setIsAddEventOpen(true)}
                        className="flex items-center gap-2 px-5 py-2.5 bg-[#E51636] hover:bg-[#c9122f] text-white rounded-xl text-[9px] font-black uppercase tracking-widest transition-all shadow-lg hover:shadow-xl active:scale-95 shadow-red-500/20"
                    >
                        <Plus className="w-3.5 h-3.5" />
                        <span>New Mission</span>
                    </button>
                 </div>
            </div>

            {/* --- SCROLLABLE CONTENT --- */}
            <div className="flex-1 overflow-y-auto p-0 md:p-0 bg-[#F8FAFC]"> 
                 {/* Mobile "New Mission" Button */}
                 <div className="md:hidden p-5 pb-0">
                    <button 
                        onClick={() => setIsAddEventOpen(true)}
                        className="w-full flex items-center justify-center gap-2 px-4 py-3 bg-[#E51636] text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-red-500/20 active:scale-95 transition-all"
                    >
                        <Plus className="w-4 h-4" />
                        <span>Deploy New Mission</span>
                    </button>
                 </div>

                {/* --- TAB ROUTER --- */}
                <div className="h-full">
                    {activeTab === 'overview' && (
                        <OverviewTab member={displayMember} />
                    )}

                    {activeTab === 'curriculum' && (
                        <CurriculumTab member={displayMember} />
                    )}

                    {activeTab === 'performance' && (
                        <PerformanceTab member={displayMember} />
                    )}

                    {activeTab === 'documents' && (
                        <OperationalDocumentInterface member={displayMember} currentUser={currentUser?.name || "Admin"} />
                    )}
                </div>
            </div>
        </div>

        {isAddEventOpen && (
            <AdvancedCreateModal 
                isOpen={isAddEventOpen} 
                onClose={() => setIsAddEventOpen(false)}
                preselectedMemberId={member.id}
            />
        )}
      </motion.div>
    </ClientPortal>
  );
}
--- FILE: ./app/(main)/team/_components/TrainerRecruitmentModal.tsx ---
"use client";

import { useMemo, useState, useRef, useEffect } from "react";
import { 
  AnimatePresence, 
  motion, 
  useMotionValue, 
  useSpring, 
  useTransform, 
  MotionValue,
  Variants
} from "framer-motion";
import { X, Crown, Search, ArrowRight } from "lucide-react";
import { useAppStore } from "@/lib/store/useStore";
import { cn } from "@/lib/utils";
import { TeamMember } from "../../calendar/_components/types";

// --- DOCK ICON COMPONENT ---
function DockIcon({ 
    trainer, 
    onSelect, 
    mouseX,
    onHoverStart,
    onHoverEnd,
    isSelected,
    isMobile // New Prop
}: { 
    trainer: TeamMember; 
    onSelect: (trainer: TeamMember) => void;
    mouseX: MotionValue;
    onHoverStart: () => void;
    onHoverEnd: () => void;
    isSelected: boolean;
    isMobile: boolean;
}) {
    const ref = useRef<HTMLButtonElement>(null);

    // --- PHYSICS ENGINE (Desktop Only) ---
    const distance = useTransform(mouseX, (val) => {
        const bounds = ref.current?.getBoundingClientRect() ?? { x: 0, width: 0 };
        return val - bounds.x - bounds.width / 2;
    });

    const widthSync = useTransform(distance, [-150, 0, 150], [64, 110, 64]);
    const width = useSpring(widthSync, { mass: 0.1, stiffness: 150, damping: 12 });

    // Visual Identity
    const isFOH = trainer.dept === "FOH";
    const isBOH = trainer.dept === "BOH";

    const brandColor = isFOH 
        ? "bg-[#004F71]" 
        : isBOH 
            ? "bg-[#E51636]" 
            : "bg-slate-500";

    const ringColor = isFOH 
        ? "group-hover:ring-[#004F71]/30" 
        : isBOH 
            ? "group-hover:ring-[#E51636]/30" 
            : "group-hover:ring-slate-500/30";
    
    // Initials Logic (First + Last)
    const initials = trainer.name
        .split(" ")
        .slice(0, 2)
        .map(n => n[0])
        .join("")
        .toUpperCase();

    return (
        <motion.button
            ref={ref}
            // On mobile, use static width (56px) instead of dynamic physics
            style={{ width: isMobile ? 56 : width }}
            onClick={() => onSelect(trainer)}
            className={cn(
                "relative flex flex-col items-center justify-end aspect-square shrink-0 mb-4 focus:outline-none group",
                isMobile ? "mx-1" : "" // Add spacing on mobile since physics gap is gone
            )}
            onMouseEnter={onHoverStart}
            onMouseLeave={onHoverEnd}
            whileTap={{ scale: 0.9 }}
        >
            <div className={cn(
                "w-full h-full rounded-[22px] overflow-hidden shadow-lg transition-all duration-300 cursor-pointer border-[3px] relative bg-white ring-1 ring-black/5",
                isSelected 
                    ? "border-emerald-500 ring-4 ring-emerald-500/20 scale-105" 
                    : `border-white hover:shadow-2xl hover:border-white hover:ring-4 ${ringColor}`
            )}>
                {trainer.image && !trainer.image.includes("ui-avatars.com") ? (
                    <img 
                        src={trainer.image} 
                        className="w-full h-full object-cover pointer-events-none" 
                        alt={trainer.name} 
                    />
                ) : (
                    <div className={cn("w-full h-full flex items-center justify-center text-white font-[1000] text-lg md:text-xl tracking-tight", brandColor)}>
                        {initials}
                    </div>
                )}
                
                {/* Premium Gloss Overlay */}
                <div className="absolute inset-0 bg-gradient-to-tr from-black/10 via-transparent to-white/30 pointer-events-none mix-blend-overlay" />
            </div>
            
            {/* Reflection Effect */}
            <div className="absolute -bottom-2 left-2 right-2 h-1 bg-black/20 blur-md rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
        </motion.button>
    );
}

interface Props {
    isOpen: boolean;
    onClose: () => void;
    onSelectLeader: (leader: TeamMember | null) => void;
    selectedLeaderId: string | null;
}

export default function TrainerRecruitmentModal({ isOpen, onClose, onSelectLeader, selectedLeaderId }: Props) {
    const { team } = useAppStore();
    const [filterQuery, setFilterQuery] = useState("");
    const mouseX = useMotionValue(Infinity);
    const [hoveredTrainer, setHoveredTrainer] = useState<TeamMember | null>(null);
    const [isMobile, setIsMobile] = useState(false);

    useEffect(() => {
        const checkMobile = () => setIsMobile(window.matchMedia("(max-width: 768px)").matches);
        checkMobile();
        window.addEventListener('resize', checkMobile);
        return () => window.removeEventListener('resize', checkMobile);
    }, []);

    const availableMentors = useMemo(() => {
        return team.filter(member => 
            ["Team Leader", "Assistant Director", "Director"].includes(member.status) &&
            member.name.toLowerCase().includes(filterQuery.toLowerCase())
        );
    }, [team, filterQuery]);

    const activeLeader = useMemo(() => 
        team.find(m => m.id === selectedLeaderId), 
    [team, selectedLeaderId]);

    const dockVariants: Variants = {
        hidden: { y: 200, opacity: 0, scale: 0.9 },
        visible: { 
            y: 0, opacity: 1, scale: 1,
            transition: { type: "spring", damping: 20, stiffness: 300, mass: 0.8 } 
        },
        exit: { y: 200, opacity: 0, transition: { duration: 0.2 } }
    };

    return (
        <AnimatePresence>
            {isOpen && (
                <>
                    {/* CLICK-AWAY LAYER */}
                    {!selectedLeaderId && (
                        <div className="fixed inset-0 z-[120]" onClick={onClose} />
                    )}

                    {/* --- THE DOCK CONTAINER --- */}
                    <motion.div
                        variants={dockVariants}
                        initial="hidden"
                        animate="visible"
                        exit="exit"
                        className="fixed bottom-6 md:bottom-10 inset-x-0 mx-auto w-full md:w-fit z-[130] flex flex-col items-center pointer-events-auto px-4 md:px-0"
                        onMouseMove={(e) => mouseX.set(e.pageX)}
                        onMouseLeave={() => { mouseX.set(Infinity); setHoveredTrainer(null); }}
                    >
                        {/* --- FLOATING HEADER (Label / Search / Active Banner) --- */}
                        <div className="h-14 md:h-16 mb-2 flex items-center justify-center pointer-events-none relative min-w-[280px] md:min-w-[320px] w-full">
                            <AnimatePresence mode="wait">
                                {selectedLeaderId && activeLeader ? (
                                    /* STATE 3: "CONNECTING WITH WHO?" (Assignment Mode) */
                                    <motion.div
                                        key="connecting"
                                        initial={{ opacity: 0, y: 10, scale: 0.9 }}
                                        animate={{ opacity: 1, y: 0, scale: 1 }}
                                        exit={{ opacity: 0, y: -10, scale: 0.9 }}
                                        className="bg-slate-900/90 backdrop-blur-3xl text-white pl-2 pr-4 py-2 rounded-full shadow-2xl border border-white/20 flex items-center gap-3 pointer-events-auto cursor-pointer group hover:bg-slate-900 transition-colors"
                                        onClick={() => onSelectLeader(null)} // Click to Cancel
                                    >
                                        {/* LEADER CHIP */}
                                        <div className="flex items-center gap-2 bg-white/10 pr-3 py-1 rounded-full pl-1">
                                            <div className="relative w-6 h-6 rounded-full overflow-hidden border border-white/30">
                                                {activeLeader.image ? (
                                                    <img src={activeLeader.image} className="w-full h-full object-cover" />
                                                ) : (
                                                    <div className="w-full h-full bg-white text-slate-900 flex items-center justify-center font-black text-[9px]">
                                                        {activeLeader.name.charAt(0)}
                                                    </div>
                                                )}
                                            </div>
                                            <span className="text-[10px] font-bold uppercase tracking-wide leading-none max-w-[80px] truncate">
                                                {activeLeader.name}
                                            </span>
                                        </div>

                                        {/* INSTRUCTION */}
                                        <div className="flex items-center gap-1.5 animate-pulse">
                                            <ArrowRight className="w-3 h-3 text-emerald-400" />
                                            <span className="text-[9px] font-black uppercase tracking-widest text-emerald-400">
                                                Select
                                            </span>
                                        </div>

                                        <div className="w-px h-3 bg-white/20" />
                                        
                                        <X className="w-3.5 h-3.5 text-slate-500 group-hover:text-white transition-colors" />
                                    </motion.div>
                                ) : hoveredTrainer ? (
                                    /* STATE 2: HOVER PREVIEW */
                                    <motion.div 
                                        key="hover"
                                        initial={{ opacity: 0, y: 10, scale: 0.9 }}
                                        animate={{ opacity: 1, y: 0, scale: 1 }}
                                        exit={{ opacity: 0, y: 10, scale: 0.9 }}
                                        transition={{ type: "spring", stiffness: 500, damping: 30 }}
                                        className="bg-white/90 backdrop-blur-md text-slate-900 px-4 py-2 rounded-full shadow-xl border border-white/60 flex items-center gap-2 max-w-[90vw]"
                                    >
                                        <span className="text-xs font-[900] uppercase tracking-widest truncate">{hoveredTrainer.name}</span>
                                        <span className={cn(
                                            "text-[8px] font-bold px-2 py-0.5 rounded-md uppercase tracking-wider whitespace-nowrap",
                                            hoveredTrainer.dept === "FOH" 
                                                ? "bg-blue-50 text-[#004F71]" 
                                                : hoveredTrainer.dept === "BOH"
                                                    ? "bg-red-50 text-[#E51636]"
                                                    : "bg-slate-100 text-slate-600"
                                        )}>
                                            {hoveredTrainer.role.replace("Assistant", "Asst.")}
                                        </span>
                                    </motion.div>
                                ) : (
                                    /* STATE 1: SEARCH DEFAULT */
                                    <motion.div 
                                        key="search"
                                        initial={{ opacity: 0, scale: 0.9 }}
                                        animate={{ opacity: 1, scale: 1 }}
                                        exit={{ opacity: 0, scale: 0.9 }}
                                        className="bg-white/80 backdrop-blur-3xl border border-white/60 shadow-xl rounded-full px-1.5 py-1.5 flex items-center gap-2 ring-1 ring-black/5 pointer-events-auto"
                                    >
                                        <div className="w-9 h-9 rounded-full bg-slate-100 flex items-center justify-center text-slate-400">
                                            <Search className="w-4 h-4" />
                                        </div>
                                        <input 
                                            value={filterQuery}
                                            onChange={(e) => setFilterQuery(e.target.value)}
                                            placeholder="Find a Leader..."
                                            className="bg-transparent outline-none text-xs font-black uppercase tracking-widest text-slate-700 placeholder:text-slate-400 w-32 md:w-56 px-2"
                                            autoFocus
                                        />
                                        <button onClick={onClose} className="w-9 h-9 rounded-full bg-slate-100 hover:bg-[#E51636] hover:text-white transition-colors flex items-center justify-center text-slate-400">
                                            <X className="w-4 h-4" />
                                        </button>
                                    </motion.div>
                                )}
                            </AnimatePresence>
                        </div>

                        {/* --- THE GLASS DOCK --- */}
                        <div className={cn(
                            "flex items-end gap-1 px-4 pb-2 pt-4 rounded-[32px] transition-all duration-300 mx-auto ring-1 ring-white/80 max-w-full",
                            // On mobile: Enable horizontal scroll, hide scrollbar
                            "overflow-x-auto overflow-y-hidden no-scrollbar w-full md:w-auto",
                            selectedLeaderId 
                                ? "bg-slate-900/10 backdrop-blur-[10px] border-white/10 opacity-60 grayscale hover:opacity-100 hover:grayscale-0"
                                : "bg-white/60 backdrop-blur-[40px] border border-white/50 shadow-[0_30px_80px_-20px_rgba(0,0,0,0.2)]"
                        )}>
                            
                            {/* STATIC BADGE (Pool Indicator) - Hide on very small screens if needed */}
                            {!selectedLeaderId && (
                                <div className="hidden md:flex flex-col items-center justify-center gap-2 mr-4 opacity-100 mb-5 ml-2 shrink-0">
                                    <div className="w-12 h-12 bg-[#E51636] rounded-[18px] flex items-center justify-center shadow-lg border-2 border-white relative group cursor-default">
                                        <div className="absolute inset-0 bg-white/20 rounded-[18px] opacity-0 group-hover:opacity-100 transition-opacity" />
                                        <Crown className="w-6 h-6 text-white fill-white drop-shadow-md" />
                                    </div>
                                    <span className="text-[9px] font-[900] text-slate-800 uppercase tracking-widest bg-white/80 px-2 py-0.5 rounded-full shadow-sm backdrop-blur-sm border border-white/40">
                                        Pool
                                    </span>
                                </div>
                            )}

                            {/* SEPARATOR */}
                            {!selectedLeaderId && <div className="hidden md:block w-px h-16 bg-slate-900/10 mx-2 mb-4 shrink-0" />}

                            {/* ICONS ROW - SCROLLABLE ON MOBILE */}
                            <div className="flex items-end gap-2 px-1 pb-1">
                                {availableMentors.length > 0 ? (
                                    availableMentors.map((trainer) => (
                                        <DockIcon 
                                            key={trainer.id}
                                            trainer={trainer}
                                            onSelect={() => onSelectLeader(selectedLeaderId === trainer.id ? null : trainer)}
                                            mouseX={mouseX}
                                            onHoverStart={() => setHoveredTrainer(trainer)}
                                            onHoverEnd={() => setHoveredTrainer(null)}
                                            isSelected={selectedLeaderId === trainer.id}
                                            isMobile={isMobile}
                                        />
                                    ))
                                ) : (
                                    <div className="px-8 py-6 text-[10px] font-black text-slate-400 uppercase tracking-widest italic opacity-60 whitespace-nowrap">
                                        No leaders found
                                    </div>
                                )}
                                {/* Spacer for scroll padding */}
                                <div className="w-4 shrink-0 md:hidden" />
                            </div>
                        </div>

                    </motion.div>
                </>
            )}
        </AnimatePresence>
    );
}
--- FILE: ./app/(main)/team/_components/TeamDynamicIsland.tsx ---
"use client";

import { useState, useRef, useEffect } from "react";
import { AnimatePresence, motion, LayoutGroup, Transition } from "framer-motion";
import { Layers, X, ChevronDown, Filter, Check, AlertCircle, UserCheck } from "lucide-react";
import { cn } from "@/lib/utils";
import { STAGES, Status } from "../../calendar/_components/types";
import { useAppStore } from "@/lib/store/useStore"; 

// --- ANIMATION PHYSICS ---
const transition: Transition = {
  type: "spring",
  stiffness: 350,
  damping: 30,
  mass: 0.8
};

interface Props {
  activeStage: Status;
  setActiveStage: (s: Status) => void;
  activeFilter: "ALL" | "FOH" | "BOH";
  setActiveFilter: (f: "ALL" | "FOH" | "BOH") => void;
  // NEW PROPS
  showMyPairings: boolean;
  setShowMyPairings: (show: boolean) => void;
}

export default function TeamDynamicIsland({
  activeStage,
  setActiveStage,
  activeFilter,
  setActiveFilter,
  showMyPairings,
  setShowMyPairings
}: Props) {
  const { team } = useAppStore();
  const [isOpen, setIsOpen] = useState(false);
  const containerRef = useRef<HTMLDivElement>(null);

  const unassignedCount = team.filter(m => m.dept === "Unassigned").length;

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {
        setIsOpen(false);
      }
    };
    document.addEventListener("mousedown", handleClickOutside);
    return () => document.removeEventListener("mousedown", handleClickOutside);
  }, []);

  const visibleStages = STAGES; 
  const activeStageData = STAGES.find((s) => s.id === activeStage);

  return (
    <div className="fixed top-24 left-0 right-0 z-50 flex justify-center pointer-events-none px-4">
      <LayoutGroup>
        <motion.div
          ref={containerRef}
          layout
          initial={false}
          transition={transition}
          onClick={() => !isOpen && setIsOpen(true)}
          className={cn(
            "pointer-events-auto bg-white/95 backdrop-blur-2xl border shadow-[0_20px_50px_-12px_rgba(0,0,0,0.15)] flex flex-col ring-1 ring-black/5 transform-gpu origin-top relative z-50 overflow-hidden",
            isOpen
              ? "rounded-[32px] w-full max-w-[420px] border-white/60" 
              : "rounded-full w-auto border-slate-200/60 cursor-pointer hover:scale-[1.02] hover:bg-white"
          )}
        >
            <AnimatePresence mode="popLayout" initial={false}>
                {!isOpen ? (
                    // --- 1. COLLAPSED VIEW ---
                    <motion.div 
                        key="collapsed"
                        layout="position"
                        initial={{ opacity: 0, filter: "blur(4px)" }}
                        animate={{ opacity: 1, filter: "blur(0px)" }}
                        exit={{ opacity: 0, filter: "blur(4px)", transition: { duration: 0.15 } }}
                        className="flex items-center gap-3 px-1.5 py-1.5 pr-3 h-14 relative w-full"
                    >
                         <motion.div layoutId="icon-container" className="w-10 h-10 bg-[#E51636] rounded-full flex items-center justify-center text-white shadow-md shadow-red-500/20 shrink-0">
                             <Layers className="w-5 h-5" />
                         </motion.div>
                         
                         <motion.div layout="position" className="flex flex-col justify-center pr-2 min-w-[120px]">
                             <motion.span layoutId="title-text" className="text-[11px] font-black uppercase tracking-widest text-slate-800 leading-tight whitespace-nowrap">
                                 {activeStageData?.title || "Roster"}
                             </motion.span>
                             <motion.span layoutId="subtitle-text" className="text-[9px] font-bold text-slate-400 whitespace-nowrap flex items-center gap-1.5">
                                 {showMyPairings && <UserCheck className="w-3 h-3 text-[#004F71]" />}
                                 {showMyPairings ? "My Pairings Only" : activeFilter === "ALL" ? "All Units" : `${activeFilter} Unit`}
                             </motion.span>
                         </motion.div>
                         
                         {unassignedCount > 0 && (
                             <motion.div 
                                layoutId="notification-badge"
                                initial={{ scale: 0 }}
                                animate={{ scale: 1 }}
                                className="absolute top-1.5 right-1.5 min-w-[18px] h-[18px] px-1 bg-[#E51636] rounded-full flex items-center justify-center border border-white text-[9px] font-black text-white shadow-sm z-50 pointer-events-none"
                             >
                                 {unassignedCount}
                             </motion.div>
                         )}

                         <motion.div layoutId="chevron" className="opacity-40 pl-1">
                             <ChevronDown className="w-4 h-4" />
                         </motion.div>
                    </motion.div>
                ) : (
                    // --- 2. EXPANDED VIEW ---
                    <motion.div 
                        key="expanded"
                        layout="position"
                        initial={{ opacity: 0, filter: "blur(4px)" }}
                        animate={{ opacity: 1, filter: "blur(0px)" }}
                        exit={{ opacity: 0, filter: "blur(4px)", transition: { duration: 0.15 } }}
                        className="flex flex-col p-3 gap-4 min-w-[320px] w-full"
                    >
                        {/* Header Row */}
                        <div className="flex items-center justify-between px-2">
                             <div className="flex items-center gap-3">
                                 <motion.div layoutId="icon-container" className="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center text-slate-500">
                                     <Filter className="w-4 h-4" />
                                 </motion.div>
                                 <motion.span layoutId="title-text" className="text-[10px] font-black uppercase tracking-widest text-slate-400">Filtering Roster</motion.span>
                             </div>
                             <motion.button 
                                layoutId="chevron"
                                onClick={(e) => { e.stopPropagation(); setIsOpen(false); }}
                                className="w-8 h-8 flex items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200 transition-colors"
                             >
                                 <X className="w-4 h-4" />
                             </motion.button>
                        </div>

                        {/* --- NEW: PERSONAL FILTER TOGGLE --- */}
                         <motion.button
                            initial={{ opacity: 0, y: 5 }}
                            animate={{ opacity: 1, y: 0 }}
                            onClick={() => setShowMyPairings(!showMyPairings)}
                            className={cn(
                                "flex items-center justify-between px-4 py-3 rounded-2xl border transition-all duration-200 text-left relative overflow-hidden mx-1",
                                showMyPairings
                                    ? "bg-[#004F71] text-white border-[#004F71] shadow-md shadow-blue-900/20"
                                    : "bg-slate-50 border-slate-100 text-slate-500 hover:bg-slate-100"
                            )}
                        >
                             <div className="flex items-center gap-3">
                                <UserCheck className={cn("w-4 h-4", showMyPairings ? "text-white" : "text-slate-400")} />
                                <span className="text-[10px] font-bold uppercase tracking-wider">Show My Pairings</span>
                             </div>
                             {showMyPairings && <Check className="w-3.5 h-3.5 text-white" />}
                        </motion.button>

                        <div className="h-px bg-slate-100 mx-2" />

                        {/* Unit Filter */}
                        <motion.div 
                            initial={{ opacity: 0, y: 10 }}
                            animate={{ opacity: 1, y: 0 }}
                            transition={{ delay: 0.1 }}
                            className="bg-slate-50 p-1 rounded-[20px] flex relative border border-slate-100"
                        >
                          {(["ALL", "FOH", "BOH"] as const).map((f) => {
                            const isActive = activeFilter === f;
                            return (
                              <button
                                key={f}
                                onClick={() => setActiveFilter(f)}
                                className={cn(
                                  "flex-1 py-3 rounded-[16px] text-[10px] font-black uppercase tracking-widest relative z-10 transition-colors duration-200 flex items-center justify-center gap-1.5",
                                  isActive ? "text-white" : "text-slate-400 hover:text-slate-600"
                                )}
                              >
                                {isActive && (
                                  <motion.div
                                    layoutId="activeFilterBg"
                                    className="absolute inset-0 bg-[#E51636] rounded-[16px] shadow-sm shadow-red-500/20"
                                    transition={transition}
                                  />
                                )}
                                <span className="relative z-10">{f === 'ALL' ? 'All Units' : f}</span>
                                
                                {f === 'ALL' && unassignedCount > 0 && (
                                    <motion.span 
                                        layoutId="notification-badge"
                                        className={cn(
                                            "relative z-10 min-w-[16px] h-4 px-1 rounded-full flex items-center justify-center text-[8px] font-bold shadow-sm transition-colors",
                                            isActive ? "bg-white text-[#E51636]" : "bg-red-100 text-red-600"
                                        )}
                                    >
                                        {unassignedCount}
                                    </motion.span>
                                )}
                              </button>
                            );
                          })}
                        </motion.div>
                        
                        {unassignedCount > 0 && (
                            <motion.div 
                                initial={{ opacity: 0, height: 0 }}
                                animate={{ opacity: 1, height: "auto" }}
                                className="mx-1 px-3 py-2 bg-red-50 border border-red-100 rounded-xl flex items-center gap-2"
                            >
                                <AlertCircle className="w-3.5 h-3.5 text-red-500" />
                                <span className="text-[9px] font-bold text-red-600 uppercase tracking-wide">
                                    {unassignedCount} Members require Unit Assignment
                                </span>
                            </motion.div>
                        )}

                        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="h-px bg-slate-100 w-full" />

                        {/* Roles Grid */}
                        <motion.div 
                            initial={{ opacity: 0, y: 10 }}
                            animate={{ opacity: 1, y: 0 }}
                            transition={{ delay: 0.15 }}
                            className="grid grid-cols-2 gap-2.5 px-1 pb-2"
                        >
                          {visibleStages.map((stage) => {
                            const isActive = activeStage === stage.id;
                            const Icon = stage.icon;
                            return (
                              <button
                                key={stage.id}
                                onClick={() => setActiveStage(stage.id)}
                                className={cn(
                                  "flex items-center justify-between px-4 py-3.5 rounded-2xl border transition-all duration-200 text-left group relative overflow-hidden",
                                  isActive
                                    ? "bg-[#004F71] text-white border-[#004F71] shadow-lg shadow-blue-900/20" 
                                    : "bg-white border-slate-100 hover:border-slate-200 text-slate-500 hover:bg-slate-50"
                                )}
                              >
                                <div className="flex items-center gap-3">
                                    <Icon
                                    className={cn(
                                        "w-4 h-4",
                                        isActive ? "text-white" : "text-slate-400 group-hover:text-slate-600"
                                    )}
                                    />
                                    <span className="text-[10px] font-bold uppercase tracking-wider">
                                        {stage.title}
                                    </span>
                                </div>
                                {isActive && <Check className="w-3.5 h-3.5 text-white" />}
                              </button>
                            );
                          })}
                        </motion.div>
                    </motion.div>
                )}
            </AnimatePresence>
        </motion.div>
      </LayoutGroup>
    </div>
  );
}
--- FILE: ./app/(main)/team/_components/Badge.tsx ---
"use client";

import { cn } from "@/lib/utils";

interface BadgeProps {
  children: React.ReactNode;
  /**
   * Defines the color palette for the badge.
   * Defaults to 'slate'.
   */
  color?: "blue" | "red" | "green" | "orange" | "slate";
  /**
   * Optional Lucide icon to display inside the badge.
   */
  icon?: any;
  /**
   * Additional Tailwind classes for layout adjustments (e.g., margins).
   */
  className?: string;
}

export const Badge = ({ 
  children, 
  color = "slate", 
  icon: Icon, 
  className 
}: BadgeProps) => {
  
  // High-contrast color mapping following the Operational Command aesthetic
  const styles = {
    blue: "bg-blue-50 text-[#004F71] border-blue-100 shadow-sm shadow-blue-900/5",
    red: "bg-red-50 text-[#E51636] border-red-100 shadow-sm shadow-red-900/5",
    green: "bg-emerald-50 text-emerald-700 border-emerald-100 shadow-sm shadow-emerald-900/5",
    orange: "bg-orange-50 text-orange-700 border-orange-100 shadow-sm shadow-orange-900/5",
    slate: "bg-slate-100 text-slate-600 border-slate-200 shadow-sm"
  };

  return (
    <div 
      className={cn(
        "px-3 py-1.5 rounded-full border text-[9px] font-black uppercase tracking-widest flex items-center gap-2 shrink-0 transition-all",
        styles[color],
        className
      )}
    >
      {Icon && <Icon className="w-3 h-3" />}
      <span className="leading-none">{children}</span>
    </div>
  );
};
--- FILE: ./app/(main)/team/_components/UnitAssignmentModal.tsx ---
"use client";

import { motion } from "framer-motion";
import { Coffee, Utensils, X, ShieldAlert, ArrowRight } from "lucide-react";
import ClientPortal from "@/components/core/ClientPortal";
import { TeamMember } from "../../calendar/_components/types";

interface Props {
    member: TeamMember;
    onAssign: (dept: "FOH" | "BOH") => void;
    onClose: () => void;
}

export default function UnitAssignmentModal({ member, onAssign, onClose }: Props) {
    return (
        <ClientPortal>
            <div className="fixed inset-0 z-[200] flex items-center justify-center p-4">
                {/* Backdrop */}
                <motion.div 
                    initial={{ opacity: 0 }} 
                    animate={{ opacity: 1 }} 
                    exit={{ opacity: 0 }} 
                    className="absolute inset-0 bg-[#0F172A]/80 backdrop-blur-md"
                    onClick={onClose}
                />
                
                {/* Modal Card */}
                <motion.div 
                    initial={{ scale: 0.9, opacity: 0, y: 20 }} 
                    animate={{ scale: 1, opacity: 1, y: 0 }} 
                    exit={{ scale: 0.9, opacity: 0, y: 20 }}
                    transition={{ type: "spring", stiffness: 300, damping: 25 }}
                    className="relative bg-white w-full max-w-lg rounded-[40px] shadow-2xl overflow-hidden border border-white/20 ring-4 ring-black/5"
                >
                    {/* Header */}
                    <div className="bg-slate-50 border-b border-slate-100 p-8 pb-6 text-center relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-red-500" />
                        
                        <div className="w-20 h-20 rounded-3xl bg-white shadow-xl mx-auto mb-6 flex items-center justify-center border border-slate-100 relative z-10">
                            {member.image && !member.image.includes("ui-avatars") ? (
                                <img src={member.image} className="w-full h-full object-cover rounded-[20px]" />
                            ) : (
                                <span className="text-3xl font-black text-slate-300">{member.name.charAt(0)}</span>
                            )}
                            <div className="absolute -bottom-2 -right-2 bg-amber-400 text-white p-1.5 rounded-full border-2 border-white shadow-sm">
                                <ShieldAlert className="w-4 h-4 fill-current text-amber-900" />
                            </div>
                        </div>

                        <h2 className="text-2xl font-[1000] text-slate-900 tracking-tight leading-none mb-2">
                            Unit Assignment Required
                        </h2>
                        <p className="text-sm font-medium text-slate-400 max-w-xs mx-auto">
                            <span className="text-slate-900 font-bold">{member.name}</span> has been synced from LifeLenz but requires a tactical unit assignment.
                        </p>

                        <button onClick={onClose} className="absolute top-6 right-6 p-2 text-slate-300 hover:text-slate-500 hover:bg-white rounded-full transition-all">
                            <X className="w-5 h-5" />
                        </button>
                    </div>

                    {/* Action Area */}
                    <div className="p-8 bg-white grid grid-cols-2 gap-4">
                        <button 
                            onClick={() => onAssign("FOH")}
                            className="group relative flex flex-col items-center justify-center p-6 rounded-[28px] border-2 border-slate-100 hover:border-[#004F71] hover:bg-blue-50/30 transition-all duration-300 active:scale-95"
                        >
                            <div className="w-14 h-14 bg-white rounded-2xl flex items-center justify-center shadow-sm border border-slate-100 mb-4 group-hover:scale-110 transition-transform group-hover:shadow-md group-hover:border-blue-200">
                                <Coffee className="w-7 h-7 text-[#004F71]" />
                            </div>
                            <span className="text-sm font-black text-[#004F71] uppercase tracking-widest mb-1">Front House</span>
                            <span className="text-[10px] font-bold text-slate-400">Guest Experience</span>
                            
                            <div className="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity transform translate-y-2 group-hover:translate-y-0">
                                <div className="w-6 h-6 bg-[#004F71] rounded-full flex items-center justify-center text-white shadow-lg">
                                    <ArrowRight className="w-3 h-3" />
                                </div>
                            </div>
                        </button>

                        <button 
                            onClick={() => onAssign("BOH")}
                            className="group relative flex flex-col items-center justify-center p-6 rounded-[28px] border-2 border-slate-100 hover:border-[#E51636] hover:bg-red-50/30 transition-all duration-300 active:scale-95"
                        >
                            <div className="w-14 h-14 bg-white rounded-2xl flex items-center justify-center shadow-sm border border-slate-100 mb-4 group-hover:scale-110 transition-transform group-hover:shadow-md group-hover:border-red-200">
                                <Utensils className="w-7 h-7 text-[#E51636]" />
                            </div>
                            <span className="text-sm font-black text-[#E51636] uppercase tracking-widest mb-1">Back House</span>
                            <span className="text-[10px] font-bold text-slate-400">Culinary Ops</span>

                            <div className="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity transform translate-y-2 group-hover:translate-y-0">
                                <div className="w-6 h-6 bg-[#E51636] rounded-full flex items-center justify-center text-white shadow-lg">
                                    <ArrowRight className="w-3 h-3" />
                                </div>
                            </div>
                        </button>
                    </div>

                    <div className="px-8 pb-8 pt-0 text-center">
                        <p className="text-[10px] font-bold text-slate-300 uppercase tracking-widest">
                            This action initializes the employee's profile
                        </p>
                    </div>
                </motion.div>
            </div>
        </ClientPortal>
    );
}
--- FILE: ./app/(main)/team/_components/OperationalDocumentInterface.tsx ---
// --- FILE: ./app/(main)/team/_components/OperationalDocumentInterface.tsx ---
"use client";

import { useState, useEffect } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { 
  FileText, CheckCircle2, Plus, 
  Printer, CornerDownRight, MoreHorizontal, ShieldAlert,
  StickyNote, History, Calendar, User, Trash2, Pencil, X
} from "lucide-react";
import { format } from "date-fns";
import { cn } from "@/lib/utils";
import { TeamMember } from "../../calendar/_components/types";
import { db } from "@/lib/firebase";
import { collection, addDoc, serverTimestamp, query, where, orderBy, getDocs, deleteDoc, doc, updateDoc } from "firebase/firestore";
import toast from "react-hot-toast";
import ClientPortal from "@/components/core/ClientPortal";

// --- TYPES ---
interface DocEntry {
  id: string;
  type: "Performance Review" | "Incident Report" | "Commendation" | "Note";
  title: string;
  content: string;
  author: string;
  timestamp: Date;
  status: "Draft" | "Official";
}

interface Props {
  member: TeamMember;
  currentUser: string; 
}

const DOC_TYPES = [
    { id: "Performance Review", icon: FileText, color: "text-blue-600 bg-blue-50 border-blue-100" },
    { id: "Incident Report", icon: ShieldAlert, color: "text-red-600 bg-red-50 border-red-100" },
    { id: "Commendation", icon: CheckCircle2, color: "text-emerald-600 bg-emerald-50 border-emerald-100" },
    { id: "Note", icon: StickyNote, color: "text-amber-600 bg-amber-50 border-amber-100" },
] as const;

// --- DELETE CONFIRMATION MODAL ---
function DeleteConfirmationModal({ isOpen, onClose, onConfirm }: { isOpen: boolean; onClose: () => void; onConfirm: () => void }) {
    if (!isOpen) return null;

    return (
        <ClientPortal>
            <div className="fixed inset-0 z-[300] flex items-center justify-center p-4">
                {/* Backdrop */}
                <motion.div 
                    initial={{ opacity: 0 }} 
                    animate={{ opacity: 1 }} 
                    exit={{ opacity: 0 }} 
                    className="absolute inset-0 bg-[#0F172A]/60 backdrop-blur-md"
                    onClick={onClose}
                />
                
                {/* Modal Card */}
                <motion.div 
                    initial={{ scale: 0.95, opacity: 0, y: 10 }} 
                    animate={{ scale: 1, opacity: 1, y: 0 }} 
                    exit={{ scale: 0.95, opacity: 0, y: 10 }}
                    className="relative bg-white w-full max-w-sm rounded-[32px] shadow-2xl overflow-hidden border border-white/20"
                >
                    <div className="p-8 flex flex-col items-center text-center">
                        <div className="w-16 h-16 rounded-full bg-red-50 flex items-center justify-center mb-6 border border-red-100 shadow-sm">
                            <ShieldAlert className="w-8 h-8 text-[#E51636]" />
                        </div>
                        
                        <h3 className="text-xl font-[1000] text-slate-900 mb-2 tracking-tight">Confirm Deletion</h3>
                        <p className="text-sm font-medium text-slate-500 leading-relaxed mb-8">
                            This action is permanent. The record will be expunged from the operational ledger.
                        </p>

                        <div className="flex gap-3 w-full">
                            <button 
                                onClick={onClose}
                                className="flex-1 py-3 bg-slate-50 hover:bg-slate-100 text-slate-600 rounded-xl font-black uppercase text-[10px] tracking-widest transition-all"
                            >
                                Cancel
                            </button>
                            <button 
                                onClick={onConfirm}
                                className="flex-1 py-3 bg-[#E51636] hover:bg-red-700 text-white rounded-xl font-black uppercase text-[10px] tracking-widest shadow-lg shadow-red-500/20 transition-all"
                            >
                                Delete
                            </button>
                        </div>
                    </div>
                </motion.div>
            </div>
        </ClientPortal>
    );
}

export default function OperationalDocumentInterface({ member, currentUser }: Props) {
  const [entries, setEntries] = useState<DocEntry[]>([]);
  const [isLoading, setIsLoading] = useState(true);

  // Form & Action States
  const [isCreating, setIsCreating] = useState(false);
  const [newEntry, setNewEntry] = useState<Partial<DocEntry>>({ type: "Note", content: "" });
  const [isSaving, setIsSaving] = useState(false);
  const [activeMenuId, setActiveMenuId] = useState<string | null>(null);
  const [editingId, setEditingId] = useState<string | null>(null);
  const [deleteTargetId, setDeleteTargetId] = useState<string | null>(null);

  // --- FETCH DOCUMENTS ON MOUNT ---
  useEffect(() => {
    const fetchDocuments = async () => {
      try {
        const q = query(
          collection(db, "events"),
          where("teamMemberId", "==", member.id),
          orderBy("createdAt", "desc")
        );

        const snapshot = await getDocs(q);
        
        const loadedEntries: DocEntry[] = snapshot.docs
          .map(doc => {
            const data = doc.data();
            // Parse only Document Logs based on the description tag
            if (data.description && data.description.startsWith("[DOCUMENT LOG:")) {
               const match = data.description.match(/\[DOCUMENT LOG: (.*?)\]\n\n([\s\S]*)/);
               if (match) {
                 return {
                   id: doc.id,
                   type: match[1] as any,
                   title: data.title,
                   content: match[2],
                   author: data.assigneeName || "Unknown",
                   timestamp: data.createdAt?.toDate ? data.createdAt.toDate() : new Date(),
                   status: "Official"
                 };
               }
            }
            return null;
          })
          .filter((e): e is DocEntry => e !== null);

        setEntries(loadedEntries);
      } catch (error) {
        console.error("Error loading documents:", error);
        toast.error("Could not load records");
      } finally {
        setIsLoading(false);
      }
    };

    fetchDocuments();
  }, [member.id]);

  // --- ACTIONS ---

  const handleDeleteClick = (id: string) => {
      setDeleteTargetId(id);
      setActiveMenuId(null);
  };

  const confirmDelete = async () => {
      if (!deleteTargetId) return;
      
      const toastId = toast.loading("Expunging record...");
      try {
          await deleteDoc(doc(db, "events", deleteTargetId));
          setEntries(prev => prev.filter(e => e.id !== deleteTargetId));
          toast.success("Record Expunged", { id: toastId });
      } catch (e) {
          toast.error("Delete Failed", { id: toastId });
      } finally {
          setDeleteTargetId(null);
      }
  };

  const handleEdit = (entry: DocEntry) => {
      setNewEntry({
          title: entry.title,
          content: entry.content,
          type: entry.type
      });
      setEditingId(entry.id);
      setIsCreating(true);
      setActiveMenuId(null);
  };

  const handleSave = async () => {
      if(!newEntry.content) return;
      setIsSaving(true);
      
      const timestamp = new Date();

      try {
        if (editingId) {
            // UPDATE EXISTING
            await updateDoc(doc(db, "events", editingId), {
                title: newEntry.title,
                description: `[DOCUMENT LOG: ${newEntry.type}]\n\n${newEntry.content}`,
                updatedAt: serverTimestamp()
            });

            // Update local state
            setEntries(prev => prev.map(e => e.id === editingId ? { 
                ...e, 
                title: newEntry.title || "", 
                content: newEntry.content || "", 
                type: newEntry.type as any 
            } : e));
            
            toast.success("Record Updated");
        } else {
            // CREATE NEW
            const res = await addDoc(collection(db, "events"), {
                type: "Operation", 
                title: newEntry.title || "Untitled Entry",
                status: "Done",
                priority: newEntry.type === "Incident Report" ? "High" : "Medium",
                startDate: timestamp,
                endDate: timestamp,
                assignee: "System", 
                assigneeName: currentUser, // Capture Author
                teamMemberId: member.id,
                teamMemberName: member.name,
                description: `[DOCUMENT LOG: ${newEntry.type}]\n\n${newEntry.content}`, 
                createdAt: serverTimestamp()
            });

            // Add to local state
            setEntries([{ 
                id: res.id,
                type: newEntry.type as any,
                title: newEntry.title || "Untitled Entry",
                content: newEntry.content || "",
                author: currentUser,
                timestamp: timestamp,
                status: "Official"
            }, ...entries]);
            
            toast.success("Record Officialized");
        }

        setIsCreating(false);
        setEditingId(null);
        setNewEntry({ type: "Note", content: "" });

      } catch (err) {
        console.error(err);
        toast.error("Failed to sync record");
      } finally {
        setIsSaving(false);
      }
  };

  const handlePrint = (entry: DocEntry) => {
    const iframe = document.createElement('iframe');
    iframe.style.position = 'absolute';
    iframe.style.width = '0px';
    iframe.style.height = '0px';
    iframe.style.border = 'none';
    document.body.appendChild(iframe);

    const doc = iframe.contentWindow?.document;
    if (!doc) return;

    doc.open();
    doc.write(`
        <html>
        <head>
            <title>Official Record - ${entry.title}</title>
            <style>
                body { font-family: 'Arial', sans-serif; padding: 40px; color: #1e293b; max-width: 800px; margin: 0 auto; }
                .header { border-bottom: 2px solid #e2e8f0; padding-bottom: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: flex-end; }
                .logo { font-size: 24px; font-weight: 900; color: #004F71; text-transform: uppercase; letter-spacing: -1px; }
                .meta { text-align: right; font-size: 12px; color: #64748b; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }
                .badge { display: inline-block; background: #f1f5f9; padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: bold; text-transform: uppercase; margin-bottom: 10px; border: 1px solid #e2e8f0; }
                h1 { font-size: 28px; margin: 0 0 20px 0; font-weight: 800; line-height: 1.2; }
                .content { font-size: 14px; line-height: 1.8; white-space: pre-wrap; color: #334155; }
                .footer { margin-top: 60px; border-top: 1px solid #e2e8f0; padding-top: 20px; display: flex; justify-content: space-between; align-items: center; }
                .signature { font-family: 'Courier New', monospace; font-size: 12px; }
                .stamp { border: 2px dashed #cbd5e1; color: #cbd5e1; padding: 10px 20px; font-weight: 900; text-transform: uppercase; transform: rotate(-5deg); font-size: 12px; border-radius: 8px; }
            </style>
        </head>
        <body>
            <div class="header">
                <div class="logo">TrainingBook</div>
                <div class="meta">
                    Personnel Record<br/>
                    ${format(new Date(), "MMMM do, yyyy")}
                </div>
            </div>
            
            <div class="badge">${entry.type}</div>
            <h1>${entry.title}</h1>
            
            <div class="content">
                ${entry.content}
            </div>

            <div class="footer">
                <div class="signature">
                    <strong>SIGNED:</strong> ${entry.author}<br/>
                    <strong>DATE:</strong> ${format(entry.timestamp, "yyyy-MM-dd HH:mm")}
                </div>
                <div class="stamp">Official Entry</div>
            </div>
        </body>
        </html>
    `);
    doc.close();

    iframe.contentWindow?.focus();
    iframe.contentWindow?.print();

    setTimeout(() => {
        document.body.removeChild(iframe);
    }, 1000);
  };

  return (
    <div className="flex flex-col h-full bg-[#F8FAFC] relative overflow-hidden">
        
        {/* --- STICKY HEADER --- */}
        <div className="px-6 py-5 bg-white/80 backdrop-blur-xl border-b border-slate-100 flex justify-between items-center shrink-0 z-30 sticky top-0">
            <div className="flex items-center gap-4">
                <div className="h-10 w-10 bg-slate-50 text-slate-400 rounded-xl border border-slate-200 flex items-center justify-center shadow-sm">
                    <History className="w-5 h-5" />
                </div>
                <div className="flex flex-col">
                    <h3 className="text-sm font-[900] text-slate-900 uppercase tracking-wide">Personnel Record</h3>
                    <span className="text-[10px] font-bold text-slate-400 tracking-wide">Official Ledger • {member.name}</span>
                </div>
            </div>
            <button 
                onClick={() => {
                    setEditingId(null);
                    setNewEntry({ type: "Note", content: "" });
                    setIsCreating(true);
                }}
                className="group flex items-center gap-2 px-5 py-2.5 bg-[#004F71] text-white rounded-full text-[10px] font-black uppercase tracking-widest shadow-lg shadow-blue-900/20 active:scale-95 transition-all hover:bg-[#003b55] hover:pr-6"
            >
                <Plus className="w-3.5 h-3.5 transition-transform group-hover:rotate-90" /> New Entry
            </button>
        </div>

        {/* --- MAIN CONTENT --- */}
        <div className="flex-1 overflow-y-auto custom-scrollbar p-6 lg:p-10 relative">
            <div className="max-w-4xl mx-auto">
                
                {/* CREATION CARD */}
                <AnimatePresence>
                    {isCreating && (
                        <motion.div 
                            initial={{ opacity: 0, scale: 0.95, y: -20 }}
                            animate={{ opacity: 1, scale: 1, y: 0 }}
                            exit={{ opacity: 0, scale: 0.95, y: -20 }}
                            transition={{ type: "spring", stiffness: 300, damping: 25 }}
                            className="bg-white rounded-[32px] border border-slate-200 shadow-2xl overflow-hidden mb-12 ring-4 ring-slate-50 relative z-20"
                        >
                            <div className="p-2 bg-slate-50/50 border-b border-slate-100 flex gap-2 overflow-x-auto no-scrollbar">
                                {DOC_TYPES.map(t => (
                                    <button 
                                        key={t.id}
                                        onClick={() => setNewEntry({...newEntry, type: t.id})}
                                        className={cn(
                                            "flex items-center gap-2 px-4 py-2.5 rounded-[18px] text-[10px] font-black uppercase tracking-wider transition-all whitespace-nowrap border",
                                            newEntry.type === t.id 
                                                ? "bg-white text-slate-900 shadow-sm border-slate-200 ring-1 ring-black/5" 
                                                : "text-slate-400 border-transparent hover:bg-white/60"
                                        )}
                                    >
                                        <t.icon className={cn("w-3.5 h-3.5", t.color.split(' ')[0])} />
                                        {t.id}
                                    </button>
                                ))}
                            </div>
                            <div className="p-8 space-y-6">
                                <input 
                                    className="w-full text-2xl font-[900] text-slate-900 placeholder:text-slate-300 outline-none bg-transparent tracking-tight"
                                    placeholder="Title of Entry..."
                                    value={newEntry.title || ""}
                                    onChange={e => setNewEntry({...newEntry, title: e.target.value})}
                                    autoFocus
                                />
                                <textarea 
                                    className="w-full min-h-[160px] text-base leading-relaxed text-slate-600 placeholder:text-slate-300 outline-none resize-none bg-transparent font-medium"
                                    placeholder="Record observations, tactical feedback, or incident details..."
                                    value={newEntry.content}
                                    onChange={e => setNewEntry({...newEntry, content: e.target.value})}
                                />
                            </div>
                            <div className="p-4 bg-slate-50 border-t border-slate-100 flex justify-end gap-3">
                                <button onClick={() => setIsCreating(false)} className="px-6 py-3 text-[10px] font-bold uppercase text-slate-400 hover:text-slate-600 tracking-widest transition-colors">Cancel</button>
                                <button 
                                    onClick={handleSave} 
                                    disabled={!newEntry.content || isSaving}
                                    className="px-8 py-3 bg-[#004F71] text-white rounded-[18px] text-[10px] font-black uppercase tracking-widest shadow-lg shadow-blue-900/10 active:scale-95 transition-all disabled:opacity-50 flex items-center gap-2 hover:translate-y-[-1px]"
                                >
                                    {isSaving ? <span className="animate-pulse">Saving...</span> : <>Save Record <CornerDownRight className="w-3.5 h-3.5" /></>}
                                </button>
                            </div>
                        </motion.div>
                    )}
                </AnimatePresence>

                {/* TIMELINE FEED */}
                <div className="relative pl-8 lg:pl-10 space-y-10 pb-20">
                    
                    {isLoading ? (
                        <div className="absolute inset-0 flex items-start justify-center pt-10 bg-white/50 backdrop-blur-sm z-50">
                             <div className="flex flex-col items-center gap-2 animate-pulse">
                                 <History className="w-6 h-6 text-slate-300" />
                                 <span className="text-[10px] font-bold uppercase tracking-widest text-slate-400">Syncing Ledger...</span>
                             </div>
                        </div>
                    ) : (
                        <>
                            {/* The Timeline Line */}
                            <div className="absolute left-[19px] lg:left-[21px] top-4 bottom-0 w-px bg-gradient-to-b from-slate-200 via-slate-200 to-transparent" />
        
                            <AnimatePresence>
                                {entries.map((entry, idx) => {
                                    const typeConfig = DOC_TYPES.find(t => t.id === entry.type) || DOC_TYPES[0];
                                    const Icon = typeConfig.icon;
                                    
                                    return (
                                        <motion.div 
                                            key={entry.id}
                                            layout
                                            initial={{ opacity: 0, x: -20, scale: 0.95 }}
                                            animate={{ opacity: 1, x: 0, scale: 1 }}
                                            transition={{ delay: idx * 0.05 }}
                                            className="relative"
                                        >
                                            {/* Timeline Dot */}
                                            <div className={cn(
                                                "absolute -left-[42px] lg:-left-[44px] top-0 z-10 w-10 h-10 lg:w-11 lg:h-11 rounded-2xl flex items-center justify-center border-[4px] border-[#F8FAFC] shadow-sm shrink-0 bg-white",
                                            )}>
                                                <div className={cn("w-full h-full rounded-xl flex items-center justify-center opacity-90", typeConfig.color.replace('text-', 'bg-').replace('bg-', 'bg-opacity-20 '))} >
                                                <Icon className={cn("w-4 h-4 lg:w-5 lg:h-5", typeConfig.color.split(' ')[0])} />
                                                </div>
                                            </div>
        
                                            {/* The Card */}
                                            <div className="bg-white rounded-[28px] border border-slate-100 shadow-[0_10px_40px_-15px_rgba(0,0,0,0.03)] overflow-hidden group hover:shadow-[0_20px_50px_-12px_rgba(0,0,0,0.08)] hover:border-slate-200 transition-all duration-300">
                                                
                                                {/* Card Header */}
                                                <div className="px-6 py-5 border-b border-slate-50 flex justify-between items-start bg-slate-50/30">
                                                    <div className="flex flex-col gap-1">
                                                        <div className="flex items-center gap-2.5">
                                                            <span className={cn("px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-wider border", typeConfig.color)}>
                                                                {entry.type}
                                                            </span>
                                                            <span className="text-[10px] font-bold text-slate-300 uppercase tracking-widest flex items-center gap-1.5">
                                                                <Calendar className="w-3 h-3" /> {format(entry.timestamp, "MMM do, yyyy")}
                                                            </span>
                                                        </div>
                                                        <h4 className="text-xl font-[800] text-slate-900 tracking-tight mt-1">{entry.title}</h4>
                                                    </div>
                                                    
                                                    {/* ACTION MENU */}
                                                    <div className="relative">
                                                        <button 
                                                            onClick={() => setActiveMenuId(activeMenuId === entry.id ? null : entry.id)}
                                                            className="p-2 text-slate-300 hover:text-slate-600 hover:bg-slate-100 rounded-xl transition-all"
                                                        >
                                                            <MoreHorizontal className="w-5 h-5" />
                                                        </button>

                                                        <AnimatePresence>
                                                            {activeMenuId === entry.id && (
                                                                <motion.div 
                                                                    initial={{ opacity: 0, scale: 0.9, y: 10 }}
                                                                    animate={{ opacity: 1, scale: 1, y: 0 }}
                                                                    exit={{ opacity: 0, scale: 0.9, y: 10 }}
                                                                    className="absolute right-0 top-full mt-2 w-32 bg-white rounded-xl shadow-xl border border-slate-100 z-50 overflow-hidden ring-1 ring-black/5"
                                                                >
                                                                    <button 
                                                                        onClick={() => handleEdit(entry)}
                                                                        className="w-full text-left px-4 py-3 text-[10px] font-bold uppercase tracking-wider hover:bg-slate-50 flex items-center gap-2 text-slate-600 transition-colors"
                                                                    >
                                                                        <Pencil className="w-3 h-3" /> Edit
                                                                    </button>
                                                                    <div className="h-px bg-slate-50" />
                                                                    <button 
                                                                        onClick={() => handleDeleteClick(entry.id)}
                                                                        className="w-full text-left px-4 py-3 text-[10px] font-bold uppercase tracking-wider hover:bg-red-50 flex items-center gap-2 text-red-500 transition-colors"
                                                                    >
                                                                        <Trash2 className="w-3 h-3" /> Delete
                                                                    </button>
                                                                </motion.div>
                                                            )}
                                                        </AnimatePresence>
                                                        
                                                        {activeMenuId === entry.id && (
                                                            <div className="fixed inset-0 z-40" onClick={() => setActiveMenuId(null)} />
                                                        )}
                                                    </div>
                                                </div>
                                                
                                                {/* Card Body */}
                                                <div className="p-7">
                                                    <p className="text-sm lg:text-[15px] font-medium text-slate-600 leading-[1.8] whitespace-pre-wrap">
                                                        {entry.content}
                                                    </p>
                                                </div>
        
                                                {/* Card Footer */}
                                                <div className="px-6 py-4 bg-slate-50/50 border-t border-slate-100 flex justify-between items-center">
                                                    <div className="flex items-center gap-3">
                                                        <div className="w-8 h-8 rounded-xl bg-[#004F71] text-white flex items-center justify-center text-[10px] font-black shadow-md shadow-blue-900/10">
                                                            {entry.author.charAt(0)}
                                                        </div>
                                                        <div className="flex flex-col">
                                                            <span className="text-[8px] font-black text-slate-400 uppercase tracking-widest">Signed By</span>
                                                            <span className="text-[10px] font-bold text-slate-700 uppercase tracking-wide">
                                                                {entry.author}
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div className="flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                                        <button 
                                                            onClick={() => handlePrint(entry)}
                                                            className="flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-[9px] font-bold text-slate-500 hover:text-[#004F71] hover:border-blue-200 shadow-sm transition-all active:scale-95"
                                                        >
                                                            <Printer className="w-3 h-3" /> Print
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </motion.div>
                                    );
                                })}
                            </AnimatePresence>

                            {/* End Cap */}
                            <div className="relative flex gap-6 opacity-30 pl-1">
                                <div className="relative z-10 w-3 h-3 rounded-full bg-slate-300 -left-[24px]" />
                                <div>
                                    <span className="text-[9px] font-black text-slate-400 uppercase tracking-[0.3em]">End of Record</span>
                                </div>
                            </div>
                        </>
                    )}
                </div>
            </div>
        </div>
        
        {/* DELETE CONFIRMATION MODAL */}
        <AnimatePresence>
            {deleteTargetId && (
                <DeleteConfirmationModal 
                    isOpen={!!deleteTargetId} 
                    onClose={() => setDeleteTargetId(null)} 
                    onConfirm={confirmDelete} 
                />
            )}
        </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/(main)/team/page.tsx ---
"use client";

import { useState, useMemo, useEffect, useRef, useCallback } from "react";
// ... existing imports ...
import { AnimatePresence, motion, LayoutGroup, PanInfo } from "framer-motion";
import { 
  Users, Search, Zap, Loader2,
  LayoutGrid, GalleryHorizontal, ArrowRight, ScanFace 
} from "lucide-react";
import { cn } from "@/lib/utils";
import toast from "react-hot-toast";

import { useAppStore } from "@/lib/store/useStore";
import { db } from "@/lib/firebase";
import { doc, setDoc, serverTimestamp, collection, addDoc, updateDoc, writeBatch } from "firebase/firestore";

import { Status, STAGES, TeamMember } from "../calendar/_components/types";
import { TeamCard } from "./_components/TeamCard";
import { MemberDetailSheet } from "./_components/MemberDetailSheet";
import TrainerRecruitmentModal from "./_components/TrainerRecruitmentModal";
import TeamDynamicIsland from "./_components/TeamDynamicIsland";
import UnitAssignmentModal from "./_components/UnitAssignmentModal";

// ... PromotionHUD component remains unchanged ...
function PromotionHUD({ 
    draggingMember, 
    onPromote 
}: { 
    draggingMember?: TeamMember; 
    onPromote: (memberId: string, newRole: Status) => void;
}) {
    // ... code unchanged ...
    const visibleStages = STAGES;
    const [hoveredStage, setHoveredStage] = useState<string | null>(null);

    return (
        <motion.div 
            initial={{ y: 100, opacity: 0, x: "-50%" }} 
            animate={{ y: 0, opacity: 1, x: "-50%" }} 
            exit={{ y: 100, opacity: 0, x: "-50%" }}
            className="fixed bottom-32 md:bottom-12 left-1/2 z-[140] w-[90%] max-w-2xl px-0 pointer-events-none"
        >
            <div className="pointer-events-auto bg-white/90 backdrop-blur-3xl border border-white/60 rounded-[32px] p-3 shadow-[0_20px_50px_-10px_rgba(0,0,0,0.2)] flex flex-col gap-3 ring-1 ring-white/50">
                <div className="flex items-center justify-between px-4 py-1">
                    <div className="flex items-center gap-3">
                         <div className="w-8 h-8 rounded-full bg-[#E51636] flex items-center justify-center text-white shadow-lg shadow-red-500/30 animate-pulse">
                            <Zap className="w-4 h-4 fill-current" />
                         </div>
                         <div className="flex flex-col">
                             <span className="text-[9px] font-black uppercase tracking-widest text-slate-400">Promoting Member</span>
                             <span className="text-xs font-bold text-slate-900">{draggingMember?.name}</span>
                         </div>
                    </div>
                </div>
                <div className="grid grid-cols-3 md:grid-cols-6 gap-2">
                    {visibleStages.map((stage) => {
                        const isCurrent = draggingMember?.status === stage.id;
                        const isHovered = hoveredStage === stage.id;

                        return (
                            <div 
                                key={stage.id} 
                                data-role-target={stage.id} 
                                onMouseEnter={() => setHoveredStage(stage.id)}
                                onMouseLeave={() => setHoveredStage(null)}
                                onMouseUp={() => {
                                    if(draggingMember) onPromote(draggingMember.id, stage.id as Status);
                                }}
                                className={cn(
                                    "relative h-16 rounded-2xl border-2 transition-all duration-200 flex flex-col items-center justify-center gap-1.5 cursor-pointer overflow-hidden",
                                    isCurrent 
                                        ? "bg-slate-50 border-slate-100 opacity-40 grayscale" 
                                        : isHovered
                                            ? "bg-blue-50 border-[#004F71] scale-105 shadow-xl z-10"
                                            : "bg-white border-slate-100 hover:border-slate-300"
                                )}
                            >
                                <stage.icon className={cn(
                                    "w-4 h-4 transition-colors",
                                    isHovered ? "text-[#004F71]" : "text-slate-400"
                                )} />
                                <span className={cn(
                                    "text-[7px] font-black uppercase tracking-widest text-center leading-none px-1",
                                    isHovered ? "text-[#004F71]" : "text-slate-500"
                                )}>
                                    {stage.title.replace('Assistant', 'Asst.')}
                                </span>
                                {isHovered && !isCurrent && (
                                    <motion.div 
                                        layoutId="target-glow" 
                                        className="absolute inset-0 bg-[#004F71]/5 pointer-events-none" 
                                        transition={{ duration: 0.2 }}
                                    />
                                )}
                            </div>
                        );
                    })}
                </div>
            </div>
        </motion.div>
    );
}

// --- MAIN PAGE ---
export default function TeamBoardPage() {
    // 1. GET CURRENT USER
    // Added 'curriculum' to store hook
    const { team, subscribeTeam, subscribeEvents, subscribeCurriculum, updateMemberLocal, currentUser, curriculum } = useAppStore(); 
    
    // Filters
    const [activeStage, setActiveStage] = useState<Status>("Team Member");
    const [activeFilter, setActiveFilter] = useState<"ALL" | "FOH" | "BOH">("ALL");
    const [viewMode, setViewMode] = useState<"grid" | "gallery">("grid"); 
    const [searchQuery, setSearchQuery] = useState("");
    
    // 2. NEW STATE: MY PAIRINGS FILTER
    const [showMyPairings, setShowMyPairings] = useState(false);
    
    // Pagination / Infinite Scroll
    const [visibleCount, setVisibleCount] = useState(12);
    const visibleCountRef = useRef(visibleCount); 
    const loadMoreRef = useRef<HTMLDivElement>(null);

    // Interaction State
    const [selectedMemberId, setSelectedMemberId] = useState<string | null>(null);
    const [assignmentMember, setAssignmentMember] = useState<TeamMember | null>(null); 
    const [activeTab, setActiveTab] = useState<"overview" | "curriculum" | "performance" | "documents">("overview");
    const [memberDraggingId, setMemberDraggingId] = useState<string | null>(null);
    
    // TRAINER ASSIGNMENT STATE
    const [activeLeaderId, setActiveLeaderId] = useState<string | null>(null);
    const [isTrainerPanelOpen, setIsTrainerPanelOpen] = useState(false);
    
    // NEW STATE: Track which member clicked "Assign Mentor" to highlight their card
    const [recipientMemberId, setRecipientMemberId] = useState<string | null>(null);
    
    const isProcessingRef = useRef(false);

    // Derived active member
    const selectedMember = useMemo(() => 
        team.find(m => m.id === selectedMemberId) || null, 
    [team, selectedMemberId]);

    // Subscriptions
    useEffect(() => {
        const unsubTeam = subscribeTeam();
        const unsubEvents = subscribeEvents(); 
        const unsubCurriculum = subscribeCurriculum();
        return () => { unsubTeam(); unsubEvents(); unsubCurriculum(); };
    }, [subscribeTeam, subscribeEvents, subscribeCurriculum]);

    useEffect(() => {
        setVisibleCount(12);
        visibleCountRef.current = 12;
    }, [activeStage, activeFilter, searchQuery]);

    useEffect(() => {
        visibleCountRef.current = visibleCount;
    }, [visibleCount]);

    // 3. UPDATE FILTER LOGIC (WITH PROGRESS CALCULATION INJECTED)
    const filteredMembers = useMemo(() => {
        return team
            .filter(m => {
                const matchesStage = m.status === activeStage;
                const matchesFilter = activeFilter === "ALL" || m.dept === activeFilter;
                const matchesSearch = m.name.toLowerCase().includes(searchQuery.toLowerCase());
                
                // My Pairings Logic
                const matchesPairing = showMyPairings 
                    ? m.pairing?.id === currentUser?.uid 
                    : true;

                return matchesStage && matchesFilter && matchesSearch && matchesPairing;
            })
            // --- INJECT REAL-TIME PROGRESS HERE ---
            .map(m => {
                // Same logic as Detail Sheet
                if (!curriculum || curriculum.length === 0) return m;

                const relevantSections = curriculum.filter(section => 
                    section.dept?.toUpperCase() === m.dept?.toUpperCase()
                );
                
                const totalTasks = relevantSections.reduce((acc, section) => 
                    acc + (section.tasks?.length || 0), 0);

                const completedCount = relevantSections.reduce((acc, section) => {
                    const completedInSection = section.tasks?.filter((t: any) => 
                        m.completedTaskIds?.includes(t.id)
                    ).length || 0;
                    return acc + completedInSection;
                }, 0);

                const calculatedProgress = totalTasks > 0 
                    ? Math.round((completedCount / totalTasks) * 100) 
                    : 0;

                return { ...m, progress: calculatedProgress };
            })
            // --- END INJECTION ---
            .sort((a, b) => a.name.localeCompare(b.name));
    }, [team, activeStage, activeFilter, searchQuery, showMyPairings, currentUser, curriculum]);

    const visibleMembers = useMemo(() => {
        return filteredMembers.slice(0, visibleCount);
    }, [filteredMembers, visibleCount]);

    // --- INFINITE SCROLL OBSERVER ---
    useEffect(() => {
        const observer = new IntersectionObserver(
            (entries) => {
                if (entries[0].isIntersecting) {
                    if (visibleCountRef.current < filteredMembers.length) {
                        setVisibleCount(prev => prev + 12);
                    }
                }
            },
            { root: null, rootMargin: "400px", threshold: 0 } 
        );

        const currentSentinel = loadMoreRef.current;
        if (currentSentinel) observer.observe(currentSentinel);
        
        return () => { 
            if (currentSentinel) observer.unobserve(currentSentinel); 
        };
    }, [filteredMembers.length]); 

    // ... (All Handlers and Render logic remain the same, just passing the new enriched 'member' object) ...
    // Note: I will just verify the rest of the file structure is intact below.

    // --- SHARED: LINK LOGIC ---
    const linkMemberAndLeader = async (targetId: string, leaderId: string) => {
        if (isProcessingRef.current) return;
        
        const leader = team.find(m => m.id === leaderId);
        const targetMember = team.find(m => m.id === targetId);
        
        if (!leader || !targetMember) return;

        isProcessingRef.current = true;
        const loadToast = toast.loading(`Linking ${leader.name} to ${targetMember.name}...`);
        
        updateMemberLocal(targetMember.id, {
            pairing: { 
                id: leader.id, 
                name: leader.name, 
                role: leader.role, 
                image: leader.image 
            }
        });

        try {
            await setDoc(doc(db, "profileOverrides", targetMember.id), {
                pairing: { id: leader.id, name: leader.name, role: leader.role, image: leader.image },
                updatedAt: serverTimestamp()
            }, { merge: true });

            await addDoc(collection(db, "events"), {
                type: "Operation",
                title: "Mentorship Uplink",
                status: "Done",
                priority: "High",
                startDate: new Date(),
                endDate: new Date(),
                assignee: leader.id,
                assigneeName: leader.name,
                teamMemberId: targetMember.id,
                teamMemberName: targetMember.name,
                description: `Official mentorship link established with ${leader.name}.`,
                createdAt: serverTimestamp()
            });

            toast.success("Mentorship Uplink Established", { id: loadToast });
            setActiveLeaderId(null);
            setRecipientMemberId(null);
            setIsTrainerPanelOpen(false);
        } catch (e) {
            updateMemberLocal(targetMember.id, { pairing: targetMember.pairing }); 
            toast.error("Failed", { id: loadToast });
        } finally {
            isProcessingRef.current = false;
        }
    };

    // --- HANDLERS ---
    const openRecruitment = (member: TeamMember) => {
        setActiveLeaderId(null);
        setRecipientMemberId(member.id); 
        setIsTrainerPanelOpen(true);
    };

    const handleSelectLeader = (leader: TeamMember | null) => {
        if (!leader) {
            setActiveLeaderId(null);
            return;
        }
        if (recipientMemberId) {
            linkMemberAndLeader(recipientMemberId, leader.id);
            return;
        }
        if (activeLeaderId === leader.id) {
            setActiveLeaderId(null);
        } else {
            setActiveLeaderId(leader.id);
        }
    };

    const handleMemberClick = async (targetMember: TeamMember) => {
        if (targetMember.dept === "Unassigned") {
            setAssignmentMember(targetMember);
            return;
        }
        if (activeLeaderId) {
            linkMemberAndLeader(targetMember.id, activeLeaderId);
            return;
        }
        setSelectedMemberId(targetMember.id);
    };

    const handleUnitAssign = async (dept: "FOH" | "BOH") => {
        if (!assignmentMember || isProcessingRef.current) return;
        isProcessingRef.current = true;
        updateMemberLocal(assignmentMember.id, { dept });

        const loadToast = toast.loading(`Initializing ${dept} Profile...`);
        try {
            await updateDoc(doc(db, "teamMembers", assignmentMember.id), { 
                dept: dept,
                updatedAt: serverTimestamp()
            });

            await addDoc(collection(db, "events"), {
                title: `Unit Assignment: ${dept}`,
                type: "Operation",
                status: "Done",
                priority: "High",
                startDate: new Date(),
                endDate: new Date(),
                assignee: "System",
                assigneeName: "Command",
                teamMemberId: assignmentMember.id,
                teamMemberName: assignmentMember.name,
                description: `[SYSTEM LOG: ASSIGNMENT]\nInitial deployment to ${dept} Unit.`,
                createdAt: serverTimestamp()
            });

            toast.success("Unit Assigned", { id: loadToast });
            setAssignmentMember(null);
        } catch (e) {
            toast.error("Assignment Failed", { id: loadToast });
        } finally {
            isProcessingRef.current = false;
        }
    };

    const handlePromoteMember = async (memberId: string, newRole: Status) => {
        if (isProcessingRef.current) return;
        const member = team.find(m => m.id === memberId);
        if(!member || member.status === newRole) {
            setMemberDraggingId(null);
            return;
        }

        isProcessingRef.current = true;
        setMemberDraggingId(null); 
        const toastId = toast.loading(`Promoting to ${newRole}...`);
        
        updateMemberLocal(memberId, { status: newRole, role: newRole });

        try {
            const batch = writeBatch(db);
            const overrideRef = doc(db, "profileOverrides", memberId);
            const memberRef = doc(db, "teamMembers", memberId);
            const today = new Date().toISOString();

            batch.set(overrideRef, {
                role: newRole, status: newRole, promotionDates: { [newRole]: today }, updatedAt: serverTimestamp()
            }, { merge: true });

            batch.update(memberRef, { role: newRole, status: newRole, updatedAt: serverTimestamp() });
            await batch.commit();

            await addDoc(collection(db, "events"), {
                title: `Rank Advancement: ${newRole}`,
                type: "Operation",
                status: "Done",
                priority: "High",
                startDate: new Date(),
                endDate: new Date(),
                assignee: "System",
                assigneeName: "Command",
                teamMemberId: memberId,
                teamMemberName: member?.name || "Member",
                description: `[SYSTEM LOG: PROMOTION]\nOfficial rank advanced to ${newRole}.`,
                createdAt: serverTimestamp()
            });

            toast.success("Promotion Confirmed", { id: toastId, icon: '🎖️' });
        } catch (error) {
            toast.error("Deployment Failed", { id: toastId });
            updateMemberLocal(memberId, { status: member.status, role: member.role });
        } finally {
            setTimeout(() => { isProcessingRef.current = false; }, 500);
        }
    };

    const handleMemberDragEnd = (event: MouseEvent | TouchEvent | PointerEvent, info: PanInfo, member: TeamMember) => {
        setMemberDraggingId(null);
        // @ts-ignore
        const clientX = event.clientX || event.changedTouches?.[0]?.clientX;
        // @ts-ignore
        const clientY = event.clientY || event.changedTouches?.[0]?.clientY;

        if (clientX && clientY) {
            const elementsBelow = document.elementsFromPoint(clientX, clientY);
            const targetElement = elementsBelow.find(el => el.hasAttribute('data-role-target'));
            
            if (targetElement) {
                const newRole = targetElement.getAttribute('data-role-target') as Status;
                if (newRole && newRole !== member.status) {
                    handlePromoteMember(member.id, newRole);
                }
            }
        }
    };

    // --- REUSABLE CONTROL BAR ---
    const ControlBar = ({ className }: { className?: string }) => (
        <div className={cn("flex items-center bg-white/90 backdrop-blur-2xl border border-white/60 shadow-[0_20px_50px_-10px_rgba(0,0,0,0.15)] rounded-full h-14 p-1.5 ring-1 ring-slate-900/5 w-full max-w-sm gap-2", className)}>
            <div className="flex bg-slate-100 rounded-full p-1 border border-slate-200 shrink-0">
                <button 
                    onClick={() => setViewMode('grid')}
                    className={cn(
                        "w-10 h-10 rounded-full flex items-center justify-center transition-all active:scale-95",
                        viewMode === 'grid' ? "bg-white text-slate-900 shadow-sm" : "text-slate-400 hover:text-slate-600"
                    )}
                >
                    <LayoutGrid className="w-5 h-5" />
                </button>
                <button 
                    onClick={() => setViewMode('gallery')}
                    className={cn(
                        "w-10 h-10 rounded-full flex items-center justify-center transition-all active:scale-95",
                        viewMode === 'gallery' ? "bg-white text-slate-900 shadow-sm" : "text-slate-400 hover:text-slate-600"
                    )}
                >
                    <GalleryHorizontal className="w-5 h-5" />
                </button>
            </div>
            
            <div className="flex-1 flex items-center gap-2 px-3 bg-slate-50/80 rounded-full h-full border border-slate-100/50">
                <Search className="w-4 h-4 text-slate-400 shrink-0" />
                <input 
                    className="bg-transparent w-full text-sm font-bold text-slate-800 outline-none placeholder:text-slate-400" 
                    placeholder="Find member..." 
                    value={searchQuery} 
                    onChange={e => setSearchQuery(e.target.value)} 
                />
            </div>
        </div>
    );

    return (
        <div className="min-h-screen bg-[#F8FAFC] pb-40 md:pb-20 relative overflow-x-hidden selection:bg-[#E51636] selection:text-white">
            <div className="absolute inset-0 pointer-events-none opacity-[0.4]" style={{ backgroundImage: 'radial-gradient(#cbd5e1 1px, transparent 1px)', backgroundSize: '24px 24px' }} />

            <TeamDynamicIsland 
                activeStage={activeStage} 
                setActiveStage={setActiveStage}
                activeFilter={activeFilter}
                setActiveFilter={setActiveFilter}
                showMyPairings={showMyPairings}
                setShowMyPairings={setShowMyPairings}
            />

            <div className="hidden md:flex fixed top-44 left-0 right-0 z-40 justify-center pointer-events-none">
                 <motion.div 
                    initial={{ y: -20, opacity: 0 }} 
                    animate={{ y: 0, opacity: 1 }} 
                    className="pointer-events-auto"
                 >
                     <ControlBar />
                 </motion.div>
            </div>

            <div className="max-w-[1400px] mx-auto mt-[8rem] md:mt-72 px-4 md:px-8 space-y-6 relative z-10">
                <div className="flex flex-col md:flex-row md:items-end justify-between gap-4">
                    <div className="space-y-1 w-full text-center md:text-left">
                        <h2 className="text-4xl md:text-6xl font-black text-slate-900 tracking-tighter leading-none uppercase">{activeStage}</h2>
                    </div>
                </div>
            </div>

            <div className="mt-8 relative z-10 w-full max-w-[100vw] overflow-visible">
                <LayoutGroup id="roster">
                    <AnimatePresence mode="wait">
                        {visibleMembers.length === 0 ? (
                             <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="col-span-full h-64 flex flex-col items-center justify-center text-slate-300 border-2 border-dashed border-slate-200 rounded-[32px] w-[90%] mx-auto bg-slate-50/50">
                                <Users className="w-12 h-12 mb-4 opacity-50" />
                                <p className="text-xs font-black uppercase tracking-[0.2em]">No Team Members Found</p>
                            </motion.div>
                        ) : viewMode === "grid" ? (
                            <motion.div 
                                key="grid"
                                initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
                                className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-10 px-4 md:px-8 max-w-[1400px] mx-auto"
                            >
                                <AnimatePresence mode="popLayout">
                                    {visibleMembers.map((member) => (
                                        <motion.div 
                                            key={member.id} 
                                            layout 
                                            initial={{ opacity: 0, scale: 0.9 }} 
                                            animate={{ opacity: 1, scale: 1 }} 
                                            exit={{ opacity: 0, scale: 0.9 }} 
                                            data-team-card-id={member.id} 
                                            className="relative"
                                            style={{ zIndex: memberDraggingId === member.id ? 100 : 1 }}
                                        >
                                            <TeamCard 
                                                member={member} 
                                                onClick={handleMemberClick} 
                                                onAssignClick={openRecruitment}
                                                onDragStart={() => setMemberDraggingId(member.id)} 
                                                onDragEnd={(e, info) => handleMemberDragEnd(e, info, member)} 
                                                isDragging={memberDraggingId === member.id} 
                                                isDropTarget={!!activeLeaderId}
                                                isWaitingForMentor={recipientMemberId === member.id}
                                            />
                                        </motion.div>
                                    ))}
                                </AnimatePresence>
                                
                                {visibleCount < filteredMembers.length && (
                                    <div 
                                        ref={loadMoreRef} 
                                        className="col-span-full py-12 flex justify-center w-full cursor-pointer"
                                        onClick={() => setVisibleCount(prev => prev + 12)}
                                    >
                                        <div className="flex items-center gap-2 text-slate-400 bg-white/50 px-4 py-2 rounded-full border border-slate-100 shadow-sm hover:bg-white hover:text-slate-600 transition-colors">
                                            <Loader2 className="w-4 h-4 animate-spin" />
                                            <span className="text-[10px] font-black uppercase tracking-widest">Loading Roster...</span>
                                        </div>
                                    </div>
                                )}
                            </motion.div>
                        ) : (
                            <motion.div 
                                key="gallery"
                                initial={{ opacity: 0, x: 20 }} 
                                animate={{ opacity: 1, x: 0 }} 
                                exit={{ opacity: 0, x: -20 }}
                                className="w-full overflow-x-auto overflow-y-hidden pb-12 pt-4 px-6 md:px-[calc(50%-190px)] snap-x snap-mandatory flex gap-6 no-scrollbar items-center"
                            >
                                {visibleMembers.map((member) => (
                                    <div 
                                        key={member.id} 
                                        className="snap-center shrink-0 w-[85vw] md:w-[380px] h-[500px] md:h-[550px] relative perspective-1000 group transition-transform duration-500 hover:scale-105"
                                        data-team-card-id={member.id} 
                                    >
                                        <div className="absolute -inset-4 bg-gradient-to-b from-slate-200/50 to-transparent rounded-[40px] -z-10 opacity-0 group-hover:opacity-100 transition-opacity" />
                                        <TeamCard 
                                            member={member} 
                                            onClick={handleMemberClick} 
                                            onAssignClick={openRecruitment}
                                            onDragStart={() => setMemberDraggingId(member.id)} 
                                            onDragEnd={(e, info) => handleMemberDragEnd(e, info, member)} 
                                            isDragging={memberDraggingId === member.id} 
                                            isDropTarget={!!activeLeaderId}
                                            isWaitingForMentor={recipientMemberId === member.id}
                                        />
                                        
                                        <div className="absolute -bottom-8 left-1/2 -translate-x-1/2 flex items-center gap-2 text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">
                                            <ScanFace className="w-4 h-4" />
                                            <span className="text-[9px] font-black uppercase tracking-widest">View Profile</span>
                                        </div>
                                    </div>
                                ))}
                                
                                <div className="snap-center shrink-0 w-[10vw]" />
                            </motion.div>
                        )}
                    </AnimatePresence>
                </LayoutGroup>
            </div>

            <div className="md:hidden fixed bottom-28 left-0 right-0 z-40 flex items-center pointer-events-none justify-center px-4">
                <motion.div initial={{ y: 20, opacity: 0 }} animate={{ y: 0, opacity: 1 }} transition={{ delay: 0.2 }} className="pointer-events-auto w-full max-w-sm">
                    <ControlBar />
                </motion.div>
            </div>

            <TrainerRecruitmentModal 
                isOpen={isTrainerPanelOpen} 
                onClose={() => { 
                    setIsTrainerPanelOpen(false); 
                    setActiveLeaderId(null); 
                    setRecipientMemberId(null); 
                }} 
                onSelectLeader={handleSelectLeader}
                selectedLeaderId={activeLeaderId}
            />
            
            <AnimatePresence>{assignmentMember && <UnitAssignmentModal member={assignmentMember} onAssign={handleUnitAssign} onClose={() => setAssignmentMember(null)} />}</AnimatePresence>
            <AnimatePresence>{memberDraggingId && <PromotionHUD draggingMember={team.find(m => m.id === memberDraggingId)} onPromote={handlePromoteMember} />}</AnimatePresence>
            <AnimatePresence>{selectedMember && <MemberDetailSheet member={selectedMember} activeTab={activeTab} setActiveTab={setActiveTab} onClose={() => setSelectedMemberId(null)} />}</AnimatePresence>
        </div>
    );
}
--- FILE: ./app/(main)/layout.tsx ---
import DynamicHeader from "@/components/core/DynamicHeader";
// We removed import Sidebar from "@/components/core/Sidebar";

export default function MainLayout({ children }: { children: React.ReactNode }) {
  return (
    <div className="min-h-screen bg-slate-50 flex flex-col">
      {/* 1. Top: The Dynamic Island Header 
      */}
      <DynamicHeader />
      
      {/* 2. Main Content Area 
        - Removed <Sidebar />
        - Removed lg:pl-64 (Sidebar offset)
        - Added w-full to ensure it spans the screen
        - Adjusted pt-12 to give breathing room below the floating header
      */}
      <main className="flex-1 w-full pt-12 transition-all duration-300">
        <div className="max-w-[1800px] mx-auto p-4 md:p-8">
          {children}
        </div>
      </main>
    </div>
  );
}
--- FILE: ./app/(main)/certifications/_components/CertificationsDynamicIsland.tsx ---
"use client";

import { motion, AnimatePresence, useDragControls, Transition, PanInfo } from "framer-motion";
import { 
  Award, Trophy, ChevronDown, ChevronUp, Plus, Star 
} from "lucide-react";
import { cn } from "@/lib/utils";
import { TACTICAL_ICONS } from "@/lib/icon-library";

// --- CONSTANTS ---
const SPRING_TRANSITION: Transition = { 
    type: "spring", 
    stiffness: 500, 
    damping: 30, 
    mass: 1 
};

// --- LOCAL DRAGGABLE BADGE COMPONENT ---
const DraggableInventoryBadge = ({ badge, onDragStart, onDrag, onDragEnd }: any) => {
    const IconComp = TACTICAL_ICONS.find(i => i.id === badge.iconId)?.icon || Star;
    const controls = useDragControls();

    return (
        <motion.div
            drag
            dragControls={controls}
            dragListener={false}
            dragSnapToOrigin
            dragElastic={0.1}
            whileHover={{ scale: 1.05, y: -2 }}
            whileDrag={{ scale: 1.2, zIndex: 9999, cursor: "grabbing", pointerEvents: "none" }}
            onDragStart={onDragStart}
            onDrag={onDrag} // Pass drag event up
            onDragEnd={onDragEnd}
            className="group relative flex flex-col items-center gap-2 cursor-grab touch-none shrink-0"
        >
            <div 
                onPointerDown={(e) => controls.start(e)}
                className="h-14 w-14 rounded-2xl flex items-center justify-center shadow-sm border border-slate-100 bg-white relative overflow-hidden transition-shadow group-hover:shadow-md group-hover:border-[#004F71]/30"
            >
                <div className="absolute inset-0 opacity-10" style={{ backgroundColor: badge.hex }} />
                <IconComp className="w-6 h-6 relative z-10 transition-transform group-hover:scale-110" style={{ color: badge.hex }} />
            </div>
            <span className="text-[9px] font-bold text-slate-500 uppercase tracking-tight max-w-[60px] truncate text-center leading-none">
                {badge.label}
            </span>
        </motion.div>
    );
};

interface Props {
    activeView: "armory" | "eotm";
    setActiveView: (v: "armory" | "eotm") => void;
    isExpanded: boolean;
    setIsExpanded: (v: boolean) => void;
    badges: any[];
    onOpenForge: () => void;
    onDragStart: (id?: string) => void;
    onDrag: (e: any, info: PanInfo) => void; // New Prop
    onDragEnd: (e: any, info: any, badge: any) => void;
}

export default function CertificationsDynamicIsland({
    activeView, setActiveView, isExpanded, setIsExpanded,
    badges, onOpenForge, onDragStart, onDrag, onDragEnd
}: Props) {

    return (
        <div className="fixed top-24 md:top-28 left-0 right-0 z-[90] flex justify-center pointer-events-none px-4">
            <motion.div 
                layout
                transition={SPRING_TRANSITION}
                className={cn(
                    "pointer-events-auto bg-white/95 backdrop-blur-2xl border border-slate-200/80 shadow-[0_20px_50px_-12px_rgba(0,0,0,0.2)] rounded-[32px] flex flex-col overflow-hidden ring-1 ring-black/5",
                    isExpanded && activeView === 'armory' ? "w-[94vw] md:w-[600px]" : "w-fit"
                )}
            >
                {/* --- MAIN PILL HEADER --- */}
                <motion.div layout="position" className="flex items-center justify-between p-1.5 gap-1.5">
                    
                    <div className="flex items-center gap-1.5">
                        {/* ARMORY TAB */}
                        <button 
                            onClick={() => { setActiveView("armory"); setIsExpanded(false); }}
                            className={cn(
                                "flex items-center gap-2 px-5 py-3 rounded-full text-[10px] font-black uppercase tracking-widest transition-colors",
                                activeView === "armory" 
                                    ? "bg-[#004F71] text-white shadow-lg shadow-blue-900/20" 
                                    : "text-slate-400 hover:text-slate-600 hover:bg-slate-50"
                            )}
                        >
                            <Award className="w-4 h-4" /> <span className="hidden md:inline">Armory</span>
                        </button>

                        {/* RECOGNITION TAB */}
                        <button 
                            onClick={() => { setActiveView("eotm"); setIsExpanded(false); }}
                            className={cn(
                                "flex items-center gap-2 px-5 py-3 rounded-full text-[10px] font-black uppercase tracking-widest transition-colors",
                                activeView === "eotm" 
                                    ? "bg-[#E51636] text-white shadow-lg shadow-red-900/20" 
                                    : "text-slate-400 hover:text-slate-600 hover:bg-slate-50"
                            )}
                        >
                            <Trophy className="w-4 h-4" /> <span className="hidden md:inline">Recognition</span>
                        </button>
                    </div>
                    
                    {/* TOGGLE BUTTON */}
                    {activeView === 'armory' && (
                        <div className="flex items-center">
                            <div className="h-6 w-px bg-slate-200 mx-1 md:mx-2" />
                            <button 
                                onClick={() => setIsExpanded(!isExpanded)}
                                className={cn(
                                    "flex items-center justify-center gap-2 h-10 px-4 md:px-5 rounded-full text-[10px] font-black uppercase tracking-widest transition-colors border",
                                    isExpanded 
                                        ? "bg-slate-100 text-slate-600 border-slate-200" 
                                        : "bg-white text-slate-500 border-transparent hover:bg-slate-50"
                                )}
                            >
                                 <span className="hidden md:inline">{isExpanded ? "Close" : "Inventory"}</span>
                                 {isExpanded ? <ChevronUp className="w-4 h-4" /> : <ChevronDown className="w-4 h-4" />}
                            </button>
                        </div>
                    )}
                </motion.div>

                {/* --- EXPANDABLE INVENTORY --- */}
                <AnimatePresence mode="popLayout">
                    {isExpanded && activeView === 'armory' && (
                        <motion.div 
                            initial={{ height: 0, opacity: 0 }}
                            animate={{ height: "auto", opacity: 1 }}
                            exit={{ height: 0, opacity: 0 }}
                            transition={{ ...SPRING_TRANSITION, opacity: { duration: 0.2 } }}
                            className="border-t border-slate-100 bg-slate-50/50"
                        >
                            <div className="p-5 md:p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <div className="flex items-center gap-3">
                                        <div className="p-2 bg-[#004F71] text-white rounded-xl shadow-md">
                                            <Award className="w-4 h-4" />
                                        </div>
                                        <div className="flex flex-col">
                                            <h4 className="text-xs font-black uppercase tracking-widest text-slate-800">Badge Inventory</h4>
                                            <p className="text-[9px] text-slate-400 font-bold uppercase tracking-wider">Drag to Assign</p>
                                        </div>
                                    </div>
                                    
                                    <button 
                                        onClick={onOpenForge} 
                                        className="group flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-xl hover:border-[#E51636] hover:text-[#E51636] transition-all shadow-sm active:scale-95"
                                    >
                                        <Plus className="w-4 h-4" />
                                        <span className="text-[9px] font-black uppercase tracking-widest text-slate-500 group-hover:text-[#E51636]">New</span>
                                    </button>
                                </div>
                                
                                <div className="flex flex-wrap gap-3 md:gap-4 max-h-[35vh] overflow-y-auto custom-scrollbar p-1 pb-4">
                                    {badges.map(badge => (
                                        <DraggableInventoryBadge 
                                            key={badge.id}
                                            badge={badge}
                                            onDragStart={() => { onDragStart(); setIsExpanded(true); }}
                                            onDrag={(e: any, info: any) => onDrag(e, info)}
                                            onDragEnd={(e: any, info: any) => onDragEnd(e, info, badge)}
                                        />
                                    ))}
                                    {badges.length === 0 && (
                                        <div className="w-full py-10 text-center flex flex-col items-center justify-center text-slate-400 border-2 border-dashed border-slate-200 rounded-2xl bg-slate-50/50">
                                            <Award className="w-8 h-8 mb-2 opacity-20" />
                                            <span className="text-[10px] font-black uppercase tracking-widest">Inventory Empty</span>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </motion.div>
                    )}
                </AnimatePresence>
            </motion.div>
        </div>
    );
}
--- FILE: ./app/(main)/certifications/_components/ForgeModal.tsx ---
"use client";

import { useState, useEffect } from "react";
import { motion, useDragControls, PanInfo, Variants } from "framer-motion";
import { 
  X, Trash2, Fingerprint, Sparkles, Check, 
  PaintBucket, LayoutGrid, PenLine 
} from "lucide-react";
import { cn } from "@/lib/utils";
import { TACTICAL_ICONS } from "@/lib/icon-library";
import ClientPortal from "@/components/core/ClientPortal";

// PRESETS
const PRESET_COLORS = [
    { id: "red", hex: "#E51636" }, 
    { id: "navy", hex: "#004F71" },
    { id: "emerald", hex: "#10b981" }, 
    { id: "amber", hex: "#f59e0b" },
    { id: "violet", hex: "#8b5cf6" }, 
    { id: "rose", hex: "#f43f5e" },
    { id: "cyan", hex: "#06b6d4" }, 
    { id: "slate", hex: "#475569" },
];

interface ForgeProps {
    isOpen: boolean;
    onClose: () => void;
    draft: any;
    setDraft: (d: any) => void;
    onSave: () => void;
    onDelete?: (id: string) => void;
    editingId?: string | null;
}

export default function ForgeModal({ 
    isOpen, onClose, draft, setDraft, onSave, onDelete, editingId 
}: ForgeProps) {
    
    const [isMobile, setIsMobile] = useState(false);
    const dragControls = useDragControls();

    useEffect(() => {
        const checkMobile = () => setIsMobile(window.innerWidth < 768);
        checkMobile();
        window.addEventListener('resize', checkMobile);
        return () => window.removeEventListener('resize', checkMobile);
    }, []);

    const CurrentIcon = TACTICAL_ICONS.find(i => i.id === draft.iconId)?.icon || Sparkles;

    const variants: Variants = {
        mobileHidden: { y: "100%" },
        mobileVisible: { y: 0, transition: { type: "spring", damping: 25, stiffness: 300 } },
        desktopHidden: { opacity: 0, scale: 0.95, y: 20 },
        desktopVisible: { opacity: 1, scale: 1, y: 0, transition: { type: "spring", duration: 0.5 } }
    };

    return (
        <ClientPortal>
            <div className={cn(
                "fixed inset-0 z-[200] flex justify-center pointer-events-none",
                isMobile ? "items-end" : "items-center p-4"
            )}>
                <motion.div 
                    initial={{ opacity: 0 }} 
                    animate={{ opacity: 1 }} 
                    exit={{ opacity: 0 }} 
                    onClick={onClose}
                    className="absolute inset-0 bg-[#0F172A]/80 backdrop-blur-xl pointer-events-auto"
                />

                <motion.div 
                    variants={variants}
                    initial={isMobile ? "mobileHidden" : "desktopHidden"}
                    animate={isMobile ? "mobileVisible" : "desktopVisible"}
                    exit={isMobile ? "mobileHidden" : "desktopHidden"}
                    drag={isMobile ? "y" : false}
                    dragControls={dragControls}
                    dragListener={false}
                    dragConstraints={{ top: 0, bottom: 0 }}
                    dragElastic={0.05}
                    onDragEnd={(_, info: PanInfo) => { if (isMobile && info.offset.y > 100) onClose(); }}
                    className={cn(
                        "relative bg-white shadow-2xl flex flex-col md:flex-row pointer-events-auto overflow-hidden",
                        "w-full h-[92vh] rounded-t-[40px]", // Mobile
                        "md:w-full md:max-w-5xl md:h-[650px] md:rounded-[48px] md:border md:border-white/40 md:ring-1 md:ring-black/5" // Desktop
                    )}
                >
                    {/* --- GLOBAL CLOSE BUTTON (Mobile & Desktop) --- */}
                    <button 
                        onClick={onClose} 
                        className="absolute top-6 right-6 z-[60] p-2 bg-white/50 hover:bg-slate-100 backdrop-blur-md rounded-full text-slate-500 transition-colors md:top-8 md:right-8"
                    >
                        <X className="w-6 h-6" />
                    </button>

                    {/* --- MOBILE DRAG HANDLE --- */}
                    <div 
                        className="md:hidden absolute top-0 left-0 right-0 h-12 flex justify-center items-center z-50 cursor-grab active:cursor-grabbing touch-none"
                        onPointerDown={(e) => dragControls.start(e)}
                    >
                        <div className="w-12 h-1.5 bg-slate-300 rounded-full opacity-50" />
                    </div>

                    {/* --- LEFT COLUMN: THE ARTIFACT STAGE --- */}
                    <div className="w-full md:w-[45%] relative flex flex-col items-center justify-center p-8 pt-16 md:p-12 bg-slate-50 border-b md:border-b-0 md:border-r border-slate-100 overflow-hidden shrink-0">
                        
                        <motion.div 
                            animate={{ backgroundColor: draft.hex }}
                            className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[150%] h-[150%] blur-[100px] opacity-15 pointer-events-none transition-colors duration-700"
                        />
                        <div className="absolute inset-0 bg-[radial-gradient(#cbd5e1_1px,transparent_1px)] [background-size:24px_24px] opacity-40 pointer-events-none" />

                        {/* PREVIEW */}
                        <div className="relative z-10 flex flex-col items-center w-full">
                            <motion.div 
                                layoutId="preview-badge"
                                className="w-32 h-32 md:w-40 md:h-40 rounded-[32px] md:rounded-[40px] flex items-center justify-center shadow-[0_30px_60px_-15px_rgba(0,0,0,0.2)] transition-all duration-500 relative group"
                                style={{ 
                                    backgroundColor: draft.hex,
                                    boxShadow: `0 20px 60px -10px ${draft.hex}60`
                                }}
                            >
                                <div className="absolute inset-0 bg-gradient-to-tr from-white/20 to-transparent rounded-[32px] md:rounded-[40px] border border-white/20" />
                                <CurrentIcon className="w-16 h-16 md:w-20 md:h-20 text-white drop-shadow-lg relative z-10 transform group-hover:scale-110 transition-transform duration-300" />
                            </motion.div>

                            <div className="mt-8 md:mt-12 w-full relative group/input text-center">
                                <label className="block text-[9px] md:text-[10px] font-black uppercase tracking-[0.3em] text-slate-400 mb-2 group-focus-within/input:text-[#004F71] transition-colors">
                                    Module Designation
                                </label>
                                <div className="relative flex items-center justify-center">
                                    <input 
                                        value={draft.label}
                                        onChange={(e) => setDraft({...draft, label: e.target.value})}
                                        placeholder="UNTITLED"
                                        className="w-full text-center text-2xl md:text-3xl font-[1000] text-slate-900 placeholder:text-slate-200 bg-transparent outline-none uppercase tracking-tighter transition-all"
                                        maxLength={20}
                                        autoFocus={!editingId && !isMobile} 
                                    />
                                    <PenLine className="absolute right-4 md:right-8 w-4 h-4 md:w-5 md:h-5 text-slate-200 opacity-0 group-hover/input:opacity-100 transition-opacity pointer-events-none" />
                                </div>
                                <div className="h-1 w-8 bg-slate-200 rounded-full mx-auto mt-2 group-focus-within/input:w-16 group-focus-within/input:bg-[#004F71] transition-all duration-300" />
                            </div>
                        </div>

                        {/* DELETE ACTION (Fixed Z-Index) */}
                        {editingId && onDelete && (
                            <button 
                                onClick={() => onDelete(editingId)}
                                className="absolute top-6 left-6 p-3 rounded-full text-slate-300 hover:bg-rose-50 hover:text-rose-500 transition-all active:scale-90 z-[70]"
                                title="Delete Module"
                            >
                                <Trash2 className="w-6 h-6" />
                            </button>
                        )}
                    </div>

                    {/* --- RIGHT COLUMN: CONTROLS --- */}
                    <div className="flex-1 flex flex-col min-h-0 bg-white relative">
                        
                        {/* Desktop Header Text (Only visible on desktop now) */}
                        <div className="hidden md:flex px-8 py-8 justify-between items-start shrink-0">
                            <div>
                                <h2 className="text-2xl font-[1000] text-slate-900 tracking-tighter">Forge Module</h2>
                                <p className="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">
                                    Configure parameters & identity
                                </p>
                            </div>
                        </div>

                        {/* Scrollable Controls */}
                        <div className="flex-1 overflow-y-auto custom-scrollbar px-6 py-6 md:px-8 md:pb-32 space-y-10">
                            
                            {/* COLOR DNA */}
                            <section>
                                <div className="flex items-center gap-2 mb-4">
                                    <PaintBucket className="w-4 h-4 text-[#004F71]" />
                                    <span className="text-[10px] font-black uppercase tracking-[0.2em] text-slate-400">Color DNA</span>
                                </div>
                                <div className="space-y-4">
                                    <div className="flex flex-wrap gap-3">
                                        {PRESET_COLORS.map((c) => (
                                            <button 
                                                key={c.id} 
                                                onClick={() => setDraft({...draft, hex: c.hex})} 
                                                className={cn(
                                                    "w-10 h-10 md:w-12 md:h-12 rounded-2xl transition-all relative flex items-center justify-center border-2 border-transparent",
                                                    draft.hex === c.hex 
                                                        ? "scale-110 shadow-lg shadow-black/5 ring-2 ring-offset-2 ring-slate-900" 
                                                        : "hover:scale-105 hover:border-slate-100"
                                                )}
                                                style={{ backgroundColor: c.hex }}
                                            >
                                                {draft.hex === c.hex && (
                                                    <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }}>
                                                        <Check className="w-5 h-5 md:w-6 md:h-6 text-white drop-shadow-md" strokeWidth={3} />
                                                    </motion.div>
                                                )}
                                            </button>
                                        ))}
                                    </div>
                                    <div className="pt-1">
                                        <div className="h-3 rounded-full w-full bg-gradient-to-r from-red-500 via-green-500 to-blue-500 p-[2px] shadow-inner">
                                            <input 
                                                type="range" 
                                                min="0" max="360" 
                                                onChange={(e) => setDraft({...draft, hex: `hsl(${e.target.value}, 75%, 50%)`})} 
                                                className="w-full h-full opacity-0 cursor-pointer"
                                            />
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* ICONOGRAPHY */}
                            <section className="pb-24 md:pb-0">
                                <div className="flex items-center gap-2 mb-4">
                                    <LayoutGrid className="w-4 h-4 text-[#004F71]" />
                                    <span className="text-[10px] font-black uppercase tracking-[0.2em] text-slate-400">Iconography</span>
                                </div>
                                <div className="space-y-6">
                                    {["Achievement", "Hospitality", "BOH", "Operational", "Creative"].map((cat) => (
                                        <div key={cat}>
                                            <div className="flex items-center gap-3 mb-3">
                                                <div className="h-px flex-1 bg-slate-100" />
                                                <span className="text-[8px] md:text-[9px] font-bold text-slate-300 uppercase tracking-widest">{cat}</span>
                                                <div className="h-px flex-1 bg-slate-100" />
                                            </div>
                                            <div className="grid grid-cols-5 sm:grid-cols-6 lg:grid-cols-7 gap-2 md:gap-3">
                                                {TACTICAL_ICONS.filter(i => i.category === cat).map((item) => (
                                                    <button 
                                                        key={item.id} 
                                                        onClick={() => setDraft({...draft, iconId: item.id})} 
                                                        className={cn(
                                                            "aspect-square rounded-xl md:rounded-2xl flex items-center justify-center transition-all duration-300 group relative border",
                                                            draft.iconId === item.id 
                                                                ? "bg-slate-900 text-white shadow-xl scale-110 border-slate-900 z-10" 
                                                                : "bg-white text-slate-400 hover:bg-slate-50 border-slate-100 hover:border-slate-200"
                                                        )}
                                                    >
                                                        <item.icon className="w-4 h-4 md:w-5 md:h-5 transition-transform group-hover:scale-110" />
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </section>
                        </div>

                        {/* Sticky Action Footer */}
                        <div className="absolute bottom-0 left-0 right-0 p-6 md:p-8 bg-gradient-to-t from-white via-white/95 to-transparent z-20">
                             <button 
                                onClick={onSave}
                                className="w-full py-4 md:py-5 rounded-2xl text-white font-[900] text-xs md:text-sm uppercase tracking-[0.25em] shadow-[0_20px_40px_-10px_rgba(0,0,0,0.3)] hover:scale-[1.01] active:scale-95 transition-all flex items-center justify-center gap-3 group"
                                style={{ backgroundColor: draft.hex }}
                             >
                                 <Fingerprint className="w-5 h-5 group-hover:scale-110 transition-transform" />
                                 {editingId ? "Update Protocol" : "Fabricate Module"}
                             </button>
                        </div>
                    </div>
                </motion.div>
            </div>
        </ClientPortal>
    );
}
--- FILE: ./app/(main)/certifications/_components/EOTMView.tsx ---
"use client";

import { useState, useMemo, useEffect } from "react";
import { motion, AnimatePresence, useDragControls, PanInfo, Variants } from "framer-motion";
import { 
  Trophy, Crown, Flame, Coffee, Vote, History, 
  Calendar, ChevronRight, User, Sparkles, Star, Search, X, Gavel, AlertTriangle
} from "lucide-react";
import { cn } from "@/lib/utils";
import { TeamMember } from "../../calendar/_components/types";
import { format } from "date-fns";
import { useAppStore } from "@/lib/store/useStore";
import { addDoc, collection, serverTimestamp, query, where, onSnapshot, orderBy, doc, setDoc, writeBatch, arrayUnion } from "firebase/firestore";
import { db } from "@/lib/firebase";
import toast from "react-hot-toast";
import ClientPortal from "@/components/core/ClientPortal";

// --- STANDARD EOTM BADGE TEMPLATE ---
const EOTM_BADGE = {
    label: "Employee of the Month",
    iconId: "Trophy", // Matches icon-library ID
    hex: "#f59e0b",   // Gold/Amber color
    desc: "Recognized for outstanding performance."
};

export default function EOTMView() {
    const { team, currentUser } = useAppStore();
    const [votingDept, setVotingDept] = useState<"FOH" | "BOH" | null>(null);
    const [searchQuery, setSearchQuery] = useState("");
    
    // DATA STATES
    const [votes, setVotes] = useState<any[]>([]);
    const [history, setHistory] = useState<any[]>([]);
    
    // CONFIRMATION STATE
    const [isConfirmingFinalize, setIsConfirmingFinalize] = useState(false);

    const currentMonthKey = format(new Date(), "yyyy-MM");
    const [isMobile, setIsMobile] = useState(false);
    const dragControls = useDragControls();

    const isAdmin = currentUser?.role === "Director" || currentUser?.role === "Assistant Director";

    useEffect(() => {
        const checkMobile = () => setIsMobile(window.innerWidth < 768);
        checkMobile();
        window.addEventListener('resize', checkMobile);
        return () => window.removeEventListener('resize', checkMobile);
    }, []);

    // --- SUBSCRIPTIONS ---
    useEffect(() => {
        const q = query(collection(db, "eotm_votes"), where("month", "==", currentMonthKey));
        const unsubscribe = onSnapshot(q, (snapshot) => {
            setVotes(snapshot.docs.map(doc => doc.data()));
        });
        return () => unsubscribe();
    }, [currentMonthKey]);

    useEffect(() => {
        const q = query(collection(db, "eotm_winners"), orderBy("monthId", "desc"));
        const unsubscribe = onSnapshot(q, (snapshot) => {
            setHistory(snapshot.docs.map(doc => doc.data()));
        });
        return () => unsubscribe();
    }, []);

    // --- LOGIC ---
    const leaders = useMemo(() => {
        const getLeader = (dept: "FOH" | "BOH") => {
            const deptVotes = votes.filter(v => v.dept === dept);
            if (deptVotes.length === 0) return null;
            const counts: Record<string, number> = {};
            deptVotes.forEach(v => { counts[v.candidateId] = (counts[v.candidateId] || 0) + 1; });
            const topId = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
            const member = team.find(m => m.id === topId);
            return member ? { ...member, voteCount: counts[topId] } : null;
        };
        return { foh: getLeader("FOH"), boh: getLeader("BOH") };
    }, [votes, team]);

    // --- EXECUTE FINALIZE (UPDATED) ---
    const executeFinalize = async () => {
        setIsConfirmingFinalize(false); // Close modal
        const loadToast = toast.loading("Tabulating results & Awarding Badges...");
        
        try {
            const fohWinner = leaders.foh 
                ? { name: leaders.foh.name, id: leaders.foh.id, image: leaders.foh.image || "" } 
                : { name: "No Selection", id: "null", image: "" };
                
            const bohWinner = leaders.boh 
                ? { name: leaders.boh.name, id: leaders.boh.id, image: leaders.boh.image || "" } 
                : { name: "No Selection", id: "null", image: "" };

            const historyData = {
                monthId: currentMonthKey,
                displayDate: format(new Date(), "MMMM yyyy"),
                foh: fohWinner,
                boh: bohWinner,
                totalVotes: votes.length,
                finalizedAt: serverTimestamp()
            };

            const batch = writeBatch(db);

            // 1. Commit to History
            const historyRef = doc(db, "eotm_winners", currentMonthKey);
            batch.set(historyRef, historyData);

            // 2. AWARD BADGES TO WINNERS & CREATE INDIVIDUAL LOGS
            
            // FOH Winner
            if (leaders.foh) {
                const fohRef = doc(db, "profileOverrides", leaders.foh.id);
                const badge = { 
                    ...EOTM_BADGE, 
                    id: Math.random().toString(36).substr(2, 9),
                    awardedId: Math.random().toString(36).substr(2, 9),
                    timestamp: new Date().toISOString(),
                    desc: `Employee of the Month - ${format(new Date(), "MMMM yyyy")}`
                };
                batch.set(fohRef, { badges: arrayUnion(badge), updatedAt: serverTimestamp() }, { merge: true });

                // Create dedicated log for FOH Winner's Profile
                const fohEventRef = doc(collection(db, "events"));
                batch.set(fohEventRef, {
                    title: `EOTM Winner: ${format(new Date(), "MMM")}`,
                    type: "Award",
                    status: "Done",
                    priority: "High",
                    startDate: new Date(),
                    endDate: new Date(),
                    assignee: "System",
                    assigneeName: "Command",
                    teamMemberId: leaders.foh.id, // LINK TO MEMBER
                    teamMemberName: leaders.foh.name,
                    description: `[OFFICIAL RECOGNITION]\nAwarded Front of House Employee of the Month for ${format(new Date(), "MMMM")}.`,
                    createdAt: serverTimestamp()
                });
            }

            // BOH Winner
            if (leaders.boh) {
                const bohRef = doc(db, "profileOverrides", leaders.boh.id);
                const badge = { 
                    ...EOTM_BADGE, 
                    id: Math.random().toString(36).substr(2, 9),
                    awardedId: Math.random().toString(36).substr(2, 9),
                    timestamp: new Date().toISOString(),
                    desc: `Employee of the Month - ${format(new Date(), "MMMM yyyy")}`
                };
                batch.set(bohRef, { badges: arrayUnion(badge), updatedAt: serverTimestamp() }, { merge: true });

                // Create dedicated log for BOH Winner's Profile
                const bohEventRef = doc(collection(db, "events"));
                batch.set(bohEventRef, {
                    title: `EOTM Winner: ${format(new Date(), "MMM")}`,
                    type: "Award",
                    status: "Done",
                    priority: "High",
                    startDate: new Date(),
                    endDate: new Date(),
                    assignee: "System",
                    assigneeName: "Command",
                    teamMemberId: leaders.boh.id, // LINK TO MEMBER
                    teamMemberName: leaders.boh.name,
                    description: `[OFFICIAL RECOGNITION]\nAwarded Back of House Employee of the Month for ${format(new Date(), "MMMM")}.`,
                    createdAt: serverTimestamp()
                });
            }

            // 3. Create Global Announcement Log (For Dashboard)
            const globalEventRef = doc(collection(db, "events"));
            batch.set(globalEventRef, {
                title: `EOTM Winners: ${format(new Date(), "MMM")}`,
                type: "Award",
                status: "Done",
                priority: "High", 
                startDate: new Date(),
                endDate: new Date(),
                assignee: "System",
                assigneeName: "Command",
                description: `[OFFICIAL ANNOUNCEMENT]\nThe voting cycle for ${format(new Date(), "MMMM")} is complete.\n\n🏆 FOH Winner: ${fohWinner.name}\n🏆 BOH Winner: ${bohWinner.name}\n\nTotal engagement: ${votes.length} votes cast.`,
                createdAt: serverTimestamp()
            });

            await batch.commit();

            toast.success("Cycle Finalized & Badges Awarded", { id: loadToast });
        } catch (e) {
            console.error(e);
            toast.error("Failed to finalize cycle", { id: loadToast });
        }
    };

    const hasVotedFOH = useMemo(() => votes.some(v => v.voterId === currentUser?.uid && v.dept === "FOH"), [votes, currentUser]);
    const hasVotedBOH = useMemo(() => votes.some(v => v.voterId === currentUser?.uid && v.dept === "BOH"), [votes, currentUser]);

    const eligibleCandidates = useMemo(() => {
        if (!votingDept) return [];
        const deptVotes = votes.filter(v => v.dept === votingDept);
        const counts: Record<string, number> = {};
        deptVotes.forEach(v => { counts[v.candidateId] = (counts[v.candidateId] || 0) + 1; });
        const maxVotes = Math.max(...Object.values(counts), 1); 

        return team
            .filter(m => m.dept === votingDept && m.name.toLowerCase().includes(searchQuery.toLowerCase()))
            .map(m => ({
                ...m,
                voteCount: counts[m.id] || 0,
                votePercent: ((counts[m.id] || 0) / maxVotes) * 100
            }))
            .sort((a, b) => b.voteCount - a.voteCount);
    }, [team, votingDept, searchQuery, votes]);

    const handleVote = async (candidateId: string, candidateName: string, dept: string) => {
        const alreadyVoted = votes.some(v => v.voterId === currentUser?.uid && v.dept === dept);
        if (alreadyVoted) return toast.error(`You already voted for ${dept}.`);

        const loadToast = toast.loading("Casting Vote...");
        try {
            // 1. Record the Vote
            await addDoc(collection(db, "eotm_votes"), {
                voterId: currentUser?.uid || "anon",
                candidateId,
                candidateName,
                dept,
                month: currentMonthKey,
                timestamp: serverTimestamp()
            });

            // 2. INTELLIGENT EVENT LOGGING (Low Priority)
            // This creates background "chatter" in the live feed showing activity
            await addDoc(collection(db, "events"), {
                title: `${dept} Vote Cast`,
                type: "Vote",
                status: "Done",
                priority: "Low", // Low priority keeps it subtle
                startDate: new Date(),
                endDate: new Date(),
                assignee: "System",
                assigneeName: "Anonymous",
                // Linking teamMemberId allows this to show up on the Candidate's profile feed too!
                teamMemberId: candidateId,
                teamMemberName: candidateName,
                description: `A vote was cast for ${candidateName} in the ${format(new Date(), 'MMMM')} EOTM cycle.`,
                createdAt: serverTimestamp()
            });

            toast.success("Vote Recorded", { id: loadToast });
            setVotingDept(null);
        } catch (e) {
            toast.error("Voting Failed", { id: loadToast });
        }
    };

    const modalVariants: Variants = {
        mobileHidden: { y: "100%" },
        mobileVisible: { y: 0, transition: { type: "spring", damping: 25, stiffness: 300 } },
        desktopHidden: { opacity: 0, scale: 0.95, y: 20 },
        desktopVisible: { opacity: 1, scale: 1, y: 0, transition: { type: "spring", duration: 0.5 } }
    };

    return (
        <div className="space-y-8 md:space-y-12 animate-fade-in pb-40 md:pb-20 relative">
            
            {/* --- HERO SECTION --- */}
            <section className="relative pt-4 md:pt-8">
                <div className="absolute top-1/2 left-0 md:left-1/4 w-32 md:w-96 h-32 md:h-96 bg-[#004F71]/10 blur-[80px] md:blur-[120px] rounded-full mix-blend-multiply pointer-events-none" />
                <div className="absolute top-1/2 right-0 md:right-1/4 w-32 md:w-96 h-32 md:h-96 bg-[#E51636]/10 blur-[80px] md:blur-[120px] rounded-full mix-blend-multiply pointer-events-none" />

                <div className="text-center mb-6 md:mb-12 relative z-10 px-4">
                    <div className="inline-flex items-center gap-2 px-3 py-1.5 bg-white border border-slate-200 rounded-full shadow-sm mb-3 md:mb-6">
                        <Calendar className="w-3.5 h-3.5 text-slate-400" />
                        <span className="text-[9px] md:text-[10px] font-black uppercase tracking-widest text-slate-500">
                            Current Cycle: {format(new Date(), "MMMM yyyy")}
                        </span>
                        {/* ADMIN CONTROL: FINALIZE BUTTON */}
                        {isAdmin && (
                            <>
                                <div className="w-px h-3 bg-slate-300 mx-1" />
                                <button 
                                    onClick={() => setIsConfirmingFinalize(true)} // Open Custom Modal
                                    className="flex items-center gap-1.5 text-[9px] font-black uppercase tracking-widest text-amber-600 hover:text-amber-700 transition-colors"
                                >
                                    <Gavel className="w-3 h-3" /> Finalize
                                </button>
                            </>
                        )}
                    </div>
                    <h2 className="text-3xl md:text-6xl font-[1000] text-slate-900 tracking-tighter uppercase leading-none mb-2 md:mb-4">
                        Employee <span className="hidden md:inline">of the Month</span><span className="md:hidden">Awards</span>
                    </h2>
                    <p className="text-slate-500 font-medium text-[10px] md:text-base max-w-lg mx-auto leading-relaxed">
                        Total Votes Cast: <span className="text-slate-900 font-black">{votes.length}</span>
                    </p>
                </div>

                {/* ... CARDS GRID (Unchanged) ... */}
                <div className="grid grid-cols-2 gap-3 md:gap-8 max-w-5xl mx-auto relative z-10 px-3 md:px-4 pb-4">
                    {/* FOH CARD */}
                    <motion.div whileHover={{ y: -4 }} className="relative group rounded-[24px] md:rounded-[40px] overflow-hidden bg-white border border-slate-100 shadow-sm hover:shadow-xl hover:border-[#004F71]/30 transition-all duration-300">
                        <div className="absolute top-0 left-0 right-0 h-24 md:h-40 bg-gradient-to-b from-[#004F71]/5 to-transparent" />
                        <div className="relative p-4 md:p-10 flex flex-col items-center text-center h-full">
                            <div className="w-12 h-12 md:w-24 md:h-24 bg-[#004F71] text-white rounded-[16px] md:rounded-[28px] flex items-center justify-center shadow-lg shadow-blue-900/20 mb-3 md:mb-8 rotate-3 group-hover:rotate-6 transition-transform duration-500">
                                <Coffee className="w-5 h-5 md:w-10 md:h-10" />
                            </div>
                            <h3 className="text-sm md:text-2xl font-[1000] text-slate-900 uppercase tracking-tight mb-0.5 md:mb-2 leading-none">Front House</h3>
                            <p className="text-[8px] md:text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 md:mb-8 hidden md:block">Service Excellence</p>
                            <div className="w-full bg-slate-50 rounded-[16px] md:rounded-[24px] p-2 md:p-5 border border-slate-100 flex flex-col md:flex-row items-center gap-2 md:gap-5 mb-4 md:mb-8 group-hover:bg-blue-50/30 group-hover:border-blue-100 transition-colors">
                                <div className="w-8 h-8 md:w-14 md:h-14 rounded-lg md:rounded-2xl bg-white border border-slate-100 shadow-sm flex items-center justify-center overflow-hidden shrink-0">
                                    {leaders.foh?.image ? <img src={leaders.foh.image} className="w-full h-full object-cover" /> : <User className="w-4 h-4 md:w-6 md:h-6 text-slate-300" />}
                                </div>
                                <div className="text-center md:text-left flex-1 min-w-0">
                                    <span className="text-[7px] md:text-[9px] font-black text-[#004F71] uppercase tracking-widest block mb-0.5">Leading</span>
                                    <span className="text-[10px] md:text-base font-bold text-slate-900 truncate block max-w-[80px] md:max-w-none mx-auto">{leaders.foh?.name.split(' ')[0] || "No Votes"}</span>
                                    {leaders.foh && <span className="text-[7px] md:text-[9px] font-bold text-slate-400">{leaders.foh.voteCount} Votes</span>}
                                </div>
                            </div>
                            <button 
                                onClick={() => !hasVotedFOH && setVotingDept("FOH")}
                                disabled={hasVotedFOH}
                                className={cn(
                                    "w-full py-2.5 md:py-5 rounded-[14px] md:rounded-[24px] font-black uppercase text-[9px] md:text-xs tracking-[0.2em] shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 mt-auto",
                                    hasVotedFOH ? "bg-slate-100 text-slate-400 shadow-none cursor-not-allowed" : "bg-[#004F71] hover:bg-[#003b55] text-white shadow-blue-900/10"
                                )}
                            >
                                {hasVotedFOH ? <span className="md:inline">Voted</span> : <><Vote className="w-3 h-3 md:w-4 md:h-4" /> <span className="md:inline">Vote</span></>}
                            </button>
                        </div>
                    </motion.div>

                    {/* BOH CARD */}
                    <motion.div whileHover={{ y: -4 }} className="relative group rounded-[24px] md:rounded-[40px] overflow-hidden bg-white border border-slate-100 shadow-sm hover:shadow-xl hover:border-[#E51636]/30 transition-all duration-300">
                        <div className="absolute top-0 left-0 right-0 h-24 md:h-40 bg-gradient-to-b from-[#E51636]/5 to-transparent" />
                        <div className="relative p-4 md:p-10 flex flex-col items-center text-center h-full">
                            <div className="w-12 h-12 md:w-24 md:h-24 bg-[#E51636] text-white rounded-[16px] md:rounded-[28px] flex items-center justify-center shadow-lg shadow-red-900/20 mb-3 md:mb-8 -rotate-3 group-hover:-rotate-6 transition-transform duration-500">
                                <Flame className="w-5 h-5 md:w-10 md:h-10" />
                            </div>
                            <h3 className="text-sm md:text-2xl font-[1000] text-slate-900 uppercase tracking-tight mb-0.5 md:mb-2 leading-none">Back House</h3>
                            <p className="text-[8px] md:text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 md:mb-8 hidden md:block">Culinary Mastery</p>
                            
                            <div className="w-full bg-slate-50 rounded-[16px] md:rounded-[24px] p-2 md:p-5 border border-slate-100 flex flex-col md:flex-row items-center gap-2 md:gap-5 mb-4 md:mb-8 group-hover:bg-red-50/30 group-hover:border-red-100 transition-colors">
                                <div className="w-8 h-8 md:w-14 md:h-14 rounded-lg md:rounded-2xl bg-white border border-slate-100 shadow-sm flex items-center justify-center overflow-hidden shrink-0">
                                    {leaders.boh?.image ? <img src={leaders.boh.image} className="w-full h-full object-cover" /> : <User className="w-4 h-4 md:w-6 md:h-6 text-slate-300" />}
                                </div>
                                <div className="text-center md:text-left flex-1 min-w-0">
                                    <span className="text-[7px] md:text-[9px] font-black text-[#E51636] uppercase tracking-widest block mb-0.5">Leading</span>
                                    <span className="text-[10px] md:text-base font-bold text-slate-900 truncate block max-w-[80px] md:max-w-none mx-auto">{leaders.boh?.name.split(' ')[0] || "No Votes"}</span>
                                    {leaders.boh && <span className="text-[7px] md:text-[9px] font-bold text-slate-400">{leaders.boh.voteCount} Votes</span>}
                                </div>
                            </div>
                            <button 
                                onClick={() => !hasVotedBOH && setVotingDept("BOH")}
                                disabled={hasVotedBOH}
                                className={cn(
                                    "w-full py-2.5 md:py-5 rounded-[14px] md:rounded-[24px] font-black uppercase text-[9px] md:text-xs tracking-[0.2em] shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 mt-auto",
                                    hasVotedBOH ? "bg-slate-100 text-slate-400 shadow-none cursor-not-allowed" : "bg-[#E51636] hover:bg-[#c4122d] text-white shadow-red-900/10"
                                )}
                            >
                                {hasVotedBOH ? "Voted" : <><Vote className="w-3 h-3 md:w-4 md:h-4" /> <span className="md:inline">Vote</span></>}
                            </button>
                        </div>
                    </motion.div>
                </div>
            </section>

            {/* ... HALL OF FAME (Unchanged) ... */}
            <section className="max-w-4xl mx-auto px-4 mt-8 md:mt-20">
                <div className="flex items-center gap-3 md:gap-4 mb-6 md:mb-10">
                    <div className="p-2 md:p-3 bg-amber-100 text-amber-600 rounded-xl md:rounded-2xl shadow-sm border border-amber-200">
                        <Trophy className="w-5 h-5 md:w-6 md:h-6" />
                    </div>
                    <div>
                        <h3 className="text-lg md:text-2xl font-[1000] text-slate-900 uppercase tracking-tight leading-none">Hall of Fame</h3>
                        <p className="text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-widest mt-0.5 md:mt-1">Legacy of Excellence</p>
                    </div>
                </div>
                <div className="space-y-4 md:space-y-8 relative">
                    <div className="absolute left-[19px] md:left-[27px] top-6 bottom-6 w-0.5 bg-gradient-to-b from-slate-200 via-slate-200 to-transparent z-0" />
                    {history.length > 0 ? history.map((period, idx) => (
                        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: idx * 0.1 }} key={period.monthId} className="relative z-10 flex items-start gap-4 md:gap-8">
                            <div className="w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl bg-white border-[3px] md:border-[4px] border-slate-50 shadow-sm flex items-center justify-center shrink-0 z-10 relative mt-1 md:mt-0">
                                <History className="w-4 h-4 md:w-6 md:h-6 text-slate-300" />
                            </div>
                            <div className="flex-1 bg-white border border-slate-100 rounded-[24px] md:rounded-[32px] p-4 md:p-8 shadow-sm hover:shadow-xl hover:border-slate-200 transition-all relative overflow-hidden group">
                                <div className="absolute top-0 right-0 p-6 opacity-5 group-hover:rotate-12 transition-transform duration-500">
                                    <Star className="w-24 h-24 md:w-32 md:h-32 text-amber-400 fill-current" />
                                </div>
                                <div className="mb-3 md:mb-6">
                                    <h4 className="text-sm md:text-xl font-[900] text-slate-900">{period.displayDate}</h4>
                                    <span className="text-[8px] md:text-[10px] font-bold text-slate-400 uppercase tracking-wider">{period.totalVotes} Votes Cast</span>
                                </div>
                                <div className="grid grid-cols-2 gap-3 md:gap-4 relative z-10">
                                    <div className="flex flex-col md:flex-row items-center md:items-start gap-2 md:gap-4 p-2 md:p-4 rounded-[16px] md:rounded-[20px] bg-blue-50/50 border border-blue-100/60 text-center md:text-left">
                                        <div className="w-8 h-8 md:w-12 md:h-12 rounded-lg md:rounded-xl bg-[#004F71] text-white flex items-center justify-center font-black text-[10px] md:text-sm shadow-md">{period.foh.name.charAt(0)}</div>
                                        <div><span className="text-[7px] md:text-[9px] font-black text-[#004F71] uppercase tracking-widest block mb-0.5">FOH</span><span className="text-xs md:text-base font-bold text-slate-900 leading-tight block">{period.foh.name}</span></div>
                                    </div>
                                    <div className="flex flex-col md:flex-row items-center md:items-start gap-2 md:gap-4 p-2 md:p-4 rounded-[16px] md:rounded-[20px] bg-red-50/50 border border-red-100/60 text-center md:text-left">
                                        <div className="w-8 h-8 md:w-12 md:h-12 rounded-lg md:rounded-xl bg-[#E51636] text-white flex items-center justify-center font-black text-[10px] md:text-sm shadow-md">{period.boh.name.charAt(0)}</div>
                                        <div><span className="text-[7px] md:text-[9px] font-black text-[#E51636] uppercase tracking-widest block mb-0.5">BOH</span><span className="text-xs md:text-base font-bold text-slate-900 leading-tight block">{period.boh.name}</span></div>
                                    </div>
                                </div>
                            </div>
                        </motion.div>
                    )) : (
                        <div className="text-center py-10 text-slate-400 border-2 border-dashed border-slate-200 rounded-3xl"><History className="w-10 h-10 mx-auto mb-2 opacity-30" /><p className="text-xs font-bold uppercase tracking-widest">No history records yet.</p></div>
                    )}
                </div>
            </section>

            {/* --- CONFIRMATION MODAL (For Finalize Cycle) --- */}
            <AnimatePresence>
                {isConfirmingFinalize && (
                    <ClientPortal>
                        <div className="fixed inset-0 z-[200] flex items-center justify-center p-4">
                            <motion.div 
                                initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} 
                                onClick={() => setIsConfirmingFinalize(false)} 
                                className="absolute inset-0 bg-[#0F172A]/80 backdrop-blur-md" 
                            />
                            <motion.div 
                                initial={{ scale: 0.9, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0.9, opacity: 0 }}
                                className="relative bg-white w-full max-w-sm rounded-[32px] p-8 shadow-2xl text-center"
                            >
                                <div className="w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <AlertTriangle className="w-8 h-8 text-amber-600" />
                                </div>
                                <h3 className="text-xl font-[1000] text-slate-900 uppercase tracking-tight mb-2">Finalize Cycle?</h3>
                                <p className="text-xs font-medium text-slate-500 mb-8 leading-relaxed">
                                    This will close voting for <strong>{format(new Date(), "MMMM")}</strong> and publish the current leaders as official winners. This cannot be undone.
                                </p>
                                <div className="flex gap-3">
                                    <button onClick={() => setIsConfirmingFinalize(false)} className="flex-1 py-3 bg-slate-100 text-slate-500 font-bold rounded-xl text-xs uppercase tracking-wider hover:bg-slate-200 transition-colors">Cancel</button>
                                    <button onClick={executeFinalize} className="flex-1 py-3 bg-[#004F71] text-white font-bold rounded-xl text-xs uppercase tracking-wider hover:bg-[#003b55] transition-colors shadow-lg shadow-blue-900/20">Confirm</button>
                                </div>
                            </motion.div>
                        </div>
                    </ClientPortal>
                )}
            </AnimatePresence>

            {/* --- SLIDE-UP VOTING MODAL --- */}
            <AnimatePresence>
                {votingDept && (
                    <ClientPortal>
                        <div className={cn("fixed inset-0 z-[200] flex justify-center pointer-events-none", isMobile ? "items-end" : "items-center p-4")}>
                            <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} onClick={() => setVotingDept(null)} className="absolute inset-0 bg-[#0F172A]/80 backdrop-blur-xl pointer-events-auto" />
                            <motion.div 
                                variants={modalVariants}
                                initial={isMobile ? "mobileHidden" : "desktopHidden"}
                                animate={isMobile ? "mobileVisible" : "desktopVisible"}
                                exit={isMobile ? "mobileHidden" : "desktopHidden"}
                                drag={isMobile ? "y" : false}
                                dragControls={dragControls}
                                dragListener={false}
                                dragConstraints={{ top: 0, bottom: 0 }}
                                dragElastic={0.05}
                                onDragEnd={(_, info: PanInfo) => { if (isMobile && info.offset.y > 100) setVotingDept(null); }}
                                className={cn(
                                    "relative bg-[#F8FAFC] shadow-2xl overflow-hidden pointer-events-auto flex flex-col",
                                    "w-full h-[85vh] rounded-t-[40px] md:rounded-[48px]",
                                    "md:w-full md:max-w-xl md:h-[650px] md:border md:border-white/20 md:ring-1 md:ring-white/10"
                                )}
                            >
                                <div className="md:hidden absolute top-0 left-0 right-0 h-10 flex justify-center items-center z-50 cursor-grab active:cursor-grabbing touch-none" onPointerDown={(e) => dragControls.start(e)}><div className="w-12 h-1.5 bg-white/20 rounded-full" /></div>
                                <button onClick={() => setVotingDept(null)} className="hidden md:flex absolute top-6 right-6 p-2 bg-white/10 hover:bg-white/20 rounded-full text-white transition-all z-50"><X className="w-5 h-5" /></button>

                                <div className={cn("p-6 md:p-8 pb-6 text-white shrink-0 relative overflow-hidden", votingDept === 'FOH' ? 'bg-[#004F71]' : 'bg-[#E51636]')}>
                                    <div className="absolute top-0 right-0 p-6 opacity-10 pointer-events-none"><Vote className="w-48 h-48 rotate-12" /></div>
                                    <div className="relative z-10 pt-4 md:pt-0">
                                        <div className="inline-flex items-center gap-2 px-3 py-1 bg-white/10 rounded-full border border-white/20 backdrop-blur-md mb-2 md:mb-4">
                                            <div className="w-1.5 h-1.5 rounded-full bg-white animate-pulse" />
                                            <span className="text-[9px] font-black uppercase tracking-widest text-white">Live Ballot</span>
                                        </div>
                                        <h3 className="text-2xl md:text-4xl font-[1000] uppercase tracking-tight leading-none mb-1">Vote For {votingDept}</h3>
                                        <p className="text-white/70 text-xs md:text-sm font-medium">Select the team member who excelled.</p>
                                    </div>
                                </div>
                                
                                <div className="p-4 md:p-6 bg-white border-b border-slate-100 sticky top-0 z-20 shadow-sm">
                                    <div className="relative group">
                                        <Search className="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-slate-600 transition-colors" />
                                        <input autoFocus={!isMobile} value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} placeholder="Search candidate..." className="w-full pl-10 md:pl-12 pr-4 py-3 md:py-4 bg-slate-50 border border-slate-200 rounded-xl md:rounded-2xl text-sm md:text-base font-bold text-slate-900 outline-none focus:bg-white focus:border-slate-300 transition-all" />
                                    </div>
                                </div>

                                <div className="flex-1 overflow-y-auto p-4 md:p-6 space-y-2 md:space-y-3 custom-scrollbar bg-[#F8FAFC]">
                                    {eligibleCandidates.map(candidate => (
                                        <button 
                                            key={candidate.id}
                                            onClick={() => handleVote(candidate.id, candidate.name, votingDept!)}
                                            className="w-full flex items-center gap-3 md:gap-4 p-2.5 md:p-3 pr-4 rounded-[16px] md:rounded-[24px] bg-white border border-slate-100 hover:border-slate-300 hover:shadow-md transition-all group text-left relative overflow-hidden active:scale-[0.98]"
                                        >
                                            <div className="w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl bg-slate-50 flex items-center justify-center font-black text-slate-400 text-xs md:text-sm overflow-hidden shrink-0 border border-slate-100 group-hover:border-slate-200 z-10 relative">
                                                {candidate.image ? <img src={candidate.image} className="w-full h-full object-cover" /> : candidate.name.charAt(0)}
                                            </div>
                                            <div className="flex-1 min-w-0 z-10 relative">
                                                <p className="text-sm md:text-base font-bold text-slate-900 group-hover:text-[#004F71] transition-colors truncate">{candidate.name}</p>
                                                <p className="text-[8px] md:text-[10px] font-bold text-slate-400 uppercase tracking-wider truncate mt-0.5">{candidate.role}</p>
                                            </div>
                                            {candidate.voteCount > 0 && (
                                                <div className="flex items-center gap-1 bg-slate-100 px-2 py-1 rounded-lg z-10 relative">
                                                    <span className="text-xs font-black text-slate-700">{candidate.voteCount}</span>
                                                    <Vote className="w-3 h-3 text-slate-400" />
                                                </div>
                                            )}
                                            <div className={cn("absolute left-0 top-0 bottom-0 opacity-10 transition-all duration-500", votingDept === 'FOH' ? 'bg-[#004F71]' : 'bg-[#E51636]')} style={{ width: `${candidate.votePercent}%` }} />
                                            <div className="w-8 h-8 md:w-10 md:h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-300 group-hover:bg-[#004F71] group-hover:text-white transition-all shrink-0 z-10 relative">
                                                <ChevronRight className="w-4 h-4 md:w-5 md:h-5" />
                                            </div>
                                        </button>
                                    ))}
                                    {eligibleCandidates.length === 0 && (
                                        <div className="py-12 text-center text-slate-400 flex flex-col items-center">
                                            <User className="w-12 h-12 mb-3 opacity-20" />
                                            <p className="text-xs font-bold uppercase tracking-widest">No candidates found</p>
                                        </div>
                                    )}
                                </div>
                            </motion.div>
                        </div>
                    </ClientPortal>
                )}
            </AnimatePresence>
        </div>
    );
}
--- FILE: ./app/(main)/certifications/page.tsx ---
"use client";

import { useState, useEffect, useMemo } from "react";
import { motion, AnimatePresence, PanInfo } from "framer-motion";
import { 
  Search, Loader2, Sparkles, X, Layout, Pipette, Check, 
  Trash2, Edit3, User, Users, RefreshCw, Star, Plus, MoreHorizontal, ArrowRight, Shield, Award, Target
} from "lucide-react";
import { cn } from "@/lib/utils";

// Firebase & Store
import { db } from "@/lib/firebase";
import { 
  collection, onSnapshot, addDoc, updateDoc, deleteDoc, doc, setDoc,
  arrayUnion, arrayRemove, serverTimestamp, query, orderBy 
} from "firebase/firestore";
import { useAppStore } from "@/lib/store/useStore";
import { TACTICAL_ICONS } from "@/lib/icon-library";
import toast from "react-hot-toast";
import ClientPortal from "@/components/core/ClientPortal"; 

// Components
import EOTMView from "./_components/EOTMView";
import ForgeModal from "./_components/ForgeModal"; 
import CertificationsDynamicIsland from "./_components/CertificationsDynamicIsland";

// --- TYPES ---
interface Badge {
    id: string;
    label: string;
    desc?: string;
    hex: string;
    iconId: string;
    count?: number; 
    awardedId?: string; 
}

// --- SUB-COMPONENT: BADGE LIST ITEM ---
const BadgeListItem = ({ 
    badge, 
    onAction, 
    onEdit, 
    onDelete, 
    mode 
}: { 
    badge: Badge; 
    onAction: (b: Badge) => void; 
    onEdit?: (b: Badge) => void; 
    onDelete?: (id: string) => void;
    mode: 'inventory' | 'earned';
}) => {
    const [isMenuOpen, setIsMenuOpen] = useState(false);
    const IconComp = TACTICAL_ICONS.find(i => i.id === badge.iconId)?.icon || Star;

    return (
        <div className="relative overflow-hidden rounded-[24px] border border-slate-100 bg-white shadow-sm transition-all duration-300 hover:shadow-md hover:border-slate-200">
            {/* Ambient Background Tint */}
            <div 
                className="absolute inset-0 opacity-[0.03] pointer-events-none" 
                style={{ backgroundColor: badge.hex }} 
            />
            
            {/* Strip on left */}
            <div className="absolute left-0 top-0 bottom-0 w-1.5" style={{ backgroundColor: badge.hex }} />

            <div className="relative z-10 flex items-center p-4 gap-4">
                {/* ICON BOX */}
                <div 
                    className="h-14 w-14 rounded-2xl flex items-center justify-center shadow-sm border border-slate-100 bg-white shrink-0 relative overflow-hidden"
                >
                    <div className="absolute inset-0 opacity-10" style={{ backgroundColor: badge.hex }} />
                    <IconComp className="w-6 h-6" style={{ color: badge.hex }} />
                </div>

                {/* CONTENT */}
                <div className="flex-1 min-w-0 cursor-pointer" onClick={() => !isMenuOpen && mode === 'inventory' && onAction(badge)}>
                    <h4 className="text-sm font-[800] text-slate-900 truncate leading-tight">{badge.label}</h4>
                    <p className="text-[10px] font-bold text-slate-400 uppercase tracking-wide truncate mt-0.5">
                        {badge.desc || "Certification Module"}
                    </p>
                </div>

                {/* ACTIONS */}
                <div className="flex items-center gap-2">
                    
                    {/* MODE: EARNED (Show Count or Delete) */}
                    {mode === 'earned' && (
                        <div className="flex items-center gap-2">
                             {badge.count && badge.count > 1 && (
                                <div className="px-2.5 py-1 bg-slate-900 text-white rounded-lg text-[10px] font-black shadow-md">
                                    x{badge.count}
                                </div>
                             )}
                             <button 
                                onClick={(e) => { e.stopPropagation(); if(onDelete) onDelete(badge.awardedId || badge.id); }}
                                className="h-8 w-8 rounded-full bg-slate-50 text-slate-300 hover:bg-red-50 hover:text-red-500 flex items-center justify-center transition-colors"
                            >
                                <Trash2 className="w-4 h-4" />
                            </button>
                        </div>
                    )}

                    {/* MODE: INVENTORY (Show Add + Menu) */}
                    {mode === 'inventory' && (
                        <div className="flex items-center gap-2">
                            {/* Primary Action: Award */}
                             <button 
                                onClick={() => onAction(badge)}
                                className="h-10 w-10 rounded-full bg-slate-900 text-white flex items-center justify-center shadow-lg active:scale-90 transition-transform hover:bg-slate-800"
                            >
                                <Plus className="w-5 h-5" />
                            </button>

                            {/* Secondary Action: Menu */}
                            <div className="relative">
                                <AnimatePresence mode="wait">
                                    {!isMenuOpen ? (
                                        <button 
                                            onClick={(e) => { e.stopPropagation(); setIsMenuOpen(true); }}
                                            className="h-10 w-10 rounded-full bg-slate-50 text-slate-400 border border-slate-200 flex items-center justify-center hover:bg-slate-100 active:scale-95 transition-all"
                                        >
                                            <MoreHorizontal className="w-5 h-5" />
                                        </button>
                                    ) : (
                                        <motion.div 
                                            key="menu"
                                            initial={{ opacity: 0, x: 10, scale: 0.9 }}
                                            animate={{ opacity: 1, x: 0, scale: 1 }}
                                            exit={{ opacity: 0, x: 10, scale: 0.9 }}
                                            className="flex items-center gap-2 absolute right-0 top-0 bottom-0 bg-white/80 backdrop-blur-md p-1 rounded-full border border-slate-100 shadow-xl z-20"
                                            style={{ height: '40px', top: '0px' }} 
                                        >
                                            <button onClick={(e) => { e.stopPropagation(); onEdit?.(badge); setIsMenuOpen(false); }} className="h-8 w-8 flex items-center justify-center bg-blue-50 text-blue-600 rounded-full hover:bg-blue-100 transition-colors"><Edit3 className="w-3.5 h-3.5" /></button>
                                            <button onClick={(e) => { e.stopPropagation(); onDelete?.(badge.id); }} className="h-8 w-8 flex items-center justify-center bg-red-50 text-red-500 rounded-full hover:bg-red-100 transition-colors"><Trash2 className="w-3.5 h-3.5" /></button>
                                            <div className="w-px h-4 bg-slate-200 mx-0.5" />
                                            <button onClick={(e) => { e.stopPropagation(); setIsMenuOpen(false); }} className="h-8 w-8 flex items-center justify-center bg-slate-100 text-slate-500 rounded-full hover:bg-slate-200"><X className="w-3.5 h-3.5" /></button>
                                        </motion.div>
                                    )}
                                </AnimatePresence>
                            </div>
                        </div>
                    )}
                </div>
            </div>
        </div>
    );
}

// --- HELPER: GROUP BADGES ---
const getUniqueBadges = (badges: any[]) => {
    if (!badges || badges.length === 0) return [];
    const groups = new Map();
    badges.forEach((b: any) => {
        const key = b.id || b.label; 
        if (!groups.has(key)) {
            // Keep the first instance found, initialize count
            groups.set(key, { ...b, count: 0 });
        }
        groups.get(key).count += 1;
    });
    return Array.from(groups.values());
};

// --- RESPONSIVE SHEET FOR MANAGING BADGES ---
const MemberAwardsSheet = ({ 
    member, 
    inventory, 
    onClose, 
    onAward,
    onRemove 
}: { 
    member: any, 
    inventory: any[], 
    onClose: () => void, 
    onAward: (badge: any) => void,
    onRemove: (badgeId: string) => void
}) => {
    const [tab, setTab] = useState<'earned' | 'award'>('earned');
    const memberUniqueBadges = useMemo(() => getUniqueBadges(member.badges || []), [member.badges]);

    return (
        <ClientPortal>
            <div className="fixed inset-0 z-[200] flex justify-end items-end lg:items-stretch pointer-events-none">
                {/* Backdrop */}
                <motion.div 
                    initial={{ opacity: 0 }} 
                    animate={{ opacity: 1 }} 
                    exit={{ opacity: 0 }} 
                    className="absolute inset-0 bg-slate-900/60 backdrop-blur-sm pointer-events-auto" 
                    onClick={onClose} 
                />
                
                {/* Sheet */}
                <motion.div 
                    initial={{ x: "100%", opacity: 0.5 }} 
                    animate={{ x: 0, opacity: 1 }} 
                    exit={{ x: "100%", opacity: 0 }} 
                    transition={{ type: "spring", damping: 30, stiffness: 300 }}
                    className={cn(
                        "pointer-events-auto bg-[#F8FAFC] w-full flex flex-col shadow-2xl relative overflow-hidden",
                        // Mobile Styles (Bottom Sheet)
                        "h-[85vh] rounded-t-[32px] lg:h-full lg:rounded-none lg:rounded-l-[40px] lg:max-w-md"
                    )}
                >
                    {/* Header */}
                    <div className="flex justify-center pt-3 pb-1 shrink-0 bg-white lg:hidden">
                        <div className="w-12 h-1.5 bg-slate-200 rounded-full" />
                    </div>
                    
                    <div className="px-6 py-6 border-b border-slate-100 flex flex-col gap-6 bg-white shrink-0">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                {/* FIX: Profile Image in Sheet Header */}
                                <div className="w-12 h-12 rounded-2xl bg-slate-100 flex items-center justify-center font-black text-slate-500 text-sm overflow-hidden shadow-inner border border-slate-100">
                                    {member.image && !member.image.includes('ui-avatars') ? (
                                        <img src={member.image} className="w-full h-full object-cover" alt={member.name} />
                                    ) : (
                                        <span>{member.name.charAt(0)}</span>
                                    )}
                                </div>
                                <div>
                                    <h2 className="text-xl font-[1000] text-slate-900 tracking-tight leading-none">{member.name}</h2>
                                    <p className="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">{member.role}</p>
                                </div>
                            </div>
                            <button onClick={onClose} className="h-9 w-9 bg-slate-50 border border-slate-200 rounded-full flex items-center justify-center active:scale-95 transition-all text-slate-400 hover:text-red-500 hover:border-red-200"><X className="w-5 h-5" /></button>
                        </div>

                        {/* TABS */}
                        <div className="flex p-1.5 bg-slate-100 rounded-xl">
                            <button 
                                onClick={() => setTab('earned')}
                                className={cn(
                                    "flex-1 py-2.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all",
                                    tab === 'earned' ? "bg-white text-slate-900 shadow-sm" : "text-slate-400 hover:text-slate-600"
                                )}
                            >
                                Trophy Case
                            </button>
                            <button 
                                onClick={() => setTab('award')}
                                className={cn(
                                    "flex-1 py-2.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all",
                                    tab === 'award' ? "bg-[#004F71] text-white shadow-md" : "text-slate-400 hover:text-slate-600"
                                )}
                            >
                                Award Badge
                            </button>
                        </div>
                    </div>

                    {/* CONTENT AREA */}
                    <div className="flex-1 overflow-y-auto p-6 space-y-3 pb-20 custom-scrollbar">
                        {tab === 'earned' ? (
                            memberUniqueBadges.length > 0 ? (
                                memberUniqueBadges.map((badge: any, i: number) => (
                                    <BadgeListItem 
                                        key={i} 
                                        badge={badge}
                                        mode="earned"
                                        onAction={() => {}} 
                                        onDelete={onRemove}
                                    />
                                ))
                            ) : (
                                <div className="flex flex-col items-center justify-center py-20 text-slate-300 border-2 border-dashed border-slate-200 rounded-3xl mx-4 bg-slate-50/50">
                                    <Shield className="w-12 h-12 mb-3 opacity-30" />
                                    <span className="text-[10px] font-black uppercase tracking-widest">No Certifications Yet</span>
                                    <button onClick={() => setTab('award')} className="mt-4 text-[10px] font-bold text-[#004F71] underline hover:text-slate-900">Award First Badge</button>
                                </div>
                            )
                        ) : (
                            inventory.map(badge => (
                                <BadgeListItem 
                                    key={badge.id}
                                    badge={badge}
                                    mode="inventory"
                                    onAction={(b) => { onAward(b); setTab('earned'); }}
                                />
                            ))
                        )}
                    </div>
                </motion.div>
            </div>
        </ClientPortal>
    );
};

// --- PAGE CONTROLLER ---
export default function CertificationsPage() {
  const { team, loading, subscribeTeam, updateMemberLocal, currentUser } = useAppStore();
  
  const [activeView, setActiveView] = useState<"armory" | "eotm">("armory");
  const [isArmoryExpanded, setIsArmoryExpanded] = useState(false);
  const [forceRefresh, setForceRefresh] = useState(0); 

  const [searchQuery, setSearchQuery] = useState("");
  const [isDragging, setIsDragging] = useState(false);
  const [hoveredMemberId, setHoveredMemberId] = useState<string | null>(null);
  
  const [isArchitectOpen, setIsArchitectOpen] = useState(false);
  const [selectedMemberForAward, setSelectedMemberForAward] = useState<string | null>(null);
  const [editingId, setEditingId] = useState<string | null>(null);
  const [deleteTargetId, setDeleteTargetId] = useState<string | null>(null); 
  const [customAccolades, setCustomAccolades] = useState<any[]>([]);
  const [badgeDraft, setBadgeDraft] = useState({ 
    label: "", iconId: "Star", hex: "#E51636", desc: "Operational Excellence" 
  });

  useEffect(() => {
    const unsubTeam = subscribeTeam();
    const q = query(collection(db, "customAccolades"), orderBy("createdAt", "desc"));
    const unsubBadges = onSnapshot(q, (snap) => {
        setCustomAccolades(snap.docs.map(d => ({ id: d.id, ...d.data() })));
    });
    return () => { unsubTeam(); unsubBadges(); };
  }, [subscribeTeam, forceRefresh]);

  const filteredTeam = useMemo(() => 
    team.filter(m => m.name.toLowerCase().includes(searchQuery.toLowerCase()))
  , [team, searchQuery]);

  const activeMember = useMemo(() => 
    team.find(m => m.id === selectedMemberForAward)
  , [team, selectedMemberForAward]);

  const handleMemberClick = (memberId: string) => {
      setSelectedMemberForAward(memberId);
  };

  const awardBadge = async (targetId: string, badge: any) => {
      const member = team.find(m => m.id === targetId);
      if (!member) return;

      const currentBadges = member.badges || [];
      const loadingToast = toast.loading(`Awarding to ${member.name}...`);
      
      try {
        const newBadgeEntry = { 
            ...badge, 
            awardedId: Math.random().toString(36).substr(2, 9), 
            timestamp: new Date().toISOString() 
        };

        const updatedBadges = [...currentBadges, newBadgeEntry];
        updateMemberLocal(targetId, { badges: updatedBadges });

        const memberRef = doc(db, "profileOverrides", targetId); 
        await setDoc(memberRef, {
            badges: arrayUnion(newBadgeEntry), 
            updatedAt: serverTimestamp() 
        }, { merge: true });

        await addDoc(collection(db, "events"), {
            title: `Awarded: ${badge.label}`,
            type: "Award",
            status: "Done",
            priority: "Medium",
            startDate: new Date(),
            endDate: new Date(),
            assignee: currentUser?.uid || "System",
            assigneeName: currentUser?.name || "Admin",
            teamMemberId: member.id,
            teamMemberName: member.name,
            description: `[SYSTEM LOG: CERTIFICATION]\nOfficial recognition granted: ${badge.desc || "Operational Excellence"}.`,
            createdAt: serverTimestamp(),
            metadata: { hex: badge.hex, iconId: badge.iconId }
        });
        
        toast.success(`${badge.label} Awarded`, { id: loadingToast });
      } catch (e) {
        updateMemberLocal(targetId, { badges: currentBadges });
        toast.error("Failed to award certification", { id: loadingToast });
      }
  };

  const removeBadge = async (badgeId: string) => {
      if(!activeMember) return;
      const badgeToRemove = activeMember.badges?.find((b: any) => (b.awardedId === badgeId || b.id === badgeId));
      if (!badgeToRemove) return;

      const loadToast = toast.loading("Revoking Certification...");
      try {
          const updatedBadges = activeMember.badges?.filter((b: any) => b !== badgeToRemove) || [];
          updateMemberLocal(activeMember.id, { badges: updatedBadges });
          const memberRef = doc(db, "profileOverrides", activeMember.id);
          await setDoc(memberRef, { badges: updatedBadges, updatedAt: serverTimestamp() }, { merge: true });
          toast.success("Certification Revoked", { id: loadToast });
      } catch (e) {
          toast.error("Failed to revoke", { id: loadToast });
      }
  };

  // --- DRAG HANDLERS ---
  const handleDragStart = () => {
    setIsDragging(true);
    setIsArmoryExpanded(true); 
  };

  const handleDrag = (event: any, info: PanInfo) => {
      let clientX, clientY;
      if (event.changedTouches && event.changedTouches.length > 0) {
          clientX = event.changedTouches[0].clientX;
          clientY = event.changedTouches[0].clientY;
      } else {
          clientX = event.clientX;
          clientY = event.clientY;
      }

      if (clientX && clientY) {
         const elements = document.elementsFromPoint(clientX, clientY);
         const card = elements.find(el => el.hasAttribute("data-member-id") || el.closest('[data-member-id]'));
         const targetElement = card?.hasAttribute("data-member-id") ? card : card?.closest('[data-member-id]');
         const targetId = targetElement?.getAttribute("data-member-id");
         setHoveredMemberId(targetId || null);
      }
  };

  const handleDragEnd = async (event: any, info: any, badge: any) => {
    setIsDragging(false);
    setHoveredMemberId(null);
    let clientX, clientY;
    if (event.changedTouches && event.changedTouches.length > 0) {
        clientX = event.changedTouches[0].clientX;
        clientY = event.changedTouches[0].clientY;
    } else if (event.clientX !== undefined && event.clientY !== undefined) {
        clientX = event.clientX;
        clientY = event.clientY;
    } else {
        clientX = info.point.x;
        clientY = info.point.y;
    }
    const elements = document.elementsFromPoint(clientX, clientY);
    const card = elements.find(el => el.hasAttribute("data-member-id") || el.closest('[data-member-id]'));
    const targetElement = card?.hasAttribute("data-member-id") ? card : card?.closest('[data-member-id]');
    const targetId = targetElement?.getAttribute("data-member-id");
    if (targetId) await awardBadge(targetId, badge);
  };

  // --- CRUD HANDLERS ---
  const openForge = (badge?: any) => {
    if (badge) {
        setEditingId(badge.id);
        setBadgeDraft({ label: badge.label, iconId: badge.iconId, hex: badge.hex, desc: badge.desc });
    } else {
        setEditingId(null);
        setBadgeDraft({ label: "", iconId: "Star", hex: "#E51636", desc: "Operational Excellence" });
    }
    setIsArchitectOpen(true);
  };

  const handleSaveBadge = async () => {
    if (!badgeDraft.label) return toast.error("Label required");
    if (editingId) {
        await updateDoc(doc(db, "customAccolades", editingId), { ...badgeDraft, updatedAt: serverTimestamp() });
        toast.success("Module Updated");
    } else {
        await addDoc(collection(db, "customAccolades"), { ...badgeDraft, createdAt: serverTimestamp() });
        toast.success("New Module Created");
    }
    setIsArchitectOpen(false);
  };

  const requestDeleteBadge = (id: string) => { setDeleteTargetId(id); };

  const confirmDeleteBadge = async () => {
    if (!deleteTargetId) return;
    const loadToast = toast.loading("Decommissioning Module...");
    try {
        await deleteDoc(doc(db, "customAccolades", deleteTargetId));
        toast.success("Module Deleted", { id: loadToast });
        setIsArchitectOpen(false);
    } catch (e) {
        toast.error("Failed to delete", { id: loadToast });
    } finally {
        setDeleteTargetId(null);
    }
  };

  return (
    <div className="min-h-screen bg-[#F8FAFC] relative font-sans select-none overflow-x-hidden pt-6 pb-40">
      
      <CertificationsDynamicIsland 
          activeView={activeView}
          setActiveView={setActiveView}
          isExpanded={isArmoryExpanded}
          setIsExpanded={setIsArmoryExpanded}
          badges={customAccolades}
          onOpenForge={() => openForge()}
          onDragStart={handleDragStart}
          onDrag={handleDrag} 
          onDragEnd={handleDragEnd}
      />

      <div className="max-w-[1400px] mx-auto px-4 md:px-6 mt-32 md:mt-48">
        <AnimatePresence mode="wait">
            
            {activeView === 'eotm' ? (
                <motion.div
                    key="eotm"
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: -10 }}
                    className="w-full"
                >
                    <EOTMView />
                </motion.div>
            ) : (
                <motion.div 
                    key="armory"
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: -10 }}
                    className="w-full"
                >
                    <div className="mb-8 md:mb-12 text-center md:text-left">
                        <h1 className="text-4xl md:text-5xl font-[1000] text-slate-900 tracking-tighter mb-2">
                             Certifications
                        </h1>
                        <p className="text-sm font-bold text-slate-400 uppercase tracking-widest">
                            Manage & Award Tactical Achievements
                        </p>
                    </div>

                    <div className="space-y-6">
                        {/* SEARCH BAR */}
                        <div className="flex items-center gap-4 mb-6">
                            <div className="relative max-w-md w-full">
                                <Search className="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" />
                                <input 
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    placeholder="Search roster..."
                                    className="w-full pl-11 pr-4 py-3 bg-white border border-slate-200 rounded-2xl text-sm font-bold text-slate-800 outline-none focus:ring-2 focus:ring-[#004F71]/10 transition-all"
                                />
                            </div>
                            <button onClick={() => setForceRefresh(p => p + 1)} className="p-3 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 text-slate-400 hover:text-slate-600 transition-all shadow-sm">
                                <RefreshCw className="w-4 h-4" />
                            </button>
                        </div>

                        {/* ROSTER GRID */}
                        <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-32">
                            {loading && team.length === 0 ? (
                                <div className="col-span-full flex flex-col items-center justify-center py-20 text-slate-400">
                                    <Loader2 className="w-10 h-10 animate-spin mb-4 text-[#004F71]" />
                                    <span className="text-xs font-black uppercase tracking-widest">Loading Roster...</span>
                                </div>
                            ) : filteredTeam.length === 0 ? (
                                <div className="col-span-full py-20 text-center border-2 border-dashed border-slate-200 rounded-[32px] text-slate-400">
                                    <Users className="w-12 h-12 mx-auto mb-3 opacity-50" />
                                    <p className="text-sm font-bold uppercase tracking-widest">No Members Found</p>
                                </div>
                            ) : (
                                filteredTeam.map((member) => {
                                    const isFOH = member.dept === "FOH";
                                    const isHoveredTarget = hoveredMemberId === member.id || selectedMemberForAward === member.id;
                                    const initials = member.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                                    
                                    const uniqueBadges = getUniqueBadges(member.badges || []);
                                    const hasBadges = uniqueBadges.length > 0;
                                    
                                    return (
                                        <motion.div 
                                            key={member.id} 
                                            data-member-id={member.id} 
                                            layout 
                                            onClick={() => handleMemberClick(member.id)}
                                            className={cn(
                                                "group relative overflow-hidden rounded-[24px] border transition-all duration-300 bg-white cursor-pointer select-none",
                                                isHoveredTarget 
                                                    ? "border-[#E51636] shadow-2xl scale-[1.02] z-30 ring-4 ring-red-50" 
                                                    : "border-slate-100 shadow-sm hover:shadow-lg hover:border-slate-200 hover:-translate-y-1",
                                                isDragging && !isHoveredTarget && "opacity-40"
                                            )}
                                        >
                                            <div className={cn("absolute left-0 top-0 bottom-0 w-1.5", isFOH ? "bg-[#004F71]" : "bg-[#E51636]")} />
                                            
                                            {isDragging && (
                                                <div className={cn(
                                                    "absolute inset-0 z-20 flex items-center justify-center transition-opacity bg-white/60 backdrop-blur-[1px] pointer-events-none",
                                                    isHoveredTarget ? "opacity-100" : "opacity-0"
                                                )}>
                                                    <div className="px-4 py-2 bg-[#004F71] text-white rounded-full font-black text-[10px] uppercase tracking-widest shadow-xl flex items-center gap-2">
                                                        <Target className="w-4 h-4" /> Drop to Award
                                                    </div>
                                                </div>
                                            )}

                                            <div className="p-5 pl-7 flex items-start gap-4">
                                                <div className="relative shrink-0">
                                                    {/* FIX: Use img for valid URLs, fallback to initials */}
                                                    <div className={cn(
                                                        "h-12 w-12 rounded-2xl flex items-center justify-center text-sm font-black shadow-md relative overflow-hidden",
                                                        member.image && !member.image.includes('ui-avatars') ? "bg-white" : "bg-slate-100 text-slate-400"
                                                    )}>
                                                        {member.image && !member.image.includes('ui-avatars') ? (
                                                            <img src={member.image} className="w-full h-full object-cover" alt="" />
                                                        ) : (
                                                            initials
                                                        )}
                                                    </div>
                                                    {(member.badges?.length || 0) > 0 && (
                                                        <div className="absolute -bottom-1 -right-1 bg-amber-400 text-white text-[8px] font-black w-5 h-5 flex items-center justify-center rounded-full border-2 border-white shadow-sm">
                                                            {member.badges?.length}
                                                        </div>
                                                    )}
                                                </div>

                                                <div className="flex-1 min-w-0">
                                                    <h3 className="text-base font-black text-slate-900 truncate leading-tight group-hover:text-[#004F71] transition-colors">{member.name}</h3>
                                                    <div className="flex items-center gap-2 mt-1">
                                                        <span className="text-[9px] font-bold text-slate-400 uppercase tracking-wider">{member.role}</span>
                                                        <span className="w-1 h-1 rounded-full bg-slate-300" />
                                                        <span className="text-[9px] font-bold text-slate-400 uppercase tracking-wider">{member.dept}</span>
                                                    </div>
                                                    
                                                    <div className="mt-3 flex flex-wrap gap-1.5 min-h-[28px]">
                                                        {hasBadges ? (
                                                            uniqueBadges.slice(0, 4).map((b: any, idx: number) => {
                                                                const Icon = TACTICAL_ICONS.find(i => i.id === b.iconId)?.icon || Star;
                                                                return (
                                                                    <div 
                                                                        key={idx} 
                                                                        className="h-7 px-1.5 rounded-lg bg-white border border-slate-200 flex items-center gap-1 shadow-sm"
                                                                        title={b.label}
                                                                    >
                                                                        <Icon className="w-3.5 h-3.5" style={{ color: b.hex }} />
                                                                        {b.count > 1 && (
                                                                            <span className="text-[8px] font-black text-slate-600 leading-none">x{b.count}</span>
                                                                        )}
                                                                    </div>
                                                                )
                                                            })
                                                        ) : (
                                                            <span className="text-[9px] font-bold text-slate-300 uppercase tracking-wider py-1.5 flex items-center gap-1">
                                                                <Layout className="w-3 h-3" /> No Certs
                                                            </span>
                                                        )}
                                                        {uniqueBadges.length > 4 && (
                                                            <div className="h-7 px-1.5 rounded-lg bg-slate-100 border border-slate-200 flex items-center justify-center">
                                                                <span className="text-[8px] font-black text-slate-500">+{uniqueBadges.length - 4}</span>
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </motion.div>
                                    );
                                })
                            )}
                        </div>
                    </div>
                </motion.div>
            )}
        </AnimatePresence>
      </div>

      <AnimatePresence>
        {isArchitectOpen && (
            <ForgeModal 
                isOpen={isArchitectOpen}
                onClose={() => setIsArchitectOpen(false)}
                draft={badgeDraft}
                setDraft={setBadgeDraft}
                onSave={handleSaveBadge}
                onDelete={editingId ? requestDeleteBadge : undefined}
                editingId={editingId}
            />
        )}
      </AnimatePresence>

      <AnimatePresence>
        {activeMember && (
            <MemberAwardsSheet 
                member={activeMember}
                inventory={customAccolades}
                onClose={() => setSelectedMemberForAward(null)}
                onAward={(badge) => awardBadge(activeMember.id, badge)}
                onRemove={removeBadge}
            />
        )}
      </AnimatePresence>

      <AnimatePresence>
        {deleteTargetId && (
            <ClientPortal>
                <div className="fixed inset-0 z-[300] flex items-center justify-center p-4">
                    <motion.div 
                        initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} 
                        className="absolute inset-0 bg-[#0F172A]/80 backdrop-blur-md"
                        onClick={() => setDeleteTargetId(null)}
                    />
                    <motion.div 
                        initial={{ scale: 0.9, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0.9, opacity: 0 }}
                        className="relative bg-white w-full max-w-sm rounded-[32px] p-8 shadow-2xl text-center border border-white/20"
                    >
                        <div className="w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6 border border-red-100">
                            <Trash2 className="w-8 h-8 text-red-500" />
                        </div>
                        <h3 className="text-xl font-[1000] text-slate-900 uppercase tracking-tight mb-2">Delete Module?</h3>
                        <p className="text-xs font-medium text-slate-500 mb-8 leading-relaxed px-4">
                            This action will permanently remove this certification template from the system.
                        </p>
                        <div className="flex gap-3">
                            <button 
                                onClick={() => setDeleteTargetId(null)} 
                                className="flex-1 py-3.5 bg-slate-100 text-slate-500 font-bold rounded-xl text-[10px] uppercase tracking-wider hover:bg-slate-200 transition-colors"
                            >
                                Cancel
                            </button>
                            <button 
                                onClick={confirmDeleteBadge} 
                                className="flex-1 py-3.5 bg-[#E51636] text-white font-bold rounded-xl text-[10px] uppercase tracking-wider hover:bg-red-700 transition-colors shadow-lg shadow-red-900/20"
                            >
                                Delete
                            </button>
                        </div>
                    </motion.div>
                </div>
            </ClientPortal>
        )}
      </AnimatePresence>
    </div>
  );
}
--- FILE: ./app/page.tsx ---
import { redirect } from "next/navigation";

export default function Home() {
  // Automatically sends user to the dashboard
  redirect("/dashboard");
}
--- FILE: ./app/globals.css ---
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --foreground-rgb: 15, 23, 42; /* slate-900 */
  --background-start-rgb: 248, 250, 252; /* slate-50 */
  --background-end-rgb: 248, 250, 252;
}

body {
  color: rgb(var(--foreground-rgb));
  background: rgb(var(--background-start-rgb));
  font-family: Arial, Helvetica, sans-serif;
  overflow-x: hidden;
}

/* Custom Scrollbar to match Infobook */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}
::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}
@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.animate-shimmer {
  animation: shimmer 2s infinite;
}

@keyframes shine {
    100% {
        left: 125%;
    }
}
.animate-shine {
    animation: shine 1s;
}

/* Hide scrollbar for Chrome, Safari and Opera */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.no-scrollbar {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}

/* Custom Scrollbar to match Infobook (Only where explicitly needed, otherwise use no-scrollbar) */
.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}
.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}
.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}
.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}

@media print {
  /* Hide everything by default */
  body * {
    visibility: hidden;
  }
  
  /* Show only the print area */
  #printable-area, #printable-area * {
    visibility: visible;
  }

  /* Reset positioning for print */
  #printable-area {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    margin: 0;
    padding: 20px;
    background: white;
    color: black;
  }

  /* Hide buttons/interactive elements inside the print area */
  .no-print {
    display: none !important;
  }

  /* Ensure text is black for readability */
  p, h1, h2, h3, h4, span {
    color: black !important;
  }
}
--- FILE: ./app/login/page.tsx ---
"use client";

import { useState } from "react";
import { motion } from "framer-motion";
import { useRouter } from "next/navigation";
import { ChevronRight, Loader2, ShieldAlert } from "lucide-react";
import { useAppStore } from "@/lib/store/useStore";
import toast from "react-hot-toast";
import Image from 'next/image';

export default function LoginPage() {
  const router = useRouter();
  const { login } = useAppStore();
  
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [isLoading, setIsLoading] = useState(false);

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    try {
      await login(email, password);
      toast.success("Identity Verified");
      router.push("/dashboard");
    } catch (error: any) {
      toast.error("Access Denied: Invalid Credentials");
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen w-full flex bg-white font-sans">
      {/* Left Column: Login Form */}
      <div className="w-full lg:w-1/2 flex flex-col justify-center p-8 md:p-16 lg:p-24 relative z-10">
        <motion.div 
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6 }}
          className="w-full max-w-md mx-auto"
        >
          <div className="flex flex-col items-start mb-10">
            {/* --- UPDATED ICON SECTION ---
              The container is now larger, with a prominent shadow and border.
              The SVG icon itself is sized to look grand and central.
            */}
            <div className="w-24 h-24 bg-white rounded-3xl flex items-center justify-center mb-6 shadow-[0_10px_30px_-10px_rgba(229,22,54,0.3)] border-[3px] border-[#E51636] p-4 relative overflow-hidden group">
               {/* Glow effect behind the icon */}
               <div className="absolute inset-0 bg-red-500 opacity-0 group-hover:opacity-10 transition-opacity duration-500 blur-xl"></div>
               <Image 
                 src="/planning.svg" 
                 alt="TrainingBook Logo" 
                 width={64} 
                 height={64} 
                 className="w-full h-full object-contain relative z-10 drop-shadow-sm transition-transform duration-500 group-hover:scale-110"
               />
            </div>
            <h1 className="text-4xl font-black text-[#E51636] tracking-tighter uppercase mb-2">TrainingBook</h1>
            <p className="text-sm font-bold text-slate-500 uppercase tracking-[0.2em]">Operational Command Access</p>
          </div>

          <form onSubmit={handleLogin} className="space-y-6">
            <div className="space-y-2">
               <label className="text-xs font-black text-slate-700 uppercase tracking-widest pl-3">Operator ID</label>
               <input 
                  type="email" 
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-slate-900 font-bold outline-none focus:border-[#E51636] focus:ring-4 focus:ring-red-500/10 transition-all placeholder:text-slate-400"
                  placeholder="Enter email address..."
               />
            </div>
            
            <div className="space-y-2">
               <label className="text-xs font-black text-slate-700 uppercase tracking-widest pl-3">Security Key</label>
               <input 
                  type="password" 
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-4 text-slate-900 font-bold outline-none focus:border-[#E51636] focus:ring-4 focus:ring-red-500/10 transition-all placeholder:text-slate-400"
                  placeholder="••••••••"
               />
            </div>

            <button 
              disabled={isLoading}
              className="w-full py-4 mt-4 bg-[#E51636] hover:bg-red-700 text-white rounded-2xl font-black uppercase text-sm tracking-[0.2em] shadow-lg shadow-red-600/20 transition-all flex items-center justify-center gap-2 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {isLoading ? <Loader2 className="w-5 h-5 animate-spin" /> : <>Init Sequence <ChevronRight className="w-5 h-5" /></>}
            </button>
          </form>

          <div className="mt-12 pt-8 border-t border-slate-100 flex items-center gap-2 text-slate-500">
             <ShieldAlert className="w-4 h-4 text-[#E51636]" />
             <span className="text-xs font-bold">Restricted Personnel Only</span>
          </div>
        </motion.div>
      </div>

      {/* Right Column: Branding & Artwork */}
      <div className="hidden lg:flex w-1/2 bg-[#E51636] relative overflow-hidden items-center justify-center p-16">
        <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
        <motion.div
            initial={{ opacity: 0, scale: 0.9 }}
            animate={{ opacity: 1, scale: 1 }}
            transition={{ duration: 0.8, delay: 0.2 }}
            className="relative z-10 text-center text-white space-y-6"
        >
            <div className="w-32 h-32 bg-white rounded-full flex items-center justify-center mx-auto shadow-2xl p-6">
                {/* Also using the new SVG here for consistency */}
                <Image 
                 src="/planning.svg" 
                 alt="TrainingBook Logo" 
                 width={80} 
                 height={80} 
                 className="w-full h-full object-contain drop-shadow-md"
               />
            </div>
            <h2 className="text-5xl font-black tracking-tighter uppercase leading-none">Excellence in Every Order</h2>
            <p className="text-lg font-medium opacity-80 max-w-md mx-auto">Training the next generation of leaders to serve with care and precision.</p>
        </motion.div>
        
        <div className="absolute -bottom-20 -right-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"></div>
        <div className="absolute -top-20 -left-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"></div>
      </div>
    </div>
  );
}
--- FILE: ./postcss.config.mjs ---
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

export default config;
--- FILE: ./cors.json ---
[
  {
    "origin": ["*"],
    "method": ["GET", "HEAD", "PUT", "POST", "DELETE"],
    "responseHeader": ["Content-Type", "Access-Control-Allow-Origin"],
    "maxAgeSeconds": 3600
  }
]
--- FILE: ./next-env.d.ts ---
/// <reference types="next" />
/// <reference types="next/image-types/global" />
import "./.next/dev/types/routes.d.ts";

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

--- FILE: ./tailwind.config.ts ---
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./app/**/*.{js,ts,jsx,tsx,mdx}",        // Scans the App Router
    "./pages/**/*.{js,ts,jsx,tsx,mdx}",      // Scans Pages (if any)
    "./components/**/*.{js,ts,jsx,tsx,mdx}", // Scans Components
  ],
  theme: {
    extend: {
      colors: {
        background: "var(--background)",
        foreground: "var(--foreground)",
      },
    },
  },
  plugins: [],
};
export default config;
--- FILE: ./components/core/UserNav.tsx ---
"use client";

import { useState, useRef, useEffect } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { LogOut, Settings, User, ChevronRight, Shield } from "lucide-react";
import { useRouter } from "next/navigation";
import { auth } from "@/lib/firebase"; 
import { signOut } from "firebase/auth";
import { useAppStore } from "@/lib/store/useStore"; 
import toast from "react-hot-toast";
import Link from "next/link";
import { cn } from "@/lib/utils";

export default function UserNav() {
  const [isOpen, setIsOpen] = useState(false);
  const menuRef = useRef<HTMLDivElement>(null);
  const router = useRouter();
  const { currentUser } = useAppStore(); 

  // Close when clicking outside
  useEffect(() => {
    function handleClickOutside(event: MouseEvent) {
      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {
        setIsOpen(false);
      }
    }
    document.addEventListener("mousedown", handleClickOutside);
    return () => document.removeEventListener("mousedown", handleClickOutside);
  }, []);

  const handleLogout = async () => {
    const toastId = toast.loading("Signing out...");
    try {
      await signOut(auth);
      toast.success("Signed out successfully", { id: toastId });
      router.push("/login");
    } catch (error) {
      toast.error("Error signing out", { id: toastId });
    }
  };

  const initials = currentUser?.name 
    ? currentUser.name.split(" ").map((n: string) => n[0]).join("").substring(0, 2).toUpperCase()
    : "OP";

  return (
    <div className="relative z-50" ref={menuRef}>
      
      {/* --- TRIGGER (AVATAR) --- */}
      <button 
        onClick={() => setIsOpen(!isOpen)}
        className="relative group outline-none block"
      >
        <div className={cn(
            "w-9 h-9 md:w-10 md:h-10 rounded-full flex items-center justify-center text-xs md:text-sm font-[1000] transition-all border-2 overflow-hidden",
            isOpen 
                ? "bg-slate-900 text-white border-slate-900 shadow-lg scale-105" 
                : "bg-white text-slate-900 border-slate-200 hover:border-slate-300"
        )}>
             {currentUser?.image ? (
                 <img src={currentUser.image} alt={initials} className="w-full h-full object-cover" />
             ) : (
                 initials
             )}
        </div>
        
        {/* Active Indicator Dot */}
        <div className="absolute -top-0.5 -right-0.5 w-3 h-3 bg-emerald-500 border-2 border-[#F8FAFC] rounded-full" />
      </button>

      {/* --- DROPDOWN MENU --- */}
      <AnimatePresence>
        {isOpen && (
          <motion.div
            initial={{ opacity: 0, y: 10, scale: 0.95 }}
            animate={{ opacity: 1, y: 0, scale: 1 }}
            exit={{ opacity: 0, y: 10, scale: 0.95 }}
            transition={{ type: "spring", damping: 25, stiffness: 300 }}
            className="absolute right-0 mt-3 w-64 bg-white rounded-2xl shadow-2xl border border-slate-100 overflow-hidden origin-top-right z-[100]"
          >
            {/* Red Gradient Header */}
            <div className="p-4 bg-gradient-to-r from-[#E51636] to-[#ff4b6a] text-white relative overflow-hidden">
                <div className="relative z-10">
                    <div className="flex items-center gap-2 mb-1 opacity-90">
                        <Shield className="w-3 h-3" />
                        <span className="text-[9px] font-black uppercase tracking-widest">{currentUser?.role || "Team Member"}</span>
                    </div>
                    <p className="text-sm font-[1000] truncate tracking-tight">{currentUser?.name || "Operative"}</p>
                    <p className="text-[10px] font-bold opacity-70 truncate">{currentUser?.email}</p>
                </div>
                {/* Decor */}
                <div className="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2" />
            </div>

            {/* Menu Items */}
            <div className="p-2 space-y-1">
                
                <Link 
                    href="/settings" 
                    onClick={() => setIsOpen(false)}
                    className="flex items-center gap-3 w-full p-3 rounded-xl text-xs font-bold text-slate-600 hover:text-slate-900 hover:bg-slate-50 transition-all group"
                >
                    <div className="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-slate-500 group-hover:bg-white group-hover:shadow-sm transition-all">
                        <Settings className="w-4 h-4" />
                    </div>
                    <span className="flex-1 text-left">Settings</span>
                    <ChevronRight className="w-3.5 h-3.5 text-slate-300 group-hover:text-slate-900 transition-colors" />
                </Link>

            </div>

            {/* Footer / Logout */}
            <div className="p-2 border-t border-slate-50">
                <button 
                    onClick={handleLogout}
                    className="flex items-center gap-3 w-full p-3 rounded-xl text-xs font-black text-[#E51636] hover:bg-red-50 transition-all group"
                >
                    <div className="w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center text-[#E51636] group-hover:bg-white group-hover:shadow-sm transition-all">
                        <LogOut className="w-4 h-4" />
                    </div>
                    <span className="flex-1 text-left">Log Out</span>
                </button>
            </div>

          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
--- FILE: ./components/core/NotificationPanel.tsx ---
"use client";
import { useState, useEffect } from "react";
import { X, Bell, CheckCircle2, AlertCircle, Calendar } from "lucide-react";
import { cn } from "@/lib/utils";

// Types of notifications for the system
type Notification = {
  id: string;
  type: "success" | "alert" | "info";
  title: string;
  message: string;
  time: string;
  read: boolean;
};

// Mock Data
const NOTIFICATIONS: Notification[] = [
  {
    id: "1",
    type: "success",
    title: "Goal Completed",
    message: "Sarah Jenkins completed 'Speed of Service' training.",
    time: "10 min ago",
    read: false,
  },
  {
    id: "2",
    type: "alert",
    title: "Shift Coverage Needed",
    message: "BOH closing shift for Friday is open.",
    time: "1 hour ago",
    read: false,
  },
  {
    id: "3",
    type: "info",
    title: "New Policy Update",
    message: "Uniform guidelines have been updated for Winter.",
    time: "2 hours ago",
    read: true,
  },
];

interface NotificationPanelProps {
  isOpen: boolean;
  onClose: () => void;
}

export default function NotificationPanel({ isOpen, onClose }: NotificationPanelProps) {
  const [isVisible, setIsVisible] = useState(false);

  // Handle animation timing
  useEffect(() => {
    if (isOpen) setIsVisible(true);
    else setTimeout(() => setIsVisible(false), 300); // Wait for slide out
  }, [isOpen]);

  if (!isVisible && !isOpen) return null;

  return (
    <div className="fixed inset-0 z-50 flex justify-end">
      {/* Backdrop */}
      <div 
        className={cn(
          "fixed inset-0 bg-slate-900/20 backdrop-blur-sm transition-opacity duration-300",
          isOpen ? "opacity-100" : "opacity-0"
        )}
        onClick={onClose}
      />

      {/* Slide-over Panel */}
      <div 
        className={cn(
          "relative z-50 w-full max-w-sm bg-slate-50 h-full shadow-2xl transition-transform duration-300 ease-in-out transform border-l border-slate-200",
          isOpen ? "translate-x-0" : "translate-x-full"
        )}
      >
        <div className="flex flex-col h-full">
          {/* Header */}
          <div className="flex items-center justify-between p-5 bg-white border-b border-slate-200">
            <div className="flex items-center gap-2">
              <Bell className="h-5 w-5 text-[#004F71]" />
              <h2 className="font-bold text-slate-800">Notifications</h2>
            </div>
            <button 
              onClick={onClose}
              className="p-2 text-slate-400 hover:bg-slate-100 rounded-full transition-colors"
            >
              <X className="h-5 w-5" />
            </button>
          </div>

          {/* List */}
          <div className="flex-1 overflow-y-auto p-4 space-y-3">
            {NOTIFICATIONS.map((note) => (
              <div 
                key={note.id}
                className={cn(
                  "p-4 rounded-xl border transition-all hover:shadow-sm bg-white relative overflow-hidden",
                  note.read ? "border-slate-200 opacity-75" : "border-blue-100 shadow-sm ring-1 ring-blue-50"
                )}
              >
                {!note.read && (
                  <div className="absolute top-4 right-4 h-2 w-2 bg-[#E51636] rounded-full" />
                )}
                
                <div className="flex gap-3">
                  <div className={cn(
                    "mt-0.5 h-8 w-8 rounded-lg flex items-center justify-center flex-shrink-0",
                    note.type === "success" && "bg-emerald-100 text-emerald-600",
                    note.type === "alert" && "bg-amber-100 text-amber-600",
                    note.type === "info" && "bg-blue-100 text-blue-600",
                  )}>
                    {note.type === "success" && <CheckCircle2 className="h-4 w-4" />}
                    {note.type === "alert" && <AlertCircle className="h-4 w-4" />}
                    {note.type === "info" && <Calendar className="h-4 w-4" />}
                  </div>
                  <div>
                    <h3 className={cn("text-sm font-bold", note.read ? "text-slate-600" : "text-slate-900")}>
                      {note.title}
                    </h3>
                    <p className="text-xs text-slate-500 mt-1 leading-relaxed">
                      {note.message}
                    </p>
                    <p className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mt-2">
                      {note.time}
                    </p>
                  </div>
                </div>
              </div>
            ))}
          </div>

          {/* Footer */}
          <div className="p-4 border-t border-slate-200 bg-white">
            <button className="w-full py-3 text-xs font-bold text-slate-500 hover:text-slate-900 hover:bg-slate-100 rounded-xl transition-colors">
              Mark all as read
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}
--- FILE: ./components/core/AuthGuard.tsx ---
"use client";

import { useEffect, useState } from "react";
import { useRouter, usePathname } from "next/navigation";
import { useAppStore } from "@/lib/store/useStore";
import { Loader2, ShieldCheck } from "lucide-react";
import { motion } from "framer-motion";
import Image from "next/image";

export default function AuthGuard({ children }: { children: React.ReactNode }) {
  // Destructure subscribe methods from the store
  const { currentUser, authLoading, checkAuth, subscribeTeam, subscribeEvents } = useAppStore();
  const router = useRouter();
  const pathname = usePathname();
  
  // Local state to prevent premature redirects
  const [isChecking, setIsChecking] = useState(true);

  // 1. Initial Auth Check
  useEffect(() => {
    const initAuth = async () => {
        await checkAuth();
        setIsChecking(false);
    };
    initAuth();
  }, [checkAuth]);

  // 2. Global Data Subscription
  useEffect(() => {
    if (currentUser) {
       console.log("✅ [AuthGuard] User authenticated. Initializing global data streams...");
       const unsubTeam = subscribeTeam();
       const unsubEvents = subscribeEvents();
       
       return () => {
           unsubTeam();
           unsubEvents();
       };
    }
  }, [currentUser, subscribeTeam, subscribeEvents]);

  // 3. Route Protection logic
  useEffect(() => {
    // Only run this logic if we are NOT currently loading auth state
    if (!authLoading && !isChecking) {
        if (!currentUser && pathname !== "/login") {
            // No user, not on login page -> Redirect to Login
            router.push("/login");
        } else if (currentUser && pathname === "/login") {
            // User exists, but on login page -> Redirect to Dashboard
            router.push("/dashboard");
        }
    }
  }, [currentUser, authLoading, isChecking, router, pathname]);

  // If loading, show the splash screen
  if (authLoading || isChecking) {
     return (
        <div className="h-screen w-full bg-white flex flex-col items-center justify-center relative overflow-hidden font-sans">
           {/* Ambient Background Accents */}
           <div className="absolute top-[-10%] left-[-5%] w-[600px] h-[600px] bg-red-50/60 rounded-full blur-[120px] pointer-events-none mix-blend-multiply" />
           <div className="absolute bottom-[-10%] right-[-5%] w-[500px] h-[500px] bg-slate-50 rounded-full blur-[100px] pointer-events-none" />

           {/* Central Brand Element */}
           <motion.div 
             initial={{ scale: 0.9, opacity: 0 }}
             animate={{ scale: 1, opacity: 1 }}
             transition={{ duration: 0.5, ease: "easeOut" }}
             className="relative z-10 flex flex-col items-center"
           >
              {/* Logo Container - Matches Login Style */}
              <div className="w-24 h-24 bg-white rounded-[24px] flex items-center justify-center shadow-[0_20px_40px_-10px_rgba(229,22,54,0.3)] mb-8 relative overflow-hidden group border-[3px] border-[#E51636]">
                  <div className="absolute inset-0 bg-red-500 opacity-0 group-hover:opacity-5 transition-opacity duration-500" />
                  <Image 
                    src="/planning.svg"
                    alt="TrainingBook Logo"
                    width={80}
                    height={80}
                    className="w-14 h-14 object-contain relative z-10 drop-shadow-sm"
                    priority
                  />
              </div>

              {/* Branding Text */}
              <h2 className="text-3xl font-black tracking-tight text-slate-900 mb-2">
                Training<span className="text-[#004F71]">book</span>
              </h2>

              <div className="flex items-center gap-3 bg-slate-50 border border-slate-100 px-4 py-2 rounded-full mt-4">
                 <Loader2 className="w-3.5 h-3.5 text-[#E51636] animate-spin" />
                 <span className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em]">
                    Establishing Uplink
                 </span>
              </div>
           </motion.div>

           {/* Footer Security Badge */}
           <div className="absolute bottom-12 flex items-center gap-2 text-slate-300 opacity-60">
              <ShieldCheck className="w-4 h-4" />
              <span className="text-[9px] font-bold uppercase tracking-widest">Secure Connection</span>
           </div>
        </div>
     );
  }

  // If checking is done and no user (and we are on login), render children (the login form)
  // If checking is done and user exists (and we are NOT on login), render children (the app)
  return <>{children}</>;
}
--- FILE: ./components/core/DynamicHeader.tsx ---
"use client";

import React, { useState, useEffect } from 'react';
import Link from 'next/link';
import Image from 'next/image'; 
import { usePathname } from 'next/navigation'; 
import { motion, useScroll, useTransform, AnimatePresence, useDragControls, PanInfo } from 'framer-motion';
import { 
  LayoutDashboard, 
  Users, 
  GraduationCap,
  Calendar,
  BookOpen,
  X,
  ExternalLink,
  Loader2,
  Maximize2
} from 'lucide-react';
import { cn } from '@/lib/utils';
import UserNav from '@/components/core/UserNav'; 
import ClientPortal from '@/components/core/ClientPortal';

// --- CONFIGURATION ---
const PATHWAY_URL = "https://www.pathway.cfahome.com/";

const NAV_LINKS = [
  { href: '/dashboard', label: 'Overview', icon: LayoutDashboard },
  { href: '/calendar', label: 'Schedule', icon: Calendar },
  { href: '/training', label: 'Learn', icon: BookOpen }, 
  { href: '/certifications', label: 'Certs', icon: GraduationCap },
  { href: '/team', label: 'Roster', icon: Users },
];

// --- CUSTOM PATHWAY ICON ---
const PathwayIcon = ({ className }: { className?: string }) => (
  <svg viewBox="0 0 32 35" fill="none" xmlns="http://www.w3.org/2000/svg" className={className}>
    <path d="m20.936 3.8357e-4h-13.741c-1.7485-0.018804-3.4335 0.65443-4.6876 1.8729-1.2541 1.2185-1.9757 2.8833-2.0073 4.6316v22.049c0.067005 1.7321 0.80221 3.3709 2.0514 4.5727s2.9152 1.8731 4.6486 1.8731 3.3994-0.6713 4.6486-1.8731c1.2491-1.2018 1.9843-2.8406 2.0513-4.5727v-13.23c0.0106-0.6291 0.2693-1.2286 0.7199-1.6678 0.4505-0.4393 1.0563-0.6828 1.6855-0.6774h4.6204c0.2852 0.0198 0.5715-0.0193 0.841-0.1148 0.2694-0.0956 0.5164-0.2455 0.7255-0.4406 0.2091-0.195 0.3758-0.431 0.4898-0.6932 0.1139-0.2623 0.1728-0.5451 0.1728-0.8311 0-0.2859-0.0589-0.5687-0.1728-0.831-0.114-0.2622-0.2807-0.49818-0.4898-0.69324-0.2091-0.19505-0.4561-0.34502-0.7255-0.44056-0.2695-0.09553-0.5558-0.13463-0.841-0.11482h-4.5803c-1.75-0.0241-3.4381 0.64738-4.6934 1.867-1.2553 1.2195-1.9752 2.8875-2.0015 4.6375v13.24c-0.03951 0.6124-0.31066 1.1868-0.75835 1.6066-0.44769 0.4197-1.0384 0.6533-1.652 0.6533s-1.2044-0.2336-1.6521-0.6533c-0.44769-0.4198-0.7188-0.9942-0.75832-1.6066v-22.049c0.01056-0.62915 0.26926-1.2286 0.71978-1.6679 0.45053-0.43926 1.0564-0.68273 1.6856-0.67735h13.741c0.9096-0.03504 1.817 0.11392 2.6677 0.43786 0.8508 0.32395 1.6274 0.81626 2.2833 1.4474 0.656 0.63119 1.1778 1.3883 1.5343 2.2259 0.3564 0.83764 0.5401 1.7386 0.5401 2.6489 0 0.9104-0.1837 1.8113-0.5401 2.6489-0.3565 0.8376-0.8783 1.5947-1.5343 2.2259-0.6559 0.6312-1.4325 1.1235-2.2833 1.4475-0.8507 0.3239-1.7581 0.4729-2.6677 0.4378h-0.411c-0.5528 0-1.0831 0.2197-1.474 0.6106-0.391 0.391-0.6106 0.9212-0.6106 1.4741 0 0.5528 0.2196 1.0831 0.6106 1.4741 0.3909 0.3909 0.9212 0.6105 1.474 0.6105h0.411c2.8973 0 5.676-1.1509 7.7247-3.1996s3.1997-4.8275 3.1997-7.7248c0-2.8973-1.151-5.676-3.1997-7.7247-2.0487-2.0487-4.8274-3.1997-7.7247-3.1997l-0.0401-0.010032z" fill="currentColor" />
  </svg>
);

export default function DynamicHeader() {
  const pathname = usePathname();
  const { scrollY } = useScroll();
  
  // Header animations
  const headerY = useTransform(scrollY, [0, 100], [0, -10]);
  const headerBorder = useTransform(scrollY, [0, 20], ["rgba(0,0,0,0)", "rgba(226,232,240,1)"]);
  const headerShadow = useTransform(scrollY, [0, 20], ["none", "0 10px 15px -3px rgba(0, 0, 0, 0.05)"]);

  const [isPathwayOpen, setIsPathwayOpen] = useState(false);
  const [iframeLoading, setIframeLoading] = useState(true);
  
  // Mobile sheet logic
  const dragControls = useDragControls();
  const [isMobile, setIsMobile] = useState(false);

  useEffect(() => {
    const checkMobile = () => setIsMobile(window.innerWidth < 768);
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  return (
    <>
      {/* =======================================
          DESKTOP & TABLET HEADER (Top)
      ======================================= */}
      <motion.header
        style={{ y: headerY, borderColor: headerBorder, boxShadow: headerShadow }}
        className="sticky top-4 z-50 mx-auto max-w-[1800px] w-[95%] rounded-full transition-all duration-300 bg-white/80 backdrop-blur-xl border border-transparent hidden md:block"
      >
        <div className="px-6 h-16 flex items-center justify-between gap-4">
          
          {/* --- Left: Logo & Nav --- */}
          <div className="flex items-center gap-6 flex-1 overflow-hidden">
            <Link href="/dashboard" className="flex items-center gap-3 group shrink-0">
              <div className="relative h-9 w-9 flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                <Image 
                    src="/planning.svg" 
                    alt="TrainingBook Logo" 
                    width={36} 
                    height={36} 
                    className="w-full h-full object-contain"
                />
              </div>
              <span className="text-lg font-black tracking-tight text-slate-900">
                Training<span className="text-[#004F71]">book</span>
              </span>
            </Link>

            {/* Desktop Navigation Pills */}
            <div className="flex items-center gap-1 p-1 bg-slate-100/50 rounded-full border border-slate-200/50">
              {NAV_LINKS.map((link) => {
                const isActive = pathname?.startsWith(link.href);
                return (
                  <Link 
                    key={link.href} 
                    href={link.href}
                    className={cn(
                      "px-4 py-1.5 rounded-full text-[11px] font-bold uppercase tracking-wide transition-all duration-300 flex items-center gap-2 relative",
                      isActive 
                        ? "text-[#004F71]" 
                        : "text-slate-500 hover:text-slate-700 hover:bg-white/50"
                    )}
                  >
                    {isActive && (
                      <motion.div 
                        layoutId="desktopNav"
                        className="absolute inset-0 bg-white shadow-sm rounded-full border border-slate-100"
                        initial={false}
                        transition={{ type: "spring", stiffness: 300, damping: 30 }}
                      />
                    )}
                    <span className="relative z-10 flex items-center gap-2">
                        <link.icon className={cn("w-3.5 h-3.5", isActive && "text-[#E51636]")} />
                        {link.label}
                    </span>
                  </Link>
                );
              })}
            </div>
            
            {/* PATHWAY BUTTON (Desktop) */}
            <button
               onClick={() => { setIsPathwayOpen(true); setIframeLoading(true); }}
               className="flex items-center gap-2 px-4 py-1.5 rounded-full bg-slate-50 border border-slate-200/60 hover:bg-slate-100 hover:border-slate-300 transition-all group ml-2"
            >
                <PathwayIcon className="w-5 h-5 text-[#004F71] group-hover:scale-110 transition-transform" />
                <span className="text-[11px] font-black uppercase text-[#004F71] tracking-wide">Pathway</span>
            </button>

          </div>

          {/* --- Right: Actions --- */}
          <div className="flex items-center gap-3 shrink-0">
            <UserNav />
          </div>
        </div>
      </motion.header>

      {/* =======================================
          MOBILE TOP BAR
      ======================================= */}
      <header className="md:hidden fixed top-0 left-0 right-0 z-[101] px-6 py-4 bg-slate-50/80 backdrop-blur-md flex items-center justify-between shadow-sm">
          <Link href="/dashboard" className="flex items-center gap-3">
            <div className="relative h-9 w-9">
                 <Image 
                    src="/planning.svg" 
                    alt="Logo" 
                    width={36} 
                    height={36} 
                    className="w-full h-full object-contain"
                />
            </div>
            <span className="text-lg font-black tracking-tight text-slate-900">Trainingbook</span>
          </Link>

          <UserNav />
      </header>

      {/* =======================================
          MOBILE COMMAND DOCK
      ======================================= */}
      <div className="md:hidden fixed bottom-8 left-1/2 -translate-x-1/2 z-[100] w-auto">
        <nav className="flex items-center gap-2 p-2 bg-white/90 backdrop-blur-2xl border border-white/60 rounded-[32px] shadow-[0_20px_50px_-12px_rgba(0,0,0,0.1)] ring-1 ring-white/50">
            {NAV_LINKS.map((link) => {
                const isActive = pathname?.startsWith(link.href);
                return (
                    <Link 
                        key={link.href} 
                        href={link.href}
                        className="relative flex items-center justify-center w-14 h-14 rounded-full"
                    >
                        {isActive && (
                            <motion.div 
                                layoutId="mobileNav"
                                className="absolute inset-0 bg-[#E51636] rounded-full shadow-lg shadow-red-500/30"
                                transition={{ type: "spring", stiffness: 350, damping: 25 }}
                            />
                        )}
                        <link.icon className={cn("w-6 h-6 transition-all relative z-10", isActive ? "text-white scale-110" : "text-slate-400 hover:text-slate-600")} />
                        
                        {isActive && (
                            <motion.div 
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                className="absolute bottom-1 w-1 h-1 bg-white rounded-full z-20" 
                            />
                        )}
                    </Link>
                )
            })}
            
            <div className="w-px h-8 bg-slate-200 mx-1" />

            {/* PATHWAY BUTTON (Mobile Dock) */}
            <button 
                onClick={() => { setIsPathwayOpen(true); setIframeLoading(true); }}
                className="relative flex items-center justify-center w-14 h-14 rounded-full bg-[#004F71]/10 border border-[#004F71]/20 active:scale-95 transition-transform"
            >
                <PathwayIcon className="w-7 h-7 text-[#004F71]" />
            </button>

        </nav>
      </div>

      {/* =======================================
          PATHWAY IFRAME MODAL
      ======================================= */}
      <AnimatePresence>
        {isPathwayOpen && (
            <ClientPortal>
                {/* Backdrop */}
                <motion.div 
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    className="fixed inset-0 z-[200] bg-[#0F172A]/80 backdrop-blur-xl"
                    onClick={() => setIsPathwayOpen(false)}
                />
                
                {/* Modal Window */}
                <motion.div 
                    initial={isMobile ? { y: "100%" } : { opacity: 0, scale: 0.95, y: 20 }}
                    animate={isMobile ? { y: 0 } : { opacity: 1, scale: 1, y: 0 }}
                    exit={isMobile ? { y: "100%" } : { opacity: 0, scale: 0.95, y: 20 }}
                    transition={{ type: "spring", damping: 25, stiffness: 300 }}
                    drag={isMobile ? "y" : false}
                    dragControls={dragControls}
                    dragListener={false}
                    dragConstraints={{ top: 0, bottom: 0 }}
                    dragElastic={0.05}
                    onDragEnd={(_, info: PanInfo) => { if (isMobile && info.offset.y > 100) setIsPathwayOpen(false); }}
                    className={cn(
                        "fixed z-[210] bg-white shadow-2xl overflow-hidden flex flex-col border border-white/20 ring-1 ring-black/5 pointer-events-auto",
                        // Mobile: Use Dynamic Viewport Height (dvh)
                        "bottom-0 left-0 right-0 h-[92dvh] rounded-t-[32px]",
                        // Desktop: Centered Modal Styles - FIXED HEIGHT AND POSITIONING
                        "md:inset-10 md:h-auto md:rounded-[40px]"
                    )}
                >
                    {/* Mobile Drag Handle */}
                    <div 
                        className="md:hidden h-10 w-full flex items-center justify-center cursor-grab active:cursor-grabbing touch-none bg-white border-b border-slate-50 shrink-0"
                        onPointerDown={(e) => dragControls.start(e)}
                    >
                        <div className="w-12 h-1.5 bg-slate-200 rounded-full" />
                    </div>

                    {/* Header */}
                    <div className="h-16 md:h-20 bg-white md:bg-[#004F71] text-[#004F71] md:text-white px-6 md:px-8 flex items-center justify-between shrink-0 relative overflow-hidden z-20 border-b border-slate-100 md:border-0 pt-6 md:pt-0">
                        {/* Desktop Header Texture */}
                        <div className="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] hidden md:block" />
                        
                        <div className="flex items-center gap-4 relative z-10">
                            <div className="w-10 h-10 bg-[#004F71]/10 md:bg-white/10 rounded-xl flex items-center justify-center border border-[#004F71]/10 md:border-white/10 shadow-sm">
                                <PathwayIcon className="w-6 h-6 text-[#004F71] md:text-white" />
                            </div>
                            <div>
                                <h3 className="text-lg md:text-xl font-[1000] tracking-tight leading-none text-slate-900 md:text-white">Pathway</h3>
                                <p className="text-[10px] font-bold text-slate-400 md:text-blue-200 uppercase tracking-widest mt-0.5">External Resource</p>
                            </div>
                        </div>

                        <div className="flex items-center gap-3 relative z-10">
                             <a 
                                href={PATHWAY_URL} 
                                target="_blank" 
                                rel="noreferrer"
                                className="hidden md:flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-full text-xs font-bold transition-all border border-white/10"
                             >
                                 <Maximize2 className="w-4 h-4" /> Open in New Tab
                             </a>
                             <button 
                                onClick={() => setIsPathwayOpen(false)}
                                className="p-2.5 bg-slate-50 md:bg-white text-slate-400 md:text-[#004F71] hover:bg-slate-100 rounded-full transition-all shadow-sm md:shadow-lg active:scale-90"
                             >
                                 <X className="w-5 h-5" />
                             </button>
                        </div>
                    </div>

                    {/* Iframe Content */}
                    <div className="flex-1 bg-slate-50 relative w-full flex flex-col min-h-0">
                        {iframeLoading && (
                            <div className="absolute inset-0 flex flex-col items-center justify-center z-0 text-slate-400">
                                <Loader2 className="w-10 h-10 animate-spin mb-4 text-[#004F71]" />
                                <span className="text-xs font-black uppercase tracking-widest">Connecting to Pathway...</span>
                            </div>
                        )}
                        
                        <iframe 
                            src={PATHWAY_URL}
                            className={cn(
                                "flex-1 w-full border-none relative z-10 bg-white transition-opacity duration-500",
                                iframeLoading ? "opacity-0" : "opacity-100"
                            )}
                            onLoad={() => setIframeLoading(false)}
                            allowFullScreen
                        />
                        
                        {/* Mobile Floating Button (Glassmorphism) - Positioned above safe area */}
                        <div className="md:hidden absolute bottom-12 left-1/2 -translate-x-1/2 z-30 w-auto pointer-events-none">
                            <a 
                                href={PATHWAY_URL} 
                                target="_blank" 
                                rel="noreferrer" 
                                className="pointer-events-auto flex items-center gap-3 px-6 py-3.5 bg-[#E51636]/90 backdrop-blur-xl text-white rounded-full font-black text-[10px] uppercase tracking-widest shadow-xl shadow-red-900/20 hover:scale-105 active:scale-95 transition-all border border-white/20"
                            >
                                <ExternalLink className="w-4 h-4" /> Open External Site
                            </a>
                        </div>
                    </div>
                </motion.div>
            </ClientPortal>
        )}
      </AnimatePresence>
    </>
  );
}
--- FILE: ./components/core/ClientPortal.tsx ---
"use client";

import { useEffect, useState } from "react";
import { createPortal } from "react-dom";

export default function ClientPortal({ children }: { children: React.ReactNode }) {
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
    return () => setMounted(false);
  }, []);

  return mounted ? createPortal(children, document.body) : null;
}
--- FILE: ./package-lock.json ---
{
  "name": "trainingbook",
  "version": "0.1.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "trainingbook",
      "version": "0.1.0",
      "dependencies": {
        "clsx": "^2.1.1",
        "date-fns": "^4.1.0",
        "firebase": "^12.7.0",
        "firebase-admin": "^13.6.0",
        "framer-motion": "^12.23.26",
        "lucide-react": "^0.561.0",
        "next": "16.0.10",
        "puppeteer": "^24.34.0",
        "react": "19.2.1",
        "react-dom": "19.2.1",
        "react-hot-toast": "^2.6.0",
        "tailwind-merge": "^3.4.0",
        "zustand": "^5.0.9"
      },
      "devDependencies": {
        "@types/node": "^20",
        "@types/react": "^19",
        "@types/react-dom": "^19",
        "autoprefixer": "^10.4.23",
        "babel-plugin-react-compiler": "1.0.0",
        "eslint": "^9",
        "eslint-config-next": "16.0.10",
        "postcss": "^8.5.6",
        "tailwindcss": "^3.4.17",
        "typescript": "^5"
      }
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.27.1.tgz",
      "integrity": "sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==",
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.27.1",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.5.tgz",
      "integrity": "sha512-6uFXyCayocRbqhZOB+6XcuZbkMNimwfVGFji8CTZnCzOHVGvDqzvitu1re2AU5LROliz7eQPhB8CpAMvnx9EjA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.5.tgz",
      "integrity": "sha512-e7jT4DxYvIDLk1ZHmU/m/mB19rex9sv0c2ftBtjSBv+kVM/902eh0fINUzD7UwLLNR+jU585GxUJ8/EBfAM5fw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-compilation-targets": "^7.27.2",
        "@babel/helper-module-transforms": "^7.28.3",
        "@babel/helpers": "^7.28.4",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/traverse": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.5.tgz",
      "integrity": "sha512-3EwLFhZ38J4VyIP6WNtt2kUdW9dokXA9Cr4IVIFHuCpZ3H8/YFOl5JjZHisrn1fATPBmKKqXzDFvh9fUwHz6CQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.2.tgz",
      "integrity": "sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.27.2",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.27.1.tgz",
      "integrity": "sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.27.1",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.3",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.3.tgz",
      "integrity": "sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.27.1",
        "@babel/traverse": "^7.28.3"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.4.tgz",
      "integrity": "sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.4"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.5.tgz",
      "integrity": "sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.5"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.27.2.tgz",
      "integrity": "sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/parser": "^7.27.2",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.5.tgz",
      "integrity": "sha512-TCCj4t55U90khlYkVV/0TfkJkAkUg3jZFA3Neb7unZT8CPok7iiRfaX0F+WnqWqt7OxhOn0uBKXCw4lbL8W0aQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.5",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.5.tgz",
      "integrity": "sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@emnapi/core": {
      "version": "1.7.1",
      "resolved": "https://registry.npmjs.org/@emnapi/core/-/core-1.7.1.tgz",
      "integrity": "sha512-o1uhUASyo921r2XtHYOHy7gdkGLge8ghBEQHMWmyJFoXlpU58kIrhhN3w26lpQb6dspetweapMn2CSNwQ8I4wg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/wasi-threads": "1.1.0",
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/runtime": {
      "version": "1.7.1",
      "resolved": "https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.7.1.tgz",
      "integrity": "sha512-PVtJr5CmLwYAU9PZDMITZoR5iAOShYREoR45EyyLrbntV50mdePTgUn4AmOw90Ifcj+x2kRjdzr1HP3RrNiHGA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/wasi-threads": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@emnapi/wasi-threads/-/wasi-threads-1.1.0.tgz",
      "integrity": "sha512-WI0DdZ8xFSbgMjR1sFsKABJ/C5OnRrjT06JXbZKexJGrDuPTzZdDYfFlsgcCXCyf+suG5QU2e/y1Wo2V/OapLQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@eslint-community/eslint-utils": {
      "version": "4.9.0",
      "resolved": "https://registry.npmjs.org/@eslint-community/eslint-utils/-/eslint-utils-4.9.0.tgz",
      "integrity": "sha512-ayVFHdtZ+hsq1t2Dy24wCmGXGe4q9Gu3smhLYALJrr473ZH27MsnSL+LKUlimp4BWJqMDMLmPpx/Q9R3OAlL4g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "eslint-visitor-keys": "^3.4.3"
      },
      "engines": {
        "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      },
      "peerDependencies": {
        "eslint": "^6.0.0 || ^7.0.0 || >=8.0.0"
      }
    },
    "node_modules/@eslint-community/eslint-utils/node_modules/eslint-visitor-keys": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-3.4.3.tgz",
      "integrity": "sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/@eslint-community/regexpp": {
      "version": "4.12.2",
      "resolved": "https://registry.npmjs.org/@eslint-community/regexpp/-/regexpp-4.12.2.tgz",
      "integrity": "sha512-EriSTlt5OC9/7SXkRSCAhfSxxoSUgBm33OH+IkwbdpgoqsSsUg7y3uh+IICI/Qg4BBWr3U2i39RpmycbxMq4ew==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^12.0.0 || ^14.0.0 || >=16.0.0"
      }
    },
    "node_modules/@eslint/config-array": {
      "version": "0.21.1",
      "resolved": "https://registry.npmjs.org/@eslint/config-array/-/config-array-0.21.1.tgz",
      "integrity": "sha512-aw1gNayWpdI/jSYVgzN5pL0cfzU02GT3NBpeT/DXbx1/1x7ZKxFPd9bwrzygx/qiwIQiJ1sw/zD8qY/kRvlGHA==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/object-schema": "^2.1.7",
        "debug": "^4.3.1",
        "minimatch": "^3.1.2"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/config-helpers": {
      "version": "0.4.2",
      "resolved": "https://registry.npmjs.org/@eslint/config-helpers/-/config-helpers-0.4.2.tgz",
      "integrity": "sha512-gBrxN88gOIf3R7ja5K9slwNayVcZgK6SOUORm2uBzTeIEfeVaIhOpCtTox3P6R7o2jLFwLFTLnC7kU/RGcYEgw==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/core": "^0.17.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/core": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/@eslint/core/-/core-0.17.0.tgz",
      "integrity": "sha512-yL/sLrpmtDaFEiUj1osRP4TI2MDz1AddJL+jZ7KSqvBuliN4xqYY54IfdN8qD8Toa6g1iloph1fxQNkjOxrrpQ==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@types/json-schema": "^7.0.15"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/eslintrc": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/@eslint/eslintrc/-/eslintrc-3.3.3.tgz",
      "integrity": "sha512-Kr+LPIUVKz2qkx1HAMH8q1q6azbqBAsXJUxBl/ODDuVPX45Z9DfwB8tPjTi6nNZ8BuM3nbJxC5zCAg5elnBUTQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ajv": "^6.12.4",
        "debug": "^4.3.2",
        "espree": "^10.0.1",
        "globals": "^14.0.0",
        "ignore": "^5.2.0",
        "import-fresh": "^3.2.1",
        "js-yaml": "^4.1.1",
        "minimatch": "^3.1.2",
        "strip-json-comments": "^3.1.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/@eslint/js": {
      "version": "9.39.2",
      "resolved": "https://registry.npmjs.org/@eslint/js/-/js-9.39.2.tgz",
      "integrity": "sha512-q1mjIoW1VX4IvSocvM/vbTiveKC4k9eLrajNEuSsmjymSDEbpGddtpfOoN7YGAqBK3NG+uqo8ia4PDTt8buCYA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://eslint.org/donate"
      }
    },
    "node_modules/@eslint/object-schema": {
      "version": "2.1.7",
      "resolved": "https://registry.npmjs.org/@eslint/object-schema/-/object-schema-2.1.7.tgz",
      "integrity": "sha512-VtAOaymWVfZcmZbp6E2mympDIHvyjXs/12LqWYjVw6qjrfF+VK+fyG33kChz3nnK+SU5/NeHOqrTEHS8sXO3OA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/plugin-kit": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/@eslint/plugin-kit/-/plugin-kit-0.4.1.tgz",
      "integrity": "sha512-43/qtrDUokr7LJqoF2c3+RInu/t4zfrpYdoSDfYyhg52rwLV6TnOvdG4fXm7IkSB3wErkcmJS9iEhjVtOSEjjA==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/core": "^0.17.0",
        "levn": "^0.4.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@fastify/busboy": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/@fastify/busboy/-/busboy-3.2.0.tgz",
      "integrity": "sha512-m9FVDXU3GT2ITSe0UaMA5rU3QkfC/UXtCU8y0gSN/GugTqtVldOBWIB5V6V3sbmenVZUIpU6f+mPEO2+m5iTaA==",
      "license": "MIT"
    },
    "node_modules/@firebase/ai": {
      "version": "2.6.1",
      "resolved": "https://registry.npmjs.org/@firebase/ai/-/ai-2.6.1.tgz",
      "integrity": "sha512-qJd9bpABqsanFnwdbjZEDbKKr1jRtuUZ+cHyNBLWsxobH4pd73QncvuO3XlMq4eKBLlg1f5jNdFpJ3G3ABu2Tg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-check-interop-types": "0.3.3",
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x",
        "@firebase/app-types": "0.x"
      }
    },
    "node_modules/@firebase/analytics": {
      "version": "0.10.19",
      "resolved": "https://registry.npmjs.org/@firebase/analytics/-/analytics-0.10.19.tgz",
      "integrity": "sha512-3wU676fh60gaiVYQEEXsbGS4HbF2XsiBphyvvqDbtC1U4/dO4coshbYktcCHq+HFaGIK07iHOh4pME0hEq1fcg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/installations": "0.6.19",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/analytics-compat": {
      "version": "0.2.25",
      "resolved": "https://registry.npmjs.org/@firebase/analytics-compat/-/analytics-compat-0.2.25.tgz",
      "integrity": "sha512-fdzoaG0BEKbqksRDhmf4JoyZf16Wosrl0Y7tbZtJyVDOOwziE0vrFjmZuTdviL0yhak+Nco6rMsUUbkbD+qb6Q==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/analytics": "0.10.19",
        "@firebase/analytics-types": "0.8.3",
        "@firebase/component": "0.7.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/analytics-types": {
      "version": "0.8.3",
      "resolved": "https://registry.npmjs.org/@firebase/analytics-types/-/analytics-types-0.8.3.tgz",
      "integrity": "sha512-VrIp/d8iq2g501qO46uGz3hjbDb8xzYMrbu8Tp0ovzIzrvJZ2fvmj649gTjge/b7cCCcjT0H37g1gVtlNhnkbg==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/app": {
      "version": "0.14.6",
      "resolved": "https://registry.npmjs.org/@firebase/app/-/app-0.14.6.tgz",
      "integrity": "sha512-4uyt8BOrBsSq6i4yiOV/gG6BnnrvTeyymlNcaN/dKvyU1GoolxAafvIvaNP1RCGPlNab3OuE4MKUQuv2lH+PLQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "idb": "7.1.1",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/app-check": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/@firebase/app-check/-/app-check-0.11.0.tgz",
      "integrity": "sha512-XAvALQayUMBJo58U/rxW02IhsesaxxfWVmVkauZvGEz3vOAjMEQnzFlyblqkc2iAaO82uJ2ZVyZv9XzPfxjJ6w==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/app-check-compat": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/@firebase/app-check-compat/-/app-check-compat-0.4.0.tgz",
      "integrity": "sha512-UfK2Q8RJNjYM/8MFORltZRG9lJj11k0nW84rrffiKvcJxLf1jf6IEjCIkCamykHE73C6BwqhVfhIBs69GXQV0g==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-check": "0.11.0",
        "@firebase/app-check-types": "0.5.3",
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/app-check-interop-types": {
      "version": "0.3.3",
      "resolved": "https://registry.npmjs.org/@firebase/app-check-interop-types/-/app-check-interop-types-0.3.3.tgz",
      "integrity": "sha512-gAlxfPLT2j8bTI/qfe3ahl2I2YcBQ8cFIBdhAQA4I2f3TndcO+22YizyGYuttLHPQEpWkhmpFW60VCFEPg4g5A==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/app-check-types": {
      "version": "0.5.3",
      "resolved": "https://registry.npmjs.org/@firebase/app-check-types/-/app-check-types-0.5.3.tgz",
      "integrity": "sha512-hyl5rKSj0QmwPdsAxrI5x1otDlByQ7bvNvVt8G/XPO2CSwE++rmSVf3VEhaeOR4J8ZFaF0Z0NDSmLejPweZ3ng==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/app-compat": {
      "version": "0.5.6",
      "resolved": "https://registry.npmjs.org/@firebase/app-compat/-/app-compat-0.5.6.tgz",
      "integrity": "sha512-YYGARbutghQY4zZUWMYia0ib0Y/rb52y72/N0z3vglRHL7ii/AaK9SA7S/dzScVOlCdnbHXz+sc5Dq+r8fwFAg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app": "0.14.6",
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/app-types": {
      "version": "0.9.3",
      "resolved": "https://registry.npmjs.org/@firebase/app-types/-/app-types-0.9.3.tgz",
      "integrity": "sha512-kRVpIl4vVGJ4baogMDINbyrIOtOxqhkZQg4jTq3l8Lw6WSk0xfpEYzezFu+Kl4ve4fbPl79dvwRtaFqAC/ucCw==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/auth": {
      "version": "1.12.0",
      "resolved": "https://registry.npmjs.org/@firebase/auth/-/auth-1.12.0.tgz",
      "integrity": "sha512-zkvLpsrxynWHk07qGrUDfCSqKf4AvfZGEqJ7mVCtYGjNNDbGE71k0Yn84rg8QEZu4hQw1BC0qDEHzpNVBcSVmA==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x",
        "@react-native-async-storage/async-storage": "^2.2.0"
      },
      "peerDependenciesMeta": {
        "@react-native-async-storage/async-storage": {
          "optional": true
        }
      }
    },
    "node_modules/@firebase/auth-compat": {
      "version": "0.6.2",
      "resolved": "https://registry.npmjs.org/@firebase/auth-compat/-/auth-compat-0.6.2.tgz",
      "integrity": "sha512-8UhCzF6pav9bw/eXA8Zy1QAKssPRYEYXaWagie1ewLTwHkXv6bKp/j6/IwzSYQP67sy/BMFXIFaCCsoXzFLr7A==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/auth": "1.12.0",
        "@firebase/auth-types": "0.13.0",
        "@firebase/component": "0.7.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/auth-interop-types": {
      "version": "0.2.4",
      "resolved": "https://registry.npmjs.org/@firebase/auth-interop-types/-/auth-interop-types-0.2.4.tgz",
      "integrity": "sha512-JPgcXKCuO+CWqGDnigBtvo09HeBs5u/Ktc2GaFj2m01hLarbxthLNm7Fk8iOP1aqAtXV+fnnGj7U28xmk7IwVA==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/auth-types": {
      "version": "0.13.0",
      "resolved": "https://registry.npmjs.org/@firebase/auth-types/-/auth-types-0.13.0.tgz",
      "integrity": "sha512-S/PuIjni0AQRLF+l9ck0YpsMOdE8GO2KU6ubmBB7P+7TJUCQDa3R1dlgYm9UzGbbePMZsp0xzB93f2b/CgxMOg==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "@firebase/app-types": "0.x",
        "@firebase/util": "1.x"
      }
    },
    "node_modules/@firebase/component": {
      "version": "0.7.0",
      "resolved": "https://registry.npmjs.org/@firebase/component/-/component-0.7.0.tgz",
      "integrity": "sha512-wR9En2A+WESUHexjmRHkqtaVH94WLNKt6rmeqZhSLBybg4Wyf0Umk04SZsS6sBq4102ZsDBFwoqMqJYj2IoDSg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/data-connect": {
      "version": "0.3.12",
      "resolved": "https://registry.npmjs.org/@firebase/data-connect/-/data-connect-0.3.12.tgz",
      "integrity": "sha512-baPddcoNLj/+vYo+HSJidJUdr5W4OkhT109c5qhR8T1dJoZcyJpkv/dFpYlw/VJ3dV66vI8GHQFrmAZw/xUS4g==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/auth-interop-types": "0.2.4",
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/database": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@firebase/database/-/database-1.1.0.tgz",
      "integrity": "sha512-gM6MJFae3pTyNLoc9VcJNuaUDej0ctdjn3cVtILo3D5lpp0dmUHHLFN/pUKe7ImyeB1KAvRlEYxvIHNF04Filg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-check-interop-types": "0.3.3",
        "@firebase/auth-interop-types": "0.2.4",
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "faye-websocket": "0.11.4",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/database-compat": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/@firebase/database-compat/-/database-compat-2.1.0.tgz",
      "integrity": "sha512-8nYc43RqxScsePVd1qe1xxvWNf0OBnbwHxmXJ7MHSuuTVYFO3eLyLW3PiCKJ9fHnmIz4p4LbieXwz+qtr9PZDg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/database": "1.1.0",
        "@firebase/database-types": "1.0.16",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/database-types": {
      "version": "1.0.16",
      "resolved": "https://registry.npmjs.org/@firebase/database-types/-/database-types-1.0.16.tgz",
      "integrity": "sha512-xkQLQfU5De7+SPhEGAXFBnDryUWhhlFXelEg2YeZOQMCdoe7dL64DDAd77SQsR+6uoXIZY5MB4y/inCs4GTfcw==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-types": "0.9.3",
        "@firebase/util": "1.13.0"
      }
    },
    "node_modules/@firebase/firestore": {
      "version": "4.9.3",
      "resolved": "https://registry.npmjs.org/@firebase/firestore/-/firestore-4.9.3.tgz",
      "integrity": "sha512-RVuvhcQzs1sD5Osr2naQS71H0bQMbSnib16uOWAKk3GaKb/WBPyCYSr2Ry7MqlxDP/YhwknUxECL07lw9Rq1nA==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "@firebase/webchannel-wrapper": "1.0.5",
        "@grpc/grpc-js": "~1.9.0",
        "@grpc/proto-loader": "^0.7.8",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/firestore-compat": {
      "version": "0.4.3",
      "resolved": "https://registry.npmjs.org/@firebase/firestore-compat/-/firestore-compat-0.4.3.tgz",
      "integrity": "sha512-1ylF/njF68Pmb6p0erP0U78XQv1w77Wap4bUmqZ7ZVkmN1oMgplyu0TyirWtCBoKFRV2+SUZfWXvIij/z39LYg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/firestore": "4.9.3",
        "@firebase/firestore-types": "3.0.3",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/firestore-types": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@firebase/firestore-types/-/firestore-types-3.0.3.tgz",
      "integrity": "sha512-hD2jGdiWRxB/eZWF89xcK9gF8wvENDJkzpVFb4aGkzfEaKxVRD1kjz1t1Wj8VZEp2LCB53Yx1zD8mrhQu87R6Q==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "@firebase/app-types": "0.x",
        "@firebase/util": "1.x"
      }
    },
    "node_modules/@firebase/functions": {
      "version": "0.13.1",
      "resolved": "https://registry.npmjs.org/@firebase/functions/-/functions-0.13.1.tgz",
      "integrity": "sha512-sUeWSb0rw5T+6wuV2o9XNmh9yHxjFI9zVGFnjFi+n7drTEWpl7ZTz1nROgGrSu472r+LAaj+2YaSicD4R8wfbw==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-check-interop-types": "0.3.3",
        "@firebase/auth-interop-types": "0.2.4",
        "@firebase/component": "0.7.0",
        "@firebase/messaging-interop-types": "0.2.3",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/functions-compat": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/@firebase/functions-compat/-/functions-compat-0.4.1.tgz",
      "integrity": "sha512-AxxUBXKuPrWaVNQ8o1cG1GaCAtXT8a0eaTDfqgS5VsRYLAR0ALcfqDLwo/QyijZj1w8Qf8n3Qrfy/+Im245hOQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/functions": "0.13.1",
        "@firebase/functions-types": "0.6.3",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/functions-types": {
      "version": "0.6.3",
      "resolved": "https://registry.npmjs.org/@firebase/functions-types/-/functions-types-0.6.3.tgz",
      "integrity": "sha512-EZoDKQLUHFKNx6VLipQwrSMh01A1SaL3Wg6Hpi//x6/fJ6Ee4hrAeswK99I5Ht8roiniKHw4iO0B1Oxj5I4plg==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/installations": {
      "version": "0.6.19",
      "resolved": "https://registry.npmjs.org/@firebase/installations/-/installations-0.6.19.tgz",
      "integrity": "sha512-nGDmiwKLI1lerhwfwSHvMR9RZuIH5/8E3kgUWnVRqqL7kGVSktjLTWEMva7oh5yxQ3zXfIlIwJwMcaM5bK5j8Q==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/util": "1.13.0",
        "idb": "7.1.1",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/installations-compat": {
      "version": "0.2.19",
      "resolved": "https://registry.npmjs.org/@firebase/installations-compat/-/installations-compat-0.2.19.tgz",
      "integrity": "sha512-khfzIY3EI5LePePo7vT19/VEIH1E3iYsHknI/6ek9T8QCozAZshWT9CjlwOzZrKvTHMeNcbpo/VSOSIWDSjWdQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/installations": "0.6.19",
        "@firebase/installations-types": "0.5.3",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/installations-types": {
      "version": "0.5.3",
      "resolved": "https://registry.npmjs.org/@firebase/installations-types/-/installations-types-0.5.3.tgz",
      "integrity": "sha512-2FJI7gkLqIE0iYsNQ1P751lO3hER+Umykel+TkLwHj6plzWVxqvfclPUZhcKFVQObqloEBTmpi2Ozn7EkCABAA==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "@firebase/app-types": "0.x"
      }
    },
    "node_modules/@firebase/logger": {
      "version": "0.5.0",
      "resolved": "https://registry.npmjs.org/@firebase/logger/-/logger-0.5.0.tgz",
      "integrity": "sha512-cGskaAvkrnh42b3BA3doDWeBmuHFO/Mx5A83rbRDYakPjO9bJtRL3dX7javzc2Rr/JHZf4HlterTW2lUkfeN4g==",
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/messaging": {
      "version": "0.12.23",
      "resolved": "https://registry.npmjs.org/@firebase/messaging/-/messaging-0.12.23.tgz",
      "integrity": "sha512-cfuzv47XxqW4HH/OcR5rM+AlQd1xL/VhuaeW/wzMW1LFrsFcTn0GND/hak1vkQc2th8UisBcrkVcQAnOnKwYxg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/installations": "0.6.19",
        "@firebase/messaging-interop-types": "0.2.3",
        "@firebase/util": "1.13.0",
        "idb": "7.1.1",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/messaging-compat": {
      "version": "0.2.23",
      "resolved": "https://registry.npmjs.org/@firebase/messaging-compat/-/messaging-compat-0.2.23.tgz",
      "integrity": "sha512-SN857v/kBUvlQ9X/UjAqBoQ2FEaL1ZozpnmL1ByTe57iXkmnVVFm9KqAsTfmf+OEwWI4kJJe9NObtN/w22lUgg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/messaging": "0.12.23",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/messaging-interop-types": {
      "version": "0.2.3",
      "resolved": "https://registry.npmjs.org/@firebase/messaging-interop-types/-/messaging-interop-types-0.2.3.tgz",
      "integrity": "sha512-xfzFaJpzcmtDjycpDeCUj0Ge10ATFi/VHVIvEEjDNc3hodVBQADZ7BWQU7CuFpjSHE+eLuBI13z5F/9xOoGX8Q==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/performance": {
      "version": "0.7.9",
      "resolved": "https://registry.npmjs.org/@firebase/performance/-/performance-0.7.9.tgz",
      "integrity": "sha512-UzybENl1EdM2I1sjYm74xGt/0JzRnU/0VmfMAKo2LSpHJzaj77FCLZXmYQ4oOuE+Pxtt8Wy2BVJEENiZkaZAzQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/installations": "0.6.19",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0",
        "web-vitals": "^4.2.4"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/performance-compat": {
      "version": "0.2.22",
      "resolved": "https://registry.npmjs.org/@firebase/performance-compat/-/performance-compat-0.2.22.tgz",
      "integrity": "sha512-xLKxaSAl/FVi10wDX/CHIYEUP13jXUjinL+UaNXT9ByIvxII5Ne5150mx6IgM8G6Q3V+sPiw9C8/kygkyHUVxg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/performance": "0.7.9",
        "@firebase/performance-types": "0.2.3",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/performance-types": {
      "version": "0.2.3",
      "resolved": "https://registry.npmjs.org/@firebase/performance-types/-/performance-types-0.2.3.tgz",
      "integrity": "sha512-IgkyTz6QZVPAq8GSkLYJvwSLr3LS9+V6vNPQr0x4YozZJiLF5jYixj0amDtATf1X0EtYHqoPO48a9ija8GocxQ==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/remote-config": {
      "version": "0.7.0",
      "resolved": "https://registry.npmjs.org/@firebase/remote-config/-/remote-config-0.7.0.tgz",
      "integrity": "sha512-dX95X6WlW7QlgNd7aaGdjAIZUiQkgWgNS+aKNu4Wv92H1T8Ue/NDUjZHd9xb8fHxLXIHNZeco9/qbZzr500MjQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/installations": "0.6.19",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/remote-config-compat": {
      "version": "0.2.20",
      "resolved": "https://registry.npmjs.org/@firebase/remote-config-compat/-/remote-config-compat-0.2.20.tgz",
      "integrity": "sha512-P/ULS9vU35EL9maG7xp66uljkZgcPMQOxLj3Zx2F289baTKSInE6+YIkgHEi1TwHoddC/AFePXPpshPlEFkbgg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/remote-config": "0.7.0",
        "@firebase/remote-config-types": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/remote-config-types": {
      "version": "0.5.0",
      "resolved": "https://registry.npmjs.org/@firebase/remote-config-types/-/remote-config-types-0.5.0.tgz",
      "integrity": "sha512-vI3bqLoF14L/GchtgayMiFpZJF+Ao3uR8WCde0XpYNkSokDpAKca2DxvcfeZv7lZUqkUwQPL2wD83d3vQ4vvrg==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/storage": {
      "version": "0.14.0",
      "resolved": "https://registry.npmjs.org/@firebase/storage/-/storage-0.14.0.tgz",
      "integrity": "sha512-xWWbb15o6/pWEw8H01UQ1dC5U3rf8QTAzOChYyCpafV6Xki7KVp3Yaw2nSklUwHEziSWE9KoZJS7iYeyqWnYFA==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app": "0.x"
      }
    },
    "node_modules/@firebase/storage-compat": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/@firebase/storage-compat/-/storage-compat-0.4.0.tgz",
      "integrity": "sha512-vDzhgGczr1OfcOy285YAPur5pWDEvD67w4thyeCUh6Ys0izN9fNYtA1MJERmNBfqjqu0lg0FM5GLbw0Il21M+g==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/storage": "0.14.0",
        "@firebase/storage-types": "0.8.3",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "@firebase/app-compat": "0.x"
      }
    },
    "node_modules/@firebase/storage-types": {
      "version": "0.8.3",
      "resolved": "https://registry.npmjs.org/@firebase/storage-types/-/storage-types-0.8.3.tgz",
      "integrity": "sha512-+Muk7g9uwngTpd8xn9OdF/D48uiQ7I1Fae7ULsWPuKoCH3HU7bfFPhxtJYzyhjdniowhuDpQcfPmuNRAqZEfvg==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "@firebase/app-types": "0.x",
        "@firebase/util": "1.x"
      }
    },
    "node_modules/@firebase/util": {
      "version": "1.13.0",
      "resolved": "https://registry.npmjs.org/@firebase/util/-/util-1.13.0.tgz",
      "integrity": "sha512-0AZUyYUfpMNcztR5l09izHwXkZpghLgCUaAGjtMwXnCg3bj4ml5VgiwqOMOxJ+Nw4qN/zJAaOQBcJ7KGkWStqQ==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/webchannel-wrapper": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/@firebase/webchannel-wrapper/-/webchannel-wrapper-1.0.5.tgz",
      "integrity": "sha512-+uGNN7rkfn41HLO0vekTFhTxk61eKa8mTpRGLO0QSqlQdKvIoGAvLp3ppdVIWbTGYJWM6Kp0iN+PjMIOcnVqTw==",
      "license": "Apache-2.0"
    },
    "node_modules/@google-cloud/firestore": {
      "version": "7.11.6",
      "resolved": "https://registry.npmjs.org/@google-cloud/firestore/-/firestore-7.11.6.tgz",
      "integrity": "sha512-EW/O8ktzwLfyWBOsNuhRoMi8lrC3clHM5LVFhGvO1HCsLozCOOXRAlHrYBoE6HL42Sc8yYMuCb2XqcnJ4OOEpw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@opentelemetry/api": "^1.3.0",
        "fast-deep-equal": "^3.1.1",
        "functional-red-black-tree": "^1.0.1",
        "google-gax": "^4.3.3",
        "protobufjs": "^7.2.6"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@google-cloud/paginator": {
      "version": "5.0.2",
      "resolved": "https://registry.npmjs.org/@google-cloud/paginator/-/paginator-5.0.2.tgz",
      "integrity": "sha512-DJS3s0OVH4zFDB1PzjxAsHqJT6sKVbRwwML0ZBP9PbU7Yebtu/7SWMRzvO2J3nUi9pRNITCfu4LJeooM2w4pjg==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "arrify": "^2.0.0",
        "extend": "^3.0.2"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@google-cloud/projectify": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/@google-cloud/projectify/-/projectify-4.0.0.tgz",
      "integrity": "sha512-MmaX6HeSvyPbWGwFq7mXdo0uQZLGBYCwziiLIGq5JVX+/bdI3SAq6bP98trV5eTWfLuvsMcIC1YJOF2vfteLFA==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@google-cloud/promisify": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/@google-cloud/promisify/-/promisify-4.0.0.tgz",
      "integrity": "sha512-Orxzlfb9c67A15cq2JQEyVc7wEsmFBmHjZWZYQMUyJ1qivXyMwdyNOs9odi79hze+2zqdTtu1E19IM/FtqZ10g==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@google-cloud/storage": {
      "version": "7.18.0",
      "resolved": "https://registry.npmjs.org/@google-cloud/storage/-/storage-7.18.0.tgz",
      "integrity": "sha512-r3ZwDMiz4nwW6R922Z1pwpePxyRwE5GdevYX63hRmAQUkUQJcBH/79EnQPDv5cOv1mFBgevdNWQfi3tie3dHrQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@google-cloud/paginator": "^5.0.0",
        "@google-cloud/projectify": "^4.0.0",
        "@google-cloud/promisify": "<4.1.0",
        "abort-controller": "^3.0.0",
        "async-retry": "^1.3.3",
        "duplexify": "^4.1.3",
        "fast-xml-parser": "^4.4.1",
        "gaxios": "^6.0.2",
        "google-auth-library": "^9.6.3",
        "html-entities": "^2.5.2",
        "mime": "^3.0.0",
        "p-limit": "^3.0.1",
        "retry-request": "^7.0.0",
        "teeny-request": "^9.0.0",
        "uuid": "^8.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@google-cloud/storage/node_modules/uuid": {
      "version": "8.3.2",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-8.3.2.tgz",
      "integrity": "sha512-+NYs2QeMWy+GWFOEm9xnn6HCDp0l7QBD7ml8zLUmJ+93Q5NF0NocErnwkTkXVFNiX3/fpC6afS8Dhb/gz7R7eg==",
      "license": "MIT",
      "optional": true,
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/@grpc/grpc-js": {
      "version": "1.9.15",
      "resolved": "https://registry.npmjs.org/@grpc/grpc-js/-/grpc-js-1.9.15.tgz",
      "integrity": "sha512-nqE7Hc0AzI+euzUwDAy0aY5hCp10r734gMGRdU+qOPX0XSceI2ULrcXB5U2xSc5VkWwalCj4M7GzCAygZl2KoQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "@grpc/proto-loader": "^0.7.8",
        "@types/node": ">=12.12.47"
      },
      "engines": {
        "node": "^8.13.0 || >=10.10.0"
      }
    },
    "node_modules/@grpc/proto-loader": {
      "version": "0.7.15",
      "resolved": "https://registry.npmjs.org/@grpc/proto-loader/-/proto-loader-0.7.15.tgz",
      "integrity": "sha512-tMXdRCfYVixjuFK+Hk0Q1s38gV9zDiDJfWL3h1rv4Qc39oILCu1TRTDt7+fGUI8K4G1Fj125Hx/ru3azECWTyQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "lodash.camelcase": "^4.3.0",
        "long": "^5.0.0",
        "protobufjs": "^7.2.5",
        "yargs": "^17.7.2"
      },
      "bin": {
        "proto-loader-gen-types": "build/bin/proto-loader-gen-types.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/@humanfs/core": {
      "version": "0.19.1",
      "resolved": "https://registry.npmjs.org/@humanfs/core/-/core-0.19.1.tgz",
      "integrity": "sha512-5DyQ4+1JEUzejeK1JGICcideyfUbGixgS9jNgex5nqkW+cY7WZhxBigmieN5Qnw9ZosSNVC9KQKyb+GUaGyKUA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18.0"
      }
    },
    "node_modules/@humanfs/node": {
      "version": "0.16.7",
      "resolved": "https://registry.npmjs.org/@humanfs/node/-/node-0.16.7.tgz",
      "integrity": "sha512-/zUx+yOsIrG4Y43Eh2peDeKCxlRt/gET6aHfaKpuq267qXdYDFViVHfMaLyygZOnl0kGWxFIgsBy8QFuTLUXEQ==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@humanfs/core": "^0.19.1",
        "@humanwhocodes/retry": "^0.4.0"
      },
      "engines": {
        "node": ">=18.18.0"
      }
    },
    "node_modules/@humanwhocodes/module-importer": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/@humanwhocodes/module-importer/-/module-importer-1.0.1.tgz",
      "integrity": "sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=12.22"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/nzakas"
      }
    },
    "node_modules/@humanwhocodes/retry": {
      "version": "0.4.3",
      "resolved": "https://registry.npmjs.org/@humanwhocodes/retry/-/retry-0.4.3.tgz",
      "integrity": "sha512-bV0Tgo9K4hfPCek+aMAn81RppFKv2ySDQeMoSZuvTASywNTnVJCArCZE2FWqpvIatKu7VMRLWlR1EazvVhDyhQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/nzakas"
      }
    },
    "node_modules/@img/colour": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@img/colour/-/colour-1.0.0.tgz",
      "integrity": "sha512-A5P/LfWGFSl6nsckYtjw9da+19jB8hkJ6ACTGcDfEJ0aE+l2n2El7dsVM7UVHZQ9s2lmYMWlrS21YLy2IR1LUw==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@img/sharp-darwin-arm64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-arm64/-/sharp-darwin-arm64-0.34.5.tgz",
      "integrity": "sha512-imtQ3WMJXbMY4fxb/Ndp6HBTNVtWCUI0WdobyheGf5+ad6xX8VIDO8u2xE4qc/fr08CKG/7dDseFtn6M6g/r3w==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-darwin-arm64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-darwin-x64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-x64/-/sharp-darwin-x64-0.34.5.tgz",
      "integrity": "sha512-YNEFAF/4KQ/PeW0N+r+aVVsoIY0/qxxikF2SWdp+NRkmMB7y9LBZAVqQ4yhGCm/H3H270OSykqmQMKLBhBJDEw==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-darwin-x64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-libvips-darwin-arm64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-arm64/-/sharp-libvips-darwin-arm64-1.2.4.tgz",
      "integrity": "sha512-zqjjo7RatFfFoP0MkQ51jfuFZBnVE2pRiaydKJ1G/rHZvnsrHAOcQALIi9sA5co5xenQdTugCvtb1cuf78Vf4g==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "darwin"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-darwin-x64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-x64/-/sharp-libvips-darwin-x64-1.2.4.tgz",
      "integrity": "sha512-1IOd5xfVhlGwX+zXv2N93k0yMONvUlANylbJw1eTah8K/Jtpi15KC+WSiaX/nBmbm2HxRM1gZ0nSdjSsrZbGKg==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "darwin"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-arm": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm/-/sharp-libvips-linux-arm-1.2.4.tgz",
      "integrity": "sha512-bFI7xcKFELdiNCVov8e44Ia4u2byA+l3XtsAj+Q8tfCwO6BQ8iDojYdvoPMqsKDkuoOo+X6HZA0s0q11ANMQ8A==",
      "cpu": [
        "arm"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-arm64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm64/-/sharp-libvips-linux-arm64-1.2.4.tgz",
      "integrity": "sha512-excjX8DfsIcJ10x1Kzr4RcWe1edC9PquDRRPx3YVCvQv+U5p7Yin2s32ftzikXojb1PIFc/9Mt28/y+iRklkrw==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-ppc64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-ppc64/-/sharp-libvips-linux-ppc64-1.2.4.tgz",
      "integrity": "sha512-FMuvGijLDYG6lW+b/UvyilUWu5Ayu+3r2d1S8notiGCIyYU/76eig1UfMmkZ7vwgOrzKzlQbFSuQfgm7GYUPpA==",
      "cpu": [
        "ppc64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-riscv64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-riscv64/-/sharp-libvips-linux-riscv64-1.2.4.tgz",
      "integrity": "sha512-oVDbcR4zUC0ce82teubSm+x6ETixtKZBh/qbREIOcI3cULzDyb18Sr/Wcyx7NRQeQzOiHTNbZFF1UwPS2scyGA==",
      "cpu": [
        "riscv64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-s390x": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-s390x/-/sharp-libvips-linux-s390x-1.2.4.tgz",
      "integrity": "sha512-qmp9VrzgPgMoGZyPvrQHqk02uyjA0/QrTO26Tqk6l4ZV0MPWIW6LTkqOIov+J1yEu7MbFQaDpwdwJKhbJvuRxQ==",
      "cpu": [
        "s390x"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-x64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-x64/-/sharp-libvips-linux-x64-1.2.4.tgz",
      "integrity": "sha512-tJxiiLsmHc9Ax1bz3oaOYBURTXGIRDODBqhveVHonrHJ9/+k89qbLl0bcJns+e4t4rvaNBxaEZsFtSfAdquPrw==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linuxmusl-arm64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-arm64/-/sharp-libvips-linuxmusl-arm64-1.2.4.tgz",
      "integrity": "sha512-FVQHuwx1IIuNow9QAbYUzJ+En8KcVm9Lk5+uGUQJHaZmMECZmOlix9HnH7n1TRkXMS0pGxIJokIVB9SuqZGGXw==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linuxmusl-x64": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-x64/-/sharp-libvips-linuxmusl-x64-1.2.4.tgz",
      "integrity": "sha512-+LpyBk7L44ZIXwz/VYfglaX/okxezESc6UxDSoyo2Ks6Jxc4Y7sGjpgU9s4PMgqgjj1gZCylTieNamqA1MF7Dg==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-linux-arm": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm/-/sharp-linux-arm-0.34.5.tgz",
      "integrity": "sha512-9dLqsvwtg1uuXBGZKsxem9595+ujv0sJ6Vi8wcTANSFpwV/GONat5eCkzQo/1O6zRIkh0m/8+5BjrRr7jDUSZw==",
      "cpu": [
        "arm"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-arm": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linux-arm64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm64/-/sharp-linux-arm64-0.34.5.tgz",
      "integrity": "sha512-bKQzaJRY/bkPOXyKx5EVup7qkaojECG6NLYswgktOZjaXecSAeCWiZwwiFf3/Y+O1HrauiE3FVsGxFg8c24rZg==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-arm64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linux-ppc64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-ppc64/-/sharp-linux-ppc64-0.34.5.tgz",
      "integrity": "sha512-7zznwNaqW6YtsfrGGDA6BRkISKAAE1Jo0QdpNYXNMHu2+0dTrPflTLNkpc8l7MUP5M16ZJcUvysVWWrMefZquA==",
      "cpu": [
        "ppc64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-ppc64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linux-riscv64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-riscv64/-/sharp-linux-riscv64-0.34.5.tgz",
      "integrity": "sha512-51gJuLPTKa7piYPaVs8GmByo7/U7/7TZOq+cnXJIHZKavIRHAP77e3N2HEl3dgiqdD/w0yUfiJnII77PuDDFdw==",
      "cpu": [
        "riscv64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-riscv64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linux-s390x": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-s390x/-/sharp-linux-s390x-0.34.5.tgz",
      "integrity": "sha512-nQtCk0PdKfho3eC5MrbQoigJ2gd1CgddUMkabUj+rBevs8tZ2cULOx46E7oyX+04WGfABgIwmMC0VqieTiR4jg==",
      "cpu": [
        "s390x"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-s390x": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linux-x64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-x64/-/sharp-linux-x64-0.34.5.tgz",
      "integrity": "sha512-MEzd8HPKxVxVenwAa+JRPwEC7QFjoPWuS5NZnBt6B3pu7EG2Ge0id1oLHZpPJdn3OQK+BQDiw9zStiHBTJQQQQ==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-x64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linuxmusl-arm64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-arm64/-/sharp-linuxmusl-arm64-0.34.5.tgz",
      "integrity": "sha512-fprJR6GtRsMt6Kyfq44IsChVZeGN97gTD331weR1ex1c1rypDEABN6Tm2xa1wE6lYb5DdEnk03NZPqA7Id21yg==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linuxmusl-arm64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-linuxmusl-x64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-x64/-/sharp-linuxmusl-x64-0.34.5.tgz",
      "integrity": "sha512-Jg8wNT1MUzIvhBFxViqrEhWDGzqymo3sV7z7ZsaWbZNDLXRJZoRGrjulp60YYtV4wfY8VIKcWidjojlLcWrd8Q==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linuxmusl-x64": "1.2.4"
      }
    },
    "node_modules/@img/sharp-wasm32": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-wasm32/-/sharp-wasm32-0.34.5.tgz",
      "integrity": "sha512-OdWTEiVkY2PHwqkbBI8frFxQQFekHaSSkUIJkwzclWZe64O1X4UlUjqqqLaPbUpMOQk6FBu/HtlGXNblIs0huw==",
      "cpu": [
        "wasm32"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later AND MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/runtime": "^1.7.0"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-arm64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-arm64/-/sharp-win32-arm64-0.34.5.tgz",
      "integrity": "sha512-WQ3AgWCWYSb2yt+IG8mnC6Jdk9Whs7O0gxphblsLvdhSpSTtmu69ZG1Gkb6NuvxsNACwiPV6cNSZNzt0KPsw7g==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-ia32": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-ia32/-/sharp-win32-ia32-0.34.5.tgz",
      "integrity": "sha512-FV9m/7NmeCmSHDD5j4+4pNI8Cp3aW+JvLoXcTUo0IqyjSfAZJ8dIUmijx1qaJsIiU+Hosw6xM5KijAWRJCSgNg==",
      "cpu": [
        "ia32"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-x64": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-x64/-/sharp-win32-x64-0.34.5.tgz",
      "integrity": "sha512-+29YMsqY2/9eFEiW93eqWnuLcWcufowXewwSNIT6UwZdUUCrM3oFjMWH/Z6/TMmb4hlFenmfAVbpWeup2jryCw==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@js-sdsl/ordered-map": {
      "version": "4.4.2",
      "resolved": "https://registry.npmjs.org/@js-sdsl/ordered-map/-/ordered-map-4.4.2.tgz",
      "integrity": "sha512-iUKgm52T8HOE/makSxjqoWhe95ZJA1/G1sYsGev2JDKUSS14KAgg1LHb+Ba+IPow0xflbnSkOsZcO08C7w1gYw==",
      "license": "MIT",
      "optional": true,
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/js-sdsl"
      }
    },
    "node_modules/@napi-rs/wasm-runtime": {
      "version": "0.2.12",
      "resolved": "https://registry.npmjs.org/@napi-rs/wasm-runtime/-/wasm-runtime-0.2.12.tgz",
      "integrity": "sha512-ZVWUcfwY4E/yPitQJl481FjFo3K22D6qF0DuFH6Y/nbnE11GY5uguDxZMGXPQ8WQ0128MXQD7TnfHyK4oWoIJQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/core": "^1.4.3",
        "@emnapi/runtime": "^1.4.3",
        "@tybys/wasm-util": "^0.10.0"
      }
    },
    "node_modules/@next/env": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/env/-/env-16.0.10.tgz",
      "integrity": "sha512-8tuaQkyDVgeONQ1MeT9Mkk8pQmZapMKFh5B+OrFUlG3rVmYTXcXlBetBgTurKXGaIZvkoqRT9JL5K3phXcgang==",
      "license": "MIT"
    },
    "node_modules/@next/eslint-plugin-next": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/eslint-plugin-next/-/eslint-plugin-next-16.0.10.tgz",
      "integrity": "sha512-b2NlWN70bbPLmfyoLvvidPKWENBYYIe017ZGUpElvQjDytCWgxPJx7L9juxHt0xHvNVA08ZHJdOyhGzon/KJuw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fast-glob": "3.3.1"
      }
    },
    "node_modules/@next/swc-darwin-arm64": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-darwin-arm64/-/swc-darwin-arm64-16.0.10.tgz",
      "integrity": "sha512-4XgdKtdVsaflErz+B5XeG0T5PeXKDdruDf3CRpnhN+8UebNa5N2H58+3GDgpn/9GBurrQ1uWW768FfscwYkJRg==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-darwin-x64": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-darwin-x64/-/swc-darwin-x64-16.0.10.tgz",
      "integrity": "sha512-spbEObMvRKkQ3CkYVOME+ocPDFo5UqHb8EMTS78/0mQ+O1nqE8toHJVioZo4TvebATxgA8XMTHHrScPrn68OGw==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-arm64-gnu": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-arm64-gnu/-/swc-linux-arm64-gnu-16.0.10.tgz",
      "integrity": "sha512-uQtWE3X0iGB8apTIskOMi2w/MKONrPOUCi5yLO+v3O8Mb5c7K4Q5KD1jvTpTF5gJKa3VH/ijKjKUq9O9UhwOYw==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-arm64-musl": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-arm64-musl/-/swc-linux-arm64-musl-16.0.10.tgz",
      "integrity": "sha512-llA+hiDTrYvyWI21Z0L1GiXwjQaanPVQQwru5peOgtooeJ8qx3tlqRV2P7uH2pKQaUfHxI/WVarvI5oYgGxaTw==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-x64-gnu": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-x64-gnu/-/swc-linux-x64-gnu-16.0.10.tgz",
      "integrity": "sha512-AK2q5H0+a9nsXbeZ3FZdMtbtu9jxW4R/NgzZ6+lrTm3d6Zb7jYrWcgjcpM1k8uuqlSy4xIyPR2YiuUr+wXsavA==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-x64-musl": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-x64-musl/-/swc-linux-x64-musl-16.0.10.tgz",
      "integrity": "sha512-1TDG9PDKivNw5550S111gsO4RGennLVl9cipPhtkXIFVwo31YZ73nEbLjNC8qG3SgTz/QZyYyaFYMeY4BKZR/g==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-win32-arm64-msvc": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-win32-arm64-msvc/-/swc-win32-arm64-msvc-16.0.10.tgz",
      "integrity": "sha512-aEZIS4Hh32xdJQbHz121pyuVZniSNoqDVx1yIr2hy+ZwJGipeqnMZBJHyMxv2tiuAXGx6/xpTcQJ6btIiBjgmg==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-win32-x64-msvc": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/@next/swc-win32-x64-msvc/-/swc-win32-x64-msvc-16.0.10.tgz",
      "integrity": "sha512-E+njfCoFLb01RAFEnGZn6ERoOqhK1Gl3Lfz1Kjnj0Ulfu7oJbuMyvBKNj/bw8XZnenHDASlygTjZICQW+rYW1Q==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@nodelib/fs.scandir": {
      "version": "2.1.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
      "integrity": "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "2.0.5",
        "run-parallel": "^1.1.9"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.stat": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz",
      "integrity": "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.walk": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz",
      "integrity": "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.scandir": "2.1.5",
        "fastq": "^1.6.0"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nolyfill/is-core-module": {
      "version": "1.0.39",
      "resolved": "https://registry.npmjs.org/@nolyfill/is-core-module/-/is-core-module-1.0.39.tgz",
      "integrity": "sha512-nn5ozdjYQpUCZlWGuxcJY/KpxkWQs4DcbMCmKojjyrYDEAGy4Ce19NN4v5MduafTwJlbKc99UA8YhSVqq9yPZA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12.4.0"
      }
    },
    "node_modules/@opentelemetry/api": {
      "version": "1.9.0",
      "resolved": "https://registry.npmjs.org/@opentelemetry/api/-/api-1.9.0.tgz",
      "integrity": "sha512-3giAOQvZiH5F9bMlMiv8+GSPMeqg0dbaeo58/0SlA9sxSqZhnUtxzX9/2FzyhS9sWQf5S0GJE0AKBrFqjpeYcg==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=8.0.0"
      }
    },
    "node_modules/@protobufjs/aspromise": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/aspromise/-/aspromise-1.1.2.tgz",
      "integrity": "sha512-j+gKExEuLmKwvz3OgROXtrJ2UG2x8Ch2YZUxahh+s1F2HZ+wAceUNLkvy6zKCPVRkU++ZWQrdxsUeQXmcg4uoQ==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/base64": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/base64/-/base64-1.1.2.tgz",
      "integrity": "sha512-AZkcAA5vnN/v4PDqKyMR5lx7hZttPDgClv83E//FMNhR2TMcLUhfRUBHCmSl0oi9zMgDDqRUJkSxO3wm85+XLg==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/codegen": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/@protobufjs/codegen/-/codegen-2.0.4.tgz",
      "integrity": "sha512-YyFaikqM5sH0ziFZCN3xDC7zeGaB/d0IUb9CATugHWbd1FRFwWwt4ld4OYMPWu5a3Xe01mGAULCdqhMlPl29Jg==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/eventemitter": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/eventemitter/-/eventemitter-1.1.0.tgz",
      "integrity": "sha512-j9ednRT81vYJ9OfVuXG6ERSTdEL1xVsNgqpkxMsbIabzSo3goCjDIveeGv5d03om39ML71RdmrGNjG5SReBP/Q==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/fetch": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/fetch/-/fetch-1.1.0.tgz",
      "integrity": "sha512-lljVXpqXebpsijW71PZaCYeIcE5on1w5DlQy5WH6GLbFryLUrBD4932W/E2BSpfRJWseIL4v/KPgBFxDOIdKpQ==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@protobufjs/aspromise": "^1.1.1",
        "@protobufjs/inquire": "^1.1.0"
      }
    },
    "node_modules/@protobufjs/float": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/float/-/float-1.0.2.tgz",
      "integrity": "sha512-Ddb+kVXlXst9d+R9PfTIxh1EdNkgoRe5tOX6t01f1lYWOvJnSPDBlG241QLzcyPdoNTsblLUdujGSE4RzrTZGQ==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/inquire": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/inquire/-/inquire-1.1.0.tgz",
      "integrity": "sha512-kdSefcPdruJiFMVSbn801t4vFK7KB/5gd2fYvrxhuJYg8ILrmn9SKSX2tZdV6V+ksulWqS7aXjBcRXl3wHoD9Q==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/path": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/path/-/path-1.1.2.tgz",
      "integrity": "sha512-6JOcJ5Tm08dOHAbdR3GrvP+yUUfkjG5ePsHYczMFLq3ZmMkAD98cDgcT2iA1lJ9NVwFd4tH/iSSoe44YWkltEA==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/pool": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/pool/-/pool-1.1.0.tgz",
      "integrity": "sha512-0kELaGSIDBKvcgS4zkjz1PeddatrjYcmMWOlAuAPwAeccUrPHdUqo/J6LiymHHEiJT5NrF1UVwxY14f+fy4WQw==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/utf8": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/utf8/-/utf8-1.1.0.tgz",
      "integrity": "sha512-Vvn3zZrhQZkkBE8LSuW3em98c0FwgO4nxzv6OdSxPKJIEKY2bGbHn+mhGIPerzI4twdxaP8/0+06HBpwf345Lw==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@puppeteer/browsers": {
      "version": "2.11.0",
      "resolved": "https://registry.npmjs.org/@puppeteer/browsers/-/browsers-2.11.0.tgz",
      "integrity": "sha512-n6oQX6mYkG8TRPuPXmbPidkUbsSRalhmaaVAQxvH1IkQy63cwsH+kOjB3e4cpCDHg0aSvsiX9bQ4s2VB6mGWUQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "debug": "^4.4.3",
        "extract-zip": "^2.0.1",
        "progress": "^2.0.3",
        "proxy-agent": "^6.5.0",
        "semver": "^7.7.3",
        "tar-fs": "^3.1.1",
        "yargs": "^17.7.2"
      },
      "bin": {
        "browsers": "lib/cjs/main-cli.js"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@puppeteer/browsers/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/@rtsao/scc": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@rtsao/scc/-/scc-1.1.0.tgz",
      "integrity": "sha512-zt6OdqaDoOnJ1ZYsCYGt9YmWzDXl4vQdKTyJev62gFhRGKdx7mcT54V9KIjg+d2wi9EXsPvAPKe7i7WjfVWB8g==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@swc/helpers": {
      "version": "0.5.15",
      "resolved": "https://registry.npmjs.org/@swc/helpers/-/helpers-0.5.15.tgz",
      "integrity": "sha512-JQ5TuMi45Owi4/BIMAJBoSQoOJu12oOk/gADqlcUL9JEdHB8vyjUSsxqeNXnmXHjYKMi2WcYtezGEEhqUI/E2g==",
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.8.0"
      }
    },
    "node_modules/@tootallnate/once": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@tootallnate/once/-/once-2.0.0.tgz",
      "integrity": "sha512-XCuKFP5PS55gnMVu3dty8KPatLqUoy/ZYzDzAGCQ8JNFCkLXzmI7vNHCR+XpbZaMWQK/vQubr7PkYq8g470J/A==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tootallnate/quickjs-emscripten": {
      "version": "0.23.0",
      "resolved": "https://registry.npmjs.org/@tootallnate/quickjs-emscripten/-/quickjs-emscripten-0.23.0.tgz",
      "integrity": "sha512-C5Mc6rdnsaJDjO3UpGW/CQTHtCKaYlScZTly4JIu97Jxo/odCiH0ITnDXSJPTOrEKk/ycSZ0AOgTmkDtkOsvIA==",
      "license": "MIT"
    },
    "node_modules/@tybys/wasm-util": {
      "version": "0.10.1",
      "resolved": "https://registry.npmjs.org/@tybys/wasm-util/-/wasm-util-0.10.1.tgz",
      "integrity": "sha512-9tTaPJLSiejZKx+Bmog4uSubteqTvFrVrURwkmHixBo0G4seD0zUxp98E1DzUBJxLQ3NPwXrGKDiVjwx/DpPsg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@types/body-parser": {
      "version": "1.19.6",
      "resolved": "https://registry.npmjs.org/@types/body-parser/-/body-parser-1.19.6.tgz",
      "integrity": "sha512-HLFeCYgz89uk22N5Qg3dvGvsv46B8GLvKKo1zKG4NybA8U2DiEO3w9lqGg29t/tfLRJpJ6iQxnVw4OnB7MoM9g==",
      "license": "MIT",
      "dependencies": {
        "@types/connect": "*",
        "@types/node": "*"
      }
    },
    "node_modules/@types/caseless": {
      "version": "0.12.5",
      "resolved": "https://registry.npmjs.org/@types/caseless/-/caseless-0.12.5.tgz",
      "integrity": "sha512-hWtVTC2q7hc7xZ/RLbxapMvDMgUnDvKvMOpKal4DrMyfGBUfB1oKaZlIRr6mJL+If3bAP6sV/QneGzF6tJjZDg==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/@types/connect": {
      "version": "3.4.38",
      "resolved": "https://registry.npmjs.org/@types/connect/-/connect-3.4.38.tgz",
      "integrity": "sha512-K6uROf1LD88uDQqJCktA4yzL1YYAK6NgfsI0v/mTgyPKWsX1CnJ0XPSDhViejru1GcRkLWb8RlzFYJRqGUbaug==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/express": {
      "version": "4.17.25",
      "resolved": "https://registry.npmjs.org/@types/express/-/express-4.17.25.tgz",
      "integrity": "sha512-dVd04UKsfpINUnK0yBoYHDF3xu7xVH4BuDotC/xGuycx4CgbP48X/KF/586bcObxT0HENHXEU8Nqtu6NR+eKhw==",
      "license": "MIT",
      "dependencies": {
        "@types/body-parser": "*",
        "@types/express-serve-static-core": "^4.17.33",
        "@types/qs": "*",
        "@types/serve-static": "^1"
      }
    },
    "node_modules/@types/express-serve-static-core": {
      "version": "4.19.7",
      "resolved": "https://registry.npmjs.org/@types/express-serve-static-core/-/express-serve-static-core-4.19.7.tgz",
      "integrity": "sha512-FvPtiIf1LfhzsaIXhv/PHan/2FeQBbtBDtfX2QfvPxdUelMDEckK08SM6nqo1MIZY3RUlfA+HV8+hFUSio78qg==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*",
        "@types/qs": "*",
        "@types/range-parser": "*",
        "@types/send": "*"
      }
    },
    "node_modules/@types/http-errors": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@types/http-errors/-/http-errors-2.0.5.tgz",
      "integrity": "sha512-r8Tayk8HJnX0FztbZN7oVqGccWgw98T/0neJphO91KkmOzug1KkofZURD4UaD5uH8AqcFLfdPErnBod0u71/qg==",
      "license": "MIT"
    },
    "node_modules/@types/json-schema": {
      "version": "7.0.15",
      "resolved": "https://registry.npmjs.org/@types/json-schema/-/json-schema-7.0.15.tgz",
      "integrity": "sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/json5": {
      "version": "0.0.29",
      "resolved": "https://registry.npmjs.org/@types/json5/-/json5-0.0.29.tgz",
      "integrity": "sha512-dRLjCWHYg4oaA77cxO64oO+7JwCwnIzkZPdrrC71jQmQtlhM556pwKo5bUzqvZndkVbeFLIIi+9TC40JNF5hNQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/jsonwebtoken": {
      "version": "9.0.10",
      "resolved": "https://registry.npmjs.org/@types/jsonwebtoken/-/jsonwebtoken-9.0.10.tgz",
      "integrity": "sha512-asx5hIG9Qmf/1oStypjanR7iKTv0gXQ1Ov/jfrX6kS/EO0OFni8orbmGCn0672NHR3kXHwpAwR+B368ZGN/2rA==",
      "license": "MIT",
      "dependencies": {
        "@types/ms": "*",
        "@types/node": "*"
      }
    },
    "node_modules/@types/long": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/@types/long/-/long-4.0.2.tgz",
      "integrity": "sha512-MqTGEo5bj5t157U6fA/BiDynNkn0YknVdh48CMPkTSpFTVmvao5UQmm7uEF6xBEo7qIMAlY/JSleYaE6VOdpaA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/@types/mime": {
      "version": "1.3.5",
      "resolved": "https://registry.npmjs.org/@types/mime/-/mime-1.3.5.tgz",
      "integrity": "sha512-/pyBZWSLD2n0dcHE3hq8s8ZvcETHtEuF+3E7XVt0Ig2nvsVQXdghHVcEkIWjy9A0wKfTn97a/PSDYohKIlnP/w==",
      "license": "MIT"
    },
    "node_modules/@types/ms": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
      "license": "MIT"
    },
    "node_modules/@types/node": {
      "version": "20.19.27",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-20.19.27.tgz",
      "integrity": "sha512-N2clP5pJhB2YnZJ3PIHFk5RkygRX5WO/5f0WC08tp0wd+sv0rsJk3MqWn3CbNmT2J505a5336jaQj4ph1AdMug==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~6.21.0"
      }
    },
    "node_modules/@types/qs": {
      "version": "6.14.0",
      "resolved": "https://registry.npmjs.org/@types/qs/-/qs-6.14.0.tgz",
      "integrity": "sha512-eOunJqu0K1923aExK6y8p6fsihYEn/BYuQ4g0CxAAgFc4b/ZLN4CrsRZ55srTdqoiLzU2B2evC+apEIxprEzkQ==",
      "license": "MIT"
    },
    "node_modules/@types/range-parser": {
      "version": "1.2.7",
      "resolved": "https://registry.npmjs.org/@types/range-parser/-/range-parser-1.2.7.tgz",
      "integrity": "sha512-hKormJbkJqzQGhziax5PItDUTMAM9uE2XXQmM37dyd4hVM+5aVl7oVxMVUiVQn2oCQFN/LKCZdvSM0pFRqbSmQ==",
      "license": "MIT"
    },
    "node_modules/@types/react": {
      "version": "19.2.7",
      "resolved": "https://registry.npmjs.org/@types/react/-/react-19.2.7.tgz",
      "integrity": "sha512-MWtvHrGZLFttgeEj28VXHxpmwYbor/ATPYbBfSFZEIRK0ecCFLl2Qo55z52Hss+UV9CRN7trSeq1zbgx7YDWWg==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "csstype": "^3.2.2"
      }
    },
    "node_modules/@types/react-dom": {
      "version": "19.2.3",
      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-19.2.3.tgz",
      "integrity": "sha512-jp2L/eY6fn+KgVVQAOqYItbF0VY/YApe5Mz2F0aykSO8gx31bYCZyvSeYxCHKvzHG5eZjc+zyaS5BrBWya2+kQ==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "^19.2.0"
      }
    },
    "node_modules/@types/request": {
      "version": "2.48.13",
      "resolved": "https://registry.npmjs.org/@types/request/-/request-2.48.13.tgz",
      "integrity": "sha512-FGJ6udDNUCjd19pp0Q3iTiDkwhYup7J8hpMW9c4k53NrccQFFWKRho6hvtPPEhnXWKvukfwAlB6DbDz4yhH5Gg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@types/caseless": "*",
        "@types/node": "*",
        "@types/tough-cookie": "*",
        "form-data": "^2.5.5"
      }
    },
    "node_modules/@types/send": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@types/send/-/send-1.2.1.tgz",
      "integrity": "sha512-arsCikDvlU99zl1g69TcAB3mzZPpxgw0UQnaHeC1Nwb015xp8bknZv5rIfri9xTOcMuaVgvabfIRA7PSZVuZIQ==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/serve-static": {
      "version": "1.15.10",
      "resolved": "https://registry.npmjs.org/@types/serve-static/-/serve-static-1.15.10.tgz",
      "integrity": "sha512-tRs1dB+g8Itk72rlSI2ZrW6vZg0YrLI81iQSTkMmOqnqCaNr/8Ek4VwWcN5vZgCYWbg/JJSGBlUaYGAOP73qBw==",
      "license": "MIT",
      "dependencies": {
        "@types/http-errors": "*",
        "@types/node": "*",
        "@types/send": "<1"
      }
    },
    "node_modules/@types/serve-static/node_modules/@types/send": {
      "version": "0.17.6",
      "resolved": "https://registry.npmjs.org/@types/send/-/send-0.17.6.tgz",
      "integrity": "sha512-Uqt8rPBE8SY0RK8JB1EzVOIZ32uqy8HwdxCnoCOsYrvnswqmFZ/k+9Ikidlk/ImhsdvBsloHbAlewb2IEBV/Og==",
      "license": "MIT",
      "dependencies": {
        "@types/mime": "^1",
        "@types/node": "*"
      }
    },
    "node_modules/@types/tough-cookie": {
      "version": "4.0.5",
      "resolved": "https://registry.npmjs.org/@types/tough-cookie/-/tough-cookie-4.0.5.tgz",
      "integrity": "sha512-/Ad8+nIOV7Rl++6f1BdKxFSMgmoqEoYbHRpPcx3JEfv8VRsQe9Z4mCXeJBzxs7mbHY/XOZZuXlRNfhpVPbs6ZA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/@types/yauzl": {
      "version": "2.10.3",
      "resolved": "https://registry.npmjs.org/@types/yauzl/-/yauzl-2.10.3.tgz",
      "integrity": "sha512-oJoftv0LSuaDZE3Le4DbKX+KS9G36NzOeSap90UIK0yMA/NhKJhqlSGtNDORNRaIbQfzjXDrQa0ytJ6mNRGz/Q==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@typescript-eslint/eslint-plugin": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/eslint-plugin/-/eslint-plugin-8.50.0.tgz",
      "integrity": "sha512-O7QnmOXYKVtPrfYzMolrCTfkezCJS9+ljLdKW/+DCvRsc3UAz+sbH6Xcsv7p30+0OwUbeWfUDAQE0vpabZ3QLg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/regexpp": "^4.10.0",
        "@typescript-eslint/scope-manager": "8.50.0",
        "@typescript-eslint/type-utils": "8.50.0",
        "@typescript-eslint/utils": "8.50.0",
        "@typescript-eslint/visitor-keys": "8.50.0",
        "ignore": "^7.0.0",
        "natural-compare": "^1.4.0",
        "ts-api-utils": "^2.1.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "@typescript-eslint/parser": "^8.50.0",
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/eslint-plugin/node_modules/ignore": {
      "version": "7.0.5",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-7.0.5.tgz",
      "integrity": "sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/@typescript-eslint/parser": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/parser/-/parser-8.50.0.tgz",
      "integrity": "sha512-6/cmF2piao+f6wSxUsJLZjck7OQsYyRtcOZS02k7XINSNlz93v6emM8WutDQSXnroG2xwYlEVHJI+cPA7CPM3Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/scope-manager": "8.50.0",
        "@typescript-eslint/types": "8.50.0",
        "@typescript-eslint/typescript-estree": "8.50.0",
        "@typescript-eslint/visitor-keys": "8.50.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/project-service": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/project-service/-/project-service-8.50.0.tgz",
      "integrity": "sha512-Cg/nQcL1BcoTijEWyx4mkVC56r8dj44bFDvBdygifuS20f3OZCHmFbjF34DPSi07kwlFvqfv/xOLnJ5DquxSGQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/tsconfig-utils": "^8.50.0",
        "@typescript-eslint/types": "^8.50.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/scope-manager": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/scope-manager/-/scope-manager-8.50.0.tgz",
      "integrity": "sha512-xCwfuCZjhIqy7+HKxBLrDVT5q/iq7XBVBXLn57RTIIpelLtEIZHXAF/Upa3+gaCpeV1NNS5Z9A+ID6jn50VD4A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.50.0",
        "@typescript-eslint/visitor-keys": "8.50.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/tsconfig-utils": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/tsconfig-utils/-/tsconfig-utils-8.50.0.tgz",
      "integrity": "sha512-vxd3G/ybKTSlm31MOA96gqvrRGv9RJ7LGtZCn2Vrc5htA0zCDvcMqUkifcjrWNNKXHUU3WCkYOzzVSFBd0wa2w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/type-utils": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/type-utils/-/type-utils-8.50.0.tgz",
      "integrity": "sha512-7OciHT2lKCewR0mFoBrvZJ4AXTMe/sYOe87289WAViOocEmDjjv8MvIOT2XESuKj9jp8u3SZYUSh89QA4S1kQw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.50.0",
        "@typescript-eslint/typescript-estree": "8.50.0",
        "@typescript-eslint/utils": "8.50.0",
        "debug": "^4.3.4",
        "ts-api-utils": "^2.1.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/types": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/types/-/types-8.50.0.tgz",
      "integrity": "sha512-iX1mgmGrXdANhhITbpp2QQM2fGehBse9LbTf0sidWK6yg/NE+uhV5dfU1g6EYPlcReYmkE9QLPq/2irKAmtS9w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/typescript-estree/-/typescript-estree-8.50.0.tgz",
      "integrity": "sha512-W7SVAGBR/IX7zm1t70Yujpbk+zdPq/u4soeFSknWFdXIFuWsBGBOUu/Tn/I6KHSKvSh91OiMuaSnYp3mtPt5IQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/project-service": "8.50.0",
        "@typescript-eslint/tsconfig-utils": "8.50.0",
        "@typescript-eslint/types": "8.50.0",
        "@typescript-eslint/visitor-keys": "8.50.0",
        "debug": "^4.3.4",
        "minimatch": "^9.0.4",
        "semver": "^7.6.0",
        "tinyglobby": "^0.2.15",
        "ts-api-utils": "^2.1.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree/node_modules/brace-expansion": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz",
      "integrity": "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree/node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/@typescript-eslint/utils": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/utils/-/utils-8.50.0.tgz",
      "integrity": "sha512-87KgUXET09CRjGCi2Ejxy3PULXna63/bMYv72tCAlDJC3Yqwln0HiFJ3VJMst2+mEtNtZu5oFvX4qJGjKsnAgg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/eslint-utils": "^4.7.0",
        "@typescript-eslint/scope-manager": "8.50.0",
        "@typescript-eslint/types": "8.50.0",
        "@typescript-eslint/typescript-estree": "8.50.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/visitor-keys": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/visitor-keys/-/visitor-keys-8.50.0.tgz",
      "integrity": "sha512-Xzmnb58+Db78gT/CCj/PVCvK+zxbnsw6F+O1oheYszJbBSdEjVhQi3C/Xttzxgi/GLmpvOggRs1RFpiJ8+c34Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.50.0",
        "eslint-visitor-keys": "^4.2.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@unrs/resolver-binding-android-arm-eabi": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-android-arm-eabi/-/resolver-binding-android-arm-eabi-1.11.1.tgz",
      "integrity": "sha512-ppLRUgHVaGRWUx0R0Ut06Mjo9gBaBkg3v/8AxusGLhsIotbBLuRk51rAzqLC8gq6NyyAojEXglNjzf6R948DNw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@unrs/resolver-binding-android-arm64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-android-arm64/-/resolver-binding-android-arm64-1.11.1.tgz",
      "integrity": "sha512-lCxkVtb4wp1v+EoN+HjIG9cIIzPkX5OtM03pQYkG+U5O/wL53LC4QbIeazgiKqluGeVEeBlZahHalCaBvU1a2g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@unrs/resolver-binding-darwin-arm64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-darwin-arm64/-/resolver-binding-darwin-arm64-1.11.1.tgz",
      "integrity": "sha512-gPVA1UjRu1Y/IsB/dQEsp2V1pm44Of6+LWvbLc9SDk1c2KhhDRDBUkQCYVWe6f26uJb3fOK8saWMgtX8IrMk3g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@unrs/resolver-binding-darwin-x64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-darwin-x64/-/resolver-binding-darwin-x64-1.11.1.tgz",
      "integrity": "sha512-cFzP7rWKd3lZaCsDze07QX1SC24lO8mPty9vdP+YVa3MGdVgPmFc59317b2ioXtgCMKGiCLxJ4HQs62oz6GfRQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@unrs/resolver-binding-freebsd-x64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-freebsd-x64/-/resolver-binding-freebsd-x64-1.11.1.tgz",
      "integrity": "sha512-fqtGgak3zX4DCB6PFpsH5+Kmt/8CIi4Bry4rb1ho6Av2QHTREM+47y282Uqiu3ZRF5IQioJQ5qWRV6jduA+iGw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm-gnueabihf": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm-gnueabihf/-/resolver-binding-linux-arm-gnueabihf-1.11.1.tgz",
      "integrity": "sha512-u92mvlcYtp9MRKmP+ZvMmtPN34+/3lMHlyMj7wXJDeXxuM0Vgzz0+PPJNsro1m3IZPYChIkn944wW8TYgGKFHw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm-musleabihf": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm-musleabihf/-/resolver-binding-linux-arm-musleabihf-1.11.1.tgz",
      "integrity": "sha512-cINaoY2z7LVCrfHkIcmvj7osTOtm6VVT16b5oQdS4beibX2SYBwgYLmqhBjA1t51CarSaBuX5YNsWLjsqfW5Cw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm64-gnu/-/resolver-binding-linux-arm64-gnu-1.11.1.tgz",
      "integrity": "sha512-34gw7PjDGB9JgePJEmhEqBhWvCiiWCuXsL9hYphDF7crW7UgI05gyBAi6MF58uGcMOiOqSJ2ybEeCvHcq0BCmQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm64-musl/-/resolver-binding-linux-arm64-musl-1.11.1.tgz",
      "integrity": "sha512-RyMIx6Uf53hhOtJDIamSbTskA99sPHS96wxVE/bJtePJJtpdKGXO1wY90oRdXuYOGOTuqjT8ACccMc4K6QmT3w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-ppc64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-ppc64-gnu/-/resolver-binding-linux-ppc64-gnu-1.11.1.tgz",
      "integrity": "sha512-D8Vae74A4/a+mZH0FbOkFJL9DSK2R6TFPC9M+jCWYia/q2einCubX10pecpDiTmkJVUH+y8K3BZClycD8nCShA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-riscv64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-riscv64-gnu/-/resolver-binding-linux-riscv64-gnu-1.11.1.tgz",
      "integrity": "sha512-frxL4OrzOWVVsOc96+V3aqTIQl1O2TjgExV4EKgRY09AJ9leZpEg8Ak9phadbuX0BA4k8U5qtvMSQQGGmaJqcQ==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-riscv64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-riscv64-musl/-/resolver-binding-linux-riscv64-musl-1.11.1.tgz",
      "integrity": "sha512-mJ5vuDaIZ+l/acv01sHoXfpnyrNKOk/3aDoEdLO/Xtn9HuZlDD6jKxHlkN8ZhWyLJsRBxfv9GYM2utQ1SChKew==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-s390x-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-s390x-gnu/-/resolver-binding-linux-s390x-gnu-1.11.1.tgz",
      "integrity": "sha512-kELo8ebBVtb9sA7rMe1Cph4QHreByhaZ2QEADd9NzIQsYNQpt9UkM9iqr2lhGr5afh885d/cB5QeTXSbZHTYPg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-x64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-x64-gnu/-/resolver-binding-linux-x64-gnu-1.11.1.tgz",
      "integrity": "sha512-C3ZAHugKgovV5YvAMsxhq0gtXuwESUKc5MhEtjBpLoHPLYM+iuwSj3lflFwK3DPm68660rZ7G8BMcwSro7hD5w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-x64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-x64-musl/-/resolver-binding-linux-x64-musl-1.11.1.tgz",
      "integrity": "sha512-rV0YSoyhK2nZ4vEswT/QwqzqQXw5I6CjoaYMOX0TqBlWhojUf8P94mvI7nuJTeaCkkds3QE4+zS8Ko+GdXuZtA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-wasm32-wasi": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-wasm32-wasi/-/resolver-binding-wasm32-wasi-1.11.1.tgz",
      "integrity": "sha512-5u4RkfxJm+Ng7IWgkzi3qrFOvLvQYnPBmjmZQ8+szTK/b31fQCnleNl1GgEt7nIsZRIf5PLhPwT0WM+q45x/UQ==",
      "cpu": [
        "wasm32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@napi-rs/wasm-runtime": "^0.2.11"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@unrs/resolver-binding-win32-arm64-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-arm64-msvc/-/resolver-binding-win32-arm64-msvc-1.11.1.tgz",
      "integrity": "sha512-nRcz5Il4ln0kMhfL8S3hLkxI85BXs3o8EYoattsJNdsX4YUU89iOkVn7g0VHSRxFuVMdM4Q1jEpIId1Ihim/Uw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@unrs/resolver-binding-win32-ia32-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-ia32-msvc/-/resolver-binding-win32-ia32-msvc-1.11.1.tgz",
      "integrity": "sha512-DCEI6t5i1NmAZp6pFonpD5m7i6aFrpofcp4LA2i8IIq60Jyo28hamKBxNrZcyOwVOZkgsRp9O2sXWBWP8MnvIQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@unrs/resolver-binding-win32-x64-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-x64-msvc/-/resolver-binding-win32-x64-msvc-1.11.1.tgz",
      "integrity": "sha512-lrW200hZdbfRtztbygyaq/6jP6AKE8qQN2KvPcJ+x7wiD038YtnYtZ82IMNJ69GJibV7bwL3y9FgK+5w/pYt6g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/abort-controller": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/abort-controller/-/abort-controller-3.0.0.tgz",
      "integrity": "sha512-h8lQ8tacZYnR3vNQTgibj+tODHI5/+l06Au2Pcriv/Gmet0eaj4TwWH41sO9wnHDiQsEj19q0drzdWdeAHtweg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "event-target-shim": "^5.0.0"
      },
      "engines": {
        "node": ">=6.5"
      }
    },
    "node_modules/acorn": {
      "version": "8.15.0",
      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.15.0.tgz",
      "integrity": "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "acorn": "bin/acorn"
      },
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/acorn-jsx": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/acorn-jsx/-/acorn-jsx-5.3.2.tgz",
      "integrity": "sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "acorn": "^6.0.0 || ^7.0.0 || ^8.0.0"
      }
    },
    "node_modules/agent-base": {
      "version": "7.1.4",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-7.1.4.tgz",
      "integrity": "sha512-MnA+YT8fwfJPgBx3m60MNqakm30XOkyIoH1y6huTQvC0PwZG7ki8NacLBcrPbNoo8vEZy7Jpuk7+jMO+CUovTQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/ajv": {
      "version": "6.12.6",
      "resolved": "https://registry.npmjs.org/ajv/-/ajv-6.12.6.tgz",
      "integrity": "sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fast-deep-equal": "^3.1.1",
        "fast-json-stable-stringify": "^2.0.0",
        "json-schema-traverse": "^0.4.1",
        "uri-js": "^4.2.2"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/epoberezkin"
      }
    },
    "node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/any-promise": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/any-promise/-/any-promise-1.3.0.tgz",
      "integrity": "sha512-7UvmKalWRt1wgjL1RrGxoSJW/0QZFIegpeGvZG9kjp8vrRu55XTHbwnqq2GpXm9uLbcuhxm3IqX9OB4MZR1b2A==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/anymatch": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "normalize-path": "^3.0.0",
        "picomatch": "^2.0.4"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/arg": {
      "version": "5.0.2",
      "resolved": "https://registry.npmjs.org/arg/-/arg-5.0.2.tgz",
      "integrity": "sha512-PYjyFOLKQ9y57JvQ6QLo8dAgNqswh8M1RMJYdQduT6xbWSgK36P/Z/v+p888pM69jMMfS8Xd8F6I1kQ/I9HUGg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/argparse": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/argparse/-/argparse-2.0.1.tgz",
      "integrity": "sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q==",
      "license": "Python-2.0"
    },
    "node_modules/aria-query": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/aria-query/-/aria-query-5.3.2.tgz",
      "integrity": "sha512-COROpnaoap1E2F000S62r6A60uHZnmlvomhfyT2DlTcrY1OrBKn2UhH7qn5wTC9zMvD0AY7csdPSNwKP+7WiQw==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/array-buffer-byte-length": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/array-buffer-byte-length/-/array-buffer-byte-length-1.0.2.tgz",
      "integrity": "sha512-LHE+8BuR7RYGDKvnrmcuSq3tDcKv9OFEXQt/HpbZhY7V6h0zlUXutnAD82GiFx9rdieCMjkvtcsPqBwgUl1Iiw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "is-array-buffer": "^3.0.5"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array-includes": {
      "version": "3.1.9",
      "resolved": "https://registry.npmjs.org/array-includes/-/array-includes-3.1.9.tgz",
      "integrity": "sha512-FmeCCAenzH0KH381SPT5FZmiA/TmpndpcaShhfgEN9eCVjnFBqq3l1xrI42y8+PPLI6hypzou4GXw00WHmPBLQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.24.0",
        "es-object-atoms": "^1.1.1",
        "get-intrinsic": "^1.3.0",
        "is-string": "^1.1.1",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.findlast": {
      "version": "1.2.5",
      "resolved": "https://registry.npmjs.org/array.prototype.findlast/-/array.prototype.findlast-1.2.5.tgz",
      "integrity": "sha512-CVvd6FHg1Z3POpBLxO6E6zr+rSKEQ9L6rZHAaY7lLfhKsWYUBBOuMs0e9o24oopj6H+geRCX0YJ+TJLBK2eHyQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.2",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.findlastindex": {
      "version": "1.2.6",
      "resolved": "https://registry.npmjs.org/array.prototype.findlastindex/-/array.prototype.findlastindex-1.2.6.tgz",
      "integrity": "sha512-F/TKATkzseUExPlfvmwQKGITM3DGTK+vkAsCZoDc5daVygbJBnjEUCbgkAvVFsgfXfX4YIqZ/27G3k3tdXrTxQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.9",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "es-shim-unscopables": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.flat": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/array.prototype.flat/-/array.prototype.flat-1.3.3.tgz",
      "integrity": "sha512-rwG/ja1neyLqCuGZ5YYrznA62D4mZXg0i1cIskIUKSiqF3Cje9/wXAls9B9s1Wa2fomMsIv8czB8jZcPmxCXFg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.flatmap": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/array.prototype.flatmap/-/array.prototype.flatmap-1.3.3.tgz",
      "integrity": "sha512-Y7Wt51eKJSyi80hFrJCePGGNo5ktJCslFuboqJsbf57CCPcm5zztluPlc4/aD8sWsKvlwatezpV4U1efk8kpjg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.tosorted": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/array.prototype.tosorted/-/array.prototype.tosorted-1.1.4.tgz",
      "integrity": "sha512-p6Fx8B7b7ZhL/gmUsAy0D15WhvDccw3mnGNbZpi3pmeJdxtWsj2jEaI4Y6oo3XiHfzuSgPwKc04MYt6KgvC/wA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.3",
        "es-errors": "^1.3.0",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/arraybuffer.prototype.slice": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/arraybuffer.prototype.slice/-/arraybuffer.prototype.slice-1.0.4.tgz",
      "integrity": "sha512-BNoCY6SXXPQ7gF2opIP4GBE+Xw7U+pHMYKuzjgCN3GwiaIR09UUeKfheyIry77QtrCBlC0KK0q5/TER/tYh3PQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-buffer-byte-length": "^1.0.1",
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "is-array-buffer": "^3.0.4"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/arrify": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/arrify/-/arrify-2.0.1.tgz",
      "integrity": "sha512-3duEwti880xqi4eAMN8AyR4a0ByT90zoYdLlevfrvU43vb0YZwZVfxOgxWrLXXXpyugL0hNZc9G6BiB5B3nUug==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/ast-types": {
      "version": "0.13.4",
      "resolved": "https://registry.npmjs.org/ast-types/-/ast-types-0.13.4.tgz",
      "integrity": "sha512-x1FCFnFifvYDDzTaLII71vG5uvDwgtmDTEVWAxrgeiR8VjMONcCXJx7E+USjDtHlwFmt9MysbqgF9b9Vjr6w+w==",
      "license": "MIT",
      "dependencies": {
        "tslib": "^2.0.1"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/ast-types-flow": {
      "version": "0.0.8",
      "resolved": "https://registry.npmjs.org/ast-types-flow/-/ast-types-flow-0.0.8.tgz",
      "integrity": "sha512-OH/2E5Fg20h2aPrbe+QL8JZQFko0YZaF+j4mnQ7BGhfavO7OpSLa8a0y9sBwomHdSbkhTS8TQNayBfnW5DwbvQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/async-function": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/async-function/-/async-function-1.0.0.tgz",
      "integrity": "sha512-hsU18Ae8CDTR6Kgu9DYf0EbCr/a5iGL0rytQDobUcdpYOKokk8LEjVphnXkDkgpi0wYVsqrXuP0bZxJaTqdgoA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/async-retry": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/async-retry/-/async-retry-1.3.3.tgz",
      "integrity": "sha512-wfr/jstw9xNi/0teMHrRW7dsz3Lt5ARhYNZ2ewpadnhaIp5mbALhOAP+EAdsC7t4Z6wqsDVv9+W6gm1Dk9mEyw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "retry": "0.13.1"
      }
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/autoprefixer": {
      "version": "10.4.23",
      "resolved": "https://registry.npmjs.org/autoprefixer/-/autoprefixer-10.4.23.tgz",
      "integrity": "sha512-YYTXSFulfwytnjAPlw8QHncHJmlvFKtczb8InXaAx9Q0LbfDnfEYDE55omerIJKihhmU61Ft+cAOSzQVaBUmeA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/autoprefixer"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "browserslist": "^4.28.1",
        "caniuse-lite": "^1.0.30001760",
        "fraction.js": "^5.3.4",
        "picocolors": "^1.1.1",
        "postcss-value-parser": "^4.2.0"
      },
      "bin": {
        "autoprefixer": "bin/autoprefixer"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      },
      "peerDependencies": {
        "postcss": "^8.1.0"
      }
    },
    "node_modules/available-typed-arrays": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/available-typed-arrays/-/available-typed-arrays-1.0.7.tgz",
      "integrity": "sha512-wvUjBtSGN7+7SjNpq/9M2Tg350UZD3q62IFZLbRAR1bSMlCo1ZaeW+BJ+D090e4hIIZLBcTDWe4Mh4jvUDajzQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "possible-typed-array-names": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/axe-core": {
      "version": "4.11.0",
      "resolved": "https://registry.npmjs.org/axe-core/-/axe-core-4.11.0.tgz",
      "integrity": "sha512-ilYanEU8vxxBexpJd8cWM4ElSQq4QctCLKih0TSfjIfCQTeyH/6zVrmIJfLPrKTKJRbiG+cfnZbQIjAlJmF1jQ==",
      "dev": true,
      "license": "MPL-2.0",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/axobject-query": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/axobject-query/-/axobject-query-4.1.0.tgz",
      "integrity": "sha512-qIj0G9wZbMGNLjLmg1PT6v2mE9AH2zlnADJD/2tC6E00hgmhUOfEB6greHPAfLRSufHqROIUTkw6E+M3lH0PTQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/b4a": {
      "version": "1.7.3",
      "resolved": "https://registry.npmjs.org/b4a/-/b4a-1.7.3.tgz",
      "integrity": "sha512-5Q2mfq2WfGuFp3uS//0s6baOJLMoVduPYVeNmDYxu5OUA1/cBfvr2RIS7vi62LdNj/urk1hfmj867I3qt6uZ7Q==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "react-native-b4a": "*"
      },
      "peerDependenciesMeta": {
        "react-native-b4a": {
          "optional": true
        }
      }
    },
    "node_modules/babel-plugin-react-compiler": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/babel-plugin-react-compiler/-/babel-plugin-react-compiler-1.0.0.tgz",
      "integrity": "sha512-Ixm8tFfoKKIPYdCCKYTsqv+Fd4IJ0DQqMyEimo+pxUOMUR9cVPlwTrFt9Avu+3cb6Zp3mAzl+t1MrG2fxxKsxw==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.26.0"
      }
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/bare-events": {
      "version": "2.8.2",
      "resolved": "https://registry.npmjs.org/bare-events/-/bare-events-2.8.2.tgz",
      "integrity": "sha512-riJjyv1/mHLIPX4RwiK+oW9/4c3TEUeORHKefKAKnZ5kyslbN+HXowtbaVEqt4IMUB7OXlfixcs6gsFeo/jhiQ==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "bare-abort-controller": "*"
      },
      "peerDependenciesMeta": {
        "bare-abort-controller": {
          "optional": true
        }
      }
    },
    "node_modules/bare-fs": {
      "version": "4.5.2",
      "resolved": "https://registry.npmjs.org/bare-fs/-/bare-fs-4.5.2.tgz",
      "integrity": "sha512-veTnRzkb6aPHOvSKIOy60KzURfBdUflr5VReI+NSaPL6xf+XLdONQgZgpYvUuZLVQ8dCqxpBAudaOM1+KpAUxw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "bare-events": "^2.5.4",
        "bare-path": "^3.0.0",
        "bare-stream": "^2.6.4",
        "bare-url": "^2.2.2",
        "fast-fifo": "^1.3.2"
      },
      "engines": {
        "bare": ">=1.16.0"
      },
      "peerDependencies": {
        "bare-buffer": "*"
      },
      "peerDependenciesMeta": {
        "bare-buffer": {
          "optional": true
        }
      }
    },
    "node_modules/bare-os": {
      "version": "3.6.2",
      "resolved": "https://registry.npmjs.org/bare-os/-/bare-os-3.6.2.tgz",
      "integrity": "sha512-T+V1+1srU2qYNBmJCXZkUY5vQ0B4FSlL3QDROnKQYOqeiQR8UbjNHlPa+TIbM4cuidiN9GaTaOZgSEgsvPbh5A==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "bare": ">=1.14.0"
      }
    },
    "node_modules/bare-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/bare-path/-/bare-path-3.0.0.tgz",
      "integrity": "sha512-tyfW2cQcB5NN8Saijrhqn0Zh7AnFNsnczRcuWODH0eYAXBsJ5gVxAUuNr7tsHSC6IZ77cA0SitzT+s47kot8Mw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "bare-os": "^3.0.1"
      }
    },
    "node_modules/bare-stream": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/bare-stream/-/bare-stream-2.7.0.tgz",
      "integrity": "sha512-oyXQNicV1y8nc2aKffH+BUHFRXmx6VrPzlnaEvMhram0nPBrKcEdcyBg5r08D0i8VxngHFAiVyn1QKXpSG0B8A==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "streamx": "^2.21.0"
      },
      "peerDependencies": {
        "bare-buffer": "*",
        "bare-events": "*"
      },
      "peerDependenciesMeta": {
        "bare-buffer": {
          "optional": true
        },
        "bare-events": {
          "optional": true
        }
      }
    },
    "node_modules/bare-url": {
      "version": "2.3.2",
      "resolved": "https://registry.npmjs.org/bare-url/-/bare-url-2.3.2.tgz",
      "integrity": "sha512-ZMq4gd9ngV5aTMa5p9+UfY0b3skwhHELaDkhEHetMdX0LRkW9kzaym4oo/Eh+Ghm0CCDuMTsRIGM/ytUc1ZYmw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "bare-path": "^3.0.0"
      }
    },
    "node_modules/base64-js": {
      "version": "1.5.1",
      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.9.7",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.7.tgz",
      "integrity": "sha512-k9xFKplee6KIio3IDbwj+uaCLpqzOwakOgmqzPezM0sFJlFKcg30vk2wOiAJtkTSfx0SSQDSe8q+mWA/fSH5Zg==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "baseline-browser-mapping": "dist/cli.js"
      }
    },
    "node_modules/basic-ftp": {
      "version": "5.0.5",
      "resolved": "https://registry.npmjs.org/basic-ftp/-/basic-ftp-5.0.5.tgz",
      "integrity": "sha512-4Bcg1P8xhUuqcii/S0Z9wiHIrQVPMermM1any+MX5GeGD7faD3/msQUDGLol9wOcz4/jbg/WJnGqoJF6LiBdtg==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/bignumber.js": {
      "version": "9.3.1",
      "resolved": "https://registry.npmjs.org/bignumber.js/-/bignumber.js-9.3.1.tgz",
      "integrity": "sha512-Ko0uX15oIUS7wJ3Rb30Fs6SkVbLmPBAKdlm7q9+ak9bbIeFf0MwuBsQV6z7+X768/cHsfg+WlysDWJcmthjsjQ==",
      "license": "MIT",
      "engines": {
        "node": "*"
      }
    },
    "node_modules/binary-extensions": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/brace-expansion": {
      "version": "1.1.12",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/braces": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fill-range": "^7.1.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/browserslist": {
      "version": "4.28.1",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "baseline-browser-mapping": "^2.9.0",
        "caniuse-lite": "^1.0.30001759",
        "electron-to-chromium": "^1.5.263",
        "node-releases": "^2.0.27",
        "update-browserslist-db": "^1.2.0"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/buffer-crc32": {
      "version": "0.2.13",
      "resolved": "https://registry.npmjs.org/buffer-crc32/-/buffer-crc32-0.2.13.tgz",
      "integrity": "sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==",
      "license": "MIT",
      "engines": {
        "node": "*"
      }
    },
    "node_modules/buffer-equal-constant-time": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/buffer-equal-constant-time/-/buffer-equal-constant-time-1.0.1.tgz",
      "integrity": "sha512-zRpUiDwd/xk6ADqPMATG8vc9VPrkck7T07OIx0gnjmJAnHnTVXNQG3vfvWNuiZIkwu9KrKdA1iJKfsfTVxE6NA==",
      "license": "BSD-3-Clause"
    },
    "node_modules/call-bind": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/call-bind/-/call-bind-1.0.8.tgz",
      "integrity": "sha512-oKlSFMcMwpUg2ednkhQ454wfWiU/ul3CkJe/PEHcTKuiX6RpbehUiFMXu13HalGZxfUwCQzZG747YXBn1im9ww==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.0",
        "es-define-property": "^1.0.0",
        "get-intrinsic": "^1.2.4",
        "set-function-length": "^1.2.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/call-bound": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "get-intrinsic": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/callsites": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
      "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/camelcase-css": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/camelcase-css/-/camelcase-css-2.0.1.tgz",
      "integrity": "sha512-QOSvevhslijgYwRx6Rv7zKdMF8lbRmx+uQGx2+vDc+KI/eBnsy9kit5aj23AgGu3pa4t9AgwbnXWqS+iOY+2aA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001760",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001760.tgz",
      "integrity": "sha512-7AAMPcueWELt1p3mi13HR/LHH0TJLT11cnwDJEs3xA4+CK/PLKeO9Kl1oru24htkyUKtkGCvAx4ohB0Ttry8Dw==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/chalk": {
      "version": "4.1.2",
      "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
      "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.1.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/chalk?sponsor=1"
      }
    },
    "node_modules/chokidar": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "anymatch": "~3.1.2",
        "braces": "~3.0.2",
        "glob-parent": "~5.1.2",
        "is-binary-path": "~2.1.0",
        "is-glob": "~4.0.1",
        "normalize-path": "~3.0.0",
        "readdirp": "~3.6.0"
      },
      "engines": {
        "node": ">= 8.10.0"
      },
      "funding": {
        "url": "https://paulmillr.com/funding/"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/chokidar/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/chromium-bidi": {
      "version": "12.0.1",
      "resolved": "https://registry.npmjs.org/chromium-bidi/-/chromium-bidi-12.0.1.tgz",
      "integrity": "sha512-fGg+6jr0xjQhzpy5N4ErZxQ4wF7KLEvhGZXD6EgvZKDhu7iOhZXnZhcDxPJDcwTcrD48NPzOCo84RP2lv3Z+Cg==",
      "license": "Apache-2.0",
      "dependencies": {
        "mitt": "^3.0.1",
        "zod": "^3.24.1"
      },
      "peerDependencies": {
        "devtools-protocol": "*"
      }
    },
    "node_modules/chromium-bidi/node_modules/zod": {
      "version": "3.25.76",
      "resolved": "https://registry.npmjs.org/zod/-/zod-3.25.76.tgz",
      "integrity": "sha512-gzUt/qt81nXsFGKIFcC3YnfEAx5NkunCfnDlvuBSSFS02bcXu4Lmea0AFIUwbLWxWPx3d9p8S5QoaujKcNQxcQ==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/colinhacks"
      }
    },
    "node_modules/client-only": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/client-only/-/client-only-0.0.1.tgz",
      "integrity": "sha512-IV3Ou0jSMzZrd3pZ48nLkT9DA7Ag1pnPzaiQhpW7c3RbcqqzvzzVu+L8gfqMp/8IM2MQtSiqaCxrrcfu8I8rMA==",
      "license": "MIT"
    },
    "node_modules/cliui": {
      "version": "8.0.1",
      "resolved": "https://registry.npmjs.org/cliui/-/cliui-8.0.1.tgz",
      "integrity": "sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==",
      "license": "ISC",
      "dependencies": {
        "string-width": "^4.2.0",
        "strip-ansi": "^6.0.1",
        "wrap-ansi": "^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "license": "MIT",
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "license": "MIT"
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/commander": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/commander/-/commander-4.1.1.tgz",
      "integrity": "sha512-NOKm8xhkzAjzFx8B2v5OAHT+u5pRQc2UCa2Vq9jYL/31o2wi9mxBA7LIFs3sV5VSC49z6pEhfbMULvShKj26WA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/concat-map": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
      "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/cosmiconfig": {
      "version": "9.0.0",
      "resolved": "https://registry.npmjs.org/cosmiconfig/-/cosmiconfig-9.0.0.tgz",
      "integrity": "sha512-itvL5h8RETACmOTFc4UfIyB2RfEHi71Ax6E/PivVxq9NseKbOWpeyHEOIbmAw1rs8Ak0VursQNww7lf7YtUwzg==",
      "license": "MIT",
      "dependencies": {
        "env-paths": "^2.2.1",
        "import-fresh": "^3.3.0",
        "js-yaml": "^4.1.0",
        "parse-json": "^5.2.0"
      },
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/d-fischer"
      },
      "peerDependencies": {
        "typescript": ">=4.9.5"
      },
      "peerDependenciesMeta": {
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/cssesc": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/cssesc/-/cssesc-3.0.0.tgz",
      "integrity": "sha512-/Tb/JcjK111nNScGob5MNtsntNM1aCNUDipB/TkwZFhyDrrE47SOx/18wF2bbjgc3ZzCSKW1T5nt5EbFoAz/Vg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "cssesc": "bin/cssesc"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/csstype": {
      "version": "3.2.3",
      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz",
      "integrity": "sha512-z1HGKcYy2xA8AGQfwrn0PAy+PB7X/GSj3UVJW9qKyn43xWa+gl5nXmU4qqLMRzWVLFC8KusUX8T/0kCiOYpAIQ==",
      "license": "MIT"
    },
    "node_modules/damerau-levenshtein": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/damerau-levenshtein/-/damerau-levenshtein-1.0.8.tgz",
      "integrity": "sha512-sdQSFB7+llfUcQHUQO3+B8ERRj0Oa4w9POWMI/puGtuf7gFywGmkaLCElnudfTiKZV+NvHqL0ifzdrI8Ro7ESA==",
      "dev": true,
      "license": "BSD-2-Clause"
    },
    "node_modules/data-uri-to-buffer": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/data-uri-to-buffer/-/data-uri-to-buffer-6.0.2.tgz",
      "integrity": "sha512-7hvf7/GW8e86rW0ptuwS3OcBGDjIi6SZva7hCyWC0yYry2cOPmLIjXAUHI6DK2HsnwJd9ifmt57i8eV2n4YNpw==",
      "license": "MIT",
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/data-view-buffer": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/data-view-buffer/-/data-view-buffer-1.0.2.tgz",
      "integrity": "sha512-EmKO5V3OLXh1rtK2wgXRansaK1/mtVdTUEiEI0W8RkvgT05kfxaH29PliLnpLP73yYO6142Q72QNa8Wx/A5CqQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "is-data-view": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/data-view-byte-length": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/data-view-byte-length/-/data-view-byte-length-1.0.2.tgz",
      "integrity": "sha512-tuhGbE6CfTM9+5ANGf+oQb72Ky/0+s3xKUpHvShfiz2RxMFgFPjsXuRLBVMtvMs15awe45SRb83D6wH4ew6wlQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "is-data-view": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/inspect-js"
      }
    },
    "node_modules/data-view-byte-offset": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/data-view-byte-offset/-/data-view-byte-offset-1.0.1.tgz",
      "integrity": "sha512-BS8PfmtDGnrgYdOonGZQdLZslWIeCGFP9tpan0hi1Co2Zr2NKADsvGYA8XxuG/4UWgJ6Cjtv+YJnB6MM69QGlQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "is-data-view": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/date-fns": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/date-fns/-/date-fns-4.1.0.tgz",
      "integrity": "sha512-Ukq0owbQXxa/U3EGtsdVBkR1w7KOQ5gIBqdH2hkvknzZPYvBxb/aa6E8L7tmjFtkwZBu3UXBbjIgPo/Ez4xaNg==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/kossnocorp"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/deep-is": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/deep-is/-/deep-is-0.1.4.tgz",
      "integrity": "sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/define-data-property": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/define-data-property/-/define-data-property-1.1.4.tgz",
      "integrity": "sha512-rBMvIzlpA8v6E+SJZoo++HAYqsLrkg7MSfIinMPFhmkorw7X+dOXVJQs+QT69zGkzMyfDnIMN2Wid1+NbL3T+A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0",
        "es-errors": "^1.3.0",
        "gopd": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/define-properties": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/define-properties/-/define-properties-1.2.1.tgz",
      "integrity": "sha512-8QmQKqEASLd5nx0U1B1okLElbUuuttJ/AnYmRXbbbGDWh6uS208EjD4Xqq/I9wK7u0v6O08XhTWnt5XtEbR6Dg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.0.1",
        "has-property-descriptors": "^1.0.0",
        "object-keys": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/degenerator": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/degenerator/-/degenerator-5.0.1.tgz",
      "integrity": "sha512-TllpMR/t0M5sqCXfj85i4XaAzxmS5tVA16dqvdkMwGmzI+dXLXnw3J+3Vdv7VKw+ThlTMboK6i9rnZ6Nntj5CQ==",
      "license": "MIT",
      "dependencies": {
        "ast-types": "^0.13.4",
        "escodegen": "^2.1.0",
        "esprima": "^4.0.1"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/detect-libc": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz",
      "integrity": "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/devtools-protocol": {
      "version": "0.0.1534754",
      "resolved": "https://registry.npmjs.org/devtools-protocol/-/devtools-protocol-0.0.1534754.tgz",
      "integrity": "sha512-26T91cV5dbOYnXdJi5qQHoTtUoNEqwkHcAyu/IKtjIAxiEqPMrDiRkDOPWVsGfNZGmlQVHQbZRSjD8sxagWVsQ==",
      "license": "BSD-3-Clause"
    },
    "node_modules/didyoumean": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/didyoumean/-/didyoumean-1.2.2.tgz",
      "integrity": "sha512-gxtyfqMg7GKyhQmb056K7M3xszy/myH8w+B4RT+QXBQsvAOdc3XymqDDPHx1BgPgsdAA5SIifona89YtRATDzw==",
      "dev": true,
      "license": "Apache-2.0"
    },
    "node_modules/dlv": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/dlv/-/dlv-1.1.3.tgz",
      "integrity": "sha512-+HlytyjlPKnIG8XuRG8WvmBP8xs8P71y+SKKS6ZXWoEgLuePxtDoUEiH7WkdePWrQ5JBpE6aoVqfZfJUQkjXwA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/doctrine": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/doctrine/-/doctrine-2.1.0.tgz",
      "integrity": "sha512-35mSku4ZXK0vfCuHEDAwt55dg2jNajHZ1odvF+8SSr82EsZY4QmXfuWso8oEd8zRhVObSN18aM0CjSdoBX7zIw==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "esutils": "^2.0.2"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/duplexify": {
      "version": "4.1.3",
      "resolved": "https://registry.npmjs.org/duplexify/-/duplexify-4.1.3.tgz",
      "integrity": "sha512-M3BmBhwJRZsSx38lZyhE53Csddgzl5R7xGJNk7CVddZD6CcmwMCH8J+7AprIrQKH7TonKxaCjcv27Qmf+sQ+oA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "end-of-stream": "^1.4.1",
        "inherits": "^2.0.3",
        "readable-stream": "^3.1.1",
        "stream-shift": "^1.0.2"
      }
    },
    "node_modules/ecdsa-sig-formatter": {
      "version": "1.0.11",
      "resolved": "https://registry.npmjs.org/ecdsa-sig-formatter/-/ecdsa-sig-formatter-1.0.11.tgz",
      "integrity": "sha512-nagl3RYrbNv6kQkeJIpt6NJZy8twLB/2vtz6yN9Z4vRKHN4/QZJIEbqohALSgwKdnksuY3k5Addp5lg8sVoVcQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.267",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.267.tgz",
      "integrity": "sha512-0Drusm6MVRXSOJpGbaSVgcQsuB4hEkMpHXaVstcPmhu5LIedxs1xNK/nIxmQIU/RPC0+1/o0AVZfBTkTNJOdUw==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/emoji-regex": {
      "version": "9.2.2",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/end-of-stream": {
      "version": "1.4.5",
      "resolved": "https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.5.tgz",
      "integrity": "sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg==",
      "license": "MIT",
      "dependencies": {
        "once": "^1.4.0"
      }
    },
    "node_modules/env-paths": {
      "version": "2.2.1",
      "resolved": "https://registry.npmjs.org/env-paths/-/env-paths-2.2.1.tgz",
      "integrity": "sha512-+h1lkLKhZMTYjog1VEpJNG7NZJWcuc2DDk/qsqSTRRCOXiLjeQ1d1/udrUGhqMxUgAlwKNZ0cf2uqan5GLuS2A==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/error-ex": {
      "version": "1.3.4",
      "resolved": "https://registry.npmjs.org/error-ex/-/error-ex-1.3.4.tgz",
      "integrity": "sha512-sqQamAnR14VgCr1A618A3sGrygcpK+HEbenA/HiEAkkUwcZIIB/tgWqHFxWgOyDh4nB4JCRimh79dR5Ywc9MDQ==",
      "license": "MIT",
      "dependencies": {
        "is-arrayish": "^0.2.1"
      }
    },
    "node_modules/es-abstract": {
      "version": "1.24.1",
      "resolved": "https://registry.npmjs.org/es-abstract/-/es-abstract-1.24.1.tgz",
      "integrity": "sha512-zHXBLhP+QehSSbsS9Pt23Gg964240DPd6QCf8WpkqEXxQ7fhdZzYsocOr5u7apWonsS5EjZDmTF+/slGMyasvw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-buffer-byte-length": "^1.0.2",
        "arraybuffer.prototype.slice": "^1.0.4",
        "available-typed-arrays": "^1.0.7",
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "data-view-buffer": "^1.0.2",
        "data-view-byte-length": "^1.0.2",
        "data-view-byte-offset": "^1.0.1",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "es-set-tostringtag": "^2.1.0",
        "es-to-primitive": "^1.3.0",
        "function.prototype.name": "^1.1.8",
        "get-intrinsic": "^1.3.0",
        "get-proto": "^1.0.1",
        "get-symbol-description": "^1.1.0",
        "globalthis": "^1.0.4",
        "gopd": "^1.2.0",
        "has-property-descriptors": "^1.0.2",
        "has-proto": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "internal-slot": "^1.1.0",
        "is-array-buffer": "^3.0.5",
        "is-callable": "^1.2.7",
        "is-data-view": "^1.0.2",
        "is-negative-zero": "^2.0.3",
        "is-regex": "^1.2.1",
        "is-set": "^2.0.3",
        "is-shared-array-buffer": "^1.0.4",
        "is-string": "^1.1.1",
        "is-typed-array": "^1.1.15",
        "is-weakref": "^1.1.1",
        "math-intrinsics": "^1.1.0",
        "object-inspect": "^1.13.4",
        "object-keys": "^1.1.1",
        "object.assign": "^4.1.7",
        "own-keys": "^1.0.1",
        "regexp.prototype.flags": "^1.5.4",
        "safe-array-concat": "^1.1.3",
        "safe-push-apply": "^1.0.0",
        "safe-regex-test": "^1.1.0",
        "set-proto": "^1.0.0",
        "stop-iteration-iterator": "^1.1.0",
        "string.prototype.trim": "^1.2.10",
        "string.prototype.trimend": "^1.0.9",
        "string.prototype.trimstart": "^1.0.8",
        "typed-array-buffer": "^1.0.3",
        "typed-array-byte-length": "^1.0.3",
        "typed-array-byte-offset": "^1.0.4",
        "typed-array-length": "^1.0.7",
        "unbox-primitive": "^1.1.0",
        "which-typed-array": "^1.1.19"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-iterator-helpers": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/es-iterator-helpers/-/es-iterator-helpers-1.2.2.tgz",
      "integrity": "sha512-BrUQ0cPTB/IwXj23HtwHjS9n7O4h9FX94b4xc5zlTHxeLgTAdzYUDyy6KdExAl9lbN5rtfe44xpjpmj9grxs5w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.24.1",
        "es-errors": "^1.3.0",
        "es-set-tostringtag": "^2.1.0",
        "function-bind": "^1.1.2",
        "get-intrinsic": "^1.3.0",
        "globalthis": "^1.0.4",
        "gopd": "^1.2.0",
        "has-property-descriptors": "^1.0.2",
        "has-proto": "^1.2.0",
        "has-symbols": "^1.1.0",
        "internal-slot": "^1.1.0",
        "iterator.prototype": "^1.1.5",
        "safe-array-concat": "^1.1.3"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-shim-unscopables": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/es-shim-unscopables/-/es-shim-unscopables-1.1.0.tgz",
      "integrity": "sha512-d9T8ucsEhh8Bi1woXCf+TIKDIROLG5WCkxg8geBCbvk22kzwC5G2OnXVMO6FUsvQlgUUXQ2itephWDLqDzbeCw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-to-primitive": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-to-primitive/-/es-to-primitive-1.3.0.tgz",
      "integrity": "sha512-w+5mJ3GuFL+NjVtJlvydShqE1eN3h3PbI7/5LAsYJP/2qtuMXjfL2LpHSRqo4b4eSF5K/DH1JXKUAHSB2UW50g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-callable": "^1.2.7",
        "is-date-object": "^1.0.5",
        "is-symbol": "^1.0.4"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/escape-string-regexp": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-4.0.0.tgz",
      "integrity": "sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/escodegen": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/escodegen/-/escodegen-2.1.0.tgz",
      "integrity": "sha512-2NlIDTwUWJN0mRPQOdtQBzbUHvdGY2P1VXSyU83Q3xKxM7WHX2Ql8dKq782Q9TgQUNOLEzEYu9bzLNj1q88I5w==",
      "license": "BSD-2-Clause",
      "dependencies": {
        "esprima": "^4.0.1",
        "estraverse": "^5.2.0",
        "esutils": "^2.0.2"
      },
      "bin": {
        "escodegen": "bin/escodegen.js",
        "esgenerate": "bin/esgenerate.js"
      },
      "engines": {
        "node": ">=6.0"
      },
      "optionalDependencies": {
        "source-map": "~0.6.1"
      }
    },
    "node_modules/eslint": {
      "version": "9.39.2",
      "resolved": "https://registry.npmjs.org/eslint/-/eslint-9.39.2.tgz",
      "integrity": "sha512-LEyamqS7W5HB3ujJyvi0HQK/dtVINZvd5mAAp9eT5S/ujByGjiZLCzPcHVzuXbpJDJF/cxwHlfceVUDZ2lnSTw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/eslint-utils": "^4.8.0",
        "@eslint-community/regexpp": "^4.12.1",
        "@eslint/config-array": "^0.21.1",
        "@eslint/config-helpers": "^0.4.2",
        "@eslint/core": "^0.17.0",
        "@eslint/eslintrc": "^3.3.1",
        "@eslint/js": "9.39.2",
        "@eslint/plugin-kit": "^0.4.1",
        "@humanfs/node": "^0.16.6",
        "@humanwhocodes/module-importer": "^1.0.1",
        "@humanwhocodes/retry": "^0.4.2",
        "@types/estree": "^1.0.6",
        "ajv": "^6.12.4",
        "chalk": "^4.0.0",
        "cross-spawn": "^7.0.6",
        "debug": "^4.3.2",
        "escape-string-regexp": "^4.0.0",
        "eslint-scope": "^8.4.0",
        "eslint-visitor-keys": "^4.2.1",
        "espree": "^10.4.0",
        "esquery": "^1.5.0",
        "esutils": "^2.0.2",
        "fast-deep-equal": "^3.1.3",
        "file-entry-cache": "^8.0.0",
        "find-up": "^5.0.0",
        "glob-parent": "^6.0.2",
        "ignore": "^5.2.0",
        "imurmurhash": "^0.1.4",
        "is-glob": "^4.0.0",
        "json-stable-stringify-without-jsonify": "^1.0.1",
        "lodash.merge": "^4.6.2",
        "minimatch": "^3.1.2",
        "natural-compare": "^1.4.0",
        "optionator": "^0.9.3"
      },
      "bin": {
        "eslint": "bin/eslint.js"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://eslint.org/donate"
      },
      "peerDependencies": {
        "jiti": "*"
      },
      "peerDependenciesMeta": {
        "jiti": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-config-next": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/eslint-config-next/-/eslint-config-next-16.0.10.tgz",
      "integrity": "sha512-BxouZUm0I45K4yjOOIzj24nTi0H2cGo0y7xUmk+Po/PYtJXFBYVDS1BguE7t28efXjKdcN0tmiLivxQy//SsZg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@next/eslint-plugin-next": "16.0.10",
        "eslint-import-resolver-node": "^0.3.6",
        "eslint-import-resolver-typescript": "^3.5.2",
        "eslint-plugin-import": "^2.32.0",
        "eslint-plugin-jsx-a11y": "^6.10.0",
        "eslint-plugin-react": "^7.37.0",
        "eslint-plugin-react-hooks": "^7.0.0",
        "globals": "16.4.0",
        "typescript-eslint": "^8.46.0"
      },
      "peerDependencies": {
        "eslint": ">=9.0.0",
        "typescript": ">=3.3.1"
      },
      "peerDependenciesMeta": {
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-config-next/node_modules/globals": {
      "version": "16.4.0",
      "resolved": "https://registry.npmjs.org/globals/-/globals-16.4.0.tgz",
      "integrity": "sha512-ob/2LcVVaVGCYN+r14cnwnoDPUufjiYgSqRhiFD0Q1iI4Odora5RE8Iv1D24hAz5oMophRGkGz+yuvQmmUMnMw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/eslint-import-resolver-node": {
      "version": "0.3.9",
      "resolved": "https://registry.npmjs.org/eslint-import-resolver-node/-/eslint-import-resolver-node-0.3.9.tgz",
      "integrity": "sha512-WFj2isz22JahUv+B788TlO3N6zL3nNJGU8CcZbPZvVEkBPaJdCV4vy5wyghty5ROFbCRnm132v8BScu5/1BQ8g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "debug": "^3.2.7",
        "is-core-module": "^2.13.0",
        "resolve": "^1.22.4"
      }
    },
    "node_modules/eslint-import-resolver-node/node_modules/debug": {
      "version": "3.2.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-3.2.7.tgz",
      "integrity": "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.1"
      }
    },
    "node_modules/eslint-import-resolver-typescript": {
      "version": "3.10.1",
      "resolved": "https://registry.npmjs.org/eslint-import-resolver-typescript/-/eslint-import-resolver-typescript-3.10.1.tgz",
      "integrity": "sha512-A1rHYb06zjMGAxdLSkN2fXPBwuSaQ0iO5M/hdyS0Ajj1VBaRp0sPD3dn1FhME3c/JluGFbwSxyCfqdSbtQLAHQ==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "@nolyfill/is-core-module": "1.0.39",
        "debug": "^4.4.0",
        "get-tsconfig": "^4.10.0",
        "is-bun-module": "^2.0.0",
        "stable-hash": "^0.0.5",
        "tinyglobby": "^0.2.13",
        "unrs-resolver": "^1.6.2"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint-import-resolver-typescript"
      },
      "peerDependencies": {
        "eslint": "*",
        "eslint-plugin-import": "*",
        "eslint-plugin-import-x": "*"
      },
      "peerDependenciesMeta": {
        "eslint-plugin-import": {
          "optional": true
        },
        "eslint-plugin-import-x": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-module-utils": {
      "version": "2.12.1",
      "resolved": "https://registry.npmjs.org/eslint-module-utils/-/eslint-module-utils-2.12.1.tgz",
      "integrity": "sha512-L8jSWTze7K2mTg0vos/RuLRS5soomksDPoJLXIslC7c8Wmut3bx7CPpJijDcBZtxQ5lrbUdM+s0OlNbz0DCDNw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "debug": "^3.2.7"
      },
      "engines": {
        "node": ">=4"
      },
      "peerDependenciesMeta": {
        "eslint": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-module-utils/node_modules/debug": {
      "version": "3.2.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-3.2.7.tgz",
      "integrity": "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.1"
      }
    },
    "node_modules/eslint-plugin-import": {
      "version": "2.32.0",
      "resolved": "https://registry.npmjs.org/eslint-plugin-import/-/eslint-plugin-import-2.32.0.tgz",
      "integrity": "sha512-whOE1HFo/qJDyX4SnXzP4N6zOWn79WhnCUY/iDR0mPfQZO8wcYE4JClzI2oZrhBnnMUCBCHZhO6VQyoBU95mZA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@rtsao/scc": "^1.1.0",
        "array-includes": "^3.1.9",
        "array.prototype.findlastindex": "^1.2.6",
        "array.prototype.flat": "^1.3.3",
        "array.prototype.flatmap": "^1.3.3",
        "debug": "^3.2.7",
        "doctrine": "^2.1.0",
        "eslint-import-resolver-node": "^0.3.9",
        "eslint-module-utils": "^2.12.1",
        "hasown": "^2.0.2",
        "is-core-module": "^2.16.1",
        "is-glob": "^4.0.3",
        "minimatch": "^3.1.2",
        "object.fromentries": "^2.0.8",
        "object.groupby": "^1.0.3",
        "object.values": "^1.2.1",
        "semver": "^6.3.1",
        "string.prototype.trimend": "^1.0.9",
        "tsconfig-paths": "^3.15.0"
      },
      "engines": {
        "node": ">=4"
      },
      "peerDependencies": {
        "eslint": "^2 || ^3 || ^4 || ^5 || ^6 || ^7.2.0 || ^8 || ^9"
      }
    },
    "node_modules/eslint-plugin-import/node_modules/debug": {
      "version": "3.2.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-3.2.7.tgz",
      "integrity": "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.1"
      }
    },
    "node_modules/eslint-plugin-jsx-a11y": {
      "version": "6.10.2",
      "resolved": "https://registry.npmjs.org/eslint-plugin-jsx-a11y/-/eslint-plugin-jsx-a11y-6.10.2.tgz",
      "integrity": "sha512-scB3nz4WmG75pV8+3eRUQOHZlNSUhFNq37xnpgRkCCELU3XMvXAxLk1eqWWyE22Ki4Q01Fnsw9BA3cJHDPgn2Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "aria-query": "^5.3.2",
        "array-includes": "^3.1.8",
        "array.prototype.flatmap": "^1.3.2",
        "ast-types-flow": "^0.0.8",
        "axe-core": "^4.10.0",
        "axobject-query": "^4.1.0",
        "damerau-levenshtein": "^1.0.8",
        "emoji-regex": "^9.2.2",
        "hasown": "^2.0.2",
        "jsx-ast-utils": "^3.3.5",
        "language-tags": "^1.0.9",
        "minimatch": "^3.1.2",
        "object.fromentries": "^2.0.8",
        "safe-regex-test": "^1.0.3",
        "string.prototype.includes": "^2.0.1"
      },
      "engines": {
        "node": ">=4.0"
      },
      "peerDependencies": {
        "eslint": "^3 || ^4 || ^5 || ^6 || ^7 || ^8 || ^9"
      }
    },
    "node_modules/eslint-plugin-react": {
      "version": "7.37.5",
      "resolved": "https://registry.npmjs.org/eslint-plugin-react/-/eslint-plugin-react-7.37.5.tgz",
      "integrity": "sha512-Qteup0SqU15kdocexFNAJMvCJEfa2xUKNV4CC1xsVMrIIqEy3SQ/rqyxCWNzfrd3/ldy6HMlD2e0JDVpDg2qIA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-includes": "^3.1.8",
        "array.prototype.findlast": "^1.2.5",
        "array.prototype.flatmap": "^1.3.3",
        "array.prototype.tosorted": "^1.1.4",
        "doctrine": "^2.1.0",
        "es-iterator-helpers": "^1.2.1",
        "estraverse": "^5.3.0",
        "hasown": "^2.0.2",
        "jsx-ast-utils": "^2.4.1 || ^3.0.0",
        "minimatch": "^3.1.2",
        "object.entries": "^1.1.9",
        "object.fromentries": "^2.0.8",
        "object.values": "^1.2.1",
        "prop-types": "^15.8.1",
        "resolve": "^2.0.0-next.5",
        "semver": "^6.3.1",
        "string.prototype.matchall": "^4.0.12",
        "string.prototype.repeat": "^1.0.0"
      },
      "engines": {
        "node": ">=4"
      },
      "peerDependencies": {
        "eslint": "^3 || ^4 || ^5 || ^6 || ^7 || ^8 || ^9.7"
      }
    },
    "node_modules/eslint-plugin-react-hooks": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/eslint-plugin-react-hooks/-/eslint-plugin-react-hooks-7.0.1.tgz",
      "integrity": "sha512-O0d0m04evaNzEPoSW+59Mezf8Qt0InfgGIBJnpC0h3NH/WjUAR7BIKUfysC6todmtiZ/A0oUVS8Gce0WhBrHsA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.24.4",
        "@babel/parser": "^7.24.4",
        "hermes-parser": "^0.25.1",
        "zod": "^3.25.0 || ^4.0.0",
        "zod-validation-error": "^3.5.0 || ^4.0.0"
      },
      "engines": {
        "node": ">=18"
      },
      "peerDependencies": {
        "eslint": "^3.0.0 || ^4.0.0 || ^5.0.0 || ^6.0.0 || ^7.0.0 || ^8.0.0-0 || ^9.0.0"
      }
    },
    "node_modules/eslint-plugin-react/node_modules/resolve": {
      "version": "2.0.0-next.5",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-2.0.0-next.5.tgz",
      "integrity": "sha512-U7WjGVG9sH8tvjW5SmGbQuui75FiyjAX72HX15DwBBwF9dNiQZRQAg9nnPhYy+TUnE0+VcrttuvNI8oSxZcocA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-core-module": "^2.13.0",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/eslint-scope": {
      "version": "8.4.0",
      "resolved": "https://registry.npmjs.org/eslint-scope/-/eslint-scope-8.4.0.tgz",
      "integrity": "sha512-sNXOfKCn74rt8RICKMvJS7XKV/Xk9kA7DyJr8mJik3S7Cwgy3qlkkmyS2uQB3jiJg6VNdZd/pDBJu0nvG2NlTg==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "esrecurse": "^4.3.0",
        "estraverse": "^5.2.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/eslint-visitor-keys": {
      "version": "4.2.1",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.2.1.tgz",
      "integrity": "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/espree": {
      "version": "10.4.0",
      "resolved": "https://registry.npmjs.org/espree/-/espree-10.4.0.tgz",
      "integrity": "sha512-j6PAQ2uUr79PZhBjP5C5fhl8e39FmRnOjsD5lGnWrFU8i2G776tBK7+nP8KuQUTTyAZUwfQqXAgrVH5MbH9CYQ==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "acorn": "^8.15.0",
        "acorn-jsx": "^5.3.2",
        "eslint-visitor-keys": "^4.2.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/esprima": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/esprima/-/esprima-4.0.1.tgz",
      "integrity": "sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==",
      "license": "BSD-2-Clause",
      "bin": {
        "esparse": "bin/esparse.js",
        "esvalidate": "bin/esvalidate.js"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/esquery": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/esquery/-/esquery-1.6.0.tgz",
      "integrity": "sha512-ca9pw9fomFcKPvFLXhBKUK90ZvGibiGOvRJNbjljY7s7uq/5YO4BOzcYtJqExdx99rF6aAcnRxHmcUHcz6sQsg==",
      "dev": true,
      "license": "BSD-3-Clause",
      "dependencies": {
        "estraverse": "^5.1.0"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/esrecurse": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/esrecurse/-/esrecurse-4.3.0.tgz",
      "integrity": "sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "estraverse": "^5.2.0"
      },
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/estraverse": {
      "version": "5.3.0",
      "resolved": "https://registry.npmjs.org/estraverse/-/estraverse-5.3.0.tgz",
      "integrity": "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==",
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/esutils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz",
      "integrity": "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==",
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/event-target-shim": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/event-target-shim/-/event-target-shim-5.0.1.tgz",
      "integrity": "sha512-i/2XbnSz/uxRCU6+NdVJgKWDTM427+MqYbkQzD321DuCQJUqOuJKIA0IM2+W2xtYHdKOmZ4dR6fExsd4SXL+WQ==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/events-universal": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/events-universal/-/events-universal-1.0.1.tgz",
      "integrity": "sha512-LUd5euvbMLpwOF8m6ivPCbhQeSiYVNb8Vs0fQ8QjXo0JTkEHpz8pxdQf0gStltaPpw0Cca8b39KxvK9cfKRiAw==",
      "license": "Apache-2.0",
      "dependencies": {
        "bare-events": "^2.7.0"
      }
    },
    "node_modules/extend": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/extend/-/extend-3.0.2.tgz",
      "integrity": "sha512-fjquC59cD7CyW6urNXK0FBufkZcoiGG80wTuPujX590cB5Ttln20E2UB4S/WARVqhXffZl2LNgS+gQdPIIim/g==",
      "license": "MIT"
    },
    "node_modules/extract-zip": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/extract-zip/-/extract-zip-2.0.1.tgz",
      "integrity": "sha512-GDhU9ntwuKyGXdZBUgTIe+vXnWj0fppUEtMDL0+idd5Sta8TGpHssn/eusA9mrPr9qNDym6SxAYZjNvCn/9RBg==",
      "license": "BSD-2-Clause",
      "dependencies": {
        "debug": "^4.1.1",
        "get-stream": "^5.1.0",
        "yauzl": "^2.10.0"
      },
      "bin": {
        "extract-zip": "cli.js"
      },
      "engines": {
        "node": ">= 10.17.0"
      },
      "optionalDependencies": {
        "@types/yauzl": "^2.9.1"
      }
    },
    "node_modules/farmhash-modern": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/farmhash-modern/-/farmhash-modern-1.1.0.tgz",
      "integrity": "sha512-6ypT4XfgqJk/F3Yuv4SX26I3doUjt0GTG4a+JgWxXQpxXzTBq8fPUeGHfcYMMDPHJHm3yPOSjaeBwBGAHWXCdA==",
      "license": "MIT",
      "engines": {
        "node": ">=18.0.0"
      }
    },
    "node_modules/fast-deep-equal": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz",
      "integrity": "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==",
      "license": "MIT"
    },
    "node_modules/fast-fifo": {
      "version": "1.3.2",
      "resolved": "https://registry.npmjs.org/fast-fifo/-/fast-fifo-1.3.2.tgz",
      "integrity": "sha512-/d9sfos4yxzpwkDkuN7k2SqFKtYNmCTzgfEpz82x34IM9/zc8KGxQoXg1liNC/izpRM/MBdt44Nmx41ZWqk+FQ==",
      "license": "MIT"
    },
    "node_modules/fast-glob": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.1.tgz",
      "integrity": "sha512-kNFPyjhh5cKjrUltxs+wFx+ZkbRaxxmZ+X0ZU31SOsxCEtP9VPgtq2teZw1DebupL5GmDaNQ6yKMMVcM41iqDg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "^2.0.2",
        "@nodelib/fs.walk": "^1.2.3",
        "glob-parent": "^5.1.2",
        "merge2": "^1.3.0",
        "micromatch": "^4.0.4"
      },
      "engines": {
        "node": ">=8.6.0"
      }
    },
    "node_modules/fast-glob/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fast-json-stable-stringify": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
      "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fast-levenshtein": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/fast-levenshtein/-/fast-levenshtein-2.0.6.tgz",
      "integrity": "sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fast-xml-parser": {
      "version": "4.5.3",
      "resolved": "https://registry.npmjs.org/fast-xml-parser/-/fast-xml-parser-4.5.3.tgz",
      "integrity": "sha512-RKihhV+SHsIUGXObeVy9AXiBbFwkVk7Syp8XgwN5U3JV416+Gwp/GO9i0JYKmikykgz/UHRrrV4ROuZEo/T0ig==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/NaturalIntelligence"
        }
      ],
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "strnum": "^1.1.1"
      },
      "bin": {
        "fxparser": "src/cli/cli.js"
      }
    },
    "node_modules/fastq": {
      "version": "1.19.1",
      "resolved": "https://registry.npmjs.org/fastq/-/fastq-1.19.1.tgz",
      "integrity": "sha512-GwLTyxkCXjXbxqIhTsMI2Nui8huMPtnxg7krajPJAjnEG/iiOS7i+zCtWGZR9G0NBKbXKh6X9m9UIsYX/N6vvQ==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "reusify": "^1.0.4"
      }
    },
    "node_modules/faye-websocket": {
      "version": "0.11.4",
      "resolved": "https://registry.npmjs.org/faye-websocket/-/faye-websocket-0.11.4.tgz",
      "integrity": "sha512-CzbClwlXAuiRQAlUyfqPgvPoNKTckTPGfwZV4ZdAhVcP2lh9KUxJg2b5GkE7XbjKQ3YJnQ9z6D9ntLAlB+tP8g==",
      "license": "Apache-2.0",
      "dependencies": {
        "websocket-driver": ">=0.5.1"
      },
      "engines": {
        "node": ">=0.8.0"
      }
    },
    "node_modules/fd-slicer": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/fd-slicer/-/fd-slicer-1.1.0.tgz",
      "integrity": "sha512-cE1qsB/VwyQozZ+q1dGxR8LBYNZeofhEdUNGSMbQD3Gw2lAzX9Zb3uIU6Ebc/Fmyjo9AWWfnn0AUCHqtevs/8g==",
      "license": "MIT",
      "dependencies": {
        "pend": "~1.2.0"
      }
    },
    "node_modules/file-entry-cache": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/file-entry-cache/-/file-entry-cache-8.0.0.tgz",
      "integrity": "sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "flat-cache": "^4.0.0"
      },
      "engines": {
        "node": ">=16.0.0"
      }
    },
    "node_modules/fill-range": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "to-regex-range": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/find-up": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/find-up/-/find-up-5.0.0.tgz",
      "integrity": "sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4fXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "locate-path": "^6.0.0",
        "path-exists": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/firebase": {
      "version": "12.7.0",
      "resolved": "https://registry.npmjs.org/firebase/-/firebase-12.7.0.tgz",
      "integrity": "sha512-ZBZg9jFo8uH4Emd7caOqtalKJfDGHnHQSrCPiqRAdTFQd0wL3ERilUBfhnhBLnlernugkN/o7nJa0p+sE71Izg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/ai": "2.6.1",
        "@firebase/analytics": "0.10.19",
        "@firebase/analytics-compat": "0.2.25",
        "@firebase/app": "0.14.6",
        "@firebase/app-check": "0.11.0",
        "@firebase/app-check-compat": "0.4.0",
        "@firebase/app-compat": "0.5.6",
        "@firebase/app-types": "0.9.3",
        "@firebase/auth": "1.12.0",
        "@firebase/auth-compat": "0.6.2",
        "@firebase/data-connect": "0.3.12",
        "@firebase/database": "1.1.0",
        "@firebase/database-compat": "2.1.0",
        "@firebase/firestore": "4.9.3",
        "@firebase/firestore-compat": "0.4.3",
        "@firebase/functions": "0.13.1",
        "@firebase/functions-compat": "0.4.1",
        "@firebase/installations": "0.6.19",
        "@firebase/installations-compat": "0.2.19",
        "@firebase/messaging": "0.12.23",
        "@firebase/messaging-compat": "0.2.23",
        "@firebase/performance": "0.7.9",
        "@firebase/performance-compat": "0.2.22",
        "@firebase/remote-config": "0.7.0",
        "@firebase/remote-config-compat": "0.2.20",
        "@firebase/storage": "0.14.0",
        "@firebase/storage-compat": "0.4.0",
        "@firebase/util": "1.13.0"
      }
    },
    "node_modules/firebase-admin": {
      "version": "13.6.0",
      "resolved": "https://registry.npmjs.org/firebase-admin/-/firebase-admin-13.6.0.tgz",
      "integrity": "sha512-GdPA/t0+Cq8p1JnjFRBmxRxAGvF/kl2yfdhALl38PrRp325YxyQ5aNaHui0XmaKcKiGRFIJ/EgBNWFoDP0onjw==",
      "license": "Apache-2.0",
      "dependencies": {
        "@fastify/busboy": "^3.0.0",
        "@firebase/database-compat": "^2.0.0",
        "@firebase/database-types": "^1.0.6",
        "@types/node": "^22.8.7",
        "farmhash-modern": "^1.1.0",
        "fast-deep-equal": "^3.1.1",
        "google-auth-library": "^9.14.2",
        "jsonwebtoken": "^9.0.0",
        "jwks-rsa": "^3.1.0",
        "node-forge": "^1.3.1",
        "uuid": "^11.0.2"
      },
      "engines": {
        "node": ">=18"
      },
      "optionalDependencies": {
        "@google-cloud/firestore": "^7.11.0",
        "@google-cloud/storage": "^7.14.0"
      }
    },
    "node_modules/firebase-admin/node_modules/@types/node": {
      "version": "22.19.3",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-22.19.3.tgz",
      "integrity": "sha512-1N9SBnWYOJTrNZCdh/yJE+t910Y128BoyY+zBLWhL3r0TYzlTmFdXrPwHL9DyFZmlEXNQQolTZh3KHV31QDhyA==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~6.21.0"
      }
    },
    "node_modules/flat-cache": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/flat-cache/-/flat-cache-4.0.1.tgz",
      "integrity": "sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3frBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "flatted": "^3.2.9",
        "keyv": "^4.5.4"
      },
      "engines": {
        "node": ">=16"
      }
    },
    "node_modules/flatted": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/flatted/-/flatted-3.3.3.tgz",
      "integrity": "sha512-GX+ysw4PBCz0PzosHDepZGANEuFCMLrnRTiEy9McGjmkCQYwRq4A/X786G/fjM/+OjsWSU1ZrY5qyARZmO/uwg==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/for-each": {
      "version": "0.3.5",
      "resolved": "https://registry.npmjs.org/for-each/-/for-each-0.3.5.tgz",
      "integrity": "sha512-dKx12eRCVIzqCxFGplyFKJMPvLEWgmNtUrpTiJIR5u97zEhRG8ySrtboPHZXx7daLxQVrl643cTzbab2tkQjxg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-callable": "^1.2.7"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/form-data": {
      "version": "2.5.5",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-2.5.5.tgz",
      "integrity": "sha512-jqdObeR2rxZZbPSGL+3VckHMYtu+f9//KXBsVny6JSX/pa38Fy+bGjuG8eW/H6USNQWhLi8Num++cU2yOCNz4A==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.35",
        "safe-buffer": "^5.2.1"
      },
      "engines": {
        "node": ">= 0.12"
      }
    },
    "node_modules/fraction.js": {
      "version": "5.3.4",
      "resolved": "https://registry.npmjs.org/fraction.js/-/fraction.js-5.3.4.tgz",
      "integrity": "sha512-1X1NTtiJphryn/uLQz3whtY6jK3fTqoE3ohKs0tT+Ujr1W59oopxmoEh7Lu5p6vBaPbgoM0bzveAW4Qi5RyWDQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "*"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/rawify"
      }
    },
    "node_modules/framer-motion": {
      "version": "12.23.26",
      "resolved": "https://registry.npmjs.org/framer-motion/-/framer-motion-12.23.26.tgz",
      "integrity": "sha512-cPcIhgR42xBn1Uj+PzOyheMtZ73H927+uWPDVhUMqxy8UHt6Okavb6xIz9J/phFUHUj0OncR6UvMfJTXoc/LKA==",
      "license": "MIT",
      "dependencies": {
        "motion-dom": "^12.23.23",
        "motion-utils": "^12.23.6",
        "tslib": "^2.4.0"
      },
      "peerDependencies": {
        "@emotion/is-prop-valid": "*",
        "react": "^18.0.0 || ^19.0.0",
        "react-dom": "^18.0.0 || ^19.0.0"
      },
      "peerDependenciesMeta": {
        "@emotion/is-prop-valid": {
          "optional": true
        },
        "react": {
          "optional": true
        },
        "react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "devOptional": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/function.prototype.name": {
      "version": "1.1.8",
      "resolved": "https://registry.npmjs.org/function.prototype.name/-/function.prototype.name-1.1.8.tgz",
      "integrity": "sha512-e5iwyodOHhbMr/yNrc7fDYG4qlbIvI5gajyzPnb5TCwyhjApznQh1BMFou9b30SevY43gCJKXycoCBjMbsuW0Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "functions-have-names": "^1.2.3",
        "hasown": "^2.0.2",
        "is-callable": "^1.2.7"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/functional-red-black-tree": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/functional-red-black-tree/-/functional-red-black-tree-1.0.1.tgz",
      "integrity": "sha512-dsKNQNdj6xA3T+QlADDA7mOSlX0qiMINjn0cgr+eGHGsbSHzTabcIogz2+p/iqP1Xs6EP/sS2SbqH+brGTbq0g==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/functions-have-names": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/functions-have-names/-/functions-have-names-1.2.3.tgz",
      "integrity": "sha512-xckBUXyTIqT97tq2x2AMb+g163b5JFysYk0x4qxNFwbfQkmNZoiRHb6sPzI9/QV33WeuvVYBUIiD4NzNIyqaRQ==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/gaxios": {
      "version": "6.7.1",
      "resolved": "https://registry.npmjs.org/gaxios/-/gaxios-6.7.1.tgz",
      "integrity": "sha512-LDODD4TMYx7XXdpwxAVRAIAuB0bzv0s+ywFonY46k126qzQHT9ygyoa9tncmOiQmmDrik65UYsEkv3lbfqQ3yQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "extend": "^3.0.2",
        "https-proxy-agent": "^7.0.1",
        "is-stream": "^2.0.0",
        "node-fetch": "^2.6.9",
        "uuid": "^9.0.1"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/gaxios/node_modules/uuid": {
      "version": "9.0.1",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/gcp-metadata": {
      "version": "6.1.1",
      "resolved": "https://registry.npmjs.org/gcp-metadata/-/gcp-metadata-6.1.1.tgz",
      "integrity": "sha512-a4tiq7E0/5fTjxPAaH4jpjkSv/uCaU2p5KC6HVGrvl0cDjA8iBZv4vv1gyzlmK0ZUKqwpOyQMKzZQe3lTit77A==",
      "license": "Apache-2.0",
      "dependencies": {
        "gaxios": "^6.1.1",
        "google-logging-utils": "^0.0.2",
        "json-bigint": "^1.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/generator-function": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/generator-function/-/generator-function-2.0.1.tgz",
      "integrity": "sha512-SFdFmIJi+ybC0vjlHN0ZGVGHc3lgE0DxPAT0djjVg+kjOnSqclqmj0KQ7ykTOLP6YxoqOvuAODGdcHJn+43q3g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/get-caller-file": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/get-caller-file/-/get-caller-file-2.0.5.tgz",
      "integrity": "sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==",
      "license": "ISC",
      "engines": {
        "node": "6.* || 8.* || >= 10.*"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/get-stream": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/get-stream/-/get-stream-5.2.0.tgz",
      "integrity": "sha512-nBF+F1rAZVCu/p7rjzgA+Yb4lfYXrpl7a6VmJrU8wF9I1CKvP/QwPNZHnOlwbTkY6dvtFIzFMSyQXbLoTQPRpA==",
      "license": "MIT",
      "dependencies": {
        "pump": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/get-symbol-description": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/get-symbol-description/-/get-symbol-description-1.1.0.tgz",
      "integrity": "sha512-w9UMqWwJxHNOvoNzSJ2oPF5wvYcvP7jUvYzhp67yEhTi17ZDBBC1z9pTdGuzjD+EFIqLSYRweZjqfiPzQ06Ebg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-tsconfig": {
      "version": "4.13.0",
      "resolved": "https://registry.npmjs.org/get-tsconfig/-/get-tsconfig-4.13.0.tgz",
      "integrity": "sha512-1VKTZJCwBrvbd+Wn3AOgQP/2Av+TfTCOlE4AcRJE72W1ksZXbAx8PPBR9RzgTeSPzlPMHrbANMH3LbltH73wxQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "resolve-pkg-maps": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/privatenumber/get-tsconfig?sponsor=1"
      }
    },
    "node_modules/get-uri": {
      "version": "6.0.5",
      "resolved": "https://registry.npmjs.org/get-uri/-/get-uri-6.0.5.tgz",
      "integrity": "sha512-b1O07XYq8eRuVzBNgJLstU6FYc1tS6wnMtF1I1D9lE8LxZSOGZ7LhxN54yPP6mGw5f2CkXY2BQUL9Fx41qvcIg==",
      "license": "MIT",
      "dependencies": {
        "basic-ftp": "^5.0.2",
        "data-uri-to-buffer": "^6.0.2",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/glob-parent": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
      "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.3"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/globals": {
      "version": "14.0.0",
      "resolved": "https://registry.npmjs.org/globals/-/globals-14.0.0.tgz",
      "integrity": "sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/globalthis": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/globalthis/-/globalthis-1.0.4.tgz",
      "integrity": "sha512-DpLKbNU4WylpxJykQujfCcwYWiV/Jhm50Goo0wrVILAv5jOr9d+H+UR3PhSCD2rCCEIg0uc+G+muBTwD54JhDQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-properties": "^1.2.1",
        "gopd": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/goober": {
      "version": "2.1.18",
      "resolved": "https://registry.npmjs.org/goober/-/goober-2.1.18.tgz",
      "integrity": "sha512-2vFqsaDVIT9Gz7N6kAL++pLpp41l3PfDuusHcjnGLfR6+huZkl6ziX+zgVC3ZxpqWhzH6pyDdGrCeDhMIvwaxw==",
      "license": "MIT",
      "peerDependencies": {
        "csstype": "^3.0.10"
      }
    },
    "node_modules/google-auth-library": {
      "version": "9.15.1",
      "resolved": "https://registry.npmjs.org/google-auth-library/-/google-auth-library-9.15.1.tgz",
      "integrity": "sha512-Jb6Z0+nvECVz+2lzSMt9u98UsoakXxA2HGHMCxh+so3n90XgYWkq5dur19JAJV7ONiJY22yBTyJB1TSkvPq9Ng==",
      "license": "Apache-2.0",
      "dependencies": {
        "base64-js": "^1.3.0",
        "ecdsa-sig-formatter": "^1.0.11",
        "gaxios": "^6.1.1",
        "gcp-metadata": "^6.1.0",
        "gtoken": "^7.0.0",
        "jws": "^4.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/google-gax": {
      "version": "4.6.1",
      "resolved": "https://registry.npmjs.org/google-gax/-/google-gax-4.6.1.tgz",
      "integrity": "sha512-V6eky/xz2mcKfAd1Ioxyd6nmA61gao3n01C+YeuIwu3vzM9EDR6wcVzMSIbLMDXWeoi9SHYctXuKYC5uJUT3eQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@grpc/grpc-js": "^1.10.9",
        "@grpc/proto-loader": "^0.7.13",
        "@types/long": "^4.0.0",
        "abort-controller": "^3.0.0",
        "duplexify": "^4.0.0",
        "google-auth-library": "^9.3.0",
        "node-fetch": "^2.7.0",
        "object-hash": "^3.0.0",
        "proto3-json-serializer": "^2.0.2",
        "protobufjs": "^7.3.2",
        "retry-request": "^7.0.0",
        "uuid": "^9.0.1"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/google-gax/node_modules/@grpc/grpc-js": {
      "version": "1.14.3",
      "resolved": "https://registry.npmjs.org/@grpc/grpc-js/-/grpc-js-1.14.3.tgz",
      "integrity": "sha512-Iq8QQQ/7X3Sac15oB6p0FmUg/klxQvXLeileoqrTRGJYLV+/9tubbr9ipz0GKHjmXVsgFPo/+W+2cA8eNcR+XA==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@grpc/proto-loader": "^0.8.0",
        "@js-sdsl/ordered-map": "^4.4.2"
      },
      "engines": {
        "node": ">=12.10.0"
      }
    },
    "node_modules/google-gax/node_modules/@grpc/grpc-js/node_modules/@grpc/proto-loader": {
      "version": "0.8.0",
      "resolved": "https://registry.npmjs.org/@grpc/proto-loader/-/proto-loader-0.8.0.tgz",
      "integrity": "sha512-rc1hOQtjIWGxcxpb9aHAfLpIctjEnsDehj0DAiVfBlmT84uvR0uUtN2hEi/ecvWVjXUGf5qPF4qEgiLOx1YIMQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "lodash.camelcase": "^4.3.0",
        "long": "^5.0.0",
        "protobufjs": "^7.5.3",
        "yargs": "^17.7.2"
      },
      "bin": {
        "proto-loader-gen-types": "build/bin/proto-loader-gen-types.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/google-gax/node_modules/uuid": {
      "version": "9.0.1",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "optional": true,
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/google-logging-utils": {
      "version": "0.0.2",
      "resolved": "https://registry.npmjs.org/google-logging-utils/-/google-logging-utils-0.0.2.tgz",
      "integrity": "sha512-NEgUnEcBiP5HrPzufUkBzJOD/Sxsco3rLNo1F1TNf7ieU8ryUzBhqba8r756CjLX7rn3fHl6iLEwPYuqpoKgQQ==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/gtoken": {
      "version": "7.1.0",
      "resolved": "https://registry.npmjs.org/gtoken/-/gtoken-7.1.0.tgz",
      "integrity": "sha512-pCcEwRi+TKpMlxAQObHDQ56KawURgyAf6jtIY046fJ5tIv3zDe/LEIubckAO8fj6JnAxLdmWkUfNyulQ2iKdEw==",
      "license": "MIT",
      "dependencies": {
        "gaxios": "^6.0.0",
        "jws": "^4.0.0"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/has-bigints": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-bigints/-/has-bigints-1.1.0.tgz",
      "integrity": "sha512-R3pbpkcIqv2Pm3dUwgjclDRVmWpTJW2DcMzcIhEXEx1oh/CEMObMm3KLmRJOdvhM7o4uQBnwr8pzRK2sJWIqfg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-flag": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/has-property-descriptors": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-property-descriptors/-/has-property-descriptors-1.0.2.tgz",
      "integrity": "sha512-55JNKuIW+vq4Ke1BjOTjM2YctQIvCT7GFzHwmfZPGo5wnrgkid0YQtnAleFSqumZm4az3n2BS+erby5ipJdgrg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-proto": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/has-proto/-/has-proto-1.2.0.tgz",
      "integrity": "sha512-KIL7eQPfHQRC8+XluaIw7BHUwwqL19bQn4hzNgdr+1wXoU0KKj6rufu47lhY7KbJR2C6T6+PfyN0Ea7wkSS+qQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/hermes-estree": {
      "version": "0.25.1",
      "resolved": "https://registry.npmjs.org/hermes-estree/-/hermes-estree-0.25.1.tgz",
      "integrity": "sha512-0wUoCcLp+5Ev5pDW2OriHC2MJCbwLwuRx+gAqMTOkGKJJiBCLjtrvy4PWUGn6MIVefecRpzoOZ/UV6iGdOr+Cw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/hermes-parser": {
      "version": "0.25.1",
      "resolved": "https://registry.npmjs.org/hermes-parser/-/hermes-parser-0.25.1.tgz",
      "integrity": "sha512-6pEjquH3rqaI6cYAXYPcz9MS4rY6R4ngRgrgfDshRptUZIc3lw0MCIJIGDj9++mfySOuPTHB4nrSW99BCvOPIA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "hermes-estree": "0.25.1"
      }
    },
    "node_modules/html-entities": {
      "version": "2.6.0",
      "resolved": "https://registry.npmjs.org/html-entities/-/html-entities-2.6.0.tgz",
      "integrity": "sha512-kig+rMn/QOVRvr7c86gQ8lWXq+Hkv6CbAH1hLu+RG338StTpE8Z0b44SDVaqVu7HGKf27frdmUYEs9hTUX/cLQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/mdevils"
        },
        {
          "type": "patreon",
          "url": "https://patreon.com/mdevils"
        }
      ],
      "license": "MIT",
      "optional": true
    },
    "node_modules/http-parser-js": {
      "version": "0.5.10",
      "resolved": "https://registry.npmjs.org/http-parser-js/-/http-parser-js-0.5.10.tgz",
      "integrity": "sha512-Pysuw9XpUq5dVc/2SMHpuTY01RFl8fttgcyunjL7eEMhGM3cI4eOmiCycJDVCo/7O7ClfQD3SaI6ftDzqOXYMA==",
      "license": "MIT"
    },
    "node_modules/http-proxy-agent": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz",
      "integrity": "sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/https-proxy-agent": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-7.0.6.tgz",
      "integrity": "sha512-vK9P5/iUfdl95AI+JVyUuIcVtd4ofvtrOr3HNtM2yxC9bnMbEdp3x01OhQNnjb8IJYi38VlTE3mBXwcfvywuSw==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.2",
        "debug": "4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/idb": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/idb/-/idb-7.1.1.tgz",
      "integrity": "sha512-gchesWBzyvGHRO9W8tzUWFDycow5gwjvFKfyV9FF32Y7F50yZMp7mP+T2mJIWFx49zicqyC4uefHM17o6xKIVQ==",
      "license": "ISC"
    },
    "node_modules/ignore": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-5.3.2.tgz",
      "integrity": "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/import-fresh": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/import-fresh/-/import-fresh-3.3.1.tgz",
      "integrity": "sha512-TR3KfrTZTYLPB6jUjfx6MF9WcWrHL9su5TObK4ZkYgBdWKPOFoSoQIdEuTuR82pmtxH2spWG9h6etwfr1pLBqQ==",
      "license": "MIT",
      "dependencies": {
        "parent-module": "^1.0.0",
        "resolve-from": "^4.0.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/imurmurhash": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
      "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.8.19"
      }
    },
    "node_modules/inherits": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
      "license": "ISC",
      "optional": true
    },
    "node_modules/internal-slot": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/internal-slot/-/internal-slot-1.1.0.tgz",
      "integrity": "sha512-4gd7VpWNQNB4UKKCFFVcp1AVv+FMOgs9NKzjHKusc8jTMhd5eL1NqQqOpE0KzMds804/yHlglp3uxgluOqAPLw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "hasown": "^2.0.2",
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/ip-address": {
      "version": "10.1.0",
      "resolved": "https://registry.npmjs.org/ip-address/-/ip-address-10.1.0.tgz",
      "integrity": "sha512-XXADHxXmvT9+CRxhXg56LJovE+bmWnEWB78LB83VZTprKTmaC5QfruXocxzTZ2Kl0DNwKuBdlIhjL8LeY8Sf8Q==",
      "license": "MIT",
      "engines": {
        "node": ">= 12"
      }
    },
    "node_modules/is-array-buffer": {
      "version": "3.0.5",
      "resolved": "https://registry.npmjs.org/is-array-buffer/-/is-array-buffer-3.0.5.tgz",
      "integrity": "sha512-DDfANUiiG2wC1qawP66qlTugJeL5HyzMpfr8lLK+jMQirGzNod0B12cFB/9q838Ru27sBwfw78/rdoU7RERz6A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "get-intrinsic": "^1.2.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-arrayish": {
      "version": "0.2.1",
      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.2.1.tgz",
      "integrity": "sha512-zz06S8t0ozoDXMG+ube26zeCTNXcKIPJZJi8hBrF4idCLms4CG9QtK7qBl1boi5ODzFpjswb5JPmHCbMpjaYzg==",
      "license": "MIT"
    },
    "node_modules/is-async-function": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-async-function/-/is-async-function-2.1.1.tgz",
      "integrity": "sha512-9dgM/cZBnNvjzaMYHVoxxfPj2QXt22Ev7SuuPrs+xav0ukGB0S6d4ydZdEiM48kLx5kDV+QBPrpVnFyefL8kkQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "async-function": "^1.0.0",
        "call-bound": "^1.0.3",
        "get-proto": "^1.0.1",
        "has-tostringtag": "^1.0.2",
        "safe-regex-test": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-bigint": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/is-bigint/-/is-bigint-1.1.0.tgz",
      "integrity": "sha512-n4ZT37wG78iz03xPRKJrHTdZbe3IicyucEtdRsV5yglwc3GyUfbAfpSeD0FJ41NbUNSt5wbhqfp1fS+BgnvDFQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "has-bigints": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-binary-path": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "binary-extensions": "^2.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-boolean-object": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/is-boolean-object/-/is-boolean-object-1.2.2.tgz",
      "integrity": "sha512-wa56o2/ElJMYqjCjGkXri7it5FbebW5usLw/nPmCMs5DeZ7eziSYZhSmPRn0txqeW4LnAmQQU7FgqLpsEFKM4A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-bun-module": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/is-bun-module/-/is-bun-module-2.0.0.tgz",
      "integrity": "sha512-gNCGbnnnnFAUGKeZ9PdbyeGYJqewpmc2aKHUEMO5nQPWU9lOmv7jcmQIv+qHD8fXW6W7qfuCwX4rY9LNRjXrkQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "semver": "^7.7.1"
      }
    },
    "node_modules/is-bun-module/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/is-callable": {
      "version": "1.2.7",
      "resolved": "https://registry.npmjs.org/is-callable/-/is-callable-1.2.7.tgz",
      "integrity": "sha512-1BC0BVFhS/p0qtw6enp8e+8OD0UrK0oFLztSjNzhcKA3WDuJxxAPXzPuPtKkjEY9UUoEWlX/8fgKeu2S8i9JTA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-core-module": {
      "version": "2.16.1",
      "resolved": "https://registry.npmjs.org/is-core-module/-/is-core-module-2.16.1.tgz",
      "integrity": "sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-data-view": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/is-data-view/-/is-data-view-1.0.2.tgz",
      "integrity": "sha512-RKtWF8pGmS87i2D6gqQu/l7EYRlVdfzemCJN/P3UOs//x1QE7mfhvzHIApBTRf7axvT6DMGwSwBXYCT0nfB9xw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "get-intrinsic": "^1.2.6",
        "is-typed-array": "^1.1.13"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-date-object": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/is-date-object/-/is-date-object-1.1.0.tgz",
      "integrity": "sha512-PwwhEakHVKTdRNVOw+/Gyh0+MzlCl4R6qKvkhuvLtPMggI1WAHt9sOwZxQLSGpUaDnrdyDsomoRgNnCfKNSXXg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-extglob": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-finalizationregistry": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-finalizationregistry/-/is-finalizationregistry-1.1.1.tgz",
      "integrity": "sha512-1pC6N8qWJbWoPtEjgcL2xyhQOP491EQjeUo3qTKcmV8YSDDJrOepfG8pcC7h/QgnQHYSv0mJ3Z/ZWxmatVrysg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-fullwidth-code-point": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-generator-function": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/is-generator-function/-/is-generator-function-1.1.2.tgz",
      "integrity": "sha512-upqt1SkGkODW9tsGNG5mtXTXtECizwtS2kA161M+gJPc1xdb/Ax629af6YrTwcOeQHbewrPNlE5Dx7kzvXTizA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.4",
        "generator-function": "^2.0.0",
        "get-proto": "^1.0.1",
        "has-tostringtag": "^1.0.2",
        "safe-regex-test": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-glob": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-extglob": "^2.1.1"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-map": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/is-map/-/is-map-2.0.3.tgz",
      "integrity": "sha512-1Qed0/Hr2m+YqxnM09CjA2d/i6YZNfF6R2oRAOj36eUdS6qIV/huPJNSEpKbupewFs+ZsJlxsjjPbc0/afW6Lw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-negative-zero": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/is-negative-zero/-/is-negative-zero-2.0.3.tgz",
      "integrity": "sha512-5KoIu2Ngpyek75jXodFvnafB6DJgr3u8uuK0LEZJjrU19DrMD3EVERaR8sjz8CCGgpZvxPl9SuE1GMVPFHx1mw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-number": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.12.0"
      }
    },
    "node_modules/is-number-object": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-number-object/-/is-number-object-1.1.1.tgz",
      "integrity": "sha512-lZhclumE1G6VYD8VHe35wFaIif+CTy5SJIi5+3y4psDgWu4wPDoBhF8NxUOinEc7pHgiTsT6MaBb92rKhhD+Xw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-regex": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/is-regex/-/is-regex-1.2.1.tgz",
      "integrity": "sha512-MjYsKHO5O7mCsmRGxWcLWheFqN9DJ/2TmngvjKXihe6efViPqc274+Fx/4fYj/r03+ESvBdTXK0V6tA3rgez1g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "gopd": "^1.2.0",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-set": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/is-set/-/is-set-2.0.3.tgz",
      "integrity": "sha512-iPAjerrse27/ygGLxw+EBR9agv9Y6uLeYVJMu+QNCoouJ1/1ri0mGrcWpfCqFZuzzx3WjtwxG098X+n4OuRkPg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-shared-array-buffer": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/is-shared-array-buffer/-/is-shared-array-buffer-1.0.4.tgz",
      "integrity": "sha512-ISWac8drv4ZGfwKl5slpHG9OwPNty4jOWPRIhBpxOoD+hqITiwuipOQ2bNthAzwA3B4fIjO4Nln74N0S9byq8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-stream": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/is-stream/-/is-stream-2.0.1.tgz",
      "integrity": "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/is-string": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-string/-/is-string-1.1.1.tgz",
      "integrity": "sha512-BtEeSsoaQjlSPBemMQIrY1MY0uM6vnS1g5fmufYOtnxLGUZM2178PKbhsk7Ffv58IX+ZtcvoGwccYsh0PglkAA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-symbol": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-symbol/-/is-symbol-1.1.1.tgz",
      "integrity": "sha512-9gGx6GTtCQM73BgmHQXfDmLtfjjTUDSyoxTCbp5WtoixAhfgsDirWIcVQ/IHpvI5Vgd5i/J5F7B9cN/WlVbC/w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "has-symbols": "^1.1.0",
        "safe-regex-test": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-typed-array": {
      "version": "1.1.15",
      "resolved": "https://registry.npmjs.org/is-typed-array/-/is-typed-array-1.1.15.tgz",
      "integrity": "sha512-p3EcsicXjit7SaskXHs1hA91QxgTw46Fv6EFKKGS5DRFLD8yKnohjF3hxoju94b/OcMZoQukzpPpBE9uLVKzgQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "which-typed-array": "^1.1.16"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-weakmap": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/is-weakmap/-/is-weakmap-2.0.2.tgz",
      "integrity": "sha512-K5pXYOm9wqY1RgjpL3YTkF39tni1XajUIkawTLUo9EZEVUFga5gSQJF8nNS7ZwJQ02y+1YCNYcMh+HIf1ZqE+w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-weakref": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-weakref/-/is-weakref-1.1.1.tgz",
      "integrity": "sha512-6i9mGWSlqzNMEqpCp93KwRS1uUOodk2OJ6b+sq7ZPDSy2WuI5NFIxp/254TytR8ftefexkWn5xNiHUNpPOfSew==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-weakset": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/is-weakset/-/is-weakset-2.0.4.tgz",
      "integrity": "sha512-mfcwb6IzQyOKTs84CQMrOwW4gQcaTOAWJ0zzJCl2WSPDrWk/OzDaImWFH3djXhb24g4eudZfLRozAvPGw4d9hQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "get-intrinsic": "^1.2.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/isarray": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/isarray/-/isarray-2.0.5.tgz",
      "integrity": "sha512-xHjhDr3cNBK0BzdUJSPXZntQUx/mwMS5Rw4A7lPJ90XGAO6ISP/ePDNuo0vhqOZU+UD5JoodwCAAoZQd3FeAKw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/iterator.prototype": {
      "version": "1.1.5",
      "resolved": "https://registry.npmjs.org/iterator.prototype/-/iterator.prototype-1.1.5.tgz",
      "integrity": "sha512-H0dkQoCa3b2VEeKQBOxFph+JAbcrQdE7KC0UkqwpLmv2EC4P41QXP+rqo9wYodACiG5/WM5s9oDApTU8utwj9g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-object-atoms": "^1.0.0",
        "get-intrinsic": "^1.2.6",
        "get-proto": "^1.0.0",
        "has-symbols": "^1.1.0",
        "set-function-name": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/jiti": {
      "version": "2.6.1",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-2.6.1.tgz",
      "integrity": "sha512-ekilCSN1jwRvIbgeg/57YFh8qQDNbwDb9xT/qu2DAHbFFZUicIl4ygVaAvzveMhMVr3LnpSKTNnwt8PoOfmKhQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "bin": {
        "jiti": "lib/jiti-cli.mjs"
      }
    },
    "node_modules/jose": {
      "version": "4.15.9",
      "resolved": "https://registry.npmjs.org/jose/-/jose-4.15.9.tgz",
      "integrity": "sha512-1vUQX+IdDMVPj4k8kOxgUqlcK518yluMuGZwqlr44FS1ppZB/5GWh4rZG89erpOBOJjU/OBsnCVFfapsRz6nEA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "license": "MIT"
    },
    "node_modules/js-yaml": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-4.1.1.tgz",
      "integrity": "sha512-qQKT4zQxXl8lLwBtHMWwaTcGfFOZviOJet3Oy/xmGk2gZH677CJM9EvtfdSkgWcATZhj/55JZ0rmy3myCT5lsA==",
      "license": "MIT",
      "dependencies": {
        "argparse": "^2.0.1"
      },
      "bin": {
        "js-yaml": "bin/js-yaml.js"
      }
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json-bigint": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/json-bigint/-/json-bigint-1.0.0.tgz",
      "integrity": "sha512-SiPv/8VpZuWbvLSMtTDU8hEfrZWg/mH/nV/b4o0CYbSxu1UIQPLdwKOCIyLQX+VIPO5vrLX3i8qtqFyhdPSUSQ==",
      "license": "MIT",
      "dependencies": {
        "bignumber.js": "^9.0.0"
      }
    },
    "node_modules/json-buffer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/json-buffer/-/json-buffer-3.0.1.tgz",
      "integrity": "sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json-parse-even-better-errors": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/json-parse-even-better-errors/-/json-parse-even-better-errors-2.3.1.tgz",
      "integrity": "sha512-xyFwyhro/JEof6Ghe2iz2NcXoj2sloNsWr/XsERDK/oiPCfaNhl5ONfp+jQdAZRQQ0IJWNzH9zIZF7li91kh2w==",
      "license": "MIT"
    },
    "node_modules/json-schema-traverse": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz",
      "integrity": "sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json-stable-stringify-without-jsonify": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/json-stable-stringify-without-jsonify/-/json-stable-stringify-without-jsonify-1.0.1.tgz",
      "integrity": "sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/jsonwebtoken": {
      "version": "9.0.3",
      "resolved": "https://registry.npmjs.org/jsonwebtoken/-/jsonwebtoken-9.0.3.tgz",
      "integrity": "sha512-MT/xP0CrubFRNLNKvxJ2BYfy53Zkm++5bX9dtuPbqAeQpTVe0MQTFhao8+Cp//EmJp244xt6Drw/GVEGCUj40g==",
      "license": "MIT",
      "dependencies": {
        "jws": "^4.0.1",
        "lodash.includes": "^4.3.0",
        "lodash.isboolean": "^3.0.3",
        "lodash.isinteger": "^4.0.4",
        "lodash.isnumber": "^3.0.3",
        "lodash.isplainobject": "^4.0.6",
        "lodash.isstring": "^4.0.1",
        "lodash.once": "^4.0.0",
        "ms": "^2.1.1",
        "semver": "^7.5.4"
      },
      "engines": {
        "node": ">=12",
        "npm": ">=6"
      }
    },
    "node_modules/jsonwebtoken/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/jsx-ast-utils": {
      "version": "3.3.5",
      "resolved": "https://registry.npmjs.org/jsx-ast-utils/-/jsx-ast-utils-3.3.5.tgz",
      "integrity": "sha512-ZZow9HBI5O6EPgSJLUb8n2NKgmVWTwCvHGwFuJlMjvLFqlGG6pjirPhtdsseaLZjSibD8eegzmYpUZwoIlj2cQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-includes": "^3.1.6",
        "array.prototype.flat": "^1.3.1",
        "object.assign": "^4.1.4",
        "object.values": "^1.1.6"
      },
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/jwa": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/jwa/-/jwa-2.0.1.tgz",
      "integrity": "sha512-hRF04fqJIP8Abbkq5NKGN0Bbr3JxlQ+qhZufXVr0DvujKy93ZCbXZMHDL4EOtodSbCWxOqR8MS1tXA5hwqCXDg==",
      "license": "MIT",
      "dependencies": {
        "buffer-equal-constant-time": "^1.0.1",
        "ecdsa-sig-formatter": "1.0.11",
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/jwks-rsa": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/jwks-rsa/-/jwks-rsa-3.2.0.tgz",
      "integrity": "sha512-PwchfHcQK/5PSydeKCs1ylNym0w/SSv8a62DgHJ//7x2ZclCoinlsjAfDxAAbpoTPybOum/Jgy+vkvMmKz89Ww==",
      "license": "MIT",
      "dependencies": {
        "@types/express": "^4.17.20",
        "@types/jsonwebtoken": "^9.0.4",
        "debug": "^4.3.4",
        "jose": "^4.15.4",
        "limiter": "^1.1.5",
        "lru-memoizer": "^2.2.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/jws": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/jws/-/jws-4.0.1.tgz",
      "integrity": "sha512-EKI/M/yqPncGUUh44xz0PxSidXFr/+r0pA70+gIYhjv+et7yxM+s29Y+VGDkovRofQem0fs7Uvf4+YmAdyRduA==",
      "license": "MIT",
      "dependencies": {
        "jwa": "^2.0.1",
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/keyv": {
      "version": "4.5.4",
      "resolved": "https://registry.npmjs.org/keyv/-/keyv-4.5.4.tgz",
      "integrity": "sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "json-buffer": "3.0.1"
      }
    },
    "node_modules/language-subtag-registry": {
      "version": "0.3.23",
      "resolved": "https://registry.npmjs.org/language-subtag-registry/-/language-subtag-registry-0.3.23.tgz",
      "integrity": "sha512-0K65Lea881pHotoGEa5gDlMxt3pctLi2RplBb7Ezh4rRdLEOtgi7n4EwK9lamnUCkKBqaeKRVebTq6BAxSkpXQ==",
      "dev": true,
      "license": "CC0-1.0"
    },
    "node_modules/language-tags": {
      "version": "1.0.9",
      "resolved": "https://registry.npmjs.org/language-tags/-/language-tags-1.0.9.tgz",
      "integrity": "sha512-MbjN408fEndfiQXbFQ1vnd+1NoLDsnQW41410oQBXiyXDMYH5z505juWa4KUE1LqxRC7DgOgZDbKLxHIwm27hA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "language-subtag-registry": "^0.3.20"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/levn": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/levn/-/levn-0.4.1.tgz",
      "integrity": "sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "prelude-ls": "^1.2.1",
        "type-check": "~0.4.0"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/lilconfig": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/lilconfig/-/lilconfig-3.1.3.tgz",
      "integrity": "sha512-/vlFKAoH5Cgt3Ie+JLhRbwOsCQePABiU3tJ1egGvyQ+33R/vcwM2Zl2QR/LzjsBeItPt3oSVXapn+m4nQDvpzw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/antonk52"
      }
    },
    "node_modules/limiter": {
      "version": "1.1.5",
      "resolved": "https://registry.npmjs.org/limiter/-/limiter-1.1.5.tgz",
      "integrity": "sha512-FWWMIEOxz3GwUI4Ts/IvgVy6LPvoMPgjMdQ185nN6psJyBJ4yOpzqm695/h5umdLJg2vW3GR5iG11MAkR2AzJA=="
    },
    "node_modules/lines-and-columns": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz",
      "integrity": "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==",
      "license": "MIT"
    },
    "node_modules/locate-path": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-6.0.0.tgz",
      "integrity": "sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "p-locate": "^5.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/lodash.camelcase": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/lodash.camelcase/-/lodash.camelcase-4.3.0.tgz",
      "integrity": "sha512-TwuEnCnxbc3rAvhf/LbG7tJUDzhqXyFnv3dtzLOPgCG/hODL7WFnsbwktkD7yUV0RrreP/l1PALq/YSg6VvjlA==",
      "license": "MIT"
    },
    "node_modules/lodash.clonedeep": {
      "version": "4.5.0",
      "resolved": "https://registry.npmjs.org/lodash.clonedeep/-/lodash.clonedeep-4.5.0.tgz",
      "integrity": "sha512-H5ZhCF25riFd9uB5UCkVKo61m3S/xZk1x4wA6yp/L3RFP6Z/eHH1ymQcGLo7J3GMPfm0V/7m1tryHuGVxpqEBQ==",
      "license": "MIT"
    },
    "node_modules/lodash.includes": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/lodash.includes/-/lodash.includes-4.3.0.tgz",
      "integrity": "sha512-W3Bx6mdkRTGtlJISOvVD/lbqjTlPPUDTMnlXZFnVwi9NKJ6tiAk6LVdlhZMm17VZisqhKcgzpO5Wz91PCt5b0w==",
      "license": "MIT"
    },
    "node_modules/lodash.isboolean": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/lodash.isboolean/-/lodash.isboolean-3.0.3.tgz",
      "integrity": "sha512-Bz5mupy2SVbPHURB98VAcw+aHh4vRV5IPNhILUCsOzRmsTmSQ17jIuqopAentWoehktxGd9e/hbIXq980/1QJg==",
      "license": "MIT"
    },
    "node_modules/lodash.isinteger": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/lodash.isinteger/-/lodash.isinteger-4.0.4.tgz",
      "integrity": "sha512-DBwtEWN2caHQ9/imiNeEA5ys1JoRtRfY3d7V9wkqtbycnAmTvRRmbHKDV4a0EYc678/dia0jrte4tjYwVBaZUA==",
      "license": "MIT"
    },
    "node_modules/lodash.isnumber": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/lodash.isnumber/-/lodash.isnumber-3.0.3.tgz",
      "integrity": "sha512-QYqzpfwO3/CWf3XP+Z+tkQsfaLL/EnUlXWVkIk5FUPc4sBdTehEqZONuyRt2P67PXAk+NXmTBcc97zw9t1FQrw==",
      "license": "MIT"
    },
    "node_modules/lodash.isplainobject": {
      "version": "4.0.6",
      "resolved": "https://registry.npmjs.org/lodash.isplainobject/-/lodash.isplainobject-4.0.6.tgz",
      "integrity": "sha512-oSXzaWypCMHkPC3NvBEaPHf0KsA5mvPrOPgQWDsbg8n7orZ290M0BmC/jgRZ4vcJ6DTAhjrsSYgdsW/F+MFOBA==",
      "license": "MIT"
    },
    "node_modules/lodash.isstring": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/lodash.isstring/-/lodash.isstring-4.0.1.tgz",
      "integrity": "sha512-0wJxfxH1wgO3GrbuP+dTTk7op+6L41QCXbGINEmD+ny/G/eCqGzxyCsh7159S+mgDDcoarnBw6PC1PS5+wUGgw==",
      "license": "MIT"
    },
    "node_modules/lodash.merge": {
      "version": "4.6.2",
      "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
      "integrity": "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/lodash.once": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/lodash.once/-/lodash.once-4.1.1.tgz",
      "integrity": "sha512-Sb487aTOCr9drQVL8pIxOzVhafOjZN9UU54hiN8PU3uAiSV7lx1yYNpbNmex2PK6dSJoNTSJUUswT651yww3Mg==",
      "license": "MIT"
    },
    "node_modules/long": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/long/-/long-5.3.2.tgz",
      "integrity": "sha512-mNAgZ1GmyNhD7AuqnTG3/VQ26o760+ZYBPKjPvugO8+nLbYfX6TVpJPseBvopbdY+qpZ/lKUnmEc1LeZYS3QAA==",
      "license": "Apache-2.0"
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/lru-memoizer": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/lru-memoizer/-/lru-memoizer-2.3.0.tgz",
      "integrity": "sha512-GXn7gyHAMhO13WSKrIiNfztwxodVsP8IoZ3XfrJV4yH2x0/OeTO/FIaAHTY5YekdGgW94njfuKmyyt1E0mR6Ug==",
      "license": "MIT",
      "dependencies": {
        "lodash.clonedeep": "^4.5.0",
        "lru-cache": "6.0.0"
      }
    },
    "node_modules/lru-memoizer/node_modules/lru-cache": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-6.0.0.tgz",
      "integrity": "sha512-Jo6dJ04CmSjuznwJSS3pUeWmd/H0ffTlkXXgwZi+eq1UCmqQwCh+eLsYOYCwY991i2Fah4h1BEMCx4qThGbsiA==",
      "license": "ISC",
      "dependencies": {
        "yallist": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/lru-memoizer/node_modules/yallist": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-4.0.0.tgz",
      "integrity": "sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==",
      "license": "ISC"
    },
    "node_modules/lucide-react": {
      "version": "0.561.0",
      "resolved": "https://registry.npmjs.org/lucide-react/-/lucide-react-0.561.0.tgz",
      "integrity": "sha512-Y59gMY38tl4/i0qewcqohPdEbieBy7SovpBL9IFebhc2mDd8x4PZSOsiFRkpPcOq6bj1r/mjH/Rk73gSlIJP2A==",
      "license": "ISC",
      "peerDependencies": {
        "react": "^16.5.1 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/merge2": {
      "version": "1.4.1",
      "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
      "integrity": "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/micromatch": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "braces": "^3.0.3",
        "picomatch": "^2.3.1"
      },
      "engines": {
        "node": ">=8.6"
      }
    },
    "node_modules/mime": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/mime/-/mime-3.0.0.tgz",
      "integrity": "sha512-jSCU7/VB1loIWBZe14aEYHU/+1UMEHoaO7qxCOVJOw9GgH72VAWppxNcjU+x9a2k3GSIBXNKxXQFqRvvZ7vr3A==",
      "license": "MIT",
      "optional": true,
      "bin": {
        "mime": "cli.js"
      },
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/minimist": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/mitt": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/mitt/-/mitt-3.0.1.tgz",
      "integrity": "sha512-vKivATfr97l2/QBCYAkXYDbrIWPM2IIKEl7YPhjCvKlG3kE2gm+uBo6nEXK3M5/Ffh/FLpKExzOQ3JJoJGFKBw==",
      "license": "MIT"
    },
    "node_modules/motion-dom": {
      "version": "12.23.23",
      "resolved": "https://registry.npmjs.org/motion-dom/-/motion-dom-12.23.23.tgz",
      "integrity": "sha512-n5yolOs0TQQBRUFImrRfs/+6X4p3Q4n1dUEqt/H58Vx7OW6RF+foWEgmTVDhIWJIMXOuNNL0apKH2S16en9eiA==",
      "license": "MIT",
      "dependencies": {
        "motion-utils": "^12.23.6"
      }
    },
    "node_modules/motion-utils": {
      "version": "12.23.6",
      "resolved": "https://registry.npmjs.org/motion-utils/-/motion-utils-12.23.6.tgz",
      "integrity": "sha512-eAWoPgr4eFEOFfg2WjIsMoqJTW6Z8MTUCgn/GZ3VRpClWBdnbjryiA3ZSNLyxCTmCQx4RmYX6jX1iWHbenUPNQ==",
      "license": "MIT"
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/mz": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/mz/-/mz-2.7.0.tgz",
      "integrity": "sha512-z81GNO7nnYMEhrGh9LeymoE4+Yr0Wn5McHIZMK5cfQCl+NDX08sCZgUc9/6MHni9IWuFLm1Z3HTCXu2z9fN62Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "any-promise": "^1.0.0",
        "object-assign": "^4.0.1",
        "thenify-all": "^1.0.0"
      }
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/napi-postinstall": {
      "version": "0.3.4",
      "resolved": "https://registry.npmjs.org/napi-postinstall/-/napi-postinstall-0.3.4.tgz",
      "integrity": "sha512-PHI5f1O0EP5xJ9gQmFGMS6IZcrVvTjpXjz7Na41gTE7eE2hK11lg04CECCYEEjdc17EV4DO+fkGEtt7TpTaTiQ==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "napi-postinstall": "lib/cli.js"
      },
      "engines": {
        "node": "^12.20.0 || ^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/napi-postinstall"
      }
    },
    "node_modules/natural-compare": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
      "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/netmask": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/netmask/-/netmask-2.0.2.tgz",
      "integrity": "sha512-dBpDMdxv9Irdq66304OLfEmQ9tbNRFnFTuZiLo+bD+r332bBmMJ8GBLXklIXXgxd3+v9+KUnZaUR5PJMa75Gsg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4.0"
      }
    },
    "node_modules/next": {
      "version": "16.0.10",
      "resolved": "https://registry.npmjs.org/next/-/next-16.0.10.tgz",
      "integrity": "sha512-RtWh5PUgI+vxlV3HdR+IfWA1UUHu0+Ram/JBO4vWB54cVPentCD0e+lxyAYEsDTqGGMg7qpjhKh6dc6aW7W/sA==",
      "license": "MIT",
      "dependencies": {
        "@next/env": "16.0.10",
        "@swc/helpers": "0.5.15",
        "caniuse-lite": "^1.0.30001579",
        "postcss": "8.4.31",
        "styled-jsx": "5.1.6"
      },
      "bin": {
        "next": "dist/bin/next"
      },
      "engines": {
        "node": ">=20.9.0"
      },
      "optionalDependencies": {
        "@next/swc-darwin-arm64": "16.0.10",
        "@next/swc-darwin-x64": "16.0.10",
        "@next/swc-linux-arm64-gnu": "16.0.10",
        "@next/swc-linux-arm64-musl": "16.0.10",
        "@next/swc-linux-x64-gnu": "16.0.10",
        "@next/swc-linux-x64-musl": "16.0.10",
        "@next/swc-win32-arm64-msvc": "16.0.10",
        "@next/swc-win32-x64-msvc": "16.0.10",
        "sharp": "^0.34.4"
      },
      "peerDependencies": {
        "@opentelemetry/api": "^1.1.0",
        "@playwright/test": "^1.51.1",
        "babel-plugin-react-compiler": "*",
        "react": "^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0",
        "react-dom": "^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0",
        "sass": "^1.3.0"
      },
      "peerDependenciesMeta": {
        "@opentelemetry/api": {
          "optional": true
        },
        "@playwright/test": {
          "optional": true
        },
        "babel-plugin-react-compiler": {
          "optional": true
        },
        "sass": {
          "optional": true
        }
      }
    },
    "node_modules/next/node_modules/postcss": {
      "version": "8.4.31",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.4.31.tgz",
      "integrity": "sha512-PS08Iboia9mts/2ygV3eLpY5ghnUcfLV/EXTOW1E2qYxJKGGBUtNjN76FYHnMs36RmARn41bC0AZmn+rR0OVpQ==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.6",
        "picocolors": "^1.0.0",
        "source-map-js": "^1.0.2"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/node-fetch": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/node-fetch/-/node-fetch-2.7.0.tgz",
      "integrity": "sha512-c4FRfUm/dbcWZ7U+1Wq0AwCyFL+3nt2bEw05wfxSz+DWpWsitgmSgYmy2dQdWyKC1694ELPqMs/YzUSNozLt8A==",
      "license": "MIT",
      "dependencies": {
        "whatwg-url": "^5.0.0"
      },
      "engines": {
        "node": "4.x || >=6.0.0"
      },
      "peerDependencies": {
        "encoding": "^0.1.0"
      },
      "peerDependenciesMeta": {
        "encoding": {
          "optional": true
        }
      }
    },
    "node_modules/node-forge": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/node-forge/-/node-forge-1.3.3.tgz",
      "integrity": "sha512-rLvcdSyRCyouf6jcOIPe/BgwG/d7hKjzMKOas33/pHEr6gbq18IK9zV7DiPvzsz0oBJPme6qr6H6kGZuI9/DZg==",
      "license": "(BSD-3-Clause OR GPL-2.0)",
      "engines": {
        "node": ">= 6.13.0"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.27",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/normalize-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz",
      "integrity": "sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-hash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/object-hash/-/object-hash-3.0.0.tgz",
      "integrity": "sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/object-inspect": {
      "version": "1.13.4",
      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.4.tgz",
      "integrity": "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/object-keys": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/object-keys/-/object-keys-1.1.1.tgz",
      "integrity": "sha512-NuAESUOUMrlIXOfHKzD6bpPu3tYt3xvjNdRIQ+FeT0lNb4K8WR70CaDxhuNguS2XG+GjkyMwOzsN5ZktImfhLA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/object.assign": {
      "version": "4.1.7",
      "resolved": "https://registry.npmjs.org/object.assign/-/object.assign-4.1.7.tgz",
      "integrity": "sha512-nK28WOo+QIjBkDduTINE4JkF/UJJKyf2EJxvJKfblDpyg0Q+pkOHNTL0Qwy6NP6FhE/EnzV73BxxqcJaXY9anw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0",
        "has-symbols": "^1.1.0",
        "object-keys": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/object.entries": {
      "version": "1.1.9",
      "resolved": "https://registry.npmjs.org/object.entries/-/object.entries-1.1.9.tgz",
      "integrity": "sha512-8u/hfXFRBD1O0hPUjioLhoWFHRmt6tKA4/vZPyckBr18l1KE9uHrFaFaUi8MDRTpi4uak2goyPTSNJLXX2k2Hw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/object.fromentries": {
      "version": "2.0.8",
      "resolved": "https://registry.npmjs.org/object.fromentries/-/object.fromentries-2.0.8.tgz",
      "integrity": "sha512-k6E21FzySsSK5a21KRADBd/NGneRegFO5pLHfdQLpRDETUNJueLXs3WCzyQ3tFRDYgbq3KHGXfTbi2bs8WQ6rQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.2",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/object.groupby": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/object.groupby/-/object.groupby-1.0.3.tgz",
      "integrity": "sha512-+Lhy3TQTuzXI5hevh8sBGqbmurHbbIjAi0Z4S63nthVLmLxfbj4T54a4CfZrXIrt9iP4mVAPYMo/v99taj3wjQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/object.values": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/object.values/-/object.values-1.2.1.tgz",
      "integrity": "sha512-gXah6aZrcUxjWg2zR2MwouP2eHlCBzdV4pygudehaKXSGW4v2AsRQUK+lwwXhii6KFZcunEnmSUoYp5CXibxtA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/once": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/once/-/once-1.4.0.tgz",
      "integrity": "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==",
      "license": "ISC",
      "dependencies": {
        "wrappy": "1"
      }
    },
    "node_modules/optionator": {
      "version": "0.9.4",
      "resolved": "https://registry.npmjs.org/optionator/-/optionator-0.9.4.tgz",
      "integrity": "sha512-6IpQ7mKUxRcZNLIObR0hz7lxsapSSIYNZJwXPGeF0mTVqGKFIXj1DQcMoT22S3ROcLyY/rz0PWaWZ9ayWmad9g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "deep-is": "^0.1.3",
        "fast-levenshtein": "^2.0.6",
        "levn": "^0.4.1",
        "prelude-ls": "^1.2.1",
        "type-check": "^0.4.0",
        "word-wrap": "^1.2.5"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/own-keys": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/own-keys/-/own-keys-1.0.1.tgz",
      "integrity": "sha512-qFOyK5PjiWZd+QQIh+1jhdb9LpxTF0qs7Pm8o5QHYZ0M3vKqSqzsZaEB6oWlxZ+q2sJBMI/Ktgd2N5ZwQoRHfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "get-intrinsic": "^1.2.6",
        "object-keys": "^1.1.1",
        "safe-push-apply": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/p-limit": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
      "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "yocto-queue": "^0.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-locate": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-5.0.0.tgz",
      "integrity": "sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "p-limit": "^3.0.2"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/pac-proxy-agent": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/pac-proxy-agent/-/pac-proxy-agent-7.2.0.tgz",
      "integrity": "sha512-TEB8ESquiLMc0lV8vcd5Ql/JAKAoyzHFXaStwjkzpOpC5Yv+pIzLfHvjTSdf3vpa2bMiUQrg9i6276yn8666aA==",
      "license": "MIT",
      "dependencies": {
        "@tootallnate/quickjs-emscripten": "^0.23.0",
        "agent-base": "^7.1.2",
        "debug": "^4.3.4",
        "get-uri": "^6.0.1",
        "http-proxy-agent": "^7.0.0",
        "https-proxy-agent": "^7.0.6",
        "pac-resolver": "^7.0.1",
        "socks-proxy-agent": "^8.0.5"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/pac-resolver": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/pac-resolver/-/pac-resolver-7.0.1.tgz",
      "integrity": "sha512-5NPgf87AT2STgwa2ntRMr45jTKrYBGkVU36yT0ig/n/GMAa3oPqhZfIQ2kMEimReg0+t9kZViDVZ83qfVUlckg==",
      "license": "MIT",
      "dependencies": {
        "degenerator": "^5.0.0",
        "netmask": "^2.0.2"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/parent-module": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
      "integrity": "sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==",
      "license": "MIT",
      "dependencies": {
        "callsites": "^3.0.0"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/parse-json": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/parse-json/-/parse-json-5.2.0.tgz",
      "integrity": "sha512-ayCKvm/phCGxOkYRSCM82iDwct8/EonSEgCSxWxD7ve6jHggsFl4fZVQBPRNgQoKiuV/odhFrGzQXZwbifC8Rg==",
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.0.0",
        "error-ex": "^1.3.1",
        "json-parse-even-better-errors": "^2.3.0",
        "lines-and-columns": "^1.1.6"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/path-exists": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
      "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-parse": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz",
      "integrity": "sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/pend": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/pend/-/pend-1.2.0.tgz",
      "integrity": "sha512-F3asv42UuXchdzt+xXqfW1OGlVBe+mxa2mqI0pg5yAHZPvFmY3Y6drSf/GQ1A86WgWEN9Kzh/WrgKa6iGcHXLg==",
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "license": "ISC"
    },
    "node_modules/picomatch": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/pify": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/pify/-/pify-2.3.0.tgz",
      "integrity": "sha512-udgsAY+fTnvv7kI7aaxbqwWNb0AHiB0qBO89PZKPkoTmGOgdbrHDKD+0B2X4uTfJ/FT1R09r9gTsjUjNJotuog==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pirates": {
      "version": "4.0.7",
      "resolved": "https://registry.npmjs.org/pirates/-/pirates-4.0.7.tgz",
      "integrity": "sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/possible-typed-array-names": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/possible-typed-array-names/-/possible-typed-array-names-1.1.0.tgz",
      "integrity": "sha512-/+5VFTchJDoVj3bhoqi6UeymcD00DAwb1nJwamzPvHEszJ4FpF6SNNbUbOS8yI56qHzdV8eK0qEfOSiodkTdxg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/postcss-import": {
      "version": "15.1.0",
      "resolved": "https://registry.npmjs.org/postcss-import/-/postcss-import-15.1.0.tgz",
      "integrity": "sha512-hpr+J05B2FVYUAXHeK1YyI267J/dDDhMU6B6civm8hSY1jYJnBXxzKDKDswzJmtLHryrjhnDjqqp/49t8FALew==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "postcss-value-parser": "^4.0.0",
        "read-cache": "^1.0.0",
        "resolve": "^1.1.7"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "postcss": "^8.0.0"
      }
    },
    "node_modules/postcss-js": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/postcss-js/-/postcss-js-4.1.0.tgz",
      "integrity": "sha512-oIAOTqgIo7q2EOwbhb8UalYePMvYoIeRY2YKntdpFQXNosSu3vLrniGgmH9OKs/qAkfoj5oB3le/7mINW1LCfw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "camelcase-css": "^2.0.1"
      },
      "engines": {
        "node": "^12 || ^14 || >= 16"
      },
      "peerDependencies": {
        "postcss": "^8.4.21"
      }
    },
    "node_modules/postcss-nested": {
      "version": "6.2.0",
      "resolved": "https://registry.npmjs.org/postcss-nested/-/postcss-nested-6.2.0.tgz",
      "integrity": "sha512-HQbt28KulC5AJzG+cZtj9kvKB93CFCdLvog1WFLf1D+xmMvPGlBstkpTEZfK5+AN9hfJocyBFCNiqyS48bpgzQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "postcss-selector-parser": "^6.1.1"
      },
      "engines": {
        "node": ">=12.0"
      },
      "peerDependencies": {
        "postcss": "^8.2.14"
      }
    },
    "node_modules/postcss-selector-parser": {
      "version": "6.1.2",
      "resolved": "https://registry.npmjs.org/postcss-selector-parser/-/postcss-selector-parser-6.1.2.tgz",
      "integrity": "sha512-Q8qQfPiZ+THO/3ZrOrO0cJJKfpYCagtMUkXbnEfmgUjwXg6z/WBeOyS9APBBPCTSiDV+s4SwQGu8yFsiMRIudg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "cssesc": "^3.0.0",
        "util-deprecate": "^1.0.2"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/postcss-value-parser": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/postcss-value-parser/-/postcss-value-parser-4.2.0.tgz",
      "integrity": "sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/prelude-ls": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/prelude-ls/-/prelude-ls-1.2.1.tgz",
      "integrity": "sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/progress": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/progress/-/progress-2.0.3.tgz",
      "integrity": "sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/prop-types": {
      "version": "15.8.1",
      "resolved": "https://registry.npmjs.org/prop-types/-/prop-types-15.8.1.tgz",
      "integrity": "sha512-oj87CgZICdulUohogVAR7AjlC0327U4el4L6eAvOqCeudMDVU0NThNaV+b9Df4dXgSP1gXMTnPdhfe/2qDH5cg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.4.0",
        "object-assign": "^4.1.1",
        "react-is": "^16.13.1"
      }
    },
    "node_modules/proto3-json-serializer": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/proto3-json-serializer/-/proto3-json-serializer-2.0.2.tgz",
      "integrity": "sha512-SAzp/O4Yh02jGdRc+uIrGoe87dkN/XtwxfZ4ZyafJHymd79ozp5VG5nyZ7ygqPM5+cpLDjjGnYFUkngonyDPOQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "protobufjs": "^7.2.5"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/protobufjs": {
      "version": "7.5.4",
      "resolved": "https://registry.npmjs.org/protobufjs/-/protobufjs-7.5.4.tgz",
      "integrity": "sha512-CvexbZtbov6jW2eXAvLukXjXUW1TzFaivC46BpWc/3BpcCysb5Vffu+B3XHMm8lVEuy2Mm4XGex8hBSg1yapPg==",
      "hasInstallScript": true,
      "license": "BSD-3-Clause",
      "dependencies": {
        "@protobufjs/aspromise": "^1.1.2",
        "@protobufjs/base64": "^1.1.2",
        "@protobufjs/codegen": "^2.0.4",
        "@protobufjs/eventemitter": "^1.1.0",
        "@protobufjs/fetch": "^1.1.0",
        "@protobufjs/float": "^1.0.2",
        "@protobufjs/inquire": "^1.1.0",
        "@protobufjs/path": "^1.1.2",
        "@protobufjs/pool": "^1.1.0",
        "@protobufjs/utf8": "^1.1.0",
        "@types/node": ">=13.7.0",
        "long": "^5.0.0"
      },
      "engines": {
        "node": ">=12.0.0"
      }
    },
    "node_modules/proxy-agent": {
      "version": "6.5.0",
      "resolved": "https://registry.npmjs.org/proxy-agent/-/proxy-agent-6.5.0.tgz",
      "integrity": "sha512-TmatMXdr2KlRiA2CyDu8GqR8EjahTG3aY3nXjdzFyoZbmB8hrBsTyMezhULIXKnC0jpfjlmiZ3+EaCzoInSu/A==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.2",
        "debug": "^4.3.4",
        "http-proxy-agent": "^7.0.1",
        "https-proxy-agent": "^7.0.6",
        "lru-cache": "^7.14.1",
        "pac-proxy-agent": "^7.1.0",
        "proxy-from-env": "^1.1.0",
        "socks-proxy-agent": "^8.0.5"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/proxy-agent/node_modules/lru-cache": {
      "version": "7.18.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-7.18.3.tgz",
      "integrity": "sha512-jumlc0BIUrS3qJGgIkWZsyfAM7NCWiBcCDhnd+3NNM5KbBmLTgHVfWBcg6W+rLUsIpzpERPsvwUP7CckAQSOoA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
      "license": "MIT"
    },
    "node_modules/pump": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/pump/-/pump-3.0.3.tgz",
      "integrity": "sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA==",
      "license": "MIT",
      "dependencies": {
        "end-of-stream": "^1.1.0",
        "once": "^1.3.1"
      }
    },
    "node_modules/punycode": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/punycode/-/punycode-2.3.1.tgz",
      "integrity": "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/puppeteer": {
      "version": "24.34.0",
      "resolved": "https://registry.npmjs.org/puppeteer/-/puppeteer-24.34.0.tgz",
      "integrity": "sha512-Sdpl/zsYOsagZ4ICoZJPGZw8d9gZmK5DcxVal11dXi/1/t2eIXHjCf5NfmhDg5XnG9Nye+yo/LqMzIxie2rHTw==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@puppeteer/browsers": "2.11.0",
        "chromium-bidi": "12.0.1",
        "cosmiconfig": "^9.0.0",
        "devtools-protocol": "0.0.1534754",
        "puppeteer-core": "24.34.0",
        "typed-query-selector": "^2.12.0"
      },
      "bin": {
        "puppeteer": "lib/cjs/puppeteer/node/cli.js"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/puppeteer-core": {
      "version": "24.34.0",
      "resolved": "https://registry.npmjs.org/puppeteer-core/-/puppeteer-core-24.34.0.tgz",
      "integrity": "sha512-24evawO+mUGW4mvS2a2ivwLdX3gk8zRLZr9HP+7+VT2vBQnm0oh9jJEZmUE3ePJhRkYlZ93i7OMpdcoi2qNCLg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@puppeteer/browsers": "2.11.0",
        "chromium-bidi": "12.0.1",
        "debug": "^4.4.3",
        "devtools-protocol": "0.0.1534754",
        "typed-query-selector": "^2.12.0",
        "webdriver-bidi-protocol": "0.3.10",
        "ws": "^8.18.3"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/queue-microtask": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
      "integrity": "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/react": {
      "version": "19.2.1",
      "resolved": "https://registry.npmjs.org/react/-/react-19.2.1.tgz",
      "integrity": "sha512-DGrYcCWK7tvYMnWh79yrPHt+vdx9tY+1gPZa7nJQtO/p8bLTDaHp4dzwEhQB7pZ4Xe3ok4XKuEPrVuc+wlpkmw==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "19.2.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-19.2.1.tgz",
      "integrity": "sha512-ibrK8llX2a4eOskq1mXKu/TGZj9qzomO+sNfO98M6d9zIPOEhlBkMkBUBLd1vgS0gQsLDBzA+8jJBVXDnfHmJg==",
      "license": "MIT",
      "dependencies": {
        "scheduler": "^0.27.0"
      },
      "peerDependencies": {
        "react": "^19.2.1"
      }
    },
    "node_modules/react-hot-toast": {
      "version": "2.6.0",
      "resolved": "https://registry.npmjs.org/react-hot-toast/-/react-hot-toast-2.6.0.tgz",
      "integrity": "sha512-bH+2EBMZ4sdyou/DPrfgIouFpcRLCJ+HoCA32UoAYHn6T3Ur5yfcDCeSr5mwldl6pFOsiocmrXMuoCJ1vV8bWg==",
      "license": "MIT",
      "dependencies": {
        "csstype": "^3.1.3",
        "goober": "^2.1.16"
      },
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "react": ">=16",
        "react-dom": ">=16"
      }
    },
    "node_modules/react-is": {
      "version": "16.13.1",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-16.13.1.tgz",
      "integrity": "sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/read-cache": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/read-cache/-/read-cache-1.0.0.tgz",
      "integrity": "sha512-Owdv/Ft7IjOgm/i0xvNDZ1LrRANRfew4b2prF3OWMQLxLfu3bS8FVhCsrSCMK4lR56Y9ya+AThoTpDCTxCmpRA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "pify": "^2.3.0"
      }
    },
    "node_modules/readable-stream": {
      "version": "3.6.2",
      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "inherits": "^2.0.3",
        "string_decoder": "^1.1.1",
        "util-deprecate": "^1.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/readdirp": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "picomatch": "^2.2.1"
      },
      "engines": {
        "node": ">=8.10.0"
      }
    },
    "node_modules/reflect.getprototypeof": {
      "version": "1.0.10",
      "resolved": "https://registry.npmjs.org/reflect.getprototypeof/-/reflect.getprototypeof-1.0.10.tgz",
      "integrity": "sha512-00o4I+DVrefhv+nX0ulyi3biSHCPDe+yLv5o/p6d/UVlirijB8E16FtfwSAi4g3tcqrQ4lRAqQSoFEZJehYEcw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.9",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0",
        "get-intrinsic": "^1.2.7",
        "get-proto": "^1.0.1",
        "which-builtin-type": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/regexp.prototype.flags": {
      "version": "1.5.4",
      "resolved": "https://registry.npmjs.org/regexp.prototype.flags/-/regexp.prototype.flags-1.5.4.tgz",
      "integrity": "sha512-dYqgNSZbDwkaJ2ceRd9ojCGjBq+mOm9LmtXnAnEGyHhN/5R7iDW2TRw3h+o/jCFxus3P2LfWIIiwowAjANm7IA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-errors": "^1.3.0",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "set-function-name": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/require-directory": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/require-directory/-/require-directory-2.1.1.tgz",
      "integrity": "sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/resolve": {
      "version": "1.22.11",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-1.22.11.tgz",
      "integrity": "sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-core-module": "^2.16.1",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/resolve-from": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-4.0.0.tgz",
      "integrity": "sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==",
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/resolve-pkg-maps": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/resolve-pkg-maps/-/resolve-pkg-maps-1.0.0.tgz",
      "integrity": "sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/privatenumber/resolve-pkg-maps?sponsor=1"
      }
    },
    "node_modules/retry": {
      "version": "0.13.1",
      "resolved": "https://registry.npmjs.org/retry/-/retry-0.13.1.tgz",
      "integrity": "sha512-XQBQ3I8W1Cge0Seh+6gjj03LbmRFWuoszgK9ooCpwYIrhhoO80pfq4cUkU5DkknwfOfFteRwlZ56PYOGYyFWdg==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/retry-request": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/retry-request/-/retry-request-7.0.2.tgz",
      "integrity": "sha512-dUOvLMJ0/JJYEn8NrpOaGNE7X3vpI5XlZS/u0ANjqtcZVKnIxP7IgCFwrKTxENw29emmwug53awKtaMm4i9g5w==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@types/request": "^2.48.8",
        "extend": "^3.0.2",
        "teeny-request": "^9.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/reusify": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/reusify/-/reusify-1.1.0.tgz",
      "integrity": "sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "iojs": ">=1.0.0",
        "node": ">=0.10.0"
      }
    },
    "node_modules/run-parallel": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz",
      "integrity": "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "queue-microtask": "^1.2.2"
      }
    },
    "node_modules/safe-array-concat": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/safe-array-concat/-/safe-array-concat-1.1.3.tgz",
      "integrity": "sha512-AURm5f0jYEOydBj7VQlVvDrjeFgthDdEF5H1dP+6mNpoXOMo1quQqJ4wvJDyRZ9+pO3kGWoOdmV08cSv2aJV6Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.2",
        "get-intrinsic": "^1.2.6",
        "has-symbols": "^1.1.0",
        "isarray": "^2.0.5"
      },
      "engines": {
        "node": ">=0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/safe-buffer": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/safe-push-apply": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/safe-push-apply/-/safe-push-apply-1.0.0.tgz",
      "integrity": "sha512-iKE9w/Z7xCzUMIZqdBsp6pEQvwuEebH4vdpjcDWnyzaI6yl6O9FHvVpmGelvEHNsoY6wGblkxR6Zty/h00WiSA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "isarray": "^2.0.5"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/safe-regex-test": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/safe-regex-test/-/safe-regex-test-1.1.0.tgz",
      "integrity": "sha512-x/+Cz4YrimQxQccJf5mKEbIa1NzeCRNI5Ecl/ekmlYaampdNLPalVyIcCZNNH3MvmqBugV5TMYZXv0ljslUlaw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "is-regex": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/scheduler": {
      "version": "0.27.0",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.27.0.tgz",
      "integrity": "sha512-eNv+WrVbKu1f3vbYJT/xtiF5syA5HPIMtf9IgY/nKg0sWqzAUEvqY/xm7OcZc/qafLx/iO9FgOmeSAp4v5ti/Q==",
      "license": "MIT"
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/set-function-length": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/set-function-length/-/set-function-length-1.2.2.tgz",
      "integrity": "sha512-pgRc4hJ4/sNjWCSS9AmnS40x3bNMDTknHgL5UaMBTMyJnU90EgWh1Rz+MC9eFu4BuN/UwZjKQuY/1v3rM7HMfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2",
        "get-intrinsic": "^1.2.4",
        "gopd": "^1.0.1",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/set-function-name": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/set-function-name/-/set-function-name-2.0.2.tgz",
      "integrity": "sha512-7PGFlmtwsEADb0WYyvCMa1t+yke6daIG4Wirafur5kcf+MhUnPms1UeR0CKQdTZD81yESwMHbtn+TR+dMviakQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-errors": "^1.3.0",
        "functions-have-names": "^1.2.3",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/set-proto": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/set-proto/-/set-proto-1.0.0.tgz",
      "integrity": "sha512-RJRdvCo6IAnPdsvP/7m6bsQqNnn1FCBX5ZNtFL98MmFF/4xAIJTIg1YbHW5DC2W5SKZanrC6i4HsJqlajw/dZw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/sharp": {
      "version": "0.34.5",
      "resolved": "https://registry.npmjs.org/sharp/-/sharp-0.34.5.tgz",
      "integrity": "sha512-Ou9I5Ft9WNcCbXrU9cMgPBcCK8LiwLqcbywW3t4oDV37n1pzpuNLsYiAV8eODnjbtQlSDwZ2cUEeQz4E54Hltg==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@img/colour": "^1.0.0",
        "detect-libc": "^2.1.2",
        "semver": "^7.7.3"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-darwin-arm64": "0.34.5",
        "@img/sharp-darwin-x64": "0.34.5",
        "@img/sharp-libvips-darwin-arm64": "1.2.4",
        "@img/sharp-libvips-darwin-x64": "1.2.4",
        "@img/sharp-libvips-linux-arm": "1.2.4",
        "@img/sharp-libvips-linux-arm64": "1.2.4",
        "@img/sharp-libvips-linux-ppc64": "1.2.4",
        "@img/sharp-libvips-linux-riscv64": "1.2.4",
        "@img/sharp-libvips-linux-s390x": "1.2.4",
        "@img/sharp-libvips-linux-x64": "1.2.4",
        "@img/sharp-libvips-linuxmusl-arm64": "1.2.4",
        "@img/sharp-libvips-linuxmusl-x64": "1.2.4",
        "@img/sharp-linux-arm": "0.34.5",
        "@img/sharp-linux-arm64": "0.34.5",
        "@img/sharp-linux-ppc64": "0.34.5",
        "@img/sharp-linux-riscv64": "0.34.5",
        "@img/sharp-linux-s390x": "0.34.5",
        "@img/sharp-linux-x64": "0.34.5",
        "@img/sharp-linuxmusl-arm64": "0.34.5",
        "@img/sharp-linuxmusl-x64": "0.34.5",
        "@img/sharp-wasm32": "0.34.5",
        "@img/sharp-win32-arm64": "0.34.5",
        "@img/sharp-win32-ia32": "0.34.5",
        "@img/sharp-win32-x64": "0.34.5"
      }
    },
    "node_modules/sharp/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "license": "ISC",
      "optional": true,
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/side-channel": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
      "integrity": "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3",
        "side-channel-list": "^1.0.0",
        "side-channel-map": "^1.0.1",
        "side-channel-weakmap": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-list": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/side-channel-list/-/side-channel-list-1.0.0.tgz",
      "integrity": "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-map": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/side-channel-map/-/side-channel-map-1.0.1.tgz",
      "integrity": "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-weakmap": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/side-channel-weakmap/-/side-channel-weakmap-1.0.2.tgz",
      "integrity": "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3",
        "side-channel-map": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/smart-buffer": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/smart-buffer/-/smart-buffer-4.2.0.tgz",
      "integrity": "sha512-94hK0Hh8rPqQl2xXc3HsaBoOXKV20MToPkcXvwbISWLEs+64sBq5kFgn2kJDHb1Pry9yrP0dxrCI9RRci7RXKg==",
      "license": "MIT",
      "engines": {
        "node": ">= 6.0.0",
        "npm": ">= 3.0.0"
      }
    },
    "node_modules/socks": {
      "version": "2.8.7",
      "resolved": "https://registry.npmjs.org/socks/-/socks-2.8.7.tgz",
      "integrity": "sha512-HLpt+uLy/pxB+bum/9DzAgiKS8CX1EvbWxI4zlmgGCExImLdiad2iCwXT5Z4c9c3Eq8rP2318mPW2c+QbtjK8A==",
      "license": "MIT",
      "dependencies": {
        "ip-address": "^10.0.1",
        "smart-buffer": "^4.2.0"
      },
      "engines": {
        "node": ">= 10.0.0",
        "npm": ">= 3.0.0"
      }
    },
    "node_modules/socks-proxy-agent": {
      "version": "8.0.5",
      "resolved": "https://registry.npmjs.org/socks-proxy-agent/-/socks-proxy-agent-8.0.5.tgz",
      "integrity": "sha512-HehCEsotFqbPW9sJ8WVYB6UbmIMv7kUUORIF2Nncq4VQvBfNBLibW9YZR5dlYCSUhwcD628pRllm7n+E+YTzJw==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.2",
        "debug": "^4.3.4",
        "socks": "^2.8.3"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "license": "BSD-3-Clause",
      "optional": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/stable-hash": {
      "version": "0.0.5",
      "resolved": "https://registry.npmjs.org/stable-hash/-/stable-hash-0.0.5.tgz",
      "integrity": "sha512-+L3ccpzibovGXFK+Ap/f8LOS0ahMrHTf3xu7mMLSpEGU0EO9ucaysSylKo9eRDFNhWve/y275iPmIZ4z39a9iA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/stop-iteration-iterator": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/stop-iteration-iterator/-/stop-iteration-iterator-1.1.0.tgz",
      "integrity": "sha512-eLoXW/DHyl62zxY4SCaIgnRhuMr6ri4juEYARS8E6sCEqzKpOiE521Ucofdx+KnDZl5xmvGYaaKCk5FEOxJCoQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "internal-slot": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/stream-events": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/stream-events/-/stream-events-1.0.5.tgz",
      "integrity": "sha512-E1GUzBSgvct8Jsb3v2X15pjzN1tYebtbLaMg+eBOUOAxgbLoSbT2NS91ckc5lJD1KfLjId+jXJRgo0qnV5Nerg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "stubs": "^3.0.0"
      }
    },
    "node_modules/stream-shift": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/stream-shift/-/stream-shift-1.0.3.tgz",
      "integrity": "sha512-76ORR0DO1o1hlKwTbi/DM3EXWGf3ZJYO8cXX5RJwnul2DEg2oyoZyjLNoQM8WsvZiFKCRfC1O0J7iCvie3RZmQ==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/streamx": {
      "version": "2.23.0",
      "resolved": "https://registry.npmjs.org/streamx/-/streamx-2.23.0.tgz",
      "integrity": "sha512-kn+e44esVfn2Fa/O0CPFcex27fjIL6MkVae0Mm6q+E6f0hWv578YCERbv+4m02cjxvDsPKLnmxral/rR6lBMAg==",
      "license": "MIT",
      "dependencies": {
        "events-universal": "^1.0.0",
        "fast-fifo": "^1.3.2",
        "text-decoder": "^1.1.0"
      }
    },
    "node_modules/string_decoder": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.3.0.tgz",
      "integrity": "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "safe-buffer": "~5.2.0"
      }
    },
    "node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/string.prototype.includes": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/string.prototype.includes/-/string.prototype.includes-2.0.1.tgz",
      "integrity": "sha512-o7+c9bW6zpAdJHTtujeePODAhkuicdAryFsfVKwA+wGw89wJ4GTY484WTucM9hLtDEOpOvI+aHnzqnC5lHp4Rg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.3"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/string.prototype.matchall": {
      "version": "4.0.12",
      "resolved": "https://registry.npmjs.org/string.prototype.matchall/-/string.prototype.matchall-4.0.12.tgz",
      "integrity": "sha512-6CC9uyBL+/48dYizRf7H7VAYCMCNTBeM78x/VTUe9bFEaxBepPJDa1Ow99LqI/1yF7kuy7Q3cQsYMrcjGUcskA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.6",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0",
        "get-intrinsic": "^1.2.6",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "internal-slot": "^1.1.0",
        "regexp.prototype.flags": "^1.5.3",
        "set-function-name": "^2.0.2",
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/string.prototype.repeat": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/string.prototype.repeat/-/string.prototype.repeat-1.0.0.tgz",
      "integrity": "sha512-0u/TldDbKD8bFCQ/4f5+mNRrXwZ8hg2w7ZR8wa16e8z9XpePWl3eGEcUD0OXpEH/VJH/2G3gjUtR3ZOiBe2S/w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-properties": "^1.1.3",
        "es-abstract": "^1.17.5"
      }
    },
    "node_modules/string.prototype.trim": {
      "version": "1.2.10",
      "resolved": "https://registry.npmjs.org/string.prototype.trim/-/string.prototype.trim-1.2.10.tgz",
      "integrity": "sha512-Rs66F0P/1kedk5lyYyH9uBzuiI/kNRmwJAR9quK6VOtIpZ2G+hMZd+HQbbv25MgCA6gEffoMZYxlTod4WcdrKA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.2",
        "define-data-property": "^1.1.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-object-atoms": "^1.0.0",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/string.prototype.trimend": {
      "version": "1.0.9",
      "resolved": "https://registry.npmjs.org/string.prototype.trimend/-/string.prototype.trimend-1.0.9.tgz",
      "integrity": "sha512-G7Ok5C6E/j4SGfyLCloXTrngQIQU3PWtXGst3yM7Bea9FRURf1S42ZHlZZtsNque2FN2PoUhfZXYLNWwEr4dLQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.2",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/string.prototype.trimstart": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/string.prototype.trimstart/-/string.prototype.trimstart-1.0.8.tgz",
      "integrity": "sha512-UXSH262CSZY1tfu3G3Secr6uGLCFVPMhIqHjlgCUtCCcgihYc/xKs9djMTMUOb2j1mVSeU8EU6NWc/iQKU6Gfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-bom": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/strip-bom/-/strip-bom-3.0.0.tgz",
      "integrity": "sha512-vavAMRXOgBVNF6nyEEmL3DBK19iRpDcoIwW+swQ+CbGiu7lju6t+JklA1MHweoWtadgt4ISVUsXLyDq34ddcwA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/strip-json-comments": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
      "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/strnum": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/strnum/-/strnum-1.1.2.tgz",
      "integrity": "sha512-vrN+B7DBIoTTZjnPNewwhx6cBA/H+IS7rfW68n7XxC1y7uoiGQBxaKzqucGUgavX15dJgiGztLJ8vxuEzwqBdA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/NaturalIntelligence"
        }
      ],
      "license": "MIT",
      "optional": true
    },
    "node_modules/stubs": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/stubs/-/stubs-3.0.0.tgz",
      "integrity": "sha512-PdHt7hHUJKxvTCgbKX9C1V/ftOcjJQgz8BZwNfV5c4B6dcGqlpelTbJ999jBGZ2jYiPAwcX5dP6oBwVlBlUbxw==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/styled-jsx": {
      "version": "5.1.6",
      "resolved": "https://registry.npmjs.org/styled-jsx/-/styled-jsx-5.1.6.tgz",
      "integrity": "sha512-qSVyDTeMotdvQYoHWLNGwRFJHC+i+ZvdBRYosOFgC+Wg1vx4frN2/RG/NA7SYqqvKNLf39P2LSRA2pu6n0XYZA==",
      "license": "MIT",
      "dependencies": {
        "client-only": "0.0.1"
      },
      "engines": {
        "node": ">= 12.0.0"
      },
      "peerDependencies": {
        "react": ">= 16.8.0 || 17.x.x || ^18.0.0-0 || ^19.0.0-0"
      },
      "peerDependenciesMeta": {
        "@babel/core": {
          "optional": true
        },
        "babel-plugin-macros": {
          "optional": true
        }
      }
    },
    "node_modules/sucrase": {
      "version": "3.35.1",
      "resolved": "https://registry.npmjs.org/sucrase/-/sucrase-3.35.1.tgz",
      "integrity": "sha512-DhuTmvZWux4H1UOnWMB3sk0sbaCVOoQZjv8u1rDoTV0HTdGem9hkAZtl4JZy8P2z4Bg0nT+YMeOFyVr4zcG5Tw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.2",
        "commander": "^4.0.0",
        "lines-and-columns": "^1.1.6",
        "mz": "^2.7.0",
        "pirates": "^4.0.1",
        "tinyglobby": "^0.2.11",
        "ts-interface-checker": "^0.1.9"
      },
      "bin": {
        "sucrase": "bin/sucrase",
        "sucrase-node": "bin/sucrase-node"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/supports-color": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/supports-preserve-symlinks-flag": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz",
      "integrity": "sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/tailwind-merge": {
      "version": "3.4.0",
      "resolved": "https://registry.npmjs.org/tailwind-merge/-/tailwind-merge-3.4.0.tgz",
      "integrity": "sha512-uSaO4gnW+b3Y2aWoWfFpX62vn2sR3skfhbjsEnaBI81WD1wBLlHZe5sWf0AqjksNdYTbGBEd0UasQMT3SNV15g==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/dcastil"
      }
    },
    "node_modules/tailwindcss": {
      "version": "3.4.17",
      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-3.4.17.tgz",
      "integrity": "sha512-w33E2aCvSDP0tW9RZuNXadXlkHXqFzSkQew/aIa2i/Sj8fThxwovwlXHSPXTbAHwEIhBFXAedUhP2tueAKP8Og==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@alloc/quick-lru": "^5.2.0",
        "arg": "^5.0.2",
        "chokidar": "^3.6.0",
        "didyoumean": "^1.2.2",
        "dlv": "^1.1.3",
        "fast-glob": "^3.3.2",
        "glob-parent": "^6.0.2",
        "is-glob": "^4.0.3",
        "jiti": "^1.21.6",
        "lilconfig": "^3.1.3",
        "micromatch": "^4.0.8",
        "normalize-path": "^3.0.0",
        "object-hash": "^3.0.0",
        "picocolors": "^1.1.1",
        "postcss": "^8.4.47",
        "postcss-import": "^15.1.0",
        "postcss-js": "^4.0.1",
        "postcss-load-config": "^4.0.2",
        "postcss-nested": "^6.2.0",
        "postcss-selector-parser": "^6.1.2",
        "resolve": "^1.22.8",
        "sucrase": "^3.35.0"
      },
      "bin": {
        "tailwind": "lib/cli.js",
        "tailwindcss": "lib/cli.js"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/tailwindcss/node_modules/fast-glob": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.3.tgz",
      "integrity": "sha512-7MptL8U0cqcFdzIzwOTHoilX9x5BrNqye7Z/LuC7kCMRio1EMSyqRK3BEAUD7sXRq4iT4AzTVuZdhgQ2TCvYLg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "^2.0.2",
        "@nodelib/fs.walk": "^1.2.3",
        "glob-parent": "^5.1.2",
        "merge2": "^1.3.0",
        "micromatch": "^4.0.8"
      },
      "engines": {
        "node": ">=8.6.0"
      }
    },
    "node_modules/tailwindcss/node_modules/fast-glob/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/tailwindcss/node_modules/jiti": {
      "version": "1.21.7",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-1.21.7.tgz",
      "integrity": "sha512-/imKNG4EbWNrVjoNC/1H5/9GFy+tqjGBHCaSsN+P2RnPqjsLmv6UD3Ej+Kj8nBWaRAwyk7kK5ZUc+OEatnTR3A==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jiti": "bin/jiti.js"
      }
    },
    "node_modules/tailwindcss/node_modules/postcss-load-config": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/postcss-load-config/-/postcss-load-config-4.0.2.tgz",
      "integrity": "sha512-bSVhyJGL00wMVoPUzAVAnbEoWyqRxkjv64tUl427SKnPrENtq6hJwUojroMz2VB+Q1edmi4IfrAPpami5VVgMQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "lilconfig": "^3.0.0",
        "yaml": "^2.3.4"
      },
      "engines": {
        "node": ">= 14"
      },
      "peerDependencies": {
        "postcss": ">=8.0.9",
        "ts-node": ">=9.0.0"
      },
      "peerDependenciesMeta": {
        "postcss": {
          "optional": true
        },
        "ts-node": {
          "optional": true
        }
      }
    },
    "node_modules/tar-fs": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/tar-fs/-/tar-fs-3.1.1.tgz",
      "integrity": "sha512-LZA0oaPOc2fVo82Txf3gw+AkEd38szODlptMYejQUhndHMLQ9M059uXR+AfS7DNo0NpINvSqDsvyaCrBVkptWg==",
      "license": "MIT",
      "dependencies": {
        "pump": "^3.0.0",
        "tar-stream": "^3.1.5"
      },
      "optionalDependencies": {
        "bare-fs": "^4.0.1",
        "bare-path": "^3.0.0"
      }
    },
    "node_modules/tar-stream": {
      "version": "3.1.7",
      "resolved": "https://registry.npmjs.org/tar-stream/-/tar-stream-3.1.7.tgz",
      "integrity": "sha512-qJj60CXt7IU1Ffyc3NJMjh6EkuCFej46zUqJ4J7pqYlThyd9bO0XBTmcOIhSzZJVWfsLks0+nle/j538YAW9RQ==",
      "license": "MIT",
      "dependencies": {
        "b4a": "^1.6.4",
        "fast-fifo": "^1.2.0",
        "streamx": "^2.15.0"
      }
    },
    "node_modules/teeny-request": {
      "version": "9.0.0",
      "resolved": "https://registry.npmjs.org/teeny-request/-/teeny-request-9.0.0.tgz",
      "integrity": "sha512-resvxdc6Mgb7YEThw6G6bExlXKkv6+YbuzGg9xuXxSgxJF7Ozs+o8Y9+2R3sArdWdW8nOokoQb1yrpFB0pQK2g==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "http-proxy-agent": "^5.0.0",
        "https-proxy-agent": "^5.0.0",
        "node-fetch": "^2.6.9",
        "stream-events": "^1.0.5",
        "uuid": "^9.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/teeny-request/node_modules/agent-base": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "debug": "4"
      },
      "engines": {
        "node": ">= 6.0.0"
      }
    },
    "node_modules/teeny-request/node_modules/http-proxy-agent": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-5.0.0.tgz",
      "integrity": "sha512-n2hY8YdoRE1i7r6M0w9DIw5GgZN0G25P8zLCRQ8rjXtTU3vsNFBI/vWK/UIeE6g5MUUz6avwAPXmL6Fy9D/90w==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@tootallnate/once": "2",
        "agent-base": "6",
        "debug": "4"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/teeny-request/node_modules/https-proxy-agent": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz",
      "integrity": "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "agent-base": "6",
        "debug": "4"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/teeny-request/node_modules/uuid": {
      "version": "9.0.1",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "optional": true,
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/text-decoder": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/text-decoder/-/text-decoder-1.2.3.tgz",
      "integrity": "sha512-3/o9z3X0X0fTupwsYvR03pJ/DjWuqqrfwBgTQzdWDiQSm9KitAyz/9WqsT2JQW7KV2m+bC2ol/zqpW37NHxLaA==",
      "license": "Apache-2.0",
      "dependencies": {
        "b4a": "^1.6.4"
      }
    },
    "node_modules/thenify": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/thenify/-/thenify-3.3.1.tgz",
      "integrity": "sha512-RVZSIV5IG10Hk3enotrhvz0T9em6cyHBLkH/YAZuKqd8hRkKhSfCGIcP2KUY0EPxndzANBmNllzWPwak+bheSw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "any-promise": "^1.0.0"
      }
    },
    "node_modules/thenify-all": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/thenify-all/-/thenify-all-1.6.0.tgz",
      "integrity": "sha512-RNxQH/qI8/t3thXJDwcstUO4zeqo64+Uy/+sNVRBx4Xn2OX+OZ9oP+iJnNFqplFra2ZUVeKCSa2oVWi3T4uVmA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "thenify": ">= 3.1.0 < 4"
      },
      "engines": {
        "node": ">=0.8"
      }
    },
    "node_modules/tinyglobby": {
      "version": "0.2.15",
      "resolved": "https://registry.npmjs.org/tinyglobby/-/tinyglobby-0.2.15.tgz",
      "integrity": "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fdir": "^6.5.0",
        "picomatch": "^4.0.3"
      },
      "engines": {
        "node": ">=12.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/SuperchupuDev"
      }
    },
    "node_modules/tinyglobby/node_modules/fdir": {
      "version": "6.5.0",
      "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
      "integrity": "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12.0.0"
      },
      "peerDependencies": {
        "picomatch": "^3 || ^4"
      },
      "peerDependenciesMeta": {
        "picomatch": {
          "optional": true
        }
      }
    },
    "node_modules/tinyglobby/node_modules/picomatch": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/to-regex-range": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-number": "^7.0.0"
      },
      "engines": {
        "node": ">=8.0"
      }
    },
    "node_modules/tr46": {
      "version": "0.0.3",
      "resolved": "https://registry.npmjs.org/tr46/-/tr46-0.0.3.tgz",
      "integrity": "sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==",
      "license": "MIT"
    },
    "node_modules/ts-api-utils": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/ts-api-utils/-/ts-api-utils-2.1.0.tgz",
      "integrity": "sha512-CUgTZL1irw8u29bzrOD/nH85jqyc74D6SshFgujOIA7osm2Rz7dYH77agkx7H4FBNxDq7Cjf+IjaX/8zwFW+ZQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18.12"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4"
      }
    },
    "node_modules/ts-interface-checker": {
      "version": "0.1.13",
      "resolved": "https://registry.npmjs.org/ts-interface-checker/-/ts-interface-checker-0.1.13.tgz",
      "integrity": "sha512-Y/arvbn+rrz3JCKl9C4kVNfTfSm2/mEp5FSz5EsZSANGPSlQrpRI5M4PKF+mJnE52jOO90PnPSc3Ur3bTQw0gA==",
      "dev": true,
      "license": "Apache-2.0"
    },
    "node_modules/tsconfig-paths": {
      "version": "3.15.0",
      "resolved": "https://registry.npmjs.org/tsconfig-paths/-/tsconfig-paths-3.15.0.tgz",
      "integrity": "sha512-2Ac2RgzDe/cn48GvOe3M+o82pEFewD3UPbyoUHHdKasHwJKjds4fLXWf/Ux5kATBKN20oaFGu+jbElp1pos0mg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/json5": "^0.0.29",
        "json5": "^1.0.2",
        "minimist": "^1.2.6",
        "strip-bom": "^3.0.0"
      }
    },
    "node_modules/tsconfig-paths/node_modules/json5": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/json5/-/json5-1.0.2.tgz",
      "integrity": "sha512-g1MWMLBiz8FKi1e4w0UyVL3w+iJceWAFBAaBnnGKOpNa5f8TLktkbre1+s6oICydWAm+HRUGTmI+//xv2hvXYA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "minimist": "^1.2.0"
      },
      "bin": {
        "json5": "lib/cli.js"
      }
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
      "license": "0BSD"
    },
    "node_modules/type-check": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/type-check/-/type-check-0.4.0.tgz",
      "integrity": "sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "prelude-ls": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/typed-array-buffer": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/typed-array-buffer/-/typed-array-buffer-1.0.3.tgz",
      "integrity": "sha512-nAYYwfY3qnzX30IkA6AQZjVbtK6duGontcQm1WSG1MD94YLqK0515GNApXkoxKOWMusVssAHWLh9SeaoefYFGw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "is-typed-array": "^1.1.14"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/typed-array-byte-length": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/typed-array-byte-length/-/typed-array-byte-length-1.0.3.tgz",
      "integrity": "sha512-BaXgOuIxz8n8pIq3e7Atg/7s+DpiYrxn4vdot3w9KbnBhcRQq6o3xemQdIfynqSeXeDrF32x+WvfzmOjPiY9lg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "for-each": "^0.3.3",
        "gopd": "^1.2.0",
        "has-proto": "^1.2.0",
        "is-typed-array": "^1.1.14"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/typed-array-byte-offset": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/typed-array-byte-offset/-/typed-array-byte-offset-1.0.4.tgz",
      "integrity": "sha512-bTlAFB/FBYMcuX81gbL4OcpH5PmlFHqlCCpAl8AlEzMz5k53oNDvN8p1PNOWLEmI2x4orp3raOFB51tv9X+MFQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "available-typed-arrays": "^1.0.7",
        "call-bind": "^1.0.8",
        "for-each": "^0.3.3",
        "gopd": "^1.2.0",
        "has-proto": "^1.2.0",
        "is-typed-array": "^1.1.15",
        "reflect.getprototypeof": "^1.0.9"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/typed-array-length": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/typed-array-length/-/typed-array-length-1.0.7.tgz",
      "integrity": "sha512-3KS2b+kL7fsuk/eJZ7EQdnEmQoaho/r6KUef7hxvltNA5DR8NAUM+8wJMbJyZ4G9/7i3v5zPBIMN5aybAh2/Jg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "for-each": "^0.3.3",
        "gopd": "^1.0.1",
        "is-typed-array": "^1.1.13",
        "possible-typed-array-names": "^1.0.0",
        "reflect.getprototypeof": "^1.0.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/typed-query-selector": {
      "version": "2.12.0",
      "resolved": "https://registry.npmjs.org/typed-query-selector/-/typed-query-selector-2.12.0.tgz",
      "integrity": "sha512-SbklCd1F0EiZOyPiW192rrHZzZ5sBijB6xM+cpmrwDqObvdtunOHHIk9fCGsoK5JVIYXoyEp4iEdE3upFH3PAg==",
      "license": "MIT"
    },
    "node_modules/typescript": {
      "version": "5.9.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
      "devOptional": true,
      "license": "Apache-2.0",
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/typescript-eslint": {
      "version": "8.50.0",
      "resolved": "https://registry.npmjs.org/typescript-eslint/-/typescript-eslint-8.50.0.tgz",
      "integrity": "sha512-Q1/6yNUmCpH94fbgMUMg2/BSAr/6U7GBk61kZTv1/asghQOWOjTlp9K8mixS5NcJmm2creY+UFfGeW/+OcA64A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/eslint-plugin": "8.50.0",
        "@typescript-eslint/parser": "8.50.0",
        "@typescript-eslint/typescript-estree": "8.50.0",
        "@typescript-eslint/utils": "8.50.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/unbox-primitive": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/unbox-primitive/-/unbox-primitive-1.1.0.tgz",
      "integrity": "sha512-nWJ91DjeOkej/TA8pXQ3myruKpKEYgqvpw9lz4OPHj/NWFNluYrjbz9j01CJ8yKQd2g4jFoOkINCTW2I5LEEyw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-bigints": "^1.0.2",
        "has-symbols": "^1.1.0",
        "which-boxed-primitive": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/undici-types": {
      "version": "6.21.0",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-6.21.0.tgz",
      "integrity": "sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==",
      "license": "MIT"
    },
    "node_modules/unrs-resolver": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/unrs-resolver/-/unrs-resolver-1.11.1.tgz",
      "integrity": "sha512-bSjt9pjaEBnNiGgc9rUiHGKv5l4/TGzDmYw3RhnkJGtLhbnnA/5qJj7x3dNDCRx/PJxu774LlH8lCOlB4hEfKg==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "dependencies": {
        "napi-postinstall": "^0.3.0"
      },
      "funding": {
        "url": "https://opencollective.com/unrs-resolver"
      },
      "optionalDependencies": {
        "@unrs/resolver-binding-android-arm-eabi": "1.11.1",
        "@unrs/resolver-binding-android-arm64": "1.11.1",
        "@unrs/resolver-binding-darwin-arm64": "1.11.1",
        "@unrs/resolver-binding-darwin-x64": "1.11.1",
        "@unrs/resolver-binding-freebsd-x64": "1.11.1",
        "@unrs/resolver-binding-linux-arm-gnueabihf": "1.11.1",
        "@unrs/resolver-binding-linux-arm-musleabihf": "1.11.1",
        "@unrs/resolver-binding-linux-arm64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-arm64-musl": "1.11.1",
        "@unrs/resolver-binding-linux-ppc64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-riscv64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-riscv64-musl": "1.11.1",
        "@unrs/resolver-binding-linux-s390x-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-x64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-x64-musl": "1.11.1",
        "@unrs/resolver-binding-wasm32-wasi": "1.11.1",
        "@unrs/resolver-binding-win32-arm64-msvc": "1.11.1",
        "@unrs/resolver-binding-win32-ia32-msvc": "1.11.1",
        "@unrs/resolver-binding-win32-x64-msvc": "1.11.1"
      }
    },
    "node_modules/update-browserslist-db": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.2.tgz",
      "integrity": "sha512-E85pfNzMQ9jpKkA7+TJAi4TJN+tBCuWh5rUcS/sv6cFi+1q9LYDwDI5dpUL0u/73EElyQ8d3TEaeW4sPedBqYA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/uri-js": {
      "version": "4.4.1",
      "resolved": "https://registry.npmjs.org/uri-js/-/uri-js-4.4.1.tgz",
      "integrity": "sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "punycode": "^2.1.0"
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "devOptional": true,
      "license": "MIT"
    },
    "node_modules/uuid": {
      "version": "11.1.0",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-11.1.0.tgz",
      "integrity": "sha512-0/A9rDy9P7cJ+8w1c9WD9V//9Wj15Ce2MPz8Ri6032usz+NfePxx5AcN3bN+r6ZL6jEo066/yNYB3tn4pQEx+A==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "bin": {
        "uuid": "dist/esm/bin/uuid"
      }
    },
    "node_modules/web-vitals": {
      "version": "4.2.4",
      "resolved": "https://registry.npmjs.org/web-vitals/-/web-vitals-4.2.4.tgz",
      "integrity": "sha512-r4DIlprAGwJ7YM11VZp4R884m0Vmgr6EAKe3P+kO0PPj3Unqyvv59rczf6UiGcb9Z8QxZVcqKNwv/g0WNdWwsw==",
      "license": "Apache-2.0"
    },
    "node_modules/webdriver-bidi-protocol": {
      "version": "0.3.10",
      "resolved": "https://registry.npmjs.org/webdriver-bidi-protocol/-/webdriver-bidi-protocol-0.3.10.tgz",
      "integrity": "sha512-5LAE43jAVLOhB/QqX4bwSiv0Hg1HBfMmOuwBSXHdvg4GMGu9Y0lIq7p4R/yySu6w74WmaR4GM4H9t2IwLW7hgw==",
      "license": "Apache-2.0"
    },
    "node_modules/webidl-conversions": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/webidl-conversions/-/webidl-conversions-3.0.1.tgz",
      "integrity": "sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==",
      "license": "BSD-2-Clause"
    },
    "node_modules/websocket-driver": {
      "version": "0.7.4",
      "resolved": "https://registry.npmjs.org/websocket-driver/-/websocket-driver-0.7.4.tgz",
      "integrity": "sha512-b17KeDIQVjvb0ssuSDF2cYXSg2iztliJ4B9WdsuB6J952qCPKmnVq4DyW5motImXHDC1cBT/1UezrJVsKw5zjg==",
      "license": "Apache-2.0",
      "dependencies": {
        "http-parser-js": ">=0.5.1",
        "safe-buffer": ">=5.1.0",
        "websocket-extensions": ">=0.1.1"
      },
      "engines": {
        "node": ">=0.8.0"
      }
    },
    "node_modules/websocket-extensions": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/websocket-extensions/-/websocket-extensions-0.1.4.tgz",
      "integrity": "sha512-OqedPIGOfsDlo31UNwYbCFMSaO9m9G/0faIHj5/dZFDMFqPTcx6UwqyOy3COEaEOg/9VsGIpdqn62W5KhoKSpg==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=0.8.0"
      }
    },
    "node_modules/whatwg-url": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-url/-/whatwg-url-5.0.0.tgz",
      "integrity": "sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==",
      "license": "MIT",
      "dependencies": {
        "tr46": "~0.0.3",
        "webidl-conversions": "^3.0.0"
      }
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/which-boxed-primitive": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/which-boxed-primitive/-/which-boxed-primitive-1.1.1.tgz",
      "integrity": "sha512-TbX3mj8n0odCBFVlY8AxkqcHASw3L60jIuF8jFP78az3C2YhmGvqbHBpAjTRH2/xqYunrJ9g1jSyjCjpoWzIAA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-bigint": "^1.1.0",
        "is-boolean-object": "^1.2.1",
        "is-number-object": "^1.1.1",
        "is-string": "^1.1.1",
        "is-symbol": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/which-builtin-type": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/which-builtin-type/-/which-builtin-type-1.2.1.tgz",
      "integrity": "sha512-6iBczoX+kDQ7a3+YJBnh3T+KZRxM/iYNPXicqk66/Qfm1b93iu+yOImkg0zHbj5LNOcNv1TEADiZ0xa34B4q6Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "function.prototype.name": "^1.1.6",
        "has-tostringtag": "^1.0.2",
        "is-async-function": "^2.0.0",
        "is-date-object": "^1.1.0",
        "is-finalizationregistry": "^1.1.0",
        "is-generator-function": "^1.0.10",
        "is-regex": "^1.2.1",
        "is-weakref": "^1.0.2",
        "isarray": "^2.0.5",
        "which-boxed-primitive": "^1.1.0",
        "which-collection": "^1.0.2",
        "which-typed-array": "^1.1.16"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/which-collection": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/which-collection/-/which-collection-1.0.2.tgz",
      "integrity": "sha512-K4jVyjnBdgvc86Y6BkaLZEN933SwYOuBFkdmBu9ZfkcAbdVbpITnDmjvZ/aQjRXQrv5EPkTnD1s39GiiqbngCw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-map": "^2.0.3",
        "is-set": "^2.0.3",
        "is-weakmap": "^2.0.2",
        "is-weakset": "^2.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/which-typed-array": {
      "version": "1.1.19",
      "resolved": "https://registry.npmjs.org/which-typed-array/-/which-typed-array-1.1.19.tgz",
      "integrity": "sha512-rEvr90Bck4WZt9HHFC4DJMsjvu7x+r6bImz0/BrbWb7A2djJ8hnZMrWnHo9F8ssv0OMErasDhftrfROTyqSDrw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "available-typed-arrays": "^1.0.7",
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "for-each": "^0.3.5",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/word-wrap": {
      "version": "1.2.5",
      "resolved": "https://registry.npmjs.org/word-wrap/-/word-wrap-1.2.5.tgz",
      "integrity": "sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/wrap-ansi": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrappy": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
      "integrity": "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==",
      "license": "ISC"
    },
    "node_modules/ws": {
      "version": "8.18.3",
      "resolved": "https://registry.npmjs.org/ws/-/ws-8.18.3.tgz",
      "integrity": "sha512-PEIGCY5tSlUt50cqyMXfCzX+oOPqN0vuGqWzbcJ2xvnkzkq46oOpz7dQaTDBdfICb4N14+GARUDw2XV2N4tvzg==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      },
      "peerDependencies": {
        "bufferutil": "^4.0.1",
        "utf-8-validate": ">=5.0.2"
      },
      "peerDependenciesMeta": {
        "bufferutil": {
          "optional": true
        },
        "utf-8-validate": {
          "optional": true
        }
      }
    },
    "node_modules/y18n": {
      "version": "5.0.8",
      "resolved": "https://registry.npmjs.org/y18n/-/y18n-5.0.8.tgz",
      "integrity": "sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==",
      "license": "ISC",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/yaml": {
      "version": "2.8.2",
      "resolved": "https://registry.npmjs.org/yaml/-/yaml-2.8.2.tgz",
      "integrity": "sha512-mplynKqc1C2hTVYxd0PU2xQAc22TI1vShAYGksCCfxbn/dFwnHTNi1bvYsBTkhdUNtGIf5xNOg938rrSSYvS9A==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "yaml": "bin.mjs"
      },
      "engines": {
        "node": ">= 14.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/eemeli"
      }
    },
    "node_modules/yargs": {
      "version": "17.7.2",
      "resolved": "https://registry.npmjs.org/yargs/-/yargs-17.7.2.tgz",
      "integrity": "sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==",
      "license": "MIT",
      "dependencies": {
        "cliui": "^8.0.1",
        "escalade": "^3.1.1",
        "get-caller-file": "^2.0.5",
        "require-directory": "^2.1.1",
        "string-width": "^4.2.3",
        "y18n": "^5.0.5",
        "yargs-parser": "^21.1.1"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/yargs-parser": {
      "version": "21.1.1",
      "resolved": "https://registry.npmjs.org/yargs-parser/-/yargs-parser-21.1.1.tgz",
      "integrity": "sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/yauzl": {
      "version": "2.10.0",
      "resolved": "https://registry.npmjs.org/yauzl/-/yauzl-2.10.0.tgz",
      "integrity": "sha512-p4a9I6X6nu6IhoGmBqAcbJy1mlC4j27vEPZX9F4L4/vZT3Lyq1VkFHw/V/PUcB9Buo+DG3iHkT0x3Qya58zc3g==",
      "license": "MIT",
      "dependencies": {
        "buffer-crc32": "~0.2.3",
        "fd-slicer": "~1.1.0"
      }
    },
    "node_modules/yocto-queue": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
      "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/zod": {
      "version": "4.2.1",
      "resolved": "https://registry.npmjs.org/zod/-/zod-4.2.1.tgz",
      "integrity": "sha512-0wZ1IRqGGhMP76gLqz8EyfBXKk0J2qo2+H3fi4mcUP/KtTocoX08nmIAHl1Z2kJIZbZee8KOpBCSNPRgauucjw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/colinhacks"
      }
    },
    "node_modules/zod-validation-error": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/zod-validation-error/-/zod-validation-error-4.0.2.tgz",
      "integrity": "sha512-Q6/nZLe6jxuU80qb/4uJ4t5v2VEZ44lzQjPDhYJNztRQ4wyWc6VF3D3Kb/fAuPetZQnhS3hnajCf9CsWesghLQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18.0.0"
      },
      "peerDependencies": {
        "zod": "^3.25.0 || ^4.0.0"
      }
    },
    "node_modules/zustand": {
      "version": "5.0.9",
      "resolved": "https://registry.npmjs.org/zustand/-/zustand-5.0.9.tgz",
      "integrity": "sha512-ALBtUj0AfjJt3uNRQoL1tL2tMvj6Gp/6e39dnfT6uzpelGru8v1tPOGBzayOWbPJvujM8JojDk3E1LxeFisBNg==",
      "license": "MIT",
      "engines": {
        "node": ">=12.20.0"
      },
      "peerDependencies": {
        "@types/react": ">=18.0.0",
        "immer": ">=9.0.6",
        "react": ">=18.0.0",
        "use-sync-external-store": ">=1.2.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "immer": {
          "optional": true
        },
        "react": {
          "optional": true
        },
        "use-sync-external-store": {
          "optional": true
        }
      }
    }
  }
}

--- FILE: ./package.json ---
{
  "name": "trainingbook",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "clsx": "^2.1.1",
    "date-fns": "^4.1.0",
    "firebase": "^12.7.0",
    "firebase-admin": "^13.6.0",
    "framer-motion": "^12.23.26",
    "lucide-react": "^0.561.0",
    "next": "16.0.10",
    "puppeteer": "^24.34.0",
    "react": "19.2.1",
    "react-dom": "19.2.1",
    "react-hot-toast": "^2.6.0",
    "tailwind-merge": "^3.4.0",
    "zustand": "^5.0.9"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "autoprefixer": "^10.4.23",
    "babel-plugin-react-compiler": "1.0.0",
    "eslint": "^9",
    "eslint-config-next": "16.0.10",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.17",
    "typescript": "^5"
  }
}

--- FILE: ./lib/firebase.ts ---
// --- FILE: ./lib/firebase.ts ---
import { initializeApp, getApps, getApp } from "firebase/app";
import { getFirestore } from "firebase/firestore";
import { getStorage } from "firebase/storage";
import { getAuth } from "firebase/auth";

// --- CONFIG: Trainingbook (Primary Project) ---
const firebaseConfig = {
  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,
  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,
};

// 1. Initialize Primary App
// We check getApps() to prevent initialization errors during Next.js hot-reloading
const app = getApps().length > 0 ? getApp() : initializeApp(firebaseConfig);

// Primary Project Instances
const db = getFirestore(app);
const storage = getStorage(app);
const auth = getAuth(app);

// Export instances
export { 
  app, 
  db, 
  storage, 
  auth 
};
--- FILE: ./lib/utils.ts ---
// --- FILE: ./lib/utils.ts ---
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";
import { addDays, differenceInDays } from "date-fns";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

// --- NEW HELPER: Probation Logic ---
export function getProbationStatus(joinedDateString?: string) {
    if (!joinedDateString) return null;
    
    // Parse
    const joined = new Date(joinedDateString);
    const today = new Date();
    
    // Calculate End Date (30 Days from Join)
    const probationEnd = addDays(joined, 30);
    
    // Calculate Difference
    const daysRemaining = differenceInDays(probationEnd, today);
    const daysPassed = 30 - daysRemaining;
    
    // If probation is over (negative remaining), return null
    if (daysRemaining <= 0) return null;

    // Calculate percentage (0 to 100)
    const percentage = Math.min(100, Math.max(0, Math.round((daysPassed / 30) * 100)));

    return {
        isActive: true,
        daysRemaining,
        daysPassed,
        percentage,
        total: 30
    };
}
--- FILE: ./lib/icon-library.ts ---
import * as LucideIcons from "lucide-react";

export interface TacticalIcon {
    id: string;
    icon: any;
    category: "Operational" | "Hospitality" | "BOH" | "Achievement" | "Creative";
}

export const TACTICAL_ICONS: TacticalIcon[] = [
    // --- ACHIEVEMENT ---
    { id: "Trophy", icon: LucideIcons.Trophy, category: "Achievement" },
    { id: "Crown", icon: LucideIcons.Crown, category: "Achievement" },
    { id: "Medal", icon: LucideIcons.Medal, category: "Achievement" },
    { id: "Award", icon: LucideIcons.Award, category: "Achievement" },
    { id: "Star", icon: LucideIcons.Star, category: "Achievement" },
    { id: "Gem", icon: LucideIcons.Gem, category: "Achievement" },
    { id: "Sparkles", icon: LucideIcons.Sparkles, category: "Achievement" },
    { id: "CheckCircle", icon: LucideIcons.CheckCircle2, category: "Achievement" },

    // --- HOSPITALITY & FOH ---
    { id: "Heart", icon: LucideIcons.Heart, category: "Hospitality" },
    { id: "Smile", icon: LucideIcons.Smile, category: "Hospitality" },
    { id: "Coffee", icon: LucideIcons.Coffee, category: "Hospitality" },
    { id: "Sun", icon: LucideIcons.Sun, category: "Hospitality" },
    { id: "Glass", icon: LucideIcons.GlassWater, category: "Hospitality" },
    { id: "Utensils", icon: LucideIcons.Utensils, category: "Hospitality" },
    { id: "Pizza", icon: LucideIcons.Pizza, category: "Hospitality" },
    { id: "IceCream", icon: LucideIcons.IceCream, category: "Hospitality" },
    { id: "Cake", icon: LucideIcons.Cake, category: "Hospitality" },
    { id: "Handshake", icon: LucideIcons.Handshake, category: "Hospitality" },

    // --- BOH & KITCHEN ---
    { id: "ChefHat", icon: LucideIcons.ChefHat, category: "BOH" },
    { id: "Flame", icon: LucideIcons.Flame, category: "BOH" },
    { id: "Pot", icon: LucideIcons.CookingPot, category: "BOH" }, // Replaced Knife
    { id: "Timer", icon: LucideIcons.Timer, category: "BOH" },
    { id: "Thermometer", icon: LucideIcons.Thermometer, category: "BOH" },
    { id: "Droplets", icon: LucideIcons.Droplets, category: "BOH" },
    { id: "Trash", icon: LucideIcons.Trash2, category: "BOH" },
    { id: "Refrigerator", icon: LucideIcons.Refrigerator, category: "BOH" },

    // --- OPERATIONAL & TACTICAL ---
    { id: "Zap", icon: LucideIcons.Zap, category: "Operational" },
    { id: "Shield", icon: LucideIcons.Shield, category: "Operational" },
    { id: "Target", icon: LucideIcons.Target, category: "Operational" },
    { id: "Crosshair", icon: LucideIcons.Crosshair, category: "Operational" },
    { id: "Rocket", icon: LucideIcons.Rocket, category: "Operational" },
    { id: "Activity", icon: LucideIcons.Activity, category: "Operational" },
    { id: "Fingerprint", icon: LucideIcons.Fingerprint, category: "Operational" },
    { id: "Compass", icon: LucideIcons.Compass, category: "Operational" },
    { id: "Anchor", icon: LucideIcons.Anchor, category: "Operational" },
    { id: "Map", icon: LucideIcons.Map, category: "Operational" },
    { id: "Radar", icon: LucideIcons.Radar, category: "Operational" },
    { id: "Flag", icon: LucideIcons.Flag, category: "Operational" },
    { id: "Gauge", icon: LucideIcons.Gauge, category: "Operational" },
    { id: "Cpu", icon: LucideIcons.Cpu, category: "Operational" },
    { id: "Terminal", icon: LucideIcons.Terminal, category: "Operational" },

    // --- CREATIVE & SYMBOLIC ---
    { id: "Palette", icon: LucideIcons.Palette, category: "Creative" },
    { id: "Feather", icon: LucideIcons.Feather, category: "Creative" },
    { id: "Moon", icon: LucideIcons.Moon, category: "Creative" },
    { id: "Mountain", icon: LucideIcons.Mountain, category: "Creative" },
    { id: "Tree", icon: LucideIcons.TreeDeciduous, category: "Creative" },
    { id: "Ghost", icon: LucideIcons.Ghost, category: "Creative" },
    { id: "Bird", icon: LucideIcons.Bird, category: "Creative" },
    { id: "Fish", icon: LucideIcons.Fish, category: "Creative" },
    { id: "Dog", icon: LucideIcons.Dog, category: "Creative" },
    { id: "Cat", icon: LucideIcons.Cat, category: "Creative" },
    { id: "Bomb", icon: LucideIcons.Bomb, category: "Creative" },
    { id: "Binoculars", icon: LucideIcons.Binoculars, category: "Creative" },
    { id: "Camera", icon: LucideIcons.Camera, category: "Creative" },
    { id: "Gamepad", icon: LucideIcons.Gamepad2, category: "Creative" },
    { id: "Music", icon: LucideIcons.Music, category: "Creative" },
    { id: "Plane", icon: LucideIcons.Plane, category: "Creative" },
    { id: "Puzzle", icon: LucideIcons.Puzzle, category: "Creative" },
    { id: "Gift", icon: LucideIcons.Gift, category: "Creative" },
    { id: "Lightbulb", icon: LucideIcons.Lightbulb, category: "Creative" },
    { id: "Magnet", icon: LucideIcons.Magnet, category: "Creative" },
    { id: "Umbrella", icon: LucideIcons.Umbrella, category: "Creative" },
];
--- FILE: ./lib/hooks/useTaskMap.ts ---
// lib/hooks/useTaskMap.ts
import { useMemo } from "react";
import { useAppStore } from "@/lib/store/useStore";

export function useTaskMap() {
  const { curriculum } = useAppStore();

  const taskMap = useMemo(() => {
    const map: Record<string, string> = {};
    
    if (!curriculum) return map;

    curriculum.forEach((section) => {
      if (section.tasks) {
        section.tasks.forEach((task: any) => {
          map[task.id] = task.title;
        });
      }
    });
    
    return map;
  }, [curriculum]);

  return taskMap;
}
--- FILE: ./lib/firebase-admin.ts ---
import * as admin from 'firebase-admin';

export const initAdmin = () => {
  if (!admin.apps.length) {
    const privateKey = process.env.FIREBASE_PRIVATE_KEY;
    const clientEmail = process.env.FIREBASE_CLIENT_EMAIL;
    const projectId = process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID;

    if (!privateKey || !clientEmail || !projectId) {
      console.error(`
      ❌ [FIREBASE ADMIN] MISSING CREDENTIALS
      - Project ID: ${projectId ? 'OK' : 'MISSING'}
      - Client Email: ${clientEmail ? 'OK' : 'MISSING'}
      - Private Key: ${privateKey ? 'OK (Length: ' + privateKey.length + ')' : 'MISSING'}
      `);
      throw new Error("Server configuration error: Missing Firebase Admin credentials.");
    }

    try {
      // FIX: Handle both escaped newlines (\\n) from .env files and real newlines
      const formattedKey = privateKey.replace(/\\n/g, '\n');

      admin.initializeApp({
        credential: admin.credential.cert({
          projectId,
          clientEmail,
          privateKey: formattedKey,
        }),
      });
      console.log("✅ [FIREBASE ADMIN] Initialized Successfully");
    } catch (error) {
      console.error("❌ [FIREBASE ADMIN] Init Error:", error);
      throw error;
    }
  }
  return admin;
};

export const getAdminAuth = () => {
  initAdmin();
  return admin.auth();
};

export const getAdminDb = () => {
  initAdmin();
  return admin.firestore();
};
--- FILE: ./lib/store/useStore.ts ---
import { create } from "zustand";
import { db, auth } from "@/lib/firebase";
import { collection, onSnapshot, query, doc, getDoc } from "firebase/firestore";
import { signInWithEmailAndPassword, signOut } from "firebase/auth";
import { 
  CalendarEvent, 
  TeamMember, 
  Status 
} from "@/app/(main)/calendar/_components/types";

interface UserProfile {
  uid: string;
  email: string;
  role: Status;
  name: string;
  image?: string;
}

interface AppState {
  events: CalendarEvent[];
  team: TeamMember[];
  curriculum: any[];
  loading: boolean;
  
  currentUser: UserProfile | null;
  authLoading: boolean;
  
  subscribeEvents: () => () => void;
  subscribeTeam: () => () => void;
  subscribeCurriculum: () => () => void;
  
  login: (email: string, pass: string) => Promise<void>;
  logout: () => Promise<void>;
  checkAuth: () => void;

  updateMemberLocal: (id: string, updates: Partial<TeamMember>) => void;
}

export const useAppStore = create<AppState>((set) => ({
  events: [],
  team: [],
  curriculum: [],
  loading: true,
  currentUser: null,
  authLoading: true,

  subscribeEvents: () => {
    const q = query(collection(db, "events"));
    return onSnapshot(q, (snapshot) => {
      const eventsData = snapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data(),
        startDate: doc.data().startDate?.toDate ? doc.data().startDate.toDate() : new Date(),
        endDate: doc.data().endDate?.toDate ? doc.data().endDate.toDate() : new Date(),
      })) as CalendarEvent[];
      set({ events: eventsData, loading: false });
    });
  },

  subscribeTeam: () => {
    const q = query(collection(db, "teamMembers")); 
    
    return onSnapshot(q, async (snapshot) => {
      const promises = snapshot.docs.map(async (d) => {
        try {
          const memberData = d.data();
          let finalStatus = memberData.status || "Team Member";
          let finalRole = memberData.role || "Team Member";

          // Merge profile overrides
          try {
            const overrideRef = doc(db, "profileOverrides", d.id);
            const overrideSnap = await getDoc(overrideRef);
            
            if (overrideSnap.exists()) {
               const overrideData = overrideSnap.data();
               Object.assign(memberData, overrideData);
               if (overrideData.status) finalStatus = overrideData.status;
               if (overrideData.role) finalRole = overrideData.role;
            }
          } catch (err) {
            console.warn(`Could not load overrides for ${d.id}`, err);
          }

          return {
            id: d.id,
            ...memberData,
            status: finalStatus,
            role: finalRole,
            stats: memberData.stats || { speed: 50, accuracy: 50, hospitality: 50, knowledge: 50, leadership: 50 },
            progress: memberData.progress || 0,
            dept: memberData.dept || "Unassigned",
            image: memberData.image || "",
            badges: memberData.badges || []
          } as TeamMember;

        } catch (e) {
          return null;
        }
      });

      const results = await Promise.all(promises);
      const validMembers = results.filter((m): m is TeamMember => m !== null);
      set({ team: validMembers, loading: false });
    });
  },

  subscribeCurriculum: () => {
    const q = query(collection(db, "curriculum"));
    return onSnapshot(q, (snapshot) => {
      const data = snapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      data.sort((a: any, b: any) => (a.order || 0) - (b.order || 0));
      set({ curriculum: data });
    });
  },

  login: async (email, password) => {
    await signInWithEmailAndPassword(auth, email, password);
    // Note: checkAuth listener will handle setting the state
  },

  logout: async () => {
    await signOut(auth);
    set({ currentUser: null });
  },

  // --- FIXED CHECKAUTH FUNCTION ---
  checkAuth: () => {
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        // Default fallback values
        let profileName = user.displayName || "User";
        let profileRole: Status = "Team Member";
        let profileImage = user.photoURL || "";

        try {
            // 1. Fetch real data from TeamMembers collection using the UID
            const memberRef = doc(db, "teamMembers", user.uid);
            const memberSnap = await getDoc(memberRef);
            
            // 2. Fetch any overrides (like roles promoted via UI)
            const overrideRef = doc(db, "profileOverrides", user.uid);
            const overrideSnap = await getDoc(overrideRef);

            if (memberSnap.exists()) {
                const data = memberSnap.data();
                profileName = data.name || profileName;
                profileImage = data.image || profileImage;
                // Use stored status as role
                if (data.status) profileRole = data.status as Status;
            }

            if (overrideSnap.exists()) {
                const data = overrideSnap.data();
                // Overrides take precedence
                if (data.role) profileRole = data.role as Status;
                if (data.status) profileRole = data.status as Status; // Ensure status sync
                if (data.image) profileImage = data.image;
            }
        } catch (error) {
            console.error("Error fetching user profile:", error);
        }

        set({ 
          currentUser: { 
              uid: user.uid, 
              email: user.email || "", 
              name: profileName, 
              role: profileRole,
              image: profileImage
          },
          authLoading: false
        });
      } else {
        set({ currentUser: null, authLoading: false });
      }
    });
  },

  updateMemberLocal: (id, updates) => {
    set((state) => ({
      team: state.team.map((m) => (m.id === id ? { ...m, ...updates } : m)),
    }));
  },
}));
--- FILE: ./functions/package-lock.json ---
{
  "name": "functions",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "functions",
      "dependencies": {
        "@sparticuz/chromium": "^143.0.0",
        "firebase-admin": "^13.6.0",
        "firebase-functions": "^7.0.0",
        "puppeteer-core": "^24.34.0"
      },
      "devDependencies": {
        "@types/puppeteer": "^5.4.7",
        "firebase-functions-test": "^3.4.1",
        "typescript": "^5.7.3"
      },
      "engines": {
        "node": "24"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.27.1.tgz",
      "integrity": "sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.27.1",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.5.tgz",
      "integrity": "sha512-6uFXyCayocRbqhZOB+6XcuZbkMNimwfVGFji8CTZnCzOHVGvDqzvitu1re2AU5LROliz7eQPhB8CpAMvnx9EjA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.5.tgz",
      "integrity": "sha512-e7jT4DxYvIDLk1ZHmU/m/mB19rex9sv0c2ftBtjSBv+kVM/902eh0fINUzD7UwLLNR+jU585GxUJ8/EBfAM5fw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-compilation-targets": "^7.27.2",
        "@babel/helper-module-transforms": "^7.28.3",
        "@babel/helpers": "^7.28.4",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/traverse": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/core/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/@babel/core/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@babel/generator": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.5.tgz",
      "integrity": "sha512-3EwLFhZ38J4VyIP6WNtt2kUdW9dokXA9Cr4IVIFHuCpZ3H8/YFOl5JjZHisrn1fATPBmKKqXzDFvh9fUwHz6CQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/parser": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.2.tgz",
      "integrity": "sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/compat-data": "^7.27.2",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.27.1.tgz",
      "integrity": "sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/traverse": "^7.27.1",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.3",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.3.tgz",
      "integrity": "sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-module-imports": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.27.1",
        "@babel/traverse": "^7.28.3"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.27.1.tgz",
      "integrity": "sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.4.tgz",
      "integrity": "sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.4"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.5.tgz",
      "integrity": "sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/types": "^7.28.5"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-syntax-async-generators": {
      "version": "7.8.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-async-generators/-/plugin-syntax-async-generators-7.8.4.tgz",
      "integrity": "sha512-tycmZxkGfZaxhMRbXlPXuVFpdWlXpir2W4AMhSJgRKzk/eDlIXOhb2LHWoLpDF7TEHylV5zNhykX6KAgHJmTNw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-bigint": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-bigint/-/plugin-syntax-bigint-7.8.3.tgz",
      "integrity": "sha512-wnTnFlG+YxQm3vDxpGE57Pj0srRU4sHE/mDkt1qv2YJJSeUAec2ma4WLUnUPeKjyrfntVwe/N6dCXpU+zL3Npg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-class-properties": {
      "version": "7.12.13",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-properties/-/plugin-syntax-class-properties-7.12.13.tgz",
      "integrity": "sha512-fm4idjKla0YahUNgFNLCB0qySdsoPiZP3iQE3rky0mBUtMZ23yDJ9SJdg6dXTSDnulOVqiF3Hgr9nbXvXTQZYA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.12.13"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-class-static-block": {
      "version": "7.14.5",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-static-block/-/plugin-syntax-class-static-block-7.14.5.tgz",
      "integrity": "sha512-b+YyPmr6ldyNnM6sqYeMWE+bgJcJpO6yS4QD7ymxgH34GBPNDM/THBh8iunyvKIZztiwLH4CJZ0RxTk9emgpjw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.14.5"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-import-attributes": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-attributes/-/plugin-syntax-import-attributes-7.27.1.tgz",
      "integrity": "sha512-oFT0FrKHgF53f4vOsZGi2Hh3I35PfSmVs4IBFLFj4dnafP+hIWDLg3VyKmUHfLoLHlyxY4C7DGtmHuJgn+IGww==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-import-meta": {
      "version": "7.10.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-meta/-/plugin-syntax-import-meta-7.10.4.tgz",
      "integrity": "sha512-Yqfm+XDx0+Prh3VSeEQCPU81yC+JWZ2pDPFSS4ZdpfZhp4MkFMaDC1UqseovEKwSUpnIL7+vK+Clp7bfh0iD7g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.10.4"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-json-strings": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-json-strings/-/plugin-syntax-json-strings-7.8.3.tgz",
      "integrity": "sha512-lY6kdGpWHvjoe2vk4WrAapEuBR69EMxZl+RoGRhrFGNYVK8mOPAW8VfbT/ZgrFbXlDNiiaxQnAtgVCZ6jv30EA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-jsx": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-jsx/-/plugin-syntax-jsx-7.27.1.tgz",
      "integrity": "sha512-y8YTNIeKoyhGd9O0Jiyzyyqk8gdjnumGTQPsz0xOZOQ2RmkVJeZ1vmmfIvFEKqucBG6axJGBZDE/7iI5suUI/w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-logical-assignment-operators": {
      "version": "7.10.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-logical-assignment-operators/-/plugin-syntax-logical-assignment-operators-7.10.4.tgz",
      "integrity": "sha512-d8waShlpFDinQ5MtvGU9xDAOzKH47+FFoney2baFIoMr952hKOLp1HR7VszoZvOsV/4+RRszNY7D17ba0te0ig==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.10.4"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-nullish-coalescing-operator": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-nullish-coalescing-operator/-/plugin-syntax-nullish-coalescing-operator-7.8.3.tgz",
      "integrity": "sha512-aSff4zPII1u2QD7y+F8oDsz19ew4IGEJg9SVW+bqwpwtfFleiQDMdzA/R+UlWDzfnHFCxxleFT0PMIrR36XLNQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-numeric-separator": {
      "version": "7.10.4",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-numeric-separator/-/plugin-syntax-numeric-separator-7.10.4.tgz",
      "integrity": "sha512-9H6YdfkcK/uOnY/K7/aA2xpzaAgkQn37yzWUMRK7OaPOqOpGS1+n0H5hxT9AUw9EsSjPW8SVyMJwYRtWs3X3ug==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.10.4"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-object-rest-spread": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-object-rest-spread/-/plugin-syntax-object-rest-spread-7.8.3.tgz",
      "integrity": "sha512-XoqMijGZb9y3y2XskN+P1wUGiVwWZ5JmoDRwx5+3GmEplNyVM2s2Dg8ILFQm8rWM48orGy5YpI5Bl8U1y7ydlA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-optional-catch-binding": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-optional-catch-binding/-/plugin-syntax-optional-catch-binding-7.8.3.tgz",
      "integrity": "sha512-6VPD0Pc1lpTqw0aKoeRTMiB+kWhAoT24PA+ksWSBrFtl5SIRVpZlwN3NNPQjehA2E/91FV3RjLWoVTglWcSV3Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-optional-chaining": {
      "version": "7.8.3",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-optional-chaining/-/plugin-syntax-optional-chaining-7.8.3.tgz",
      "integrity": "sha512-KoK9ErH1MBlCPxV0VANkXW2/dw4vlbGDrFgz8bmUsBGYkFRcbRwMh6cIJubdPrkxRwuGdtCk0v/wPTKbQgBjkg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.8.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-private-property-in-object": {
      "version": "7.14.5",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-private-property-in-object/-/plugin-syntax-private-property-in-object-7.14.5.tgz",
      "integrity": "sha512-0wVnp9dxJ72ZUJDV27ZfbSj6iHLoytYZmh3rFcxNnvsJF3ktkzLDZPy/mA17HGsaQT3/DQsWYX1f1QGWkCoVUg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.14.5"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-top-level-await": {
      "version": "7.14.5",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-top-level-await/-/plugin-syntax-top-level-await-7.14.5.tgz",
      "integrity": "sha512-hx++upLv5U1rgYfwe1xBQUhRmU41NEvpUvrp8jkrSCdvGSnM5/qdRMtylJ6PG5OFkBaHkbTAKTnd3/YyESRHFw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.14.5"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-syntax-typescript": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-typescript/-/plugin-syntax-typescript-7.27.1.tgz",
      "integrity": "sha512-xfYCBMxveHrRMnAWl1ZlPXOZjzkN82THFvLhQhFXFt81Z5HnN+EtUkZhv/zcKpmT3fzmWZB0ywiBrbC3vogbwQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.27.2.tgz",
      "integrity": "sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/parser": "^7.27.2",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.5.tgz",
      "integrity": "sha512-TCCj4t55U90khlYkVV/0TfkJkAkUg3jZFA3Neb7unZT8CPok7iiRfaX0F+WnqWqt7OxhOn0uBKXCw4lbL8W0aQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.5",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/@babel/traverse/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@babel/types": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.5.tgz",
      "integrity": "sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@bcoe/v8-coverage": {
      "version": "0.2.3",
      "resolved": "https://registry.npmjs.org/@bcoe/v8-coverage/-/v8-coverage-0.2.3.tgz",
      "integrity": "sha512-0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@emnapi/core": {
      "version": "1.7.1",
      "resolved": "https://registry.npmjs.org/@emnapi/core/-/core-1.7.1.tgz",
      "integrity": "sha512-o1uhUASyo921r2XtHYOHy7gdkGLge8ghBEQHMWmyJFoXlpU58kIrhhN3w26lpQb6dspetweapMn2CSNwQ8I4wg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "dependencies": {
        "@emnapi/wasi-threads": "1.1.0",
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/runtime": {
      "version": "1.7.1",
      "resolved": "https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.7.1.tgz",
      "integrity": "sha512-PVtJr5CmLwYAU9PZDMITZoR5iAOShYREoR45EyyLrbntV50mdePTgUn4AmOw90Ifcj+x2kRjdzr1HP3RrNiHGA==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/wasi-threads": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@emnapi/wasi-threads/-/wasi-threads-1.1.0.tgz",
      "integrity": "sha512-WI0DdZ8xFSbgMjR1sFsKABJ/C5OnRrjT06JXbZKexJGrDuPTzZdDYfFlsgcCXCyf+suG5QU2e/y1Wo2V/OapLQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@fastify/busboy": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/@fastify/busboy/-/busboy-3.2.0.tgz",
      "integrity": "sha512-m9FVDXU3GT2ITSe0UaMA5rU3QkfC/UXtCU8y0gSN/GugTqtVldOBWIB5V6V3sbmenVZUIpU6f+mPEO2+m5iTaA==",
      "license": "MIT"
    },
    "node_modules/@firebase/app-check-interop-types": {
      "version": "0.3.3",
      "resolved": "https://registry.npmjs.org/@firebase/app-check-interop-types/-/app-check-interop-types-0.3.3.tgz",
      "integrity": "sha512-gAlxfPLT2j8bTI/qfe3ahl2I2YcBQ8cFIBdhAQA4I2f3TndcO+22YizyGYuttLHPQEpWkhmpFW60VCFEPg4g5A==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/app-types": {
      "version": "0.9.3",
      "resolved": "https://registry.npmjs.org/@firebase/app-types/-/app-types-0.9.3.tgz",
      "integrity": "sha512-kRVpIl4vVGJ4baogMDINbyrIOtOxqhkZQg4jTq3l8Lw6WSk0xfpEYzezFu+Kl4ve4fbPl79dvwRtaFqAC/ucCw==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/auth-interop-types": {
      "version": "0.2.4",
      "resolved": "https://registry.npmjs.org/@firebase/auth-interop-types/-/auth-interop-types-0.2.4.tgz",
      "integrity": "sha512-JPgcXKCuO+CWqGDnigBtvo09HeBs5u/Ktc2GaFj2m01hLarbxthLNm7Fk8iOP1aqAtXV+fnnGj7U28xmk7IwVA==",
      "license": "Apache-2.0"
    },
    "node_modules/@firebase/component": {
      "version": "0.7.0",
      "resolved": "https://registry.npmjs.org/@firebase/component/-/component-0.7.0.tgz",
      "integrity": "sha512-wR9En2A+WESUHexjmRHkqtaVH94WLNKt6rmeqZhSLBybg4Wyf0Umk04SZsS6sBq4102ZsDBFwoqMqJYj2IoDSg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/database": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@firebase/database/-/database-1.1.0.tgz",
      "integrity": "sha512-gM6MJFae3pTyNLoc9VcJNuaUDej0ctdjn3cVtILo3D5lpp0dmUHHLFN/pUKe7ImyeB1KAvRlEYxvIHNF04Filg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-check-interop-types": "0.3.3",
        "@firebase/auth-interop-types": "0.2.4",
        "@firebase/component": "0.7.0",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "faye-websocket": "0.11.4",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/database-compat": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/@firebase/database-compat/-/database-compat-2.1.0.tgz",
      "integrity": "sha512-8nYc43RqxScsePVd1qe1xxvWNf0OBnbwHxmXJ7MHSuuTVYFO3eLyLW3PiCKJ9fHnmIz4p4LbieXwz+qtr9PZDg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/component": "0.7.0",
        "@firebase/database": "1.1.0",
        "@firebase/database-types": "1.0.16",
        "@firebase/logger": "0.5.0",
        "@firebase/util": "1.13.0",
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/database-types": {
      "version": "1.0.16",
      "resolved": "https://registry.npmjs.org/@firebase/database-types/-/database-types-1.0.16.tgz",
      "integrity": "sha512-xkQLQfU5De7+SPhEGAXFBnDryUWhhlFXelEg2YeZOQMCdoe7dL64DDAd77SQsR+6uoXIZY5MB4y/inCs4GTfcw==",
      "license": "Apache-2.0",
      "dependencies": {
        "@firebase/app-types": "0.9.3",
        "@firebase/util": "1.13.0"
      }
    },
    "node_modules/@firebase/logger": {
      "version": "0.5.0",
      "resolved": "https://registry.npmjs.org/@firebase/logger/-/logger-0.5.0.tgz",
      "integrity": "sha512-cGskaAvkrnh42b3BA3doDWeBmuHFO/Mx5A83rbRDYakPjO9bJtRL3dX7javzc2Rr/JHZf4HlterTW2lUkfeN4g==",
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@firebase/util": {
      "version": "1.13.0",
      "resolved": "https://registry.npmjs.org/@firebase/util/-/util-1.13.0.tgz",
      "integrity": "sha512-0AZUyYUfpMNcztR5l09izHwXkZpghLgCUaAGjtMwXnCg3bj4ml5VgiwqOMOxJ+Nw4qN/zJAaOQBcJ7KGkWStqQ==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.1.0"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@google-cloud/firestore": {
      "version": "7.11.6",
      "resolved": "https://registry.npmjs.org/@google-cloud/firestore/-/firestore-7.11.6.tgz",
      "integrity": "sha512-EW/O8ktzwLfyWBOsNuhRoMi8lrC3clHM5LVFhGvO1HCsLozCOOXRAlHrYBoE6HL42Sc8yYMuCb2XqcnJ4OOEpw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@opentelemetry/api": "^1.3.0",
        "fast-deep-equal": "^3.1.1",
        "functional-red-black-tree": "^1.0.1",
        "google-gax": "^4.3.3",
        "protobufjs": "^7.2.6"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@google-cloud/paginator": {
      "version": "5.0.2",
      "resolved": "https://registry.npmjs.org/@google-cloud/paginator/-/paginator-5.0.2.tgz",
      "integrity": "sha512-DJS3s0OVH4zFDB1PzjxAsHqJT6sKVbRwwML0ZBP9PbU7Yebtu/7SWMRzvO2J3nUi9pRNITCfu4LJeooM2w4pjg==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "arrify": "^2.0.0",
        "extend": "^3.0.2"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@google-cloud/projectify": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/@google-cloud/projectify/-/projectify-4.0.0.tgz",
      "integrity": "sha512-MmaX6HeSvyPbWGwFq7mXdo0uQZLGBYCwziiLIGq5JVX+/bdI3SAq6bP98trV5eTWfLuvsMcIC1YJOF2vfteLFA==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@google-cloud/promisify": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/@google-cloud/promisify/-/promisify-4.0.0.tgz",
      "integrity": "sha512-Orxzlfb9c67A15cq2JQEyVc7wEsmFBmHjZWZYQMUyJ1qivXyMwdyNOs9odi79hze+2zqdTtu1E19IM/FtqZ10g==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@google-cloud/storage": {
      "version": "7.18.0",
      "resolved": "https://registry.npmjs.org/@google-cloud/storage/-/storage-7.18.0.tgz",
      "integrity": "sha512-r3ZwDMiz4nwW6R922Z1pwpePxyRwE5GdevYX63hRmAQUkUQJcBH/79EnQPDv5cOv1mFBgevdNWQfi3tie3dHrQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@google-cloud/paginator": "^5.0.0",
        "@google-cloud/projectify": "^4.0.0",
        "@google-cloud/promisify": "<4.1.0",
        "abort-controller": "^3.0.0",
        "async-retry": "^1.3.3",
        "duplexify": "^4.1.3",
        "fast-xml-parser": "^4.4.1",
        "gaxios": "^6.0.2",
        "google-auth-library": "^9.6.3",
        "html-entities": "^2.5.2",
        "mime": "^3.0.0",
        "p-limit": "^3.0.1",
        "retry-request": "^7.0.0",
        "teeny-request": "^9.0.0",
        "uuid": "^8.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@google-cloud/storage/node_modules/uuid": {
      "version": "8.3.2",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-8.3.2.tgz",
      "integrity": "sha512-+NYs2QeMWy+GWFOEm9xnn6HCDp0l7QBD7ml8zLUmJ+93Q5NF0NocErnwkTkXVFNiX3/fpC6afS8Dhb/gz7R7eg==",
      "license": "MIT",
      "optional": true,
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/@grpc/grpc-js": {
      "version": "1.14.3",
      "resolved": "https://registry.npmjs.org/@grpc/grpc-js/-/grpc-js-1.14.3.tgz",
      "integrity": "sha512-Iq8QQQ/7X3Sac15oB6p0FmUg/klxQvXLeileoqrTRGJYLV+/9tubbr9ipz0GKHjmXVsgFPo/+W+2cA8eNcR+XA==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@grpc/proto-loader": "^0.8.0",
        "@js-sdsl/ordered-map": "^4.4.2"
      },
      "engines": {
        "node": ">=12.10.0"
      }
    },
    "node_modules/@grpc/grpc-js/node_modules/@grpc/proto-loader": {
      "version": "0.8.0",
      "resolved": "https://registry.npmjs.org/@grpc/proto-loader/-/proto-loader-0.8.0.tgz",
      "integrity": "sha512-rc1hOQtjIWGxcxpb9aHAfLpIctjEnsDehj0DAiVfBlmT84uvR0uUtN2hEi/ecvWVjXUGf5qPF4qEgiLOx1YIMQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "lodash.camelcase": "^4.3.0",
        "long": "^5.0.0",
        "protobufjs": "^7.5.3",
        "yargs": "^17.7.2"
      },
      "bin": {
        "proto-loader-gen-types": "build/bin/proto-loader-gen-types.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/@grpc/proto-loader": {
      "version": "0.7.15",
      "resolved": "https://registry.npmjs.org/@grpc/proto-loader/-/proto-loader-0.7.15.tgz",
      "integrity": "sha512-tMXdRCfYVixjuFK+Hk0Q1s38gV9zDiDJfWL3h1rv4Qc39oILCu1TRTDt7+fGUI8K4G1Fj125Hx/ru3azECWTyQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "lodash.camelcase": "^4.3.0",
        "long": "^5.0.0",
        "protobufjs": "^7.2.5",
        "yargs": "^17.7.2"
      },
      "bin": {
        "proto-loader-gen-types": "build/bin/proto-loader-gen-types.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/@isaacs/cliui": {
      "version": "8.0.2",
      "resolved": "https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz",
      "integrity": "sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "string-width": "^5.1.2",
        "string-width-cjs": "npm:string-width@^4.2.0",
        "strip-ansi": "^7.0.1",
        "strip-ansi-cjs": "npm:strip-ansi@^6.0.1",
        "wrap-ansi": "^8.1.0",
        "wrap-ansi-cjs": "npm:wrap-ansi@^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@istanbuljs/load-nyc-config": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@istanbuljs/load-nyc-config/-/load-nyc-config-1.1.0.tgz",
      "integrity": "sha512-VjeHSlIzpv/NyD3N0YuHfXOPDIixcA1q2ZV98wsMqcYlPmv2n3Yb2lYP9XMElnaFVXg5A7YLTeLu6V84uQDjmQ==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "camelcase": "^5.3.1",
        "find-up": "^4.1.0",
        "get-package-type": "^0.1.0",
        "js-yaml": "^3.13.1",
        "resolve-from": "^5.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@istanbuljs/schema": {
      "version": "0.1.3",
      "resolved": "https://registry.npmjs.org/@istanbuljs/schema/-/schema-0.1.3.tgz",
      "integrity": "sha512-ZXRY4jNvVgSVQ8DL3LTcakaAtXwTVUxE81hslsyD2AtoXW/wVob10HkOJ1X/pAlcI7D+2YoZKg5do8G/w6RYgA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/@jest/console": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/console/-/console-30.2.0.tgz",
      "integrity": "sha512-+O1ifRjkvYIkBqASKWgLxrpEhQAAE7hY77ALLUufSk5717KfOShg6IbqLmdsLMPdUiFvA2kTs0R7YZy+l0IzZQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "chalk": "^4.1.2",
        "jest-message-util": "30.2.0",
        "jest-util": "30.2.0",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/core": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/core/-/core-30.2.0.tgz",
      "integrity": "sha512-03W6IhuhjqTlpzh/ojut/pDB2LPRygyWX8ExpgHtQA8H/3K7+1vKmcINx5UzeOX1se6YEsBsOHQ1CRzf3fOwTQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/console": "30.2.0",
        "@jest/pattern": "30.0.1",
        "@jest/reporters": "30.2.0",
        "@jest/test-result": "30.2.0",
        "@jest/transform": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "ansi-escapes": "^4.3.2",
        "chalk": "^4.1.2",
        "ci-info": "^4.2.0",
        "exit-x": "^0.2.2",
        "graceful-fs": "^4.2.11",
        "jest-changed-files": "30.2.0",
        "jest-config": "30.2.0",
        "jest-haste-map": "30.2.0",
        "jest-message-util": "30.2.0",
        "jest-regex-util": "30.0.1",
        "jest-resolve": "30.2.0",
        "jest-resolve-dependencies": "30.2.0",
        "jest-runner": "30.2.0",
        "jest-runtime": "30.2.0",
        "jest-snapshot": "30.2.0",
        "jest-util": "30.2.0",
        "jest-validate": "30.2.0",
        "jest-watcher": "30.2.0",
        "micromatch": "^4.0.8",
        "pretty-format": "30.2.0",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/@jest/diff-sequences": {
      "version": "30.0.1",
      "resolved": "https://registry.npmjs.org/@jest/diff-sequences/-/diff-sequences-30.0.1.tgz",
      "integrity": "sha512-n5H8QLDJ47QqbCNn5SuFjCRDrOLEZ0h8vAHCK5RL9Ls7Xa8AQLa/YxAc9UjFqoEDM48muwtBGjtMY5cr0PLDCw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/environment": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/environment/-/environment-30.2.0.tgz",
      "integrity": "sha512-/QPTL7OBJQ5ac09UDRa3EQes4gt1FTEG/8jZ/4v5IVzx+Cv7dLxlVIvfvSVRiiX2drWyXeBjkMSR8hvOWSog5g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/fake-timers": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "jest-mock": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/expect": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/expect/-/expect-30.2.0.tgz",
      "integrity": "sha512-V9yxQK5erfzx99Sf+7LbhBwNWEZ9eZay8qQ9+JSC0TrMR1pMDHLMY+BnVPacWU6Jamrh252/IKo4F1Xn/zfiqA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "expect": "30.2.0",
        "jest-snapshot": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/expect-utils": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/expect-utils/-/expect-utils-30.2.0.tgz",
      "integrity": "sha512-1JnRfhqpD8HGpOmQp180Fo9Zt69zNtC+9lR+kT7NVL05tNXIi+QC8Csz7lfidMoVLPD3FnOtcmp0CEFnxExGEA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/get-type": "30.1.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/fake-timers": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/fake-timers/-/fake-timers-30.2.0.tgz",
      "integrity": "sha512-HI3tRLjRxAbBy0VO8dqqm7Hb2mIa8d5bg/NJkyQcOk7V118ObQML8RC5luTF/Zsg4474a+gDvhce7eTnP4GhYw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/types": "30.2.0",
        "@sinonjs/fake-timers": "^13.0.0",
        "@types/node": "*",
        "jest-message-util": "30.2.0",
        "jest-mock": "30.2.0",
        "jest-util": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/get-type": {
      "version": "30.1.0",
      "resolved": "https://registry.npmjs.org/@jest/get-type/-/get-type-30.1.0.tgz",
      "integrity": "sha512-eMbZE2hUnx1WV0pmURZY9XoXPkUYjpc55mb0CrhtdWLtzMQPFvu/rZkTLZFTsdaVQa+Tr4eWAteqcUzoawq/uA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/globals": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/globals/-/globals-30.2.0.tgz",
      "integrity": "sha512-b63wmnKPaK+6ZZfpYhz9K61oybvbI1aMcIs80++JI1O1rR1vaxHUCNqo3ITu6NU0d4V34yZFoHMn/uoKr/Rwfw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/environment": "30.2.0",
        "@jest/expect": "30.2.0",
        "@jest/types": "30.2.0",
        "jest-mock": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/pattern": {
      "version": "30.0.1",
      "resolved": "https://registry.npmjs.org/@jest/pattern/-/pattern-30.0.1.tgz",
      "integrity": "sha512-gWp7NfQW27LaBQz3TITS8L7ZCQ0TLvtmI//4OwlQRx4rnWxcPNIYjxZpDcN4+UlGxgm3jS5QPz8IPTCkb59wZA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@types/node": "*",
        "jest-regex-util": "30.0.1"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/reporters": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/reporters/-/reporters-30.2.0.tgz",
      "integrity": "sha512-DRyW6baWPqKMa9CzeiBjHwjd8XeAyco2Vt8XbcLFjiwCOEKOvy82GJ8QQnJE9ofsxCMPjH4MfH8fCWIHHDKpAQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@bcoe/v8-coverage": "^0.2.3",
        "@jest/console": "30.2.0",
        "@jest/test-result": "30.2.0",
        "@jest/transform": "30.2.0",
        "@jest/types": "30.2.0",
        "@jridgewell/trace-mapping": "^0.3.25",
        "@types/node": "*",
        "chalk": "^4.1.2",
        "collect-v8-coverage": "^1.0.2",
        "exit-x": "^0.2.2",
        "glob": "^10.3.10",
        "graceful-fs": "^4.2.11",
        "istanbul-lib-coverage": "^3.0.0",
        "istanbul-lib-instrument": "^6.0.0",
        "istanbul-lib-report": "^3.0.0",
        "istanbul-lib-source-maps": "^5.0.0",
        "istanbul-reports": "^3.1.3",
        "jest-message-util": "30.2.0",
        "jest-util": "30.2.0",
        "jest-worker": "30.2.0",
        "slash": "^3.0.0",
        "string-length": "^4.0.2",
        "v8-to-istanbul": "^9.0.1"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/@jest/schemas": {
      "version": "30.0.5",
      "resolved": "https://registry.npmjs.org/@jest/schemas/-/schemas-30.0.5.tgz",
      "integrity": "sha512-DmdYgtezMkh3cpU8/1uyXakv3tJRcmcXxBOcO0tbaozPwpmh4YMsnWrQm9ZmZMfa5ocbxzbFk6O4bDPEc/iAnA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@sinclair/typebox": "^0.34.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/snapshot-utils": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/snapshot-utils/-/snapshot-utils-30.2.0.tgz",
      "integrity": "sha512-0aVxM3RH6DaiLcjj/b0KrIBZhSX1373Xci4l3cW5xiUWPctZ59zQ7jj4rqcJQ/Z8JuN/4wX3FpJSa3RssVvCug==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/types": "30.2.0",
        "chalk": "^4.1.2",
        "graceful-fs": "^4.2.11",
        "natural-compare": "^1.4.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/source-map": {
      "version": "30.0.1",
      "resolved": "https://registry.npmjs.org/@jest/source-map/-/source-map-30.0.1.tgz",
      "integrity": "sha512-MIRWMUUR3sdbP36oyNyhbThLHyJ2eEDClPCiHVbrYAe5g3CHRArIVpBw7cdSB5fr+ofSfIb2Tnsw8iEHL0PYQg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jridgewell/trace-mapping": "^0.3.25",
        "callsites": "^3.1.0",
        "graceful-fs": "^4.2.11"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/test-result": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/test-result/-/test-result-30.2.0.tgz",
      "integrity": "sha512-RF+Z+0CCHkARz5HT9mcQCBulb1wgCP3FBvl9VFokMX27acKphwyQsNuWH3c+ojd1LeWBLoTYoxF0zm6S/66mjg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/console": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/istanbul-lib-coverage": "^2.0.6",
        "collect-v8-coverage": "^1.0.2"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/test-sequencer": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/test-sequencer/-/test-sequencer-30.2.0.tgz",
      "integrity": "sha512-wXKgU/lk8fKXMu/l5Hog1R61bL4q5GCdT6OJvdAFz1P+QrpoFuLU68eoKuVc4RbrTtNnTL5FByhWdLgOPSph+Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/test-result": "30.2.0",
        "graceful-fs": "^4.2.11",
        "jest-haste-map": "30.2.0",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/transform": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/transform/-/transform-30.2.0.tgz",
      "integrity": "sha512-XsauDV82o5qXbhalKxD7p4TZYYdwcaEXC77PPD2HixEFF+6YGppjrAAQurTl2ECWcEomHBMMNS9AH3kcCFx8jA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/core": "^7.27.4",
        "@jest/types": "30.2.0",
        "@jridgewell/trace-mapping": "^0.3.25",
        "babel-plugin-istanbul": "^7.0.1",
        "chalk": "^4.1.2",
        "convert-source-map": "^2.0.0",
        "fast-json-stable-stringify": "^2.1.0",
        "graceful-fs": "^4.2.11",
        "jest-haste-map": "30.2.0",
        "jest-regex-util": "30.0.1",
        "jest-util": "30.2.0",
        "micromatch": "^4.0.8",
        "pirates": "^4.0.7",
        "slash": "^3.0.0",
        "write-file-atomic": "^5.0.1"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jest/types": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/@jest/types/-/types-30.2.0.tgz",
      "integrity": "sha512-H9xg1/sfVvyfU7o3zMfBEjQ1gcsdeTMgqHoYdN79tuLqfTtuu7WckRA1R5whDwOzxaZAeMKTYWqP+WCAi0CHsg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/pattern": "30.0.1",
        "@jest/schemas": "30.0.5",
        "@types/istanbul-lib-coverage": "^2.0.6",
        "@types/istanbul-reports": "^3.0.4",
        "@types/node": "*",
        "@types/yargs": "^17.0.33",
        "chalk": "^4.1.2"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@js-sdsl/ordered-map": {
      "version": "4.4.2",
      "resolved": "https://registry.npmjs.org/@js-sdsl/ordered-map/-/ordered-map-4.4.2.tgz",
      "integrity": "sha512-iUKgm52T8HOE/makSxjqoWhe95ZJA1/G1sYsGev2JDKUSS14KAgg1LHb+Ba+IPow0xflbnSkOsZcO08C7w1gYw==",
      "license": "MIT",
      "optional": true,
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/js-sdsl"
      }
    },
    "node_modules/@napi-rs/wasm-runtime": {
      "version": "0.2.12",
      "resolved": "https://registry.npmjs.org/@napi-rs/wasm-runtime/-/wasm-runtime-0.2.12.tgz",
      "integrity": "sha512-ZVWUcfwY4E/yPitQJl481FjFo3K22D6qF0DuFH6Y/nbnE11GY5uguDxZMGXPQ8WQ0128MXQD7TnfHyK4oWoIJQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "dependencies": {
        "@emnapi/core": "^1.4.3",
        "@emnapi/runtime": "^1.4.3",
        "@tybys/wasm-util": "^0.10.0"
      }
    },
    "node_modules/@opentelemetry/api": {
      "version": "1.9.0",
      "resolved": "https://registry.npmjs.org/@opentelemetry/api/-/api-1.9.0.tgz",
      "integrity": "sha512-3giAOQvZiH5F9bMlMiv8+GSPMeqg0dbaeo58/0SlA9sxSqZhnUtxzX9/2FzyhS9sWQf5S0GJE0AKBrFqjpeYcg==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "node": ">=8.0.0"
      }
    },
    "node_modules/@pkgjs/parseargs": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz",
      "integrity": "sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@pkgr/core": {
      "version": "0.2.9",
      "resolved": "https://registry.npmjs.org/@pkgr/core/-/core-0.2.9.tgz",
      "integrity": "sha512-QNqXyfVS2wm9hweSYD2O7F0G06uurj9kZ96TRQE5Y9hU7+tgdZwIkbAKc5Ocy1HxEY2kuDQa6cQ1WRs/O5LFKA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": "^12.20.0 || ^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/pkgr"
      }
    },
    "node_modules/@protobufjs/aspromise": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/aspromise/-/aspromise-1.1.2.tgz",
      "integrity": "sha512-j+gKExEuLmKwvz3OgROXtrJ2UG2x8Ch2YZUxahh+s1F2HZ+wAceUNLkvy6zKCPVRkU++ZWQrdxsUeQXmcg4uoQ==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/base64": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/base64/-/base64-1.1.2.tgz",
      "integrity": "sha512-AZkcAA5vnN/v4PDqKyMR5lx7hZttPDgClv83E//FMNhR2TMcLUhfRUBHCmSl0oi9zMgDDqRUJkSxO3wm85+XLg==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/codegen": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/@protobufjs/codegen/-/codegen-2.0.4.tgz",
      "integrity": "sha512-YyFaikqM5sH0ziFZCN3xDC7zeGaB/d0IUb9CATugHWbd1FRFwWwt4ld4OYMPWu5a3Xe01mGAULCdqhMlPl29Jg==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/eventemitter": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/eventemitter/-/eventemitter-1.1.0.tgz",
      "integrity": "sha512-j9ednRT81vYJ9OfVuXG6ERSTdEL1xVsNgqpkxMsbIabzSo3goCjDIveeGv5d03om39ML71RdmrGNjG5SReBP/Q==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/fetch": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/fetch/-/fetch-1.1.0.tgz",
      "integrity": "sha512-lljVXpqXebpsijW71PZaCYeIcE5on1w5DlQy5WH6GLbFryLUrBD4932W/E2BSpfRJWseIL4v/KPgBFxDOIdKpQ==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "@protobufjs/aspromise": "^1.1.1",
        "@protobufjs/inquire": "^1.1.0"
      }
    },
    "node_modules/@protobufjs/float": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/float/-/float-1.0.2.tgz",
      "integrity": "sha512-Ddb+kVXlXst9d+R9PfTIxh1EdNkgoRe5tOX6t01f1lYWOvJnSPDBlG241QLzcyPdoNTsblLUdujGSE4RzrTZGQ==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/inquire": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/inquire/-/inquire-1.1.0.tgz",
      "integrity": "sha512-kdSefcPdruJiFMVSbn801t4vFK7KB/5gd2fYvrxhuJYg8ILrmn9SKSX2tZdV6V+ksulWqS7aXjBcRXl3wHoD9Q==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/path": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@protobufjs/path/-/path-1.1.2.tgz",
      "integrity": "sha512-6JOcJ5Tm08dOHAbdR3GrvP+yUUfkjG5ePsHYczMFLq3ZmMkAD98cDgcT2iA1lJ9NVwFd4tH/iSSoe44YWkltEA==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/pool": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/pool/-/pool-1.1.0.tgz",
      "integrity": "sha512-0kELaGSIDBKvcgS4zkjz1PeddatrjYcmMWOlAuAPwAeccUrPHdUqo/J6LiymHHEiJT5NrF1UVwxY14f+fy4WQw==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@protobufjs/utf8": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@protobufjs/utf8/-/utf8-1.1.0.tgz",
      "integrity": "sha512-Vvn3zZrhQZkkBE8LSuW3em98c0FwgO4nxzv6OdSxPKJIEKY2bGbHn+mhGIPerzI4twdxaP8/0+06HBpwf345Lw==",
      "license": "BSD-3-Clause"
    },
    "node_modules/@puppeteer/browsers": {
      "version": "2.11.0",
      "resolved": "https://registry.npmjs.org/@puppeteer/browsers/-/browsers-2.11.0.tgz",
      "integrity": "sha512-n6oQX6mYkG8TRPuPXmbPidkUbsSRalhmaaVAQxvH1IkQy63cwsH+kOjB3e4cpCDHg0aSvsiX9bQ4s2VB6mGWUQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "debug": "^4.4.3",
        "extract-zip": "^2.0.1",
        "progress": "^2.0.3",
        "proxy-agent": "^6.5.0",
        "semver": "^7.7.3",
        "tar-fs": "^3.1.1",
        "yargs": "^17.7.2"
      },
      "bin": {
        "browsers": "lib/cjs/main-cli.js"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@puppeteer/browsers/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/@puppeteer/browsers/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/@puppeteer/browsers/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/@sinclair/typebox": {
      "version": "0.34.41",
      "resolved": "https://registry.npmjs.org/@sinclair/typebox/-/typebox-0.34.41.tgz",
      "integrity": "sha512-6gS8pZzSXdyRHTIqoqSVknxolr1kzfy4/CeDnrzsVz8TTIWUbOBr6gnzOmTYJ3eXQNh4IYHIGi5aIL7sOZ2G/g==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@sinonjs/commons": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/@sinonjs/commons/-/commons-3.0.1.tgz",
      "integrity": "sha512-K3mCHKQ9sVh8o1C9cxkwxaOmXoAMlDxC1mYyHrjqOWEcBjYr76t96zL2zlj5dUGZ3HSw240X1qgH3Mjf1yJWpQ==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "type-detect": "4.0.8"
      }
    },
    "node_modules/@sinonjs/fake-timers": {
      "version": "13.0.5",
      "resolved": "https://registry.npmjs.org/@sinonjs/fake-timers/-/fake-timers-13.0.5.tgz",
      "integrity": "sha512-36/hTbH2uaWuGVERyC6da9YwGWnzUZXuPro/F2LfsdOsLnCojz/iSH8MxUt/FD2S5XBSVPhmArFUXcpCQ2Hkiw==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "@sinonjs/commons": "^3.0.1"
      }
    },
    "node_modules/@sparticuz/chromium": {
      "version": "143.0.0",
      "resolved": "https://registry.npmjs.org/@sparticuz/chromium/-/chromium-143.0.0.tgz",
      "integrity": "sha512-/vvplFwu1yDNt/Q1uwXQUwxmfZutU9K+WtzSYwptLWV8IeSdSF6vwW9hW11fZA8Gl9+2mytAGUe6/otgd2VeXA==",
      "license": "MIT",
      "dependencies": {
        "follow-redirects": "^1.15.11",
        "tar-fs": "^3.1.1"
      },
      "engines": {
        "node": ">=20.11.0"
      }
    },
    "node_modules/@tootallnate/once": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@tootallnate/once/-/once-2.0.0.tgz",
      "integrity": "sha512-XCuKFP5PS55gnMVu3dty8KPatLqUoy/ZYzDzAGCQ8JNFCkLXzmI7vNHCR+XpbZaMWQK/vQubr7PkYq8g470J/A==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tootallnate/quickjs-emscripten": {
      "version": "0.23.0",
      "resolved": "https://registry.npmjs.org/@tootallnate/quickjs-emscripten/-/quickjs-emscripten-0.23.0.tgz",
      "integrity": "sha512-C5Mc6rdnsaJDjO3UpGW/CQTHtCKaYlScZTly4JIu97Jxo/odCiH0ITnDXSJPTOrEKk/ycSZ0AOgTmkDtkOsvIA==",
      "license": "MIT"
    },
    "node_modules/@tybys/wasm-util": {
      "version": "0.10.1",
      "resolved": "https://registry.npmjs.org/@tybys/wasm-util/-/wasm-util-0.10.1.tgz",
      "integrity": "sha512-9tTaPJLSiejZKx+Bmog4uSubteqTvFrVrURwkmHixBo0G4seD0zUxp98E1DzUBJxLQ3NPwXrGKDiVjwx/DpPsg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@types/babel__core": {
      "version": "7.20.5",
      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/parser": "^7.20.7",
        "@babel/types": "^7.20.7",
        "@types/babel__generator": "*",
        "@types/babel__template": "*",
        "@types/babel__traverse": "*"
      }
    },
    "node_modules/@types/babel__generator": {
      "version": "7.27.0",
      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__template": {
      "version": "7.4.4",
      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/parser": "^7.1.0",
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__traverse": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/types": "^7.28.2"
      }
    },
    "node_modules/@types/body-parser": {
      "version": "1.19.6",
      "resolved": "https://registry.npmjs.org/@types/body-parser/-/body-parser-1.19.6.tgz",
      "integrity": "sha512-HLFeCYgz89uk22N5Qg3dvGvsv46B8GLvKKo1zKG4NybA8U2DiEO3w9lqGg29t/tfLRJpJ6iQxnVw4OnB7MoM9g==",
      "license": "MIT",
      "dependencies": {
        "@types/connect": "*",
        "@types/node": "*"
      }
    },
    "node_modules/@types/caseless": {
      "version": "0.12.5",
      "resolved": "https://registry.npmjs.org/@types/caseless/-/caseless-0.12.5.tgz",
      "integrity": "sha512-hWtVTC2q7hc7xZ/RLbxapMvDMgUnDvKvMOpKal4DrMyfGBUfB1oKaZlIRr6mJL+If3bAP6sV/QneGzF6tJjZDg==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/@types/connect": {
      "version": "3.4.38",
      "resolved": "https://registry.npmjs.org/@types/connect/-/connect-3.4.38.tgz",
      "integrity": "sha512-K6uROf1LD88uDQqJCktA4yzL1YYAK6NgfsI0v/mTgyPKWsX1CnJ0XPSDhViejru1GcRkLWb8RlzFYJRqGUbaug==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/cors": {
      "version": "2.8.19",
      "resolved": "https://registry.npmjs.org/@types/cors/-/cors-2.8.19.tgz",
      "integrity": "sha512-mFNylyeyqN93lfe/9CSxOGREz8cpzAhH+E93xJ4xWQf62V8sQ/24reV2nyzUWM6H6Xji+GGHpkbLe7pVoUEskg==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/express": {
      "version": "4.17.25",
      "resolved": "https://registry.npmjs.org/@types/express/-/express-4.17.25.tgz",
      "integrity": "sha512-dVd04UKsfpINUnK0yBoYHDF3xu7xVH4BuDotC/xGuycx4CgbP48X/KF/586bcObxT0HENHXEU8Nqtu6NR+eKhw==",
      "license": "MIT",
      "dependencies": {
        "@types/body-parser": "*",
        "@types/express-serve-static-core": "^4.17.33",
        "@types/qs": "*",
        "@types/serve-static": "^1"
      }
    },
    "node_modules/@types/express-serve-static-core": {
      "version": "4.19.7",
      "resolved": "https://registry.npmjs.org/@types/express-serve-static-core/-/express-serve-static-core-4.19.7.tgz",
      "integrity": "sha512-FvPtiIf1LfhzsaIXhv/PHan/2FeQBbtBDtfX2QfvPxdUelMDEckK08SM6nqo1MIZY3RUlfA+HV8+hFUSio78qg==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*",
        "@types/qs": "*",
        "@types/range-parser": "*",
        "@types/send": "*"
      }
    },
    "node_modules/@types/http-errors": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@types/http-errors/-/http-errors-2.0.5.tgz",
      "integrity": "sha512-r8Tayk8HJnX0FztbZN7oVqGccWgw98T/0neJphO91KkmOzug1KkofZURD4UaD5uH8AqcFLfdPErnBod0u71/qg==",
      "license": "MIT"
    },
    "node_modules/@types/istanbul-lib-coverage": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/@types/istanbul-lib-coverage/-/istanbul-lib-coverage-2.0.6.tgz",
      "integrity": "sha512-2QF/t/auWm0lsy8XtKVPG19v3sSOQlJe/YHZgfjb/KBBHOGSV+J2q/S671rcq9uTBrLAXmZpqJiaQbMT+zNU1w==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@types/istanbul-lib-report": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@types/istanbul-lib-report/-/istanbul-lib-report-3.0.3.tgz",
      "integrity": "sha512-NQn7AHQnk/RSLOxrBbGyJM/aVQ+pjj5HCgasFxc0K/KhoATfQ/47AyUl15I2yBUpihjmas+a+VJBOqecrFH+uA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@types/istanbul-lib-coverage": "*"
      }
    },
    "node_modules/@types/istanbul-reports": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/istanbul-reports/-/istanbul-reports-3.0.4.tgz",
      "integrity": "sha512-pk2B1NWalF9toCRu6gjBzR69syFjP4Od8WRAX+0mmf9lAjCRicLOWc+ZrxZHx/0XRjotgkF9t6iaMJ+aXcOdZQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@types/istanbul-lib-report": "*"
      }
    },
    "node_modules/@types/jsonwebtoken": {
      "version": "9.0.10",
      "resolved": "https://registry.npmjs.org/@types/jsonwebtoken/-/jsonwebtoken-9.0.10.tgz",
      "integrity": "sha512-asx5hIG9Qmf/1oStypjanR7iKTv0gXQ1Ov/jfrX6kS/EO0OFni8orbmGCn0672NHR3kXHwpAwR+B368ZGN/2rA==",
      "license": "MIT",
      "dependencies": {
        "@types/ms": "*",
        "@types/node": "*"
      }
    },
    "node_modules/@types/lodash": {
      "version": "4.17.21",
      "resolved": "https://registry.npmjs.org/@types/lodash/-/lodash-4.17.21.tgz",
      "integrity": "sha512-FOvQ0YPD5NOfPgMzJihoT+Za5pdkDJWcbpuj1DjaKZIr/gxodQjY/uWEFlTNqW2ugXHUiL8lRQgw63dzKHZdeQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/long": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/@types/long/-/long-4.0.2.tgz",
      "integrity": "sha512-MqTGEo5bj5t157U6fA/BiDynNkn0YknVdh48CMPkTSpFTVmvao5UQmm7uEF6xBEo7qIMAlY/JSleYaE6VOdpaA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/@types/mime": {
      "version": "1.3.5",
      "resolved": "https://registry.npmjs.org/@types/mime/-/mime-1.3.5.tgz",
      "integrity": "sha512-/pyBZWSLD2n0dcHE3hq8s8ZvcETHtEuF+3E7XVt0Ig2nvsVQXdghHVcEkIWjy9A0wKfTn97a/PSDYohKIlnP/w==",
      "license": "MIT"
    },
    "node_modules/@types/ms": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
      "license": "MIT"
    },
    "node_modules/@types/node": {
      "version": "22.19.3",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-22.19.3.tgz",
      "integrity": "sha512-1N9SBnWYOJTrNZCdh/yJE+t910Y128BoyY+zBLWhL3r0TYzlTmFdXrPwHL9DyFZmlEXNQQolTZh3KHV31QDhyA==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~6.21.0"
      }
    },
    "node_modules/@types/puppeteer": {
      "version": "5.4.7",
      "resolved": "https://registry.npmjs.org/@types/puppeteer/-/puppeteer-5.4.7.tgz",
      "integrity": "sha512-JdGWZZYL0vKapXF4oQTC5hLVNfOgdPrqeZ1BiQnGk5cB7HeE91EWUiTdVSdQPobRN8rIcdffjiOgCYJ/S8QrnQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/qs": {
      "version": "6.14.0",
      "resolved": "https://registry.npmjs.org/@types/qs/-/qs-6.14.0.tgz",
      "integrity": "sha512-eOunJqu0K1923aExK6y8p6fsihYEn/BYuQ4g0CxAAgFc4b/ZLN4CrsRZ55srTdqoiLzU2B2evC+apEIxprEzkQ==",
      "license": "MIT"
    },
    "node_modules/@types/range-parser": {
      "version": "1.2.7",
      "resolved": "https://registry.npmjs.org/@types/range-parser/-/range-parser-1.2.7.tgz",
      "integrity": "sha512-hKormJbkJqzQGhziax5PItDUTMAM9uE2XXQmM37dyd4hVM+5aVl7oVxMVUiVQn2oCQFN/LKCZdvSM0pFRqbSmQ==",
      "license": "MIT"
    },
    "node_modules/@types/request": {
      "version": "2.48.13",
      "resolved": "https://registry.npmjs.org/@types/request/-/request-2.48.13.tgz",
      "integrity": "sha512-FGJ6udDNUCjd19pp0Q3iTiDkwhYup7J8hpMW9c4k53NrccQFFWKRho6hvtPPEhnXWKvukfwAlB6DbDz4yhH5Gg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@types/caseless": "*",
        "@types/node": "*",
        "@types/tough-cookie": "*",
        "form-data": "^2.5.5"
      }
    },
    "node_modules/@types/send": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@types/send/-/send-1.2.1.tgz",
      "integrity": "sha512-arsCikDvlU99zl1g69TcAB3mzZPpxgw0UQnaHeC1Nwb015xp8bknZv5rIfri9xTOcMuaVgvabfIRA7PSZVuZIQ==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/serve-static": {
      "version": "1.15.10",
      "resolved": "https://registry.npmjs.org/@types/serve-static/-/serve-static-1.15.10.tgz",
      "integrity": "sha512-tRs1dB+g8Itk72rlSI2ZrW6vZg0YrLI81iQSTkMmOqnqCaNr/8Ek4VwWcN5vZgCYWbg/JJSGBlUaYGAOP73qBw==",
      "license": "MIT",
      "dependencies": {
        "@types/http-errors": "*",
        "@types/node": "*",
        "@types/send": "<1"
      }
    },
    "node_modules/@types/serve-static/node_modules/@types/send": {
      "version": "0.17.6",
      "resolved": "https://registry.npmjs.org/@types/send/-/send-0.17.6.tgz",
      "integrity": "sha512-Uqt8rPBE8SY0RK8JB1EzVOIZ32uqy8HwdxCnoCOsYrvnswqmFZ/k+9Ikidlk/ImhsdvBsloHbAlewb2IEBV/Og==",
      "license": "MIT",
      "dependencies": {
        "@types/mime": "^1",
        "@types/node": "*"
      }
    },
    "node_modules/@types/stack-utils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/@types/stack-utils/-/stack-utils-2.0.3.tgz",
      "integrity": "sha512-9aEbYZ3TbYMznPdcdr3SmIrLXwC/AKZXQeCf9Pgao5CKb8CyHuEX5jzWPTkvregvhRJHcpRO6BFoGW9ycaOkYw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@types/tough-cookie": {
      "version": "4.0.5",
      "resolved": "https://registry.npmjs.org/@types/tough-cookie/-/tough-cookie-4.0.5.tgz",
      "integrity": "sha512-/Ad8+nIOV7Rl++6f1BdKxFSMgmoqEoYbHRpPcx3JEfv8VRsQe9Z4mCXeJBzxs7mbHY/XOZZuXlRNfhpVPbs6ZA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/@types/yargs": {
      "version": "17.0.35",
      "resolved": "https://registry.npmjs.org/@types/yargs/-/yargs-17.0.35.tgz",
      "integrity": "sha512-qUHkeCyQFxMXg79wQfTtfndEC+N9ZZg76HJftDJp+qH2tV7Gj4OJi7l+PiWwJ+pWtW8GwSmqsDj/oymhrTWXjg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@types/yargs-parser": "*"
      }
    },
    "node_modules/@types/yargs-parser": {
      "version": "21.0.3",
      "resolved": "https://registry.npmjs.org/@types/yargs-parser/-/yargs-parser-21.0.3.tgz",
      "integrity": "sha512-I4q9QU9MQv4oEOz4tAHJtNz1cwuLxn2F3xcc2iV5WdqLPpUnj30aUuxt1mAxYTG+oe8CZMV/+6rU4S4gRDzqtQ==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/@types/yauzl": {
      "version": "2.10.3",
      "resolved": "https://registry.npmjs.org/@types/yauzl/-/yauzl-2.10.3.tgz",
      "integrity": "sha512-oJoftv0LSuaDZE3Le4DbKX+KS9G36NzOeSap90UIK0yMA/NhKJhqlSGtNDORNRaIbQfzjXDrQa0ytJ6mNRGz/Q==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@ungap/structured-clone": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/@ungap/structured-clone/-/structured-clone-1.3.0.tgz",
      "integrity": "sha512-WmoN8qaIAo7WTYWbAZuG8PYEhn5fkz7dZrqTBZ7dtt//lL2Gwms1IcnQ5yHqjDfX8Ft5j4YzDM23f87zBfDe9g==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-android-arm-eabi": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-android-arm-eabi/-/resolver-binding-android-arm-eabi-1.11.1.tgz",
      "integrity": "sha512-ppLRUgHVaGRWUx0R0Ut06Mjo9gBaBkg3v/8AxusGLhsIotbBLuRk51rAzqLC8gq6NyyAojEXglNjzf6R948DNw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-android-arm64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-android-arm64/-/resolver-binding-android-arm64-1.11.1.tgz",
      "integrity": "sha512-lCxkVtb4wp1v+EoN+HjIG9cIIzPkX5OtM03pQYkG+U5O/wL53LC4QbIeazgiKqluGeVEeBlZahHalCaBvU1a2g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-darwin-arm64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-darwin-arm64/-/resolver-binding-darwin-arm64-1.11.1.tgz",
      "integrity": "sha512-gPVA1UjRu1Y/IsB/dQEsp2V1pm44Of6+LWvbLc9SDk1c2KhhDRDBUkQCYVWe6f26uJb3fOK8saWMgtX8IrMk3g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-darwin-x64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-darwin-x64/-/resolver-binding-darwin-x64-1.11.1.tgz",
      "integrity": "sha512-cFzP7rWKd3lZaCsDze07QX1SC24lO8mPty9vdP+YVa3MGdVgPmFc59317b2ioXtgCMKGiCLxJ4HQs62oz6GfRQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-freebsd-x64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-freebsd-x64/-/resolver-binding-freebsd-x64-1.11.1.tgz",
      "integrity": "sha512-fqtGgak3zX4DCB6PFpsH5+Kmt/8CIi4Bry4rb1ho6Av2QHTREM+47y282Uqiu3ZRF5IQioJQ5qWRV6jduA+iGw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-arm-gnueabihf": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm-gnueabihf/-/resolver-binding-linux-arm-gnueabihf-1.11.1.tgz",
      "integrity": "sha512-u92mvlcYtp9MRKmP+ZvMmtPN34+/3lMHlyMj7wXJDeXxuM0Vgzz0+PPJNsro1m3IZPYChIkn944wW8TYgGKFHw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-arm-musleabihf": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm-musleabihf/-/resolver-binding-linux-arm-musleabihf-1.11.1.tgz",
      "integrity": "sha512-cINaoY2z7LVCrfHkIcmvj7osTOtm6VVT16b5oQdS4beibX2SYBwgYLmqhBjA1t51CarSaBuX5YNsWLjsqfW5Cw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-arm64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm64-gnu/-/resolver-binding-linux-arm64-gnu-1.11.1.tgz",
      "integrity": "sha512-34gw7PjDGB9JgePJEmhEqBhWvCiiWCuXsL9hYphDF7crW7UgI05gyBAi6MF58uGcMOiOqSJ2ybEeCvHcq0BCmQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-arm64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm64-musl/-/resolver-binding-linux-arm64-musl-1.11.1.tgz",
      "integrity": "sha512-RyMIx6Uf53hhOtJDIamSbTskA99sPHS96wxVE/bJtePJJtpdKGXO1wY90oRdXuYOGOTuqjT8ACccMc4K6QmT3w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-ppc64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-ppc64-gnu/-/resolver-binding-linux-ppc64-gnu-1.11.1.tgz",
      "integrity": "sha512-D8Vae74A4/a+mZH0FbOkFJL9DSK2R6TFPC9M+jCWYia/q2einCubX10pecpDiTmkJVUH+y8K3BZClycD8nCShA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-riscv64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-riscv64-gnu/-/resolver-binding-linux-riscv64-gnu-1.11.1.tgz",
      "integrity": "sha512-frxL4OrzOWVVsOc96+V3aqTIQl1O2TjgExV4EKgRY09AJ9leZpEg8Ak9phadbuX0BA4k8U5qtvMSQQGGmaJqcQ==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-riscv64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-riscv64-musl/-/resolver-binding-linux-riscv64-musl-1.11.1.tgz",
      "integrity": "sha512-mJ5vuDaIZ+l/acv01sHoXfpnyrNKOk/3aDoEdLO/Xtn9HuZlDD6jKxHlkN8ZhWyLJsRBxfv9GYM2utQ1SChKew==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-s390x-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-s390x-gnu/-/resolver-binding-linux-s390x-gnu-1.11.1.tgz",
      "integrity": "sha512-kELo8ebBVtb9sA7rMe1Cph4QHreByhaZ2QEADd9NzIQsYNQpt9UkM9iqr2lhGr5afh885d/cB5QeTXSbZHTYPg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-x64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-x64-gnu/-/resolver-binding-linux-x64-gnu-1.11.1.tgz",
      "integrity": "sha512-C3ZAHugKgovV5YvAMsxhq0gtXuwESUKc5MhEtjBpLoHPLYM+iuwSj3lflFwK3DPm68660rZ7G8BMcwSro7hD5w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-linux-x64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-x64-musl/-/resolver-binding-linux-x64-musl-1.11.1.tgz",
      "integrity": "sha512-rV0YSoyhK2nZ4vEswT/QwqzqQXw5I6CjoaYMOX0TqBlWhojUf8P94mvI7nuJTeaCkkds3QE4+zS8Ko+GdXuZtA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-wasm32-wasi": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-wasm32-wasi/-/resolver-binding-wasm32-wasi-1.11.1.tgz",
      "integrity": "sha512-5u4RkfxJm+Ng7IWgkzi3qrFOvLvQYnPBmjmZQ8+szTK/b31fQCnleNl1GgEt7nIsZRIf5PLhPwT0WM+q45x/UQ==",
      "cpu": [
        "wasm32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "peer": true,
      "dependencies": {
        "@napi-rs/wasm-runtime": "^0.2.11"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@unrs/resolver-binding-win32-arm64-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-arm64-msvc/-/resolver-binding-win32-arm64-msvc-1.11.1.tgz",
      "integrity": "sha512-nRcz5Il4ln0kMhfL8S3hLkxI85BXs3o8EYoattsJNdsX4YUU89iOkVn7g0VHSRxFuVMdM4Q1jEpIId1Ihim/Uw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-win32-ia32-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-ia32-msvc/-/resolver-binding-win32-ia32-msvc-1.11.1.tgz",
      "integrity": "sha512-DCEI6t5i1NmAZp6pFonpD5m7i6aFrpofcp4LA2i8IIq60Jyo28hamKBxNrZcyOwVOZkgsRp9O2sXWBWP8MnvIQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "peer": true
    },
    "node_modules/@unrs/resolver-binding-win32-x64-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-x64-msvc/-/resolver-binding-win32-x64-msvc-1.11.1.tgz",
      "integrity": "sha512-lrW200hZdbfRtztbygyaq/6jP6AKE8qQN2KvPcJ+x7wiD038YtnYtZ82IMNJ69GJibV7bwL3y9FgK+5w/pYt6g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "peer": true
    },
    "node_modules/abort-controller": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/abort-controller/-/abort-controller-3.0.0.tgz",
      "integrity": "sha512-h8lQ8tacZYnR3vNQTgibj+tODHI5/+l06Au2Pcriv/Gmet0eaj4TwWH41sO9wnHDiQsEj19q0drzdWdeAHtweg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "event-target-shim": "^5.0.0"
      },
      "engines": {
        "node": ">=6.5"
      }
    },
    "node_modules/accepts": {
      "version": "1.3.8",
      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
      "license": "MIT",
      "dependencies": {
        "mime-types": "~2.1.34",
        "negotiator": "0.6.3"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/agent-base": {
      "version": "7.1.4",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-7.1.4.tgz",
      "integrity": "sha512-MnA+YT8fwfJPgBx3m60MNqakm30XOkyIoH1y6huTQvC0PwZG7ki8NacLBcrPbNoo8vEZy7Jpuk7+jMO+CUovTQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/ansi-escapes": {
      "version": "4.3.2",
      "resolved": "https://registry.npmjs.org/ansi-escapes/-/ansi-escapes-4.3.2.tgz",
      "integrity": "sha512-gKXj5ALrKWQLsYG9jlTRmR/xKluxHV+Z9QEwNIgCfM1/uwPMCuzVVnh5mwTd+OuBZcwSIMbqssNWRm1lE51QaQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "type-fest": "^0.21.3"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/ansi-regex": {
      "version": "6.2.2",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz",
      "integrity": "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
      }
    },
    "node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/anymatch": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "normalize-path": "^3.0.0",
        "picomatch": "^2.0.4"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/argparse": {
      "version": "1.0.10",
      "resolved": "https://registry.npmjs.org/argparse/-/argparse-1.0.10.tgz",
      "integrity": "sha512-o5Roy6tNG4SL/FOkCAN6RzjiakZS25RLYFrcMttJqbdd8BWrnA+fGz57iN5Pb06pvBGvl5gQ0B48dJlslXvoTg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "sprintf-js": "~1.0.2"
      }
    },
    "node_modules/array-flatten": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/array-flatten/-/array-flatten-1.1.1.tgz",
      "integrity": "sha512-PCVAQswWemu6UdxsDFFX/+gVeYqKAod3D3UVm91jHwynguOwAvYPhx8nNlM++NqRcK6CxxpUafjmhIdKiHibqg==",
      "license": "MIT"
    },
    "node_modules/arrify": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/arrify/-/arrify-2.0.1.tgz",
      "integrity": "sha512-3duEwti880xqi4eAMN8AyR4a0ByT90zoYdLlevfrvU43vb0YZwZVfxOgxWrLXXXpyugL0hNZc9G6BiB5B3nUug==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/ast-types": {
      "version": "0.13.4",
      "resolved": "https://registry.npmjs.org/ast-types/-/ast-types-0.13.4.tgz",
      "integrity": "sha512-x1FCFnFifvYDDzTaLII71vG5uvDwgtmDTEVWAxrgeiR8VjMONcCXJx7E+USjDtHlwFmt9MysbqgF9b9Vjr6w+w==",
      "license": "MIT",
      "dependencies": {
        "tslib": "^2.0.1"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/async-retry": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/async-retry/-/async-retry-1.3.3.tgz",
      "integrity": "sha512-wfr/jstw9xNi/0teMHrRW7dsz3Lt5ARhYNZ2ewpadnhaIp5mbALhOAP+EAdsC7t4Z6wqsDVv9+W6gm1Dk9mEyw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "retry": "0.13.1"
      }
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/b4a": {
      "version": "1.7.3",
      "resolved": "https://registry.npmjs.org/b4a/-/b4a-1.7.3.tgz",
      "integrity": "sha512-5Q2mfq2WfGuFp3uS//0s6baOJLMoVduPYVeNmDYxu5OUA1/cBfvr2RIS7vi62LdNj/urk1hfmj867I3qt6uZ7Q==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "react-native-b4a": "*"
      },
      "peerDependenciesMeta": {
        "react-native-b4a": {
          "optional": true
        }
      }
    },
    "node_modules/babel-jest": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/babel-jest/-/babel-jest-30.2.0.tgz",
      "integrity": "sha512-0YiBEOxWqKkSQWL9nNGGEgndoeL0ZpWrbLMNL5u/Kaxrli3Eaxlt3ZtIDktEvXt4L/R9r3ODr2zKwGM/2BjxVw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/transform": "30.2.0",
        "@types/babel__core": "^7.20.5",
        "babel-plugin-istanbul": "^7.0.1",
        "babel-preset-jest": "30.2.0",
        "chalk": "^4.1.2",
        "graceful-fs": "^4.2.11",
        "slash": "^3.0.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.11.0 || ^8.0.0-0"
      }
    },
    "node_modules/babel-plugin-istanbul": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/babel-plugin-istanbul/-/babel-plugin-istanbul-7.0.1.tgz",
      "integrity": "sha512-D8Z6Qm8jCvVXtIRkBnqNHX0zJ37rQcFJ9u8WOS6tkYOsRdHBzypCstaxWiu5ZIlqQtviRYbgnRLSoCEvjqcqbA==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "workspaces": [
        "test/babel-8"
      ],
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.0.0",
        "@istanbuljs/load-nyc-config": "^1.0.0",
        "@istanbuljs/schema": "^0.1.3",
        "istanbul-lib-instrument": "^6.0.2",
        "test-exclude": "^6.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/babel-plugin-jest-hoist": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/babel-plugin-jest-hoist/-/babel-plugin-jest-hoist-30.2.0.tgz",
      "integrity": "sha512-ftzhzSGMUnOzcCXd6WHdBGMyuwy15Wnn0iyyWGKgBDLxf9/s5ABuraCSpBX2uG0jUg4rqJnxsLc5+oYBqoxVaA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@types/babel__core": "^7.20.5"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/babel-preset-current-node-syntax": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/babel-preset-current-node-syntax/-/babel-preset-current-node-syntax-1.2.0.tgz",
      "integrity": "sha512-E/VlAEzRrsLEb2+dv8yp3bo4scof3l9nR4lrld+Iy5NyVqgVYUJnDAmunkhPMisRI32Qc4iRiz425d8vM++2fg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/plugin-syntax-async-generators": "^7.8.4",
        "@babel/plugin-syntax-bigint": "^7.8.3",
        "@babel/plugin-syntax-class-properties": "^7.12.13",
        "@babel/plugin-syntax-class-static-block": "^7.14.5",
        "@babel/plugin-syntax-import-attributes": "^7.24.7",
        "@babel/plugin-syntax-import-meta": "^7.10.4",
        "@babel/plugin-syntax-json-strings": "^7.8.3",
        "@babel/plugin-syntax-logical-assignment-operators": "^7.10.4",
        "@babel/plugin-syntax-nullish-coalescing-operator": "^7.8.3",
        "@babel/plugin-syntax-numeric-separator": "^7.10.4",
        "@babel/plugin-syntax-object-rest-spread": "^7.8.3",
        "@babel/plugin-syntax-optional-catch-binding": "^7.8.3",
        "@babel/plugin-syntax-optional-chaining": "^7.8.3",
        "@babel/plugin-syntax-private-property-in-object": "^7.14.5",
        "@babel/plugin-syntax-top-level-await": "^7.14.5"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0 || ^8.0.0-0"
      }
    },
    "node_modules/babel-preset-jest": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/babel-preset-jest/-/babel-preset-jest-30.2.0.tgz",
      "integrity": "sha512-US4Z3NOieAQumwFnYdUWKvUKh8+YSnS/gB3t6YBiz0bskpu7Pine8pPCheNxlPEW4wnUkma2a94YuW2q3guvCQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "babel-plugin-jest-hoist": "30.2.0",
        "babel-preset-current-node-syntax": "^1.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.11.0 || ^8.0.0-beta.1"
      }
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/bare-events": {
      "version": "2.8.2",
      "resolved": "https://registry.npmjs.org/bare-events/-/bare-events-2.8.2.tgz",
      "integrity": "sha512-riJjyv1/mHLIPX4RwiK+oW9/4c3TEUeORHKefKAKnZ5kyslbN+HXowtbaVEqt4IMUB7OXlfixcs6gsFeo/jhiQ==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "bare-abort-controller": "*"
      },
      "peerDependenciesMeta": {
        "bare-abort-controller": {
          "optional": true
        }
      }
    },
    "node_modules/bare-fs": {
      "version": "4.5.2",
      "resolved": "https://registry.npmjs.org/bare-fs/-/bare-fs-4.5.2.tgz",
      "integrity": "sha512-veTnRzkb6aPHOvSKIOy60KzURfBdUflr5VReI+NSaPL6xf+XLdONQgZgpYvUuZLVQ8dCqxpBAudaOM1+KpAUxw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "bare-events": "^2.5.4",
        "bare-path": "^3.0.0",
        "bare-stream": "^2.6.4",
        "bare-url": "^2.2.2",
        "fast-fifo": "^1.3.2"
      },
      "engines": {
        "bare": ">=1.16.0"
      },
      "peerDependencies": {
        "bare-buffer": "*"
      },
      "peerDependenciesMeta": {
        "bare-buffer": {
          "optional": true
        }
      }
    },
    "node_modules/bare-os": {
      "version": "3.6.2",
      "resolved": "https://registry.npmjs.org/bare-os/-/bare-os-3.6.2.tgz",
      "integrity": "sha512-T+V1+1srU2qYNBmJCXZkUY5vQ0B4FSlL3QDROnKQYOqeiQR8UbjNHlPa+TIbM4cuidiN9GaTaOZgSEgsvPbh5A==",
      "license": "Apache-2.0",
      "optional": true,
      "engines": {
        "bare": ">=1.14.0"
      }
    },
    "node_modules/bare-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/bare-path/-/bare-path-3.0.0.tgz",
      "integrity": "sha512-tyfW2cQcB5NN8Saijrhqn0Zh7AnFNsnczRcuWODH0eYAXBsJ5gVxAUuNr7tsHSC6IZ77cA0SitzT+s47kot8Mw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "bare-os": "^3.0.1"
      }
    },
    "node_modules/bare-stream": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/bare-stream/-/bare-stream-2.7.0.tgz",
      "integrity": "sha512-oyXQNicV1y8nc2aKffH+BUHFRXmx6VrPzlnaEvMhram0nPBrKcEdcyBg5r08D0i8VxngHFAiVyn1QKXpSG0B8A==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "streamx": "^2.21.0"
      },
      "peerDependencies": {
        "bare-buffer": "*",
        "bare-events": "*"
      },
      "peerDependenciesMeta": {
        "bare-buffer": {
          "optional": true
        },
        "bare-events": {
          "optional": true
        }
      }
    },
    "node_modules/bare-url": {
      "version": "2.3.2",
      "resolved": "https://registry.npmjs.org/bare-url/-/bare-url-2.3.2.tgz",
      "integrity": "sha512-ZMq4gd9ngV5aTMa5p9+UfY0b3skwhHELaDkhEHetMdX0LRkW9kzaym4oo/Eh+Ghm0CCDuMTsRIGM/ytUc1ZYmw==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "bare-path": "^3.0.0"
      }
    },
    "node_modules/base64-js": {
      "version": "1.5.1",
      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.9.11",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.11.tgz",
      "integrity": "sha512-Sg0xJUNDU1sJNGdfGWhVHX0kkZ+HWcvmVymJbj6NSgZZmW/8S9Y2HQ5euytnIgakgxN6papOAWiwDo1ctFDcoQ==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "bin": {
        "baseline-browser-mapping": "dist/cli.js"
      }
    },
    "node_modules/basic-ftp": {
      "version": "5.0.5",
      "resolved": "https://registry.npmjs.org/basic-ftp/-/basic-ftp-5.0.5.tgz",
      "integrity": "sha512-4Bcg1P8xhUuqcii/S0Z9wiHIrQVPMermM1any+MX5GeGD7faD3/msQUDGLol9wOcz4/jbg/WJnGqoJF6LiBdtg==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/bignumber.js": {
      "version": "9.3.1",
      "resolved": "https://registry.npmjs.org/bignumber.js/-/bignumber.js-9.3.1.tgz",
      "integrity": "sha512-Ko0uX15oIUS7wJ3Rb30Fs6SkVbLmPBAKdlm7q9+ak9bbIeFf0MwuBsQV6z7+X768/cHsfg+WlysDWJcmthjsjQ==",
      "license": "MIT",
      "engines": {
        "node": "*"
      }
    },
    "node_modules/body-parser": {
      "version": "1.20.4",
      "resolved": "https://registry.npmjs.org/body-parser/-/body-parser-1.20.4.tgz",
      "integrity": "sha512-ZTgYYLMOXY9qKU/57FAo8F+HA2dGX7bqGc71txDRC1rS4frdFI5R7NhluHxH6M0YItAP0sHB4uqAOcYKxO6uGA==",
      "license": "MIT",
      "dependencies": {
        "bytes": "~3.1.2",
        "content-type": "~1.0.5",
        "debug": "2.6.9",
        "depd": "2.0.0",
        "destroy": "~1.2.0",
        "http-errors": "~2.0.1",
        "iconv-lite": "~0.4.24",
        "on-finished": "~2.4.1",
        "qs": "~6.14.0",
        "raw-body": "~2.5.3",
        "type-is": "~1.6.18",
        "unpipe": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8",
        "npm": "1.2.8000 || >= 1.4.16"
      }
    },
    "node_modules/brace-expansion": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz",
      "integrity": "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/braces": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "fill-range": "^7.1.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/browserslist": {
      "version": "4.28.1",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "baseline-browser-mapping": "^2.9.0",
        "caniuse-lite": "^1.0.30001759",
        "electron-to-chromium": "^1.5.263",
        "node-releases": "^2.0.27",
        "update-browserslist-db": "^1.2.0"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/bser": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/bser/-/bser-2.1.1.tgz",
      "integrity": "sha512-gQxTNE/GAfIIrmHLUE3oJyp5FO6HRBfhjnw4/wMmA63ZGDJnWBmgY/lyQBpnDUkGmAhbSe39tx2d/iTOAfglwQ==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "dependencies": {
        "node-int64": "^0.4.0"
      }
    },
    "node_modules/buffer-crc32": {
      "version": "0.2.13",
      "resolved": "https://registry.npmjs.org/buffer-crc32/-/buffer-crc32-0.2.13.tgz",
      "integrity": "sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==",
      "license": "MIT",
      "engines": {
        "node": "*"
      }
    },
    "node_modules/buffer-equal-constant-time": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/buffer-equal-constant-time/-/buffer-equal-constant-time-1.0.1.tgz",
      "integrity": "sha512-zRpUiDwd/xk6ADqPMATG8vc9VPrkck7T07OIx0gnjmJAnHnTVXNQG3vfvWNuiZIkwu9KrKdA1iJKfsfTVxE6NA==",
      "license": "BSD-3-Clause"
    },
    "node_modules/buffer-from": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/bytes": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/bytes/-/bytes-3.1.2.tgz",
      "integrity": "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/call-bound": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "get-intrinsic": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/callsites": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
      "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/camelcase": {
      "version": "5.3.1",
      "resolved": "https://registry.npmjs.org/camelcase/-/camelcase-5.3.1.tgz",
      "integrity": "sha512-L28STB170nwWS63UjtlEOE3dldQApaJXZkOI1uMFfzf3rRuPegHaHesyee+YxQ+W6SvRDQV6UrdOdRiR153wJg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001761",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001761.tgz",
      "integrity": "sha512-JF9ptu1vP2coz98+5051jZ4PwQgd2ni8A+gYSN7EA7dPKIMf0pDlSUxhdmVOaV3/fYK5uWBkgSXJaRLr4+3A6g==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0",
      "peer": true
    },
    "node_modules/chalk": {
      "version": "4.1.2",
      "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
      "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-styles": "^4.1.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/chalk?sponsor=1"
      }
    },
    "node_modules/char-regex": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/char-regex/-/char-regex-1.0.2.tgz",
      "integrity": "sha512-kWWXztvZ5SBQV+eRgKFeh8q5sLuZY2+8WUIzlxWVTg+oGwY14qylx1KbKzHd8P6ZYkAg0xyIDU9JMHhyJMZ1jw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/chromium-bidi": {
      "version": "12.0.1",
      "resolved": "https://registry.npmjs.org/chromium-bidi/-/chromium-bidi-12.0.1.tgz",
      "integrity": "sha512-fGg+6jr0xjQhzpy5N4ErZxQ4wF7KLEvhGZXD6EgvZKDhu7iOhZXnZhcDxPJDcwTcrD48NPzOCo84RP2lv3Z+Cg==",
      "license": "Apache-2.0",
      "dependencies": {
        "mitt": "^3.0.1",
        "zod": "^3.24.1"
      },
      "peerDependencies": {
        "devtools-protocol": "*"
      }
    },
    "node_modules/ci-info": {
      "version": "4.3.1",
      "resolved": "https://registry.npmjs.org/ci-info/-/ci-info-4.3.1.tgz",
      "integrity": "sha512-Wdy2Igu8OcBpI2pZePZ5oWjPC38tmDVx5WKUXKwlLYkA0ozo85sLsLvkBbBn/sZaSCMFOGZJ14fvW9t5/d7kdA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/sibiraj-s"
        }
      ],
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cjs-module-lexer": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/cjs-module-lexer/-/cjs-module-lexer-2.1.1.tgz",
      "integrity": "sha512-+CmxIZ/L2vNcEfvNtLdU0ZQ6mbq3FZnwAP2PPTiKP+1QOoKwlKlPgb8UKV0Dds7QVaMnHm+FwSft2VB0s/SLjQ==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/cliui": {
      "version": "8.0.1",
      "resolved": "https://registry.npmjs.org/cliui/-/cliui-8.0.1.tgz",
      "integrity": "sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==",
      "license": "ISC",
      "dependencies": {
        "string-width": "^4.2.0",
        "strip-ansi": "^6.0.1",
        "wrap-ansi": "^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/cliui/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cliui/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/cliui/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cliui/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/cliui/node_modules/wrap-ansi": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/co": {
      "version": "4.6.0",
      "resolved": "https://registry.npmjs.org/co/-/co-4.6.0.tgz",
      "integrity": "sha512-QVb0dM5HvG+uaxitm8wONl7jltx8dqhfU33DcqtOZcLSVIKSDDLDi7+0LbAKiyI8hD9u42m2YxXSkMGWThaecQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "iojs": ">= 1.0.0",
        "node": ">= 0.12.0"
      }
    },
    "node_modules/collect-v8-coverage": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/collect-v8-coverage/-/collect-v8-coverage-1.0.3.tgz",
      "integrity": "sha512-1L5aqIkwPfiodaMgQunkF1zRhNqifHBmtbbbxcr6yVxxBnliw4TDOW6NxpO8DJLgJ16OT+Y4ztZqP6p/FtXnAw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "license": "MIT",
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "license": "MIT"
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/concat-map": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
      "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/content-disposition": {
      "version": "0.5.4",
      "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
      "integrity": "sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==",
      "license": "MIT",
      "dependencies": {
        "safe-buffer": "5.2.1"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/content-type": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/content-type/-/content-type-1.0.5.tgz",
      "integrity": "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/cookie": {
      "version": "0.7.2",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/cookie-signature": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.7.tgz",
      "integrity": "sha512-NXdYc3dLr47pBkpUCHtKSwIOQXLVn8dZEuywboCOJY/osA0wFSLlSawr3KN8qXJEyX66FcONTH8EIlVuK0yyFA==",
      "license": "MIT"
    },
    "node_modules/cors": {
      "version": "2.8.5",
      "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.5.tgz",
      "integrity": "sha512-KIHbLJqu73RGr/hnbrO9uBeixNGuvSQjul/jdFvS/KFSIH1hWVd1ng7zOHx+YrEfInLG7q4n6GHQ9cDtxv/P6g==",
      "license": "MIT",
      "dependencies": {
        "object-assign": "^4",
        "vary": "^1"
      },
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/data-uri-to-buffer": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/data-uri-to-buffer/-/data-uri-to-buffer-6.0.2.tgz",
      "integrity": "sha512-7hvf7/GW8e86rW0ptuwS3OcBGDjIi6SZva7hCyWC0yYry2cOPmLIjXAUHI6DK2HsnwJd9ifmt57i8eV2n4YNpw==",
      "license": "MIT",
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/debug": {
      "version": "2.6.9",
      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
      "license": "MIT",
      "dependencies": {
        "ms": "2.0.0"
      }
    },
    "node_modules/dedent": {
      "version": "1.7.1",
      "resolved": "https://registry.npmjs.org/dedent/-/dedent-1.7.1.tgz",
      "integrity": "sha512-9JmrhGZpOlEgOLdQgSm0zxFaYoQon408V1v49aqTWuXENVlnCuY9JBZcXZiCsZQWDjTm5Qf/nIvAy77mXDAjEg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "peerDependencies": {
        "babel-plugin-macros": "^3.1.0"
      },
      "peerDependenciesMeta": {
        "babel-plugin-macros": {
          "optional": true
        }
      }
    },
    "node_modules/deepmerge": {
      "version": "4.3.1",
      "resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
      "integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/degenerator": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/degenerator/-/degenerator-5.0.1.tgz",
      "integrity": "sha512-TllpMR/t0M5sqCXfj85i4XaAzxmS5tVA16dqvdkMwGmzI+dXLXnw3J+3Vdv7VKw+ThlTMboK6i9rnZ6Nntj5CQ==",
      "license": "MIT",
      "dependencies": {
        "ast-types": "^0.13.4",
        "escodegen": "^2.1.0",
        "esprima": "^4.0.1"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/depd": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
      "integrity": "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/destroy": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/destroy/-/destroy-1.2.0.tgz",
      "integrity": "sha512-2sJGJTaXIIaR1w4iJSNoN0hnMY7Gpc/n8D4qSCJw8QqFWXf7cuAgnEHxBpweaVcPevC2l3KpjYCx3NypQQgaJg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8",
        "npm": "1.2.8000 || >= 1.4.16"
      }
    },
    "node_modules/detect-newline": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/detect-newline/-/detect-newline-3.1.0.tgz",
      "integrity": "sha512-TLz+x/vEXm/Y7P7wn1EJFNLxYpUD4TgMosxY6fAVJUnJMbupHBOncxyWUG9OpTaH9EBD7uFI5LfEgmMOc54DsA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/devtools-protocol": {
      "version": "0.0.1534754",
      "resolved": "https://registry.npmjs.org/devtools-protocol/-/devtools-protocol-0.0.1534754.tgz",
      "integrity": "sha512-26T91cV5dbOYnXdJi5qQHoTtUoNEqwkHcAyu/IKtjIAxiEqPMrDiRkDOPWVsGfNZGmlQVHQbZRSjD8sxagWVsQ==",
      "license": "BSD-3-Clause"
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/duplexify": {
      "version": "4.1.3",
      "resolved": "https://registry.npmjs.org/duplexify/-/duplexify-4.1.3.tgz",
      "integrity": "sha512-M3BmBhwJRZsSx38lZyhE53Csddgzl5R7xGJNk7CVddZD6CcmwMCH8J+7AprIrQKH7TonKxaCjcv27Qmf+sQ+oA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "end-of-stream": "^1.4.1",
        "inherits": "^2.0.3",
        "readable-stream": "^3.1.1",
        "stream-shift": "^1.0.2"
      }
    },
    "node_modules/eastasianwidth": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz",
      "integrity": "sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/ecdsa-sig-formatter": {
      "version": "1.0.11",
      "resolved": "https://registry.npmjs.org/ecdsa-sig-formatter/-/ecdsa-sig-formatter-1.0.11.tgz",
      "integrity": "sha512-nagl3RYrbNv6kQkeJIpt6NJZy8twLB/2vtz6yN9Z4vRKHN4/QZJIEbqohALSgwKdnksuY3k5Addp5lg8sVoVcQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/ee-first": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/ee-first/-/ee-first-1.1.1.tgz",
      "integrity": "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow==",
      "license": "MIT"
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.267",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.267.tgz",
      "integrity": "sha512-0Drusm6MVRXSOJpGbaSVgcQsuB4hEkMpHXaVstcPmhu5LIedxs1xNK/nIxmQIU/RPC0+1/o0AVZfBTkTNJOdUw==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/emittery": {
      "version": "0.13.1",
      "resolved": "https://registry.npmjs.org/emittery/-/emittery-0.13.1.tgz",
      "integrity": "sha512-DeWwawk6r5yR9jFgnDKYt4sLS0LmHJJi3ZOnb5/JdbYwj3nW+FxQnHIjhBKz8YLC7oRNPVM9NQ47I3CVx34eqQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sindresorhus/emittery?sponsor=1"
      }
    },
    "node_modules/emoji-regex": {
      "version": "9.2.2",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/encodeurl": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-2.0.0.tgz",
      "integrity": "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/end-of-stream": {
      "version": "1.4.5",
      "resolved": "https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.5.tgz",
      "integrity": "sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg==",
      "license": "MIT",
      "dependencies": {
        "once": "^1.4.0"
      }
    },
    "node_modules/error-ex": {
      "version": "1.3.4",
      "resolved": "https://registry.npmjs.org/error-ex/-/error-ex-1.3.4.tgz",
      "integrity": "sha512-sqQamAnR14VgCr1A618A3sGrygcpK+HEbenA/HiEAkkUwcZIIB/tgWqHFxWgOyDh4nB4JCRimh79dR5Ywc9MDQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "is-arrayish": "^0.2.1"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/escape-html": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz",
      "integrity": "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==",
      "license": "MIT"
    },
    "node_modules/escape-string-regexp": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-2.0.0.tgz",
      "integrity": "sha512-UpzcLCXolUWcNu5HtVMHYdXJjArjsF9C0aNnquZYY4uW/Vu0miy5YoWvbV345HauVvcAUnpRuhMMcqTcGOY2+w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/escodegen": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/escodegen/-/escodegen-2.1.0.tgz",
      "integrity": "sha512-2NlIDTwUWJN0mRPQOdtQBzbUHvdGY2P1VXSyU83Q3xKxM7WHX2Ql8dKq782Q9TgQUNOLEzEYu9bzLNj1q88I5w==",
      "license": "BSD-2-Clause",
      "dependencies": {
        "esprima": "^4.0.1",
        "estraverse": "^5.2.0",
        "esutils": "^2.0.2"
      },
      "bin": {
        "escodegen": "bin/escodegen.js",
        "esgenerate": "bin/esgenerate.js"
      },
      "engines": {
        "node": ">=6.0"
      },
      "optionalDependencies": {
        "source-map": "~0.6.1"
      }
    },
    "node_modules/esprima": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/esprima/-/esprima-4.0.1.tgz",
      "integrity": "sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==",
      "license": "BSD-2-Clause",
      "bin": {
        "esparse": "bin/esparse.js",
        "esvalidate": "bin/esvalidate.js"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/estraverse": {
      "version": "5.3.0",
      "resolved": "https://registry.npmjs.org/estraverse/-/estraverse-5.3.0.tgz",
      "integrity": "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==",
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/esutils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz",
      "integrity": "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==",
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/etag": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/event-target-shim": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/event-target-shim/-/event-target-shim-5.0.1.tgz",
      "integrity": "sha512-i/2XbnSz/uxRCU6+NdVJgKWDTM427+MqYbkQzD321DuCQJUqOuJKIA0IM2+W2xtYHdKOmZ4dR6fExsd4SXL+WQ==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/events-universal": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/events-universal/-/events-universal-1.0.1.tgz",
      "integrity": "sha512-LUd5euvbMLpwOF8m6ivPCbhQeSiYVNb8Vs0fQ8QjXo0JTkEHpz8pxdQf0gStltaPpw0Cca8b39KxvK9cfKRiAw==",
      "license": "Apache-2.0",
      "dependencies": {
        "bare-events": "^2.7.0"
      }
    },
    "node_modules/execa": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/execa/-/execa-5.1.1.tgz",
      "integrity": "sha512-8uSpZZocAZRBAPIEINJj3Lo9HyGitllczc27Eh5YYojjMFMn8yHMDMaUHE2Jqfq05D/wucwI4JGURyXt1vchyg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "cross-spawn": "^7.0.3",
        "get-stream": "^6.0.0",
        "human-signals": "^2.1.0",
        "is-stream": "^2.0.0",
        "merge-stream": "^2.0.0",
        "npm-run-path": "^4.0.1",
        "onetime": "^5.1.2",
        "signal-exit": "^3.0.3",
        "strip-final-newline": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sindresorhus/execa?sponsor=1"
      }
    },
    "node_modules/execa/node_modules/signal-exit": {
      "version": "3.0.7",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-3.0.7.tgz",
      "integrity": "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/exit-x": {
      "version": "0.2.2",
      "resolved": "https://registry.npmjs.org/exit-x/-/exit-x-0.2.2.tgz",
      "integrity": "sha512-+I6B/IkJc1o/2tiURyz/ivu/O0nKNEArIUB5O7zBrlDVJr22SCLH3xTeEry428LvFhRzIA1g8izguxJ/gbNcVQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/expect": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/expect/-/expect-30.2.0.tgz",
      "integrity": "sha512-u/feCi0GPsI+988gU2FLcsHyAHTU0MX1Wg68NhAnN7z/+C5wqG+CY8J53N9ioe8RXgaoz0nBR/TYMf3AycUuPw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/expect-utils": "30.2.0",
        "@jest/get-type": "30.1.0",
        "jest-matcher-utils": "30.2.0",
        "jest-message-util": "30.2.0",
        "jest-mock": "30.2.0",
        "jest-util": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/express": {
      "version": "4.22.1",
      "resolved": "https://registry.npmjs.org/express/-/express-4.22.1.tgz",
      "integrity": "sha512-F2X8g9P1X7uCPZMA3MVf9wcTqlyNp7IhH5qPCI0izhaOIYXaW9L535tGA3qmjRzpH+bZczqq7hVKxTR4NWnu+g==",
      "license": "MIT",
      "dependencies": {
        "accepts": "~1.3.8",
        "array-flatten": "1.1.1",
        "body-parser": "~1.20.3",
        "content-disposition": "~0.5.4",
        "content-type": "~1.0.4",
        "cookie": "~0.7.1",
        "cookie-signature": "~1.0.6",
        "debug": "2.6.9",
        "depd": "2.0.0",
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "etag": "~1.8.1",
        "finalhandler": "~1.3.1",
        "fresh": "~0.5.2",
        "http-errors": "~2.0.0",
        "merge-descriptors": "1.0.3",
        "methods": "~1.1.2",
        "on-finished": "~2.4.1",
        "parseurl": "~1.3.3",
        "path-to-regexp": "~0.1.12",
        "proxy-addr": "~2.0.7",
        "qs": "~6.14.0",
        "range-parser": "~1.2.1",
        "safe-buffer": "5.2.1",
        "send": "~0.19.0",
        "serve-static": "~1.16.2",
        "setprototypeof": "1.2.0",
        "statuses": "~2.0.1",
        "type-is": "~1.6.18",
        "utils-merge": "1.0.1",
        "vary": "~1.1.2"
      },
      "engines": {
        "node": ">= 0.10.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/express"
      }
    },
    "node_modules/extend": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/extend/-/extend-3.0.2.tgz",
      "integrity": "sha512-fjquC59cD7CyW6urNXK0FBufkZcoiGG80wTuPujX590cB5Ttln20E2UB4S/WARVqhXffZl2LNgS+gQdPIIim/g==",
      "license": "MIT"
    },
    "node_modules/extract-zip": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/extract-zip/-/extract-zip-2.0.1.tgz",
      "integrity": "sha512-GDhU9ntwuKyGXdZBUgTIe+vXnWj0fppUEtMDL0+idd5Sta8TGpHssn/eusA9mrPr9qNDym6SxAYZjNvCn/9RBg==",
      "license": "BSD-2-Clause",
      "dependencies": {
        "debug": "^4.1.1",
        "get-stream": "^5.1.0",
        "yauzl": "^2.10.0"
      },
      "bin": {
        "extract-zip": "cli.js"
      },
      "engines": {
        "node": ">= 10.17.0"
      },
      "optionalDependencies": {
        "@types/yauzl": "^2.9.1"
      }
    },
    "node_modules/extract-zip/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/extract-zip/node_modules/get-stream": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/get-stream/-/get-stream-5.2.0.tgz",
      "integrity": "sha512-nBF+F1rAZVCu/p7rjzgA+Yb4lfYXrpl7a6VmJrU8wF9I1CKvP/QwPNZHnOlwbTkY6dvtFIzFMSyQXbLoTQPRpA==",
      "license": "MIT",
      "dependencies": {
        "pump": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/extract-zip/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/farmhash-modern": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/farmhash-modern/-/farmhash-modern-1.1.0.tgz",
      "integrity": "sha512-6ypT4XfgqJk/F3Yuv4SX26I3doUjt0GTG4a+JgWxXQpxXzTBq8fPUeGHfcYMMDPHJHm3yPOSjaeBwBGAHWXCdA==",
      "license": "MIT",
      "engines": {
        "node": ">=18.0.0"
      }
    },
    "node_modules/fast-deep-equal": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz",
      "integrity": "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==",
      "license": "MIT"
    },
    "node_modules/fast-fifo": {
      "version": "1.3.2",
      "resolved": "https://registry.npmjs.org/fast-fifo/-/fast-fifo-1.3.2.tgz",
      "integrity": "sha512-/d9sfos4yxzpwkDkuN7k2SqFKtYNmCTzgfEpz82x34IM9/zc8KGxQoXg1liNC/izpRM/MBdt44Nmx41ZWqk+FQ==",
      "license": "MIT"
    },
    "node_modules/fast-json-stable-stringify": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
      "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/fast-xml-parser": {
      "version": "4.5.3",
      "resolved": "https://registry.npmjs.org/fast-xml-parser/-/fast-xml-parser-4.5.3.tgz",
      "integrity": "sha512-RKihhV+SHsIUGXObeVy9AXiBbFwkVk7Syp8XgwN5U3JV416+Gwp/GO9i0JYKmikykgz/UHRrrV4ROuZEo/T0ig==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/NaturalIntelligence"
        }
      ],
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "strnum": "^1.1.1"
      },
      "bin": {
        "fxparser": "src/cli/cli.js"
      }
    },
    "node_modules/faye-websocket": {
      "version": "0.11.4",
      "resolved": "https://registry.npmjs.org/faye-websocket/-/faye-websocket-0.11.4.tgz",
      "integrity": "sha512-CzbClwlXAuiRQAlUyfqPgvPoNKTckTPGfwZV4ZdAhVcP2lh9KUxJg2b5GkE7XbjKQ3YJnQ9z6D9ntLAlB+tP8g==",
      "license": "Apache-2.0",
      "dependencies": {
        "websocket-driver": ">=0.5.1"
      },
      "engines": {
        "node": ">=0.8.0"
      }
    },
    "node_modules/fb-watchman": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/fb-watchman/-/fb-watchman-2.0.2.tgz",
      "integrity": "sha512-p5161BqbuCaSnB8jIbzQHOlpgsPmK5rJVDfDKO91Axs5NC1uu3HRQm6wt9cd9/+GtQQIO53JdGXXoyDpTAsgYA==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "dependencies": {
        "bser": "2.1.1"
      }
    },
    "node_modules/fd-slicer": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/fd-slicer/-/fd-slicer-1.1.0.tgz",
      "integrity": "sha512-cE1qsB/VwyQozZ+q1dGxR8LBYNZeofhEdUNGSMbQD3Gw2lAzX9Zb3uIU6Ebc/Fmyjo9AWWfnn0AUCHqtevs/8g==",
      "license": "MIT",
      "dependencies": {
        "pend": "~1.2.0"
      }
    },
    "node_modules/fill-range": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "to-regex-range": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/finalhandler": {
      "version": "1.3.2",
      "resolved": "https://registry.npmjs.org/finalhandler/-/finalhandler-1.3.2.tgz",
      "integrity": "sha512-aA4RyPcd3badbdABGDuTXCMTtOneUCAYH/gxoYRTZlIJdF0YPWuGqiAsIrhNnnqdXGswYk6dGujem4w80UJFhg==",
      "license": "MIT",
      "dependencies": {
        "debug": "2.6.9",
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "on-finished": "~2.4.1",
        "parseurl": "~1.3.3",
        "statuses": "~2.0.2",
        "unpipe": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/find-up": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/find-up/-/find-up-4.1.0.tgz",
      "integrity": "sha512-PpOwAdQ/YlXQ2vj8a3h8IipDuYRi3wceVQQGYWxNINccq40Anw7BlsEXCMbt1Zt+OLA6Fq9suIpIWD0OsnISlw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "locate-path": "^5.0.0",
        "path-exists": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/firebase-admin": {
      "version": "13.6.0",
      "resolved": "https://registry.npmjs.org/firebase-admin/-/firebase-admin-13.6.0.tgz",
      "integrity": "sha512-GdPA/t0+Cq8p1JnjFRBmxRxAGvF/kl2yfdhALl38PrRp325YxyQ5aNaHui0XmaKcKiGRFIJ/EgBNWFoDP0onjw==",
      "license": "Apache-2.0",
      "dependencies": {
        "@fastify/busboy": "^3.0.0",
        "@firebase/database-compat": "^2.0.0",
        "@firebase/database-types": "^1.0.6",
        "@types/node": "^22.8.7",
        "farmhash-modern": "^1.1.0",
        "fast-deep-equal": "^3.1.1",
        "google-auth-library": "^9.14.2",
        "jsonwebtoken": "^9.0.0",
        "jwks-rsa": "^3.1.0",
        "node-forge": "^1.3.1",
        "uuid": "^11.0.2"
      },
      "engines": {
        "node": ">=18"
      },
      "optionalDependencies": {
        "@google-cloud/firestore": "^7.11.0",
        "@google-cloud/storage": "^7.14.0"
      }
    },
    "node_modules/firebase-functions": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/firebase-functions/-/firebase-functions-7.0.2.tgz",
      "integrity": "sha512-AFAZOn2iMp6X6lvCzEI92/J/JfT2ZAGSHKAfop4btWZdIqeHU40gFwVBGPl53bnqEpuv5VYKirmkxGuPu4OHpA==",
      "license": "MIT",
      "dependencies": {
        "@types/cors": "^2.8.5",
        "@types/express": "^4.17.21",
        "cors": "^2.8.5",
        "express": "^4.21.0",
        "protobufjs": "^7.2.2"
      },
      "bin": {
        "firebase-functions": "lib/bin/firebase-functions.js"
      },
      "engines": {
        "node": ">=18.0.0"
      },
      "peerDependencies": {
        "firebase-admin": "^11.10.0 || ^12.0.0 || ^13.0.0"
      }
    },
    "node_modules/firebase-functions-test": {
      "version": "3.4.1",
      "resolved": "https://registry.npmjs.org/firebase-functions-test/-/firebase-functions-test-3.4.1.tgz",
      "integrity": "sha512-qAq0oszrBGdf4bnCF6t4FoSgMsepeIXh0Pi/FhikSE6e+TvKKGpfrfUP/5pFjJZxFcLsweoau88KydCql4xSeg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/lodash": "^4.14.104",
        "lodash": "^4.17.5",
        "ts-deepmerge": "^2.0.1"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "firebase-admin": "^8.0.0 || ^9.0.0 || ^10.0.0 || ^11.0.0 || ^12.0.0 || ^13.0.0",
        "firebase-functions": ">=4.9.0",
        "jest": ">=28.0.0"
      }
    },
    "node_modules/follow-redirects": {
      "version": "1.15.11",
      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/RubenVerborgh"
        }
      ],
      "license": "MIT",
      "engines": {
        "node": ">=4.0"
      },
      "peerDependenciesMeta": {
        "debug": {
          "optional": true
        }
      }
    },
    "node_modules/foreground-child": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.1.tgz",
      "integrity": "sha512-gIXjKqtFuWEgzFRJA9WCQeSJLZDjgJUOMCMzxtvFq/37KojM1BFGufqsCy0r4qSQmYLsZYMeyRqzIWOMup03sw==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "cross-spawn": "^7.0.6",
        "signal-exit": "^4.0.1"
      },
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/form-data": {
      "version": "2.5.5",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-2.5.5.tgz",
      "integrity": "sha512-jqdObeR2rxZZbPSGL+3VckHMYtu+f9//KXBsVny6JSX/pa38Fy+bGjuG8eW/H6USNQWhLi8Num++cU2yOCNz4A==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.35",
        "safe-buffer": "^5.2.1"
      },
      "engines": {
        "node": ">= 0.12"
      }
    },
    "node_modules/forwarded": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz",
      "integrity": "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/fresh": {
      "version": "0.5.2",
      "resolved": "https://registry.npmjs.org/fresh/-/fresh-0.5.2.tgz",
      "integrity": "sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/fs.realpath": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/fs.realpath/-/fs.realpath-1.0.0.tgz",
      "integrity": "sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "peer": true,
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/functional-red-black-tree": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/functional-red-black-tree/-/functional-red-black-tree-1.0.1.tgz",
      "integrity": "sha512-dsKNQNdj6xA3T+QlADDA7mOSlX0qiMINjn0cgr+eGHGsbSHzTabcIogz2+p/iqP1Xs6EP/sS2SbqH+brGTbq0g==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/gaxios": {
      "version": "6.7.1",
      "resolved": "https://registry.npmjs.org/gaxios/-/gaxios-6.7.1.tgz",
      "integrity": "sha512-LDODD4TMYx7XXdpwxAVRAIAuB0bzv0s+ywFonY46k126qzQHT9ygyoa9tncmOiQmmDrik65UYsEkv3lbfqQ3yQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "extend": "^3.0.2",
        "https-proxy-agent": "^7.0.1",
        "is-stream": "^2.0.0",
        "node-fetch": "^2.6.9",
        "uuid": "^9.0.1"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/gaxios/node_modules/uuid": {
      "version": "9.0.1",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/gcp-metadata": {
      "version": "6.1.1",
      "resolved": "https://registry.npmjs.org/gcp-metadata/-/gcp-metadata-6.1.1.tgz",
      "integrity": "sha512-a4tiq7E0/5fTjxPAaH4jpjkSv/uCaU2p5KC6HVGrvl0cDjA8iBZv4vv1gyzlmK0ZUKqwpOyQMKzZQe3lTit77A==",
      "license": "Apache-2.0",
      "dependencies": {
        "gaxios": "^6.1.1",
        "google-logging-utils": "^0.0.2",
        "json-bigint": "^1.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/get-caller-file": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/get-caller-file/-/get-caller-file-2.0.5.tgz",
      "integrity": "sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==",
      "license": "ISC",
      "engines": {
        "node": "6.* || 8.* || >= 10.*"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-package-type": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/get-package-type/-/get-package-type-0.1.0.tgz",
      "integrity": "sha512-pjzuKtY64GYfWizNAJ0fr9VqttZkNiK2iS430LtIHzjBEr6bX8Am2zm4sW4Ro5wjWW5cAlRL1qAMTcXbjNAO2Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8.0.0"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/get-stream": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/get-stream/-/get-stream-6.0.1.tgz",
      "integrity": "sha512-ts6Wi+2j3jQjqi70w5AlN8DFnkSwC+MqmxEzdEALB2qXZYV3X/b1CTfgPLGJNMeAWxdPfU8FO1ms3NUfaHCPYg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/get-uri": {
      "version": "6.0.5",
      "resolved": "https://registry.npmjs.org/get-uri/-/get-uri-6.0.5.tgz",
      "integrity": "sha512-b1O07XYq8eRuVzBNgJLstU6FYc1tS6wnMtF1I1D9lE8LxZSOGZ7LhxN54yPP6mGw5f2CkXY2BQUL9Fx41qvcIg==",
      "license": "MIT",
      "dependencies": {
        "basic-ftp": "^5.0.2",
        "data-uri-to-buffer": "^6.0.2",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/get-uri/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/get-uri/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/glob": {
      "version": "10.5.0",
      "resolved": "https://registry.npmjs.org/glob/-/glob-10.5.0.tgz",
      "integrity": "sha512-DfXN8DfhJ7NH3Oe7cFmu3NCu1wKbkReJ8TorzSAFbSKrlNaQSKfIzqYqVY8zlbs2NLBbWpRiU52GX2PbaBVNkg==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "foreground-child": "^3.1.0",
        "jackspeak": "^3.1.2",
        "minimatch": "^9.0.4",
        "minipass": "^7.1.2",
        "package-json-from-dist": "^1.0.0",
        "path-scurry": "^1.11.1"
      },
      "bin": {
        "glob": "dist/esm/bin.mjs"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/google-auth-library": {
      "version": "9.15.1",
      "resolved": "https://registry.npmjs.org/google-auth-library/-/google-auth-library-9.15.1.tgz",
      "integrity": "sha512-Jb6Z0+nvECVz+2lzSMt9u98UsoakXxA2HGHMCxh+so3n90XgYWkq5dur19JAJV7ONiJY22yBTyJB1TSkvPq9Ng==",
      "license": "Apache-2.0",
      "dependencies": {
        "base64-js": "^1.3.0",
        "ecdsa-sig-formatter": "^1.0.11",
        "gaxios": "^6.1.1",
        "gcp-metadata": "^6.1.0",
        "gtoken": "^7.0.0",
        "jws": "^4.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/google-gax": {
      "version": "4.6.1",
      "resolved": "https://registry.npmjs.org/google-gax/-/google-gax-4.6.1.tgz",
      "integrity": "sha512-V6eky/xz2mcKfAd1Ioxyd6nmA61gao3n01C+YeuIwu3vzM9EDR6wcVzMSIbLMDXWeoi9SHYctXuKYC5uJUT3eQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "@grpc/grpc-js": "^1.10.9",
        "@grpc/proto-loader": "^0.7.13",
        "@types/long": "^4.0.0",
        "abort-controller": "^3.0.0",
        "duplexify": "^4.0.0",
        "google-auth-library": "^9.3.0",
        "node-fetch": "^2.7.0",
        "object-hash": "^3.0.0",
        "proto3-json-serializer": "^2.0.2",
        "protobufjs": "^7.3.2",
        "retry-request": "^7.0.0",
        "uuid": "^9.0.1"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/google-gax/node_modules/uuid": {
      "version": "9.0.1",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "optional": true,
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/google-logging-utils": {
      "version": "0.0.2",
      "resolved": "https://registry.npmjs.org/google-logging-utils/-/google-logging-utils-0.0.2.tgz",
      "integrity": "sha512-NEgUnEcBiP5HrPzufUkBzJOD/Sxsco3rLNo1F1TNf7ieU8ryUzBhqba8r756CjLX7rn3fHl6iLEwPYuqpoKgQQ==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/graceful-fs": {
      "version": "4.2.11",
      "resolved": "https://registry.npmjs.org/graceful-fs/-/graceful-fs-4.2.11.tgz",
      "integrity": "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/gtoken": {
      "version": "7.1.0",
      "resolved": "https://registry.npmjs.org/gtoken/-/gtoken-7.1.0.tgz",
      "integrity": "sha512-pCcEwRi+TKpMlxAQObHDQ56KawURgyAf6jtIY046fJ5tIv3zDe/LEIubckAO8fj6JnAxLdmWkUfNyulQ2iKdEw==",
      "license": "MIT",
      "dependencies": {
        "gaxios": "^6.0.0",
        "jws": "^4.0.0"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/has-flag": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/html-entities": {
      "version": "2.6.0",
      "resolved": "https://registry.npmjs.org/html-entities/-/html-entities-2.6.0.tgz",
      "integrity": "sha512-kig+rMn/QOVRvr7c86gQ8lWXq+Hkv6CbAH1hLu+RG338StTpE8Z0b44SDVaqVu7HGKf27frdmUYEs9hTUX/cLQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/mdevils"
        },
        {
          "type": "patreon",
          "url": "https://patreon.com/mdevils"
        }
      ],
      "license": "MIT",
      "optional": true
    },
    "node_modules/html-escaper": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/html-escaper/-/html-escaper-2.0.2.tgz",
      "integrity": "sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/http-errors": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.1.tgz",
      "integrity": "sha512-4FbRdAX+bSdmo4AUFuS0WNiPz8NgFt+r8ThgNWmlrjQjt1Q7ZR9+zTlce2859x4KSXrwIsaeTqDoKQmtP8pLmQ==",
      "license": "MIT",
      "dependencies": {
        "depd": "~2.0.0",
        "inherits": "~2.0.4",
        "setprototypeof": "~1.2.0",
        "statuses": "~2.0.2",
        "toidentifier": "~1.0.1"
      },
      "engines": {
        "node": ">= 0.8"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/express"
      }
    },
    "node_modules/http-parser-js": {
      "version": "0.5.10",
      "resolved": "https://registry.npmjs.org/http-parser-js/-/http-parser-js-0.5.10.tgz",
      "integrity": "sha512-Pysuw9XpUq5dVc/2SMHpuTY01RFl8fttgcyunjL7eEMhGM3cI4eOmiCycJDVCo/7O7ClfQD3SaI6ftDzqOXYMA==",
      "license": "MIT"
    },
    "node_modules/http-proxy-agent": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-5.0.0.tgz",
      "integrity": "sha512-n2hY8YdoRE1i7r6M0w9DIw5GgZN0G25P8zLCRQ8rjXtTU3vsNFBI/vWK/UIeE6g5MUUz6avwAPXmL6Fy9D/90w==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@tootallnate/once": "2",
        "agent-base": "6",
        "debug": "4"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/http-proxy-agent/node_modules/agent-base": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "debug": "4"
      },
      "engines": {
        "node": ">= 6.0.0"
      }
    },
    "node_modules/http-proxy-agent/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/http-proxy-agent/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/https-proxy-agent": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-7.0.6.tgz",
      "integrity": "sha512-vK9P5/iUfdl95AI+JVyUuIcVtd4ofvtrOr3HNtM2yxC9bnMbEdp3x01OhQNnjb8IJYi38VlTE3mBXwcfvywuSw==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.2",
        "debug": "4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/https-proxy-agent/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/https-proxy-agent/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/human-signals": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/human-signals/-/human-signals-2.1.0.tgz",
      "integrity": "sha512-B4FFZ6q/T2jhhksgkbEW3HBvWIfDW85snkQgawt07S7J5QXTk6BkNV+0yAeZrM5QpMAdYlocGoljn0sJ/WQkFw==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "engines": {
        "node": ">=10.17.0"
      }
    },
    "node_modules/iconv-lite": {
      "version": "0.4.24",
      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz",
      "integrity": "sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==",
      "license": "MIT",
      "dependencies": {
        "safer-buffer": ">= 2.1.2 < 3"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/import-local": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/import-local/-/import-local-3.2.0.tgz",
      "integrity": "sha512-2SPlun1JUPWoM6t3F0dw0FkCF/jWY8kttcY4f599GLTSjh2OCuuhdTkJQsEcZzBqbXZGKMK2OqW1oZsjtf/gQA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "pkg-dir": "^4.2.0",
        "resolve-cwd": "^3.0.0"
      },
      "bin": {
        "import-local-fixture": "fixtures/cli.js"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/imurmurhash": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
      "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=0.8.19"
      }
    },
    "node_modules/inflight": {
      "version": "1.0.6",
      "resolved": "https://registry.npmjs.org/inflight/-/inflight-1.0.6.tgz",
      "integrity": "sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==",
      "deprecated": "This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "once": "^1.3.0",
        "wrappy": "1"
      }
    },
    "node_modules/inherits": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
      "license": "ISC"
    },
    "node_modules/ip-address": {
      "version": "10.1.0",
      "resolved": "https://registry.npmjs.org/ip-address/-/ip-address-10.1.0.tgz",
      "integrity": "sha512-XXADHxXmvT9+CRxhXg56LJovE+bmWnEWB78LB83VZTprKTmaC5QfruXocxzTZ2Kl0DNwKuBdlIhjL8LeY8Sf8Q==",
      "license": "MIT",
      "engines": {
        "node": ">= 12"
      }
    },
    "node_modules/ipaddr.js": {
      "version": "1.9.1",
      "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
      "integrity": "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/is-arrayish": {
      "version": "0.2.1",
      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.2.1.tgz",
      "integrity": "sha512-zz06S8t0ozoDXMG+ube26zeCTNXcKIPJZJi8hBrF4idCLms4CG9QtK7qBl1boi5ODzFpjswb5JPmHCbMpjaYzg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/is-fullwidth-code-point": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-generator-fn": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/is-generator-fn/-/is-generator-fn-2.1.0.tgz",
      "integrity": "sha512-cTIB4yPYL/Grw0EaSzASzg6bBy9gqCofvWN8okThAYIxKJZC+udlRAmGbM0XLeniEJSs8uEgHPGuHSe1XsOLSQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/is-number": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=0.12.0"
      }
    },
    "node_modules/is-stream": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/is-stream/-/is-stream-2.0.1.tgz",
      "integrity": "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/istanbul-lib-coverage": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/istanbul-lib-coverage/-/istanbul-lib-coverage-3.2.2.tgz",
      "integrity": "sha512-O8dpsF+r0WV/8MNRKfnmrtCWhuKjxrq2w+jpzBL5UZKTi2LeVWnWOmWRxFlesJONmc+wLAGvKQZEOanko0LFTg==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/istanbul-lib-instrument": {
      "version": "6.0.3",
      "resolved": "https://registry.npmjs.org/istanbul-lib-instrument/-/istanbul-lib-instrument-6.0.3.tgz",
      "integrity": "sha512-Vtgk7L/R2JHyyGW07spoFlB8/lpjiOLTjMdms6AFMraYt3BaJauod/NGrfnVG/y4Ix1JEuMRPDPEj2ua+zz1/Q==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "@babel/core": "^7.23.9",
        "@babel/parser": "^7.23.9",
        "@istanbuljs/schema": "^0.1.3",
        "istanbul-lib-coverage": "^3.2.0",
        "semver": "^7.5.4"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-instrument/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-report": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/istanbul-lib-report/-/istanbul-lib-report-3.0.1.tgz",
      "integrity": "sha512-GCfE1mtsHGOELCU8e/Z7YWzpmybrx/+dSTfLrvY8qRmaY6zXTKWn6WQIjaAFw069icm6GVMNkgu0NzI4iPZUNw==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "istanbul-lib-coverage": "^3.0.0",
        "make-dir": "^4.0.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-source-maps": {
      "version": "5.0.6",
      "resolved": "https://registry.npmjs.org/istanbul-lib-source-maps/-/istanbul-lib-source-maps-5.0.6.tgz",
      "integrity": "sha512-yg2d+Em4KizZC5niWhQaIomgf5WlL4vOOjZ5xGCmF8SnPE/mDWWXgvRExdcpCgh9lLRRa1/fSYp2ymmbJ1pI+A==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "@jridgewell/trace-mapping": "^0.3.23",
        "debug": "^4.1.1",
        "istanbul-lib-coverage": "^3.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/istanbul-lib-source-maps/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/istanbul-lib-source-maps/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/istanbul-reports": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/istanbul-reports/-/istanbul-reports-3.2.0.tgz",
      "integrity": "sha512-HGYWWS/ehqTV3xN10i23tkPkpH46MLCIMFNCaaKNavAXTF1RkqxawEPtnjnGZ6XKSInBKkiOA5BKS+aZiY3AvA==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "html-escaper": "^2.0.0",
        "istanbul-lib-report": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/jackspeak": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz",
      "integrity": "sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==",
      "dev": true,
      "license": "BlueOak-1.0.0",
      "peer": true,
      "dependencies": {
        "@isaacs/cliui": "^8.0.2"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      },
      "optionalDependencies": {
        "@pkgjs/parseargs": "^0.11.0"
      }
    },
    "node_modules/jest": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest/-/jest-30.2.0.tgz",
      "integrity": "sha512-F26gjC0yWN8uAA5m5Ss8ZQf5nDHWGlN/xWZIh8S5SRbsEKBovwZhxGd6LJlbZYxBgCYOtreSUyb8hpXyGC5O4A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/core": "30.2.0",
        "@jest/types": "30.2.0",
        "import-local": "^3.2.0",
        "jest-cli": "30.2.0"
      },
      "bin": {
        "jest": "bin/jest.js"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/jest-changed-files": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-changed-files/-/jest-changed-files-30.2.0.tgz",
      "integrity": "sha512-L8lR1ChrRnSdfeOvTrwZMlnWV8G/LLjQ0nG9MBclwWZidA2N5FviRki0Bvh20WRMOX31/JYvzdqTJrk5oBdydQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "execa": "^5.1.1",
        "jest-util": "30.2.0",
        "p-limit": "^3.1.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-circus": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-circus/-/jest-circus-30.2.0.tgz",
      "integrity": "sha512-Fh0096NC3ZkFx05EP2OXCxJAREVxj1BcW/i6EWqqymcgYKWjyyDpral3fMxVcHXg6oZM7iULer9wGRFvfpl+Tg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/environment": "30.2.0",
        "@jest/expect": "30.2.0",
        "@jest/test-result": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "chalk": "^4.1.2",
        "co": "^4.6.0",
        "dedent": "^1.6.0",
        "is-generator-fn": "^2.1.0",
        "jest-each": "30.2.0",
        "jest-matcher-utils": "30.2.0",
        "jest-message-util": "30.2.0",
        "jest-runtime": "30.2.0",
        "jest-snapshot": "30.2.0",
        "jest-util": "30.2.0",
        "p-limit": "^3.1.0",
        "pretty-format": "30.2.0",
        "pure-rand": "^7.0.0",
        "slash": "^3.0.0",
        "stack-utils": "^2.0.6"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-cli": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-cli/-/jest-cli-30.2.0.tgz",
      "integrity": "sha512-Os9ukIvADX/A9sLt6Zse3+nmHtHaE6hqOsjQtNiugFTbKRHYIYtZXNGNK9NChseXy7djFPjndX1tL0sCTlfpAA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/core": "30.2.0",
        "@jest/test-result": "30.2.0",
        "@jest/types": "30.2.0",
        "chalk": "^4.1.2",
        "exit-x": "^0.2.2",
        "import-local": "^3.2.0",
        "jest-config": "30.2.0",
        "jest-util": "30.2.0",
        "jest-validate": "30.2.0",
        "yargs": "^17.7.2"
      },
      "bin": {
        "jest": "bin/jest.js"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
      },
      "peerDependenciesMeta": {
        "node-notifier": {
          "optional": true
        }
      }
    },
    "node_modules/jest-config": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-config/-/jest-config-30.2.0.tgz",
      "integrity": "sha512-g4WkyzFQVWHtu6uqGmQR4CQxz/CH3yDSlhzXMWzNjDx843gYjReZnMRanjRCq5XZFuQrGDxgUaiYWE8BRfVckA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/core": "^7.27.4",
        "@jest/get-type": "30.1.0",
        "@jest/pattern": "30.0.1",
        "@jest/test-sequencer": "30.2.0",
        "@jest/types": "30.2.0",
        "babel-jest": "30.2.0",
        "chalk": "^4.1.2",
        "ci-info": "^4.2.0",
        "deepmerge": "^4.3.1",
        "glob": "^10.3.10",
        "graceful-fs": "^4.2.11",
        "jest-circus": "30.2.0",
        "jest-docblock": "30.2.0",
        "jest-environment-node": "30.2.0",
        "jest-regex-util": "30.0.1",
        "jest-resolve": "30.2.0",
        "jest-runner": "30.2.0",
        "jest-util": "30.2.0",
        "jest-validate": "30.2.0",
        "micromatch": "^4.0.8",
        "parse-json": "^5.2.0",
        "pretty-format": "30.2.0",
        "slash": "^3.0.0",
        "strip-json-comments": "^3.1.1"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "peerDependencies": {
        "@types/node": "*",
        "esbuild-register": ">=3.4.0",
        "ts-node": ">=9.0.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "esbuild-register": {
          "optional": true
        },
        "ts-node": {
          "optional": true
        }
      }
    },
    "node_modules/jest-diff": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-diff/-/jest-diff-30.2.0.tgz",
      "integrity": "sha512-dQHFo3Pt4/NLlG5z4PxZ/3yZTZ1C7s9hveiOj+GCN+uT109NC2QgsoVZsVOAvbJ3RgKkvyLGXZV9+piDpWbm6A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/diff-sequences": "30.0.1",
        "@jest/get-type": "30.1.0",
        "chalk": "^4.1.2",
        "pretty-format": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-docblock": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-docblock/-/jest-docblock-30.2.0.tgz",
      "integrity": "sha512-tR/FFgZKS1CXluOQzZvNH3+0z9jXr3ldGSD8bhyuxvlVUwbeLOGynkunvlTMxchC5urrKndYiwCFC0DLVjpOCA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "detect-newline": "^3.1.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-each": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-each/-/jest-each-30.2.0.tgz",
      "integrity": "sha512-lpWlJlM7bCUf1mfmuqTA8+j2lNURW9eNafOy99knBM01i5CQeY5UH1vZjgT9071nDJac1M4XsbyI44oNOdhlDQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/get-type": "30.1.0",
        "@jest/types": "30.2.0",
        "chalk": "^4.1.2",
        "jest-util": "30.2.0",
        "pretty-format": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-environment-node": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-environment-node/-/jest-environment-node-30.2.0.tgz",
      "integrity": "sha512-ElU8v92QJ9UrYsKrxDIKCxu6PfNj4Hdcktcn0JX12zqNdqWHB0N+hwOnnBBXvjLd2vApZtuLUGs1QSY+MsXoNA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/environment": "30.2.0",
        "@jest/fake-timers": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "jest-mock": "30.2.0",
        "jest-util": "30.2.0",
        "jest-validate": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-haste-map": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-haste-map/-/jest-haste-map-30.2.0.tgz",
      "integrity": "sha512-sQA/jCb9kNt+neM0anSj6eZhLZUIhQgwDt7cPGjumgLM4rXsfb9kpnlacmvZz3Q5tb80nS+oG/if+NBKrHC+Xw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "anymatch": "^3.1.3",
        "fb-watchman": "^2.0.2",
        "graceful-fs": "^4.2.11",
        "jest-regex-util": "30.0.1",
        "jest-util": "30.2.0",
        "jest-worker": "30.2.0",
        "micromatch": "^4.0.8",
        "walker": "^1.0.8"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      },
      "optionalDependencies": {
        "fsevents": "^2.3.3"
      }
    },
    "node_modules/jest-leak-detector": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-leak-detector/-/jest-leak-detector-30.2.0.tgz",
      "integrity": "sha512-M6jKAjyzjHG0SrQgwhgZGy9hFazcudwCNovY/9HPIicmNSBuockPSedAP9vlPK6ONFJ1zfyH/M2/YYJxOz5cdQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/get-type": "30.1.0",
        "pretty-format": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-matcher-utils": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-matcher-utils/-/jest-matcher-utils-30.2.0.tgz",
      "integrity": "sha512-dQ94Nq4dbzmUWkQ0ANAWS9tBRfqCrn0bV9AMYdOi/MHW726xn7eQmMeRTpX2ViC00bpNaWXq+7o4lIQ3AX13Hg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/get-type": "30.1.0",
        "chalk": "^4.1.2",
        "jest-diff": "30.2.0",
        "pretty-format": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-message-util": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-message-util/-/jest-message-util-30.2.0.tgz",
      "integrity": "sha512-y4DKFLZ2y6DxTWD4cDe07RglV88ZiNEdlRfGtqahfbIjfsw1nMCPx49Uev4IA/hWn3sDKyAnSPwoYSsAEdcimw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@jest/types": "30.2.0",
        "@types/stack-utils": "^2.0.3",
        "chalk": "^4.1.2",
        "graceful-fs": "^4.2.11",
        "micromatch": "^4.0.8",
        "pretty-format": "30.2.0",
        "slash": "^3.0.0",
        "stack-utils": "^2.0.6"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-mock": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-mock/-/jest-mock-30.2.0.tgz",
      "integrity": "sha512-JNNNl2rj4b5ICpmAcq+WbLH83XswjPbjH4T7yvGzfAGCPh1rw+xVNbtk+FnRslvt9lkCcdn9i1oAoKUuFsOxRw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "jest-util": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-pnp-resolver": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/jest-pnp-resolver/-/jest-pnp-resolver-1.2.3.tgz",
      "integrity": "sha512-+3NpwQEnRoIBtx4fyhblQDPgJI0H1IEIkX7ShLUjPGA7TtUTvI1oiKi3SR4oBR0hQhQR80l4WAe5RrXBwWMA8w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      },
      "peerDependencies": {
        "jest-resolve": "*"
      },
      "peerDependenciesMeta": {
        "jest-resolve": {
          "optional": true
        }
      }
    },
    "node_modules/jest-regex-util": {
      "version": "30.0.1",
      "resolved": "https://registry.npmjs.org/jest-regex-util/-/jest-regex-util-30.0.1.tgz",
      "integrity": "sha512-jHEQgBXAgc+Gh4g0p3bCevgRCVRkB4VB70zhoAE48gxeSr1hfUOsM/C2WoJgVL7Eyg//hudYENbm3Ne+/dRVVA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-resolve": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-resolve/-/jest-resolve-30.2.0.tgz",
      "integrity": "sha512-TCrHSxPlx3tBY3hWNtRQKbtgLhsXa1WmbJEqBlTBrGafd5fiQFByy2GNCEoGR+Tns8d15GaL9cxEzKOO3GEb2A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "chalk": "^4.1.2",
        "graceful-fs": "^4.2.11",
        "jest-haste-map": "30.2.0",
        "jest-pnp-resolver": "^1.2.3",
        "jest-util": "30.2.0",
        "jest-validate": "30.2.0",
        "slash": "^3.0.0",
        "unrs-resolver": "^1.7.11"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-resolve-dependencies": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-resolve-dependencies/-/jest-resolve-dependencies-30.2.0.tgz",
      "integrity": "sha512-xTOIGug/0RmIe3mmCqCT95yO0vj6JURrn1TKWlNbhiAefJRWINNPgwVkrVgt/YaerPzY3iItufd80v3lOrFJ2w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "jest-regex-util": "30.0.1",
        "jest-snapshot": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-runner": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-runner/-/jest-runner-30.2.0.tgz",
      "integrity": "sha512-PqvZ2B2XEyPEbclp+gV6KO/F1FIFSbIwewRgmROCMBo/aZ6J1w8Qypoj2pEOcg3G2HzLlaP6VUtvwCI8dM3oqQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/console": "30.2.0",
        "@jest/environment": "30.2.0",
        "@jest/test-result": "30.2.0",
        "@jest/transform": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "chalk": "^4.1.2",
        "emittery": "^0.13.1",
        "exit-x": "^0.2.2",
        "graceful-fs": "^4.2.11",
        "jest-docblock": "30.2.0",
        "jest-environment-node": "30.2.0",
        "jest-haste-map": "30.2.0",
        "jest-leak-detector": "30.2.0",
        "jest-message-util": "30.2.0",
        "jest-resolve": "30.2.0",
        "jest-runtime": "30.2.0",
        "jest-util": "30.2.0",
        "jest-watcher": "30.2.0",
        "jest-worker": "30.2.0",
        "p-limit": "^3.1.0",
        "source-map-support": "0.5.13"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-runtime": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-runtime/-/jest-runtime-30.2.0.tgz",
      "integrity": "sha512-p1+GVX/PJqTucvsmERPMgCPvQJpFt4hFbM+VN3n8TMo47decMUcJbt+rgzwrEme0MQUA/R+1de2axftTHkKckg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/environment": "30.2.0",
        "@jest/fake-timers": "30.2.0",
        "@jest/globals": "30.2.0",
        "@jest/source-map": "30.0.1",
        "@jest/test-result": "30.2.0",
        "@jest/transform": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "chalk": "^4.1.2",
        "cjs-module-lexer": "^2.1.0",
        "collect-v8-coverage": "^1.0.2",
        "glob": "^10.3.10",
        "graceful-fs": "^4.2.11",
        "jest-haste-map": "30.2.0",
        "jest-message-util": "30.2.0",
        "jest-mock": "30.2.0",
        "jest-regex-util": "30.0.1",
        "jest-resolve": "30.2.0",
        "jest-snapshot": "30.2.0",
        "jest-util": "30.2.0",
        "slash": "^3.0.0",
        "strip-bom": "^4.0.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-snapshot": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-snapshot/-/jest-snapshot-30.2.0.tgz",
      "integrity": "sha512-5WEtTy2jXPFypadKNpbNkZ72puZCa6UjSr/7djeecHWOu7iYhSXSnHScT8wBz3Rn8Ena5d5RYRcsyKIeqG1IyA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/core": "^7.27.4",
        "@babel/generator": "^7.27.5",
        "@babel/plugin-syntax-jsx": "^7.27.1",
        "@babel/plugin-syntax-typescript": "^7.27.1",
        "@babel/types": "^7.27.3",
        "@jest/expect-utils": "30.2.0",
        "@jest/get-type": "30.1.0",
        "@jest/snapshot-utils": "30.2.0",
        "@jest/transform": "30.2.0",
        "@jest/types": "30.2.0",
        "babel-preset-current-node-syntax": "^1.2.0",
        "chalk": "^4.1.2",
        "expect": "30.2.0",
        "graceful-fs": "^4.2.11",
        "jest-diff": "30.2.0",
        "jest-matcher-utils": "30.2.0",
        "jest-message-util": "30.2.0",
        "jest-util": "30.2.0",
        "pretty-format": "30.2.0",
        "semver": "^7.7.2",
        "synckit": "^0.11.8"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-snapshot/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/jest-util": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-util/-/jest-util-30.2.0.tgz",
      "integrity": "sha512-QKNsM0o3Xe6ISQU869e+DhG+4CK/48aHYdJZGlFQVTjnbvgpcKyxpzk29fGiO7i/J8VENZ+d2iGnSsvmuHywlA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "chalk": "^4.1.2",
        "ci-info": "^4.2.0",
        "graceful-fs": "^4.2.11",
        "picomatch": "^4.0.2"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-util/node_modules/picomatch": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/jest-validate": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-validate/-/jest-validate-30.2.0.tgz",
      "integrity": "sha512-FBGWi7dP2hpdi8nBoWxSsLvBFewKAg0+uSQwBaof4Y4DPgBabXgpSYC5/lR7VmnIlSpASmCi/ntRWPbv7089Pw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/get-type": "30.1.0",
        "@jest/types": "30.2.0",
        "camelcase": "^6.3.0",
        "chalk": "^4.1.2",
        "leven": "^3.1.0",
        "pretty-format": "30.2.0"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-validate/node_modules/camelcase": {
      "version": "6.3.0",
      "resolved": "https://registry.npmjs.org/camelcase/-/camelcase-6.3.0.tgz",
      "integrity": "sha512-Gmy6FhYlCY7uOElZUSbxo2UCDH8owEk996gkbrpsgGtrJLM3J7jGxl9Ic7Qwwj4ivOE5AWZWRMecDdF7hqGjFA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/jest-watcher": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-watcher/-/jest-watcher-30.2.0.tgz",
      "integrity": "sha512-PYxa28dxJ9g777pGm/7PrbnMeA0Jr7osHP9bS7eJy9DuAjMgdGtxgf0uKMyoIsTWAkIbUW5hSDdJ3urmgXBqxg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/test-result": "30.2.0",
        "@jest/types": "30.2.0",
        "@types/node": "*",
        "ansi-escapes": "^4.3.2",
        "chalk": "^4.1.2",
        "emittery": "^0.13.1",
        "jest-util": "30.2.0",
        "string-length": "^4.0.2"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-worker": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/jest-worker/-/jest-worker-30.2.0.tgz",
      "integrity": "sha512-0Q4Uk8WF7BUwqXHuAjc23vmopWJw5WH7w2tqBoUOZpOjW/ZnR44GXXd1r82RvnmI2GZge3ivrYXk/BE2+VtW2g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@types/node": "*",
        "@ungap/structured-clone": "^1.3.0",
        "jest-util": "30.2.0",
        "merge-stream": "^2.0.0",
        "supports-color": "^8.1.1"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/jest-worker/node_modules/supports-color": {
      "version": "8.1.1",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-8.1.1.tgz",
      "integrity": "sha512-MpUEN2OodtUzxvKQl72cUF7RQ5EiHsGvSsVG0ia9c5RbWGL2CI4C7EpPS8UTBIplnlzZiNuV56w+FuNxy3ty2Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/supports-color?sponsor=1"
      }
    },
    "node_modules/jose": {
      "version": "4.15.9",
      "resolved": "https://registry.npmjs.org/jose/-/jose-4.15.9.tgz",
      "integrity": "sha512-1vUQX+IdDMVPj4k8kOxgUqlcK518yluMuGZwqlr44FS1ppZB/5GWh4rZG89erpOBOJjU/OBsnCVFfapsRz6nEA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/js-yaml": {
      "version": "3.14.2",
      "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-3.14.2.tgz",
      "integrity": "sha512-PMSmkqxr106Xa156c2M265Z+FTrPl+oxd/rgOQy2tijQeK5TxQ43psO1ZCwhVOSdnn+RzkzlRz/eY4BgJBYVpg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "argparse": "^1.0.7",
        "esprima": "^4.0.0"
      },
      "bin": {
        "js-yaml": "bin/js-yaml.js"
      }
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json-bigint": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/json-bigint/-/json-bigint-1.0.0.tgz",
      "integrity": "sha512-SiPv/8VpZuWbvLSMtTDU8hEfrZWg/mH/nV/b4o0CYbSxu1UIQPLdwKOCIyLQX+VIPO5vrLX3i8qtqFyhdPSUSQ==",
      "license": "MIT",
      "dependencies": {
        "bignumber.js": "^9.0.0"
      }
    },
    "node_modules/json-parse-even-better-errors": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/json-parse-even-better-errors/-/json-parse-even-better-errors-2.3.1.tgz",
      "integrity": "sha512-xyFwyhro/JEof6Ghe2iz2NcXoj2sloNsWr/XsERDK/oiPCfaNhl5ONfp+jQdAZRQQ0IJWNzH9zIZF7li91kh2w==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/jsonwebtoken": {
      "version": "9.0.3",
      "resolved": "https://registry.npmjs.org/jsonwebtoken/-/jsonwebtoken-9.0.3.tgz",
      "integrity": "sha512-MT/xP0CrubFRNLNKvxJ2BYfy53Zkm++5bX9dtuPbqAeQpTVe0MQTFhao8+Cp//EmJp244xt6Drw/GVEGCUj40g==",
      "license": "MIT",
      "dependencies": {
        "jws": "^4.0.1",
        "lodash.includes": "^4.3.0",
        "lodash.isboolean": "^3.0.3",
        "lodash.isinteger": "^4.0.4",
        "lodash.isnumber": "^3.0.3",
        "lodash.isplainobject": "^4.0.6",
        "lodash.isstring": "^4.0.1",
        "lodash.once": "^4.0.0",
        "ms": "^2.1.1",
        "semver": "^7.5.4"
      },
      "engines": {
        "node": ">=12",
        "npm": ">=6"
      }
    },
    "node_modules/jsonwebtoken/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/jsonwebtoken/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/jwa": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/jwa/-/jwa-2.0.1.tgz",
      "integrity": "sha512-hRF04fqJIP8Abbkq5NKGN0Bbr3JxlQ+qhZufXVr0DvujKy93ZCbXZMHDL4EOtodSbCWxOqR8MS1tXA5hwqCXDg==",
      "license": "MIT",
      "dependencies": {
        "buffer-equal-constant-time": "^1.0.1",
        "ecdsa-sig-formatter": "1.0.11",
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/jwks-rsa": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/jwks-rsa/-/jwks-rsa-3.2.0.tgz",
      "integrity": "sha512-PwchfHcQK/5PSydeKCs1ylNym0w/SSv8a62DgHJ//7x2ZclCoinlsjAfDxAAbpoTPybOum/Jgy+vkvMmKz89Ww==",
      "license": "MIT",
      "dependencies": {
        "@types/express": "^4.17.20",
        "@types/jsonwebtoken": "^9.0.4",
        "debug": "^4.3.4",
        "jose": "^4.15.4",
        "limiter": "^1.1.5",
        "lru-memoizer": "^2.2.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/jwks-rsa/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/jwks-rsa/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/jws": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/jws/-/jws-4.0.1.tgz",
      "integrity": "sha512-EKI/M/yqPncGUUh44xz0PxSidXFr/+r0pA70+gIYhjv+et7yxM+s29Y+VGDkovRofQem0fs7Uvf4+YmAdyRduA==",
      "license": "MIT",
      "dependencies": {
        "jwa": "^2.0.1",
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/leven": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/leven/-/leven-3.1.0.tgz",
      "integrity": "sha512-qsda+H8jTaUaN/x5vzW2rzc+8Rw4TAQ/4KjB46IwK5VH+IlVeeeje/EoZRpiXvIqjFgK84QffqPztGI3VBLG1A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/limiter": {
      "version": "1.1.5",
      "resolved": "https://registry.npmjs.org/limiter/-/limiter-1.1.5.tgz",
      "integrity": "sha512-FWWMIEOxz3GwUI4Ts/IvgVy6LPvoMPgjMdQ185nN6psJyBJ4yOpzqm695/h5umdLJg2vW3GR5iG11MAkR2AzJA=="
    },
    "node_modules/lines-and-columns": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz",
      "integrity": "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/locate-path": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-5.0.0.tgz",
      "integrity": "sha512-t7hw9pI+WvuwNJXwk5zVHpyhIqzg2qTlklJOf0mVxGSbe3Fp2VieZcduNYjaLDoy6p9uGpQEGWG87WpMKlNq8g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "p-locate": "^4.1.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/lodash": {
      "version": "4.17.21",
      "resolved": "https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz",
      "integrity": "sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/lodash.camelcase": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/lodash.camelcase/-/lodash.camelcase-4.3.0.tgz",
      "integrity": "sha512-TwuEnCnxbc3rAvhf/LbG7tJUDzhqXyFnv3dtzLOPgCG/hODL7WFnsbwktkD7yUV0RrreP/l1PALq/YSg6VvjlA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/lodash.clonedeep": {
      "version": "4.5.0",
      "resolved": "https://registry.npmjs.org/lodash.clonedeep/-/lodash.clonedeep-4.5.0.tgz",
      "integrity": "sha512-H5ZhCF25riFd9uB5UCkVKo61m3S/xZk1x4wA6yp/L3RFP6Z/eHH1ymQcGLo7J3GMPfm0V/7m1tryHuGVxpqEBQ==",
      "license": "MIT"
    },
    "node_modules/lodash.includes": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/lodash.includes/-/lodash.includes-4.3.0.tgz",
      "integrity": "sha512-W3Bx6mdkRTGtlJISOvVD/lbqjTlPPUDTMnlXZFnVwi9NKJ6tiAk6LVdlhZMm17VZisqhKcgzpO5Wz91PCt5b0w==",
      "license": "MIT"
    },
    "node_modules/lodash.isboolean": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/lodash.isboolean/-/lodash.isboolean-3.0.3.tgz",
      "integrity": "sha512-Bz5mupy2SVbPHURB98VAcw+aHh4vRV5IPNhILUCsOzRmsTmSQ17jIuqopAentWoehktxGd9e/hbIXq980/1QJg==",
      "license": "MIT"
    },
    "node_modules/lodash.isinteger": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/lodash.isinteger/-/lodash.isinteger-4.0.4.tgz",
      "integrity": "sha512-DBwtEWN2caHQ9/imiNeEA5ys1JoRtRfY3d7V9wkqtbycnAmTvRRmbHKDV4a0EYc678/dia0jrte4tjYwVBaZUA==",
      "license": "MIT"
    },
    "node_modules/lodash.isnumber": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/lodash.isnumber/-/lodash.isnumber-3.0.3.tgz",
      "integrity": "sha512-QYqzpfwO3/CWf3XP+Z+tkQsfaLL/EnUlXWVkIk5FUPc4sBdTehEqZONuyRt2P67PXAk+NXmTBcc97zw9t1FQrw==",
      "license": "MIT"
    },
    "node_modules/lodash.isplainobject": {
      "version": "4.0.6",
      "resolved": "https://registry.npmjs.org/lodash.isplainobject/-/lodash.isplainobject-4.0.6.tgz",
      "integrity": "sha512-oSXzaWypCMHkPC3NvBEaPHf0KsA5mvPrOPgQWDsbg8n7orZ290M0BmC/jgRZ4vcJ6DTAhjrsSYgdsW/F+MFOBA==",
      "license": "MIT"
    },
    "node_modules/lodash.isstring": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/lodash.isstring/-/lodash.isstring-4.0.1.tgz",
      "integrity": "sha512-0wJxfxH1wgO3GrbuP+dTTk7op+6L41QCXbGINEmD+ny/G/eCqGzxyCsh7159S+mgDDcoarnBw6PC1PS5+wUGgw==",
      "license": "MIT"
    },
    "node_modules/lodash.once": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/lodash.once/-/lodash.once-4.1.1.tgz",
      "integrity": "sha512-Sb487aTOCr9drQVL8pIxOzVhafOjZN9UU54hiN8PU3uAiSV7lx1yYNpbNmex2PK6dSJoNTSJUUswT651yww3Mg==",
      "license": "MIT"
    },
    "node_modules/long": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/long/-/long-5.3.2.tgz",
      "integrity": "sha512-mNAgZ1GmyNhD7AuqnTG3/VQ26o760+ZYBPKjPvugO8+nLbYfX6TVpJPseBvopbdY+qpZ/lKUnmEc1LeZYS3QAA==",
      "license": "Apache-2.0"
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/lru-memoizer": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/lru-memoizer/-/lru-memoizer-2.3.0.tgz",
      "integrity": "sha512-GXn7gyHAMhO13WSKrIiNfztwxodVsP8IoZ3XfrJV4yH2x0/OeTO/FIaAHTY5YekdGgW94njfuKmyyt1E0mR6Ug==",
      "license": "MIT",
      "dependencies": {
        "lodash.clonedeep": "^4.5.0",
        "lru-cache": "6.0.0"
      }
    },
    "node_modules/lru-memoizer/node_modules/lru-cache": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-6.0.0.tgz",
      "integrity": "sha512-Jo6dJ04CmSjuznwJSS3pUeWmd/H0ffTlkXXgwZi+eq1UCmqQwCh+eLsYOYCwY991i2Fah4h1BEMCx4qThGbsiA==",
      "license": "ISC",
      "dependencies": {
        "yallist": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/lru-memoizer/node_modules/yallist": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-4.0.0.tgz",
      "integrity": "sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==",
      "license": "ISC"
    },
    "node_modules/make-dir": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/make-dir/-/make-dir-4.0.0.tgz",
      "integrity": "sha512-hXdUTZYIVOt1Ex//jAQi+wTZZpUpwBj/0QsOzqegb3rGMMeJiSEu5xLHnYfBrRV4RH2+OCSOO95Is/7x1WJ4bw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "semver": "^7.5.3"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/make-dir/node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/makeerror": {
      "version": "1.0.12",
      "resolved": "https://registry.npmjs.org/makeerror/-/makeerror-1.0.12.tgz",
      "integrity": "sha512-JmqCvUhmt43madlpFzG4BQzG2Z3m6tvQDNKdClZnO3VbIudJYmxsT0FNJMeiB2+JTSlTQTSbU8QdesVmwJcmLg==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true,
      "dependencies": {
        "tmpl": "1.0.5"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/media-typer": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/media-typer/-/media-typer-0.3.0.tgz",
      "integrity": "sha512-dq+qelQ9akHpcOl/gUVRTxVIOkAJ1wR3QAvb4RsVjS8oVoFjDGTc679wJYmUmknUF5HwMLOgb5O+a3KxfWapPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/merge-descriptors": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/merge-descriptors/-/merge-descriptors-1.0.3.tgz",
      "integrity": "sha512-gaNvAS7TZ897/rVaZ0nMtAyxNyi/pdbjbAwUpFQpN70GqnVfOiXpeUUMKRBmzXaSQ8DdTX4/0ms62r2K+hE6mQ==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/merge-stream": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/merge-stream/-/merge-stream-2.0.0.tgz",
      "integrity": "sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/methods": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
      "integrity": "sha512-iclAHeNqNm68zFtnZ0e+1L2yUIdvzNoauKU4WBA3VvH/vPFieF7qfRlwUZU+DA9P9bPXIS90ulxoUoCH23sV2w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/micromatch": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "braces": "^3.0.3",
        "picomatch": "^2.3.1"
      },
      "engines": {
        "node": ">=8.6"
      }
    },
    "node_modules/mime": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/mime/-/mime-3.0.0.tgz",
      "integrity": "sha512-jSCU7/VB1loIWBZe14aEYHU/+1UMEHoaO7qxCOVJOw9GgH72VAWppxNcjU+x9a2k3GSIBXNKxXQFqRvvZ7vr3A==",
      "license": "MIT",
      "optional": true,
      "bin": {
        "mime": "cli.js"
      },
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mimic-fn": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/mimic-fn/-/mimic-fn-2.1.0.tgz",
      "integrity": "sha512-OqbOk5oEQeAZ8WXWydlu9HJjz9WVdEIvamMCcXmuqUYjTknH/sqsWvhQ3vgwKFRR1HpjvNBKQ37nbJgYzGqGcg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/minipass": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz",
      "integrity": "sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/mitt": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/mitt/-/mitt-3.0.1.tgz",
      "integrity": "sha512-vKivATfr97l2/QBCYAkXYDbrIWPM2IIKEl7YPhjCvKlG3kE2gm+uBo6nEXK3M5/Ffh/FLpKExzOQ3JJoJGFKBw==",
      "license": "MIT"
    },
    "node_modules/ms": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
      "license": "MIT"
    },
    "node_modules/napi-postinstall": {
      "version": "0.3.4",
      "resolved": "https://registry.npmjs.org/napi-postinstall/-/napi-postinstall-0.3.4.tgz",
      "integrity": "sha512-PHI5f1O0EP5xJ9gQmFGMS6IZcrVvTjpXjz7Na41gTE7eE2hK11lg04CECCYEEjdc17EV4DO+fkGEtt7TpTaTiQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "bin": {
        "napi-postinstall": "lib/cli.js"
      },
      "engines": {
        "node": "^12.20.0 || ^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/napi-postinstall"
      }
    },
    "node_modules/natural-compare": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
      "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/negotiator": {
      "version": "0.6.3",
      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.3.tgz",
      "integrity": "sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/netmask": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/netmask/-/netmask-2.0.2.tgz",
      "integrity": "sha512-dBpDMdxv9Irdq66304OLfEmQ9tbNRFnFTuZiLo+bD+r332bBmMJ8GBLXklIXXgxd3+v9+KUnZaUR5PJMa75Gsg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4.0"
      }
    },
    "node_modules/node-fetch": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/node-fetch/-/node-fetch-2.7.0.tgz",
      "integrity": "sha512-c4FRfUm/dbcWZ7U+1Wq0AwCyFL+3nt2bEw05wfxSz+DWpWsitgmSgYmy2dQdWyKC1694ELPqMs/YzUSNozLt8A==",
      "license": "MIT",
      "dependencies": {
        "whatwg-url": "^5.0.0"
      },
      "engines": {
        "node": "4.x || >=6.0.0"
      },
      "peerDependencies": {
        "encoding": "^0.1.0"
      },
      "peerDependenciesMeta": {
        "encoding": {
          "optional": true
        }
      }
    },
    "node_modules/node-forge": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/node-forge/-/node-forge-1.3.3.tgz",
      "integrity": "sha512-rLvcdSyRCyouf6jcOIPe/BgwG/d7hKjzMKOas33/pHEr6gbq18IK9zV7DiPvzsz0oBJPme6qr6H6kGZuI9/DZg==",
      "license": "(BSD-3-Clause OR GPL-2.0)",
      "engines": {
        "node": ">= 6.13.0"
      }
    },
    "node_modules/node-int64": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/node-int64/-/node-int64-0.4.0.tgz",
      "integrity": "sha512-O5lz91xSOeoXP6DulyHfllpq+Eg00MWitZIbtPfoSEvqIHdl5gfcY6hYzDWnj0qD5tz52PI08u9qUvSVeUBeHw==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/node-releases": {
      "version": "2.0.27",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/normalize-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz",
      "integrity": "sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/npm-run-path": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/npm-run-path/-/npm-run-path-4.0.1.tgz",
      "integrity": "sha512-S48WzZW777zhNIrn7gxOlISNAqi9ZC/uQFnRdbeIHhZhCA6UqpkOT8T1G7BvfdgP4Er8gF4sUbaS0i7QvIfCWw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "path-key": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-hash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/object-hash/-/object-hash-3.0.0.tgz",
      "integrity": "sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/object-inspect": {
      "version": "1.13.4",
      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.4.tgz",
      "integrity": "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/on-finished": {
      "version": "2.4.1",
      "resolved": "https://registry.npmjs.org/on-finished/-/on-finished-2.4.1.tgz",
      "integrity": "sha512-oVlzkg3ENAhCk2zdv7IJwd/QUD4z2RxRwpkcGY8psCVcCYZNq4wYnVWALHM+brtuJjePWiYF/ClmuDr8Ch5+kg==",
      "license": "MIT",
      "dependencies": {
        "ee-first": "1.1.1"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/once": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/once/-/once-1.4.0.tgz",
      "integrity": "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==",
      "license": "ISC",
      "dependencies": {
        "wrappy": "1"
      }
    },
    "node_modules/onetime": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/onetime/-/onetime-5.1.2.tgz",
      "integrity": "sha512-kbpaSSGJTWdAY5KPVeMOKXSrPtr8C8C7wodJbcsd51jRnmD+GZu8Y0VoU6Dm5Z4vWr0Ig/1NKuWRKf7j5aaYSg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "mimic-fn": "^2.1.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-limit": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
      "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "yocto-queue": "^0.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-locate": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-4.1.0.tgz",
      "integrity": "sha512-R79ZZ/0wAxKGu3oYMlz8jy/kbhsNrS7SKZ7PxEHBgJ5+F2mtFW2fK2cOtBh1cHYkQsbzFV7I+EoRKe6Yt0oK7A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "p-limit": "^2.2.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/p-locate/node_modules/p-limit": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-2.3.0.tgz",
      "integrity": "sha512-//88mFWSJx8lxCzwdAABTJL2MyWB12+eIY7MDL2SqLmAkeKU9qxRvWuSyTjm3FUmpBEMuFfckAIqEaVGUDxb6w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "p-try": "^2.0.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-try": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/p-try/-/p-try-2.2.0.tgz",
      "integrity": "sha512-R4nPAVTAU0B9D35/Gk3uJf/7XYbQcyohSKdvAxIRSNghFl4e71hVoGnBNQz9cWaXxO2I10KTC+3jMdvvoKw6dQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/pac-proxy-agent": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/pac-proxy-agent/-/pac-proxy-agent-7.2.0.tgz",
      "integrity": "sha512-TEB8ESquiLMc0lV8vcd5Ql/JAKAoyzHFXaStwjkzpOpC5Yv+pIzLfHvjTSdf3vpa2bMiUQrg9i6276yn8666aA==",
      "license": "MIT",
      "dependencies": {
        "@tootallnate/quickjs-emscripten": "^0.23.0",
        "agent-base": "^7.1.2",
        "debug": "^4.3.4",
        "get-uri": "^6.0.1",
        "http-proxy-agent": "^7.0.0",
        "https-proxy-agent": "^7.0.6",
        "pac-resolver": "^7.0.1",
        "socks-proxy-agent": "^8.0.5"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/pac-proxy-agent/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/pac-proxy-agent/node_modules/http-proxy-agent": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz",
      "integrity": "sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/pac-proxy-agent/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/pac-resolver": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/pac-resolver/-/pac-resolver-7.0.1.tgz",
      "integrity": "sha512-5NPgf87AT2STgwa2ntRMr45jTKrYBGkVU36yT0ig/n/GMAa3oPqhZfIQ2kMEimReg0+t9kZViDVZ83qfVUlckg==",
      "license": "MIT",
      "dependencies": {
        "degenerator": "^5.0.0",
        "netmask": "^2.0.2"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/package-json-from-dist": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz",
      "integrity": "sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==",
      "dev": true,
      "license": "BlueOak-1.0.0",
      "peer": true
    },
    "node_modules/parse-json": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/parse-json/-/parse-json-5.2.0.tgz",
      "integrity": "sha512-ayCKvm/phCGxOkYRSCM82iDwct8/EonSEgCSxWxD7ve6jHggsFl4fZVQBPRNgQoKiuV/odhFrGzQXZwbifC8Rg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/code-frame": "^7.0.0",
        "error-ex": "^1.3.1",
        "json-parse-even-better-errors": "^2.3.0",
        "lines-and-columns": "^1.1.6"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/parseurl": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/parseurl/-/parseurl-1.3.3.tgz",
      "integrity": "sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/path-exists": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
      "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-is-absolute": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/path-is-absolute/-/path-is-absolute-1.0.1.tgz",
      "integrity": "sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-scurry": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz",
      "integrity": "sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==",
      "dev": true,
      "license": "BlueOak-1.0.0",
      "peer": true,
      "dependencies": {
        "lru-cache": "^10.2.0",
        "minipass": "^5.0.0 || ^6.0.2 || ^7.0.0"
      },
      "engines": {
        "node": ">=16 || 14 >=14.18"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/path-scurry/node_modules/lru-cache": {
      "version": "10.4.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz",
      "integrity": "sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/path-to-regexp": {
      "version": "0.1.12",
      "resolved": "https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.12.tgz",
      "integrity": "sha512-RA1GjUVMnvYFxuqovrEqZoxxW5NUZqbwKtYz/Tt7nXerk0LbLblQmrsgdeOxV5SFHf0UDggjS/bSeOZwt1pmEQ==",
      "license": "MIT"
    },
    "node_modules/pend": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/pend/-/pend-1.2.0.tgz",
      "integrity": "sha512-F3asv42UuXchdzt+xXqfW1OGlVBe+mxa2mqI0pg5yAHZPvFmY3Y6drSf/GQ1A86WgWEN9Kzh/WrgKa6iGcHXLg==",
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/picomatch": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/pirates": {
      "version": "4.0.7",
      "resolved": "https://registry.npmjs.org/pirates/-/pirates-4.0.7.tgz",
      "integrity": "sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/pkg-dir": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/pkg-dir/-/pkg-dir-4.2.0.tgz",
      "integrity": "sha512-HRDzbaKjC+AOWVXxAU/x54COGeIv9eb+6CkDSQoNTt4XyWoIJvuPsXizxu/Fr23EiekbtZwmh1IcIG/l/a10GQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "find-up": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/pretty-format": {
      "version": "30.2.0",
      "resolved": "https://registry.npmjs.org/pretty-format/-/pretty-format-30.2.0.tgz",
      "integrity": "sha512-9uBdv/B4EefsuAL+pWqueZyZS2Ba+LxfFeQ9DN14HU4bN8bhaxKdkpjpB6fs9+pSjIBu+FXQHImEg8j/Lw0+vA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@jest/schemas": "30.0.5",
        "ansi-styles": "^5.2.0",
        "react-is": "^18.3.1"
      },
      "engines": {
        "node": "^18.14.0 || ^20.0.0 || ^22.0.0 || >=24.0.0"
      }
    },
    "node_modules/pretty-format/node_modules/ansi-styles": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-5.2.0.tgz",
      "integrity": "sha512-Cxwpt2SfTzTtXcfOlzGEee8O+c+MmUgGrNiBcXnuWxuFJHe6a5Hz7qwhwe5OgaSYI0IJvkLqWX1ASG+cJOkEiA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/progress": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/progress/-/progress-2.0.3.tgz",
      "integrity": "sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/proto3-json-serializer": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/proto3-json-serializer/-/proto3-json-serializer-2.0.2.tgz",
      "integrity": "sha512-SAzp/O4Yh02jGdRc+uIrGoe87dkN/XtwxfZ4ZyafJHymd79ozp5VG5nyZ7ygqPM5+cpLDjjGnYFUkngonyDPOQ==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "protobufjs": "^7.2.5"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/protobufjs": {
      "version": "7.5.4",
      "resolved": "https://registry.npmjs.org/protobufjs/-/protobufjs-7.5.4.tgz",
      "integrity": "sha512-CvexbZtbov6jW2eXAvLukXjXUW1TzFaivC46BpWc/3BpcCysb5Vffu+B3XHMm8lVEuy2Mm4XGex8hBSg1yapPg==",
      "hasInstallScript": true,
      "license": "BSD-3-Clause",
      "dependencies": {
        "@protobufjs/aspromise": "^1.1.2",
        "@protobufjs/base64": "^1.1.2",
        "@protobufjs/codegen": "^2.0.4",
        "@protobufjs/eventemitter": "^1.1.0",
        "@protobufjs/fetch": "^1.1.0",
        "@protobufjs/float": "^1.0.2",
        "@protobufjs/inquire": "^1.1.0",
        "@protobufjs/path": "^1.1.2",
        "@protobufjs/pool": "^1.1.0",
        "@protobufjs/utf8": "^1.1.0",
        "@types/node": ">=13.7.0",
        "long": "^5.0.0"
      },
      "engines": {
        "node": ">=12.0.0"
      }
    },
    "node_modules/proxy-addr": {
      "version": "2.0.7",
      "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
      "integrity": "sha512-llQsMLSUDUPT44jdrU/O37qlnifitDP+ZwrmmZcoSKyLKvtZxpyV0n2/bD/N4tBAAZ/gJEdZU7KMraoK1+XYAg==",
      "license": "MIT",
      "dependencies": {
        "forwarded": "0.2.0",
        "ipaddr.js": "1.9.1"
      },
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/proxy-agent": {
      "version": "6.5.0",
      "resolved": "https://registry.npmjs.org/proxy-agent/-/proxy-agent-6.5.0.tgz",
      "integrity": "sha512-TmatMXdr2KlRiA2CyDu8GqR8EjahTG3aY3nXjdzFyoZbmB8hrBsTyMezhULIXKnC0jpfjlmiZ3+EaCzoInSu/A==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.2",
        "debug": "^4.3.4",
        "http-proxy-agent": "^7.0.1",
        "https-proxy-agent": "^7.0.6",
        "lru-cache": "^7.14.1",
        "pac-proxy-agent": "^7.1.0",
        "proxy-from-env": "^1.1.0",
        "socks-proxy-agent": "^8.0.5"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/proxy-agent/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/proxy-agent/node_modules/http-proxy-agent": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz",
      "integrity": "sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/proxy-agent/node_modules/lru-cache": {
      "version": "7.18.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-7.18.3.tgz",
      "integrity": "sha512-jumlc0BIUrS3qJGgIkWZsyfAM7NCWiBcCDhnd+3NNM5KbBmLTgHVfWBcg6W+rLUsIpzpERPsvwUP7CckAQSOoA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/proxy-agent/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
      "license": "MIT"
    },
    "node_modules/pump": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/pump/-/pump-3.0.3.tgz",
      "integrity": "sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA==",
      "license": "MIT",
      "dependencies": {
        "end-of-stream": "^1.1.0",
        "once": "^1.3.1"
      }
    },
    "node_modules/puppeteer-core": {
      "version": "24.34.0",
      "resolved": "https://registry.npmjs.org/puppeteer-core/-/puppeteer-core-24.34.0.tgz",
      "integrity": "sha512-24evawO+mUGW4mvS2a2ivwLdX3gk8zRLZr9HP+7+VT2vBQnm0oh9jJEZmUE3ePJhRkYlZ93i7OMpdcoi2qNCLg==",
      "license": "Apache-2.0",
      "dependencies": {
        "@puppeteer/browsers": "2.11.0",
        "chromium-bidi": "12.0.1",
        "debug": "^4.4.3",
        "devtools-protocol": "0.0.1534754",
        "typed-query-selector": "^2.12.0",
        "webdriver-bidi-protocol": "0.3.10",
        "ws": "^8.18.3"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/puppeteer-core/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/puppeteer-core/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/pure-rand": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/pure-rand/-/pure-rand-7.0.1.tgz",
      "integrity": "sha512-oTUZM/NAZS8p7ANR3SHh30kXB+zK2r2BPcEn/awJIbOvq82WoMN4p62AWWp3Hhw50G0xMsw1mhIBLqHw64EcNQ==",
      "dev": true,
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/dubzzz"
        },
        {
          "type": "opencollective",
          "url": "https://opencollective.com/fast-check"
        }
      ],
      "license": "MIT",
      "peer": true
    },
    "node_modules/qs": {
      "version": "6.14.0",
      "resolved": "https://registry.npmjs.org/qs/-/qs-6.14.0.tgz",
      "integrity": "sha512-YWWTjgABSKcvs/nWBi9PycY/JiPJqOD4JA6o9Sej2AtvSGarXxKC3OQSk4pAarbdQlKAh5D4FCQkJNkW+GAn3w==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">=0.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/range-parser": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
      "integrity": "sha512-Hrgsx+orqoygnmhFbKaHE6c296J+HTAQXoxEF6gNupROmmGJRoyzfG3ccAveqCBrwr/2yxQ5BVd/GTl5agOwSg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/raw-body": {
      "version": "2.5.3",
      "resolved": "https://registry.npmjs.org/raw-body/-/raw-body-2.5.3.tgz",
      "integrity": "sha512-s4VSOf6yN0rvbRZGxs8Om5CWj6seneMwK3oDb4lWDH0UPhWcxwOWw5+qk24bxq87szX1ydrwylIOp2uG1ojUpA==",
      "license": "MIT",
      "dependencies": {
        "bytes": "~3.1.2",
        "http-errors": "~2.0.1",
        "iconv-lite": "~0.4.24",
        "unpipe": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/react-is": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-18.3.1.tgz",
      "integrity": "sha512-/LLMVyas0ljjAtoYiPqYiL8VWXzUUdThrmU5+n20DZv+a+ClRoevUzw5JxU+Ieh5/c87ytoTBV9G1FiKfNJdmg==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/readable-stream": {
      "version": "3.6.2",
      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "inherits": "^2.0.3",
        "string_decoder": "^1.1.1",
        "util-deprecate": "^1.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/require-directory": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/require-directory/-/require-directory-2.1.1.tgz",
      "integrity": "sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/resolve-cwd": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/resolve-cwd/-/resolve-cwd-3.0.0.tgz",
      "integrity": "sha512-OrZaX2Mb+rJCpH/6CpSqt9xFVpN++x01XnN2ie9g6P5/3xelLAkXWVADpdz1IHD/KFfEXyE6V0U01OQ3UO2rEg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "resolve-from": "^5.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/resolve-from": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-5.0.0.tgz",
      "integrity": "sha512-qYg9KP24dD5qka9J47d0aVky0N+b4fTU89LN9iDnjB5waksiC49rvMB0PrUJQGoTmH50XPiqOvAjDfaijGxYZw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/retry": {
      "version": "0.13.1",
      "resolved": "https://registry.npmjs.org/retry/-/retry-0.13.1.tgz",
      "integrity": "sha512-XQBQ3I8W1Cge0Seh+6gjj03LbmRFWuoszgK9ooCpwYIrhhoO80pfq4cUkU5DkknwfOfFteRwlZ56PYOGYyFWdg==",
      "license": "MIT",
      "optional": true,
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/retry-request": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/retry-request/-/retry-request-7.0.2.tgz",
      "integrity": "sha512-dUOvLMJ0/JJYEn8NrpOaGNE7X3vpI5XlZS/u0ANjqtcZVKnIxP7IgCFwrKTxENw29emmwug53awKtaMm4i9g5w==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@types/request": "^2.48.8",
        "extend": "^3.0.2",
        "teeny-request": "^9.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/safe-buffer": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/safer-buffer": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
      "license": "MIT"
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/send": {
      "version": "0.19.2",
      "resolved": "https://registry.npmjs.org/send/-/send-0.19.2.tgz",
      "integrity": "sha512-VMbMxbDeehAxpOtWJXlcUS5E8iXh6QmN+BkRX1GARS3wRaXEEgzCcB10gTQazO42tpNIya8xIyNx8fll1OFPrg==",
      "license": "MIT",
      "dependencies": {
        "debug": "2.6.9",
        "depd": "2.0.0",
        "destroy": "1.2.0",
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "etag": "~1.8.1",
        "fresh": "~0.5.2",
        "http-errors": "~2.0.1",
        "mime": "1.6.0",
        "ms": "2.1.3",
        "on-finished": "~2.4.1",
        "range-parser": "~1.2.1",
        "statuses": "~2.0.2"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/send/node_modules/mime": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/mime/-/mime-1.6.0.tgz",
      "integrity": "sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==",
      "license": "MIT",
      "bin": {
        "mime": "cli.js"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/send/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/serve-static": {
      "version": "1.16.3",
      "resolved": "https://registry.npmjs.org/serve-static/-/serve-static-1.16.3.tgz",
      "integrity": "sha512-x0RTqQel6g5SY7Lg6ZreMmsOzncHFU7nhnRWkKgWuMTu5NN0DR5oruckMqRvacAN9d5w6ARnRBXl9xhDCgfMeA==",
      "license": "MIT",
      "dependencies": {
        "encodeurl": "~2.0.0",
        "escape-html": "~1.0.3",
        "parseurl": "~1.3.3",
        "send": "~0.19.1"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/setprototypeof": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.2.0.tgz",
      "integrity": "sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw==",
      "license": "ISC"
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/side-channel": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
      "integrity": "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3",
        "side-channel-list": "^1.0.0",
        "side-channel-map": "^1.0.1",
        "side-channel-weakmap": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-list": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/side-channel-list/-/side-channel-list-1.0.0.tgz",
      "integrity": "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-map": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/side-channel-map/-/side-channel-map-1.0.1.tgz",
      "integrity": "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==",
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-weakmap": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/side-channel-weakmap/-/side-channel-weakmap-1.0.2.tgz",
      "integrity": "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==",
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3",
        "side-channel-map": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/signal-exit": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz",
      "integrity": "sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/slash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/slash/-/slash-3.0.0.tgz",
      "integrity": "sha512-g9Q1haeby36OSStwb4ntCGGGaKsaVSjQ68fBxoQcutl5fS1vuY18H3wSt3jFyFtrkx+Kz0V1G85A4MyAdDMi2Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/smart-buffer": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/smart-buffer/-/smart-buffer-4.2.0.tgz",
      "integrity": "sha512-94hK0Hh8rPqQl2xXc3HsaBoOXKV20MToPkcXvwbISWLEs+64sBq5kFgn2kJDHb1Pry9yrP0dxrCI9RRci7RXKg==",
      "license": "MIT",
      "engines": {
        "node": ">= 6.0.0",
        "npm": ">= 3.0.0"
      }
    },
    "node_modules/socks": {
      "version": "2.8.7",
      "resolved": "https://registry.npmjs.org/socks/-/socks-2.8.7.tgz",
      "integrity": "sha512-HLpt+uLy/pxB+bum/9DzAgiKS8CX1EvbWxI4zlmgGCExImLdiad2iCwXT5Z4c9c3Eq8rP2318mPW2c+QbtjK8A==",
      "license": "MIT",
      "dependencies": {
        "ip-address": "^10.0.1",
        "smart-buffer": "^4.2.0"
      },
      "engines": {
        "node": ">= 10.0.0",
        "npm": ">= 3.0.0"
      }
    },
    "node_modules/socks-proxy-agent": {
      "version": "8.0.5",
      "resolved": "https://registry.npmjs.org/socks-proxy-agent/-/socks-proxy-agent-8.0.5.tgz",
      "integrity": "sha512-HehCEsotFqbPW9sJ8WVYB6UbmIMv7kUUORIF2Nncq4VQvBfNBLibW9YZR5dlYCSUhwcD628pRllm7n+E+YTzJw==",
      "license": "MIT",
      "dependencies": {
        "agent-base": "^7.1.2",
        "debug": "^4.3.4",
        "socks": "^2.8.3"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/socks-proxy-agent/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/socks-proxy-agent/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "devOptional": true,
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/source-map-support": {
      "version": "0.5.13",
      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.13.tgz",
      "integrity": "sha512-SHSKFHadjVA5oR4PPqhtAVdcBWwRYVd6g6cAXnIbRiIwc2EhPrTuKUBdSLvlEKyIP3GCf89fltvcZiP9MMFA1w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "buffer-from": "^1.0.0",
        "source-map": "^0.6.0"
      }
    },
    "node_modules/sprintf-js": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/sprintf-js/-/sprintf-js-1.0.3.tgz",
      "integrity": "sha512-D9cPgkvLlV3t3IzL0D0YLvGA9Ahk4PcvVwUbN0dSGr1aP0Nrt4AEnTUbuGvquEC0mA64Gqt1fzirlRs5ibXx8g==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true
    },
    "node_modules/stack-utils": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/stack-utils/-/stack-utils-2.0.6.tgz",
      "integrity": "sha512-XlkWvfIm6RmsWtNJx+uqtKLS8eqFbxUg0ZzLXqY0caEy9l7hruX8IpiDnjsLavoBgqCCR71TqWO8MaXYheJ3RQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "escape-string-regexp": "^2.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/statuses": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.2.tgz",
      "integrity": "sha512-DvEy55V3DB7uknRo+4iOGT5fP1slR8wQohVdknigZPMpMstaKJQWhwiYBACJE3Ul2pTnATihhBYnRhZQHGBiRw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/stream-events": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/stream-events/-/stream-events-1.0.5.tgz",
      "integrity": "sha512-E1GUzBSgvct8Jsb3v2X15pjzN1tYebtbLaMg+eBOUOAxgbLoSbT2NS91ckc5lJD1KfLjId+jXJRgo0qnV5Nerg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "stubs": "^3.0.0"
      }
    },
    "node_modules/stream-shift": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/stream-shift/-/stream-shift-1.0.3.tgz",
      "integrity": "sha512-76ORR0DO1o1hlKwTbi/DM3EXWGf3ZJYO8cXX5RJwnul2DEg2oyoZyjLNoQM8WsvZiFKCRfC1O0J7iCvie3RZmQ==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/streamx": {
      "version": "2.23.0",
      "resolved": "https://registry.npmjs.org/streamx/-/streamx-2.23.0.tgz",
      "integrity": "sha512-kn+e44esVfn2Fa/O0CPFcex27fjIL6MkVae0Mm6q+E6f0hWv578YCERbv+4m02cjxvDsPKLnmxral/rR6lBMAg==",
      "license": "MIT",
      "dependencies": {
        "events-universal": "^1.0.0",
        "fast-fifo": "^1.3.2",
        "text-decoder": "^1.1.0"
      }
    },
    "node_modules/string_decoder": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.3.0.tgz",
      "integrity": "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "safe-buffer": "~5.2.0"
      }
    },
    "node_modules/string-length": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/string-length/-/string-length-4.0.2.tgz",
      "integrity": "sha512-+l6rNN5fYHNhZZy41RXsYptCjA2Igmq4EG7kZAYFQI1E1VTXarr6ZPXBg6eq7Y6eK4FEhY6AJlyuFIb/v/S0VQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "char-regex": "^1.0.2",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/string-length/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-length/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz",
      "integrity": "sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "eastasianwidth": "^0.2.0",
        "emoji-regex": "^9.2.2",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/string-width-cjs": {
      "name": "string-width",
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/string-width-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz",
      "integrity": "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-regex": "^6.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
      }
    },
    "node_modules/strip-ansi-cjs": {
      "name": "strip-ansi",
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-bom": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/strip-bom/-/strip-bom-4.0.0.tgz",
      "integrity": "sha512-3xurFv5tEgii33Zi8Jtp55wEIILR9eh34FAW00PZf+JnSsTmV/ioewSgQl97JHvgjoRGwPShsWm+IdrxB35d0w==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-final-newline": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/strip-final-newline/-/strip-final-newline-2.0.0.tgz",
      "integrity": "sha512-BrpvfNAE3dcvq7ll3xVumzjKjZQ5tI1sEUIKr3Uoks0XUl45St3FlatVqef9prk4jRDzhW6WZg+3bk93y6pLjA==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/strip-json-comments": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
      "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/strnum": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/strnum/-/strnum-1.1.2.tgz",
      "integrity": "sha512-vrN+B7DBIoTTZjnPNewwhx6cBA/H+IS7rfW68n7XxC1y7uoiGQBxaKzqucGUgavX15dJgiGztLJ8vxuEzwqBdA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/NaturalIntelligence"
        }
      ],
      "license": "MIT",
      "optional": true
    },
    "node_modules/stubs": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/stubs/-/stubs-3.0.0.tgz",
      "integrity": "sha512-PdHt7hHUJKxvTCgbKX9C1V/ftOcjJQgz8BZwNfV5c4B6dcGqlpelTbJ999jBGZ2jYiPAwcX5dP6oBwVlBlUbxw==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/supports-color": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/synckit": {
      "version": "0.11.11",
      "resolved": "https://registry.npmjs.org/synckit/-/synckit-0.11.11.tgz",
      "integrity": "sha512-MeQTA1r0litLUf0Rp/iisCaL8761lKAZHaimlbGK4j0HysC4PLfqygQj9srcs0m2RdtDYnF8UuYyKpbjHYp7Jw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@pkgr/core": "^0.2.9"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/synckit"
      }
    },
    "node_modules/tar-fs": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/tar-fs/-/tar-fs-3.1.1.tgz",
      "integrity": "sha512-LZA0oaPOc2fVo82Txf3gw+AkEd38szODlptMYejQUhndHMLQ9M059uXR+AfS7DNo0NpINvSqDsvyaCrBVkptWg==",
      "license": "MIT",
      "dependencies": {
        "pump": "^3.0.0",
        "tar-stream": "^3.1.5"
      },
      "optionalDependencies": {
        "bare-fs": "^4.0.1",
        "bare-path": "^3.0.0"
      }
    },
    "node_modules/tar-stream": {
      "version": "3.1.7",
      "resolved": "https://registry.npmjs.org/tar-stream/-/tar-stream-3.1.7.tgz",
      "integrity": "sha512-qJj60CXt7IU1Ffyc3NJMjh6EkuCFej46zUqJ4J7pqYlThyd9bO0XBTmcOIhSzZJVWfsLks0+nle/j538YAW9RQ==",
      "license": "MIT",
      "dependencies": {
        "b4a": "^1.6.4",
        "fast-fifo": "^1.2.0",
        "streamx": "^2.15.0"
      }
    },
    "node_modules/teeny-request": {
      "version": "9.0.0",
      "resolved": "https://registry.npmjs.org/teeny-request/-/teeny-request-9.0.0.tgz",
      "integrity": "sha512-resvxdc6Mgb7YEThw6G6bExlXKkv6+YbuzGg9xuXxSgxJF7Ozs+o8Y9+2R3sArdWdW8nOokoQb1yrpFB0pQK2g==",
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "http-proxy-agent": "^5.0.0",
        "https-proxy-agent": "^5.0.0",
        "node-fetch": "^2.6.9",
        "stream-events": "^1.0.5",
        "uuid": "^9.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/teeny-request/node_modules/agent-base": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "debug": "4"
      },
      "engines": {
        "node": ">= 6.0.0"
      }
    },
    "node_modules/teeny-request/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/teeny-request/node_modules/https-proxy-agent": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz",
      "integrity": "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "agent-base": "6",
        "debug": "4"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/teeny-request/node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/teeny-request/node_modules/uuid": {
      "version": "9.0.1",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "optional": true,
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/test-exclude": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/test-exclude/-/test-exclude-6.0.0.tgz",
      "integrity": "sha512-cAGWPIyOHU6zlmg88jwm7VRyXnMN7iV68OGAbYDk/Mh/xC/pzVPlQtY6ngoIH/5/tciuhGfvESU8GrHrcxD56w==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "@istanbuljs/schema": "^0.1.2",
        "glob": "^7.1.4",
        "minimatch": "^3.0.4"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/test-exclude/node_modules/brace-expansion": {
      "version": "1.1.12",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/test-exclude/node_modules/glob": {
      "version": "7.2.3",
      "resolved": "https://registry.npmjs.org/glob/-/glob-7.2.3.tgz",
      "integrity": "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==",
      "deprecated": "Glob versions prior to v9 are no longer supported",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "fs.realpath": "^1.0.0",
        "inflight": "^1.0.4",
        "inherits": "2",
        "minimatch": "^3.1.1",
        "once": "^1.3.0",
        "path-is-absolute": "^1.0.0"
      },
      "engines": {
        "node": "*"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/test-exclude/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/text-decoder": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/text-decoder/-/text-decoder-1.2.3.tgz",
      "integrity": "sha512-3/o9z3X0X0fTupwsYvR03pJ/DjWuqqrfwBgTQzdWDiQSm9KitAyz/9WqsT2JQW7KV2m+bC2ol/zqpW37NHxLaA==",
      "license": "Apache-2.0",
      "dependencies": {
        "b4a": "^1.6.4"
      }
    },
    "node_modules/tmpl": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/tmpl/-/tmpl-1.0.5.tgz",
      "integrity": "sha512-3f0uOEAQwIqGuWW2MVzYg8fV/QNnc/IpuJNG837rLuczAaLVHslWHZQj4IGiEl5Hs3kkbhwL9Ab7Hrsmuj+Smw==",
      "dev": true,
      "license": "BSD-3-Clause",
      "peer": true
    },
    "node_modules/to-regex-range": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "is-number": "^7.0.0"
      },
      "engines": {
        "node": ">=8.0"
      }
    },
    "node_modules/toidentifier": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/toidentifier/-/toidentifier-1.0.1.tgz",
      "integrity": "sha512-o5sSPKEkg/DIQNmH43V0/uerLrpzVedkUh8tGNvaeXpfpuwjKenlSox/2O/BTlZUtEe+JG7s5YhEz608PlAHRA==",
      "license": "MIT",
      "engines": {
        "node": ">=0.6"
      }
    },
    "node_modules/tr46": {
      "version": "0.0.3",
      "resolved": "https://registry.npmjs.org/tr46/-/tr46-0.0.3.tgz",
      "integrity": "sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==",
      "license": "MIT"
    },
    "node_modules/ts-deepmerge": {
      "version": "2.0.7",
      "resolved": "https://registry.npmjs.org/ts-deepmerge/-/ts-deepmerge-2.0.7.tgz",
      "integrity": "sha512-3phiGcxPSSR47RBubQxPoZ+pqXsEsozLo4G4AlSrsMKTFg9TA3l+3he5BqpUi9wiuDbaHWXH/amlzQ49uEdXtg==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
      "license": "0BSD"
    },
    "node_modules/type-detect": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/type-detect/-/type-detect-4.0.8.tgz",
      "integrity": "sha512-0fr/mIH1dlO+x7TlcMy+bIDqKPsw/70tVyeHW787goQjhmqaZe10uwLujubK9q9Lg6Fiho1KUKDYz0Z7k7g5/g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/type-fest": {
      "version": "0.21.3",
      "resolved": "https://registry.npmjs.org/type-fest/-/type-fest-0.21.3.tgz",
      "integrity": "sha512-t0rzBq87m3fVcduHDUFhKmyyX+9eo6WQjZvf51Ea/M0Q7+T374Jp1aUiyUl0GKxp8M/OETVHSDvmkyPgvX+X2w==",
      "dev": true,
      "license": "(MIT OR CC0-1.0)",
      "peer": true,
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/type-is": {
      "version": "1.6.18",
      "resolved": "https://registry.npmjs.org/type-is/-/type-is-1.6.18.tgz",
      "integrity": "sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==",
      "license": "MIT",
      "dependencies": {
        "media-typer": "0.3.0",
        "mime-types": "~2.1.24"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/typed-query-selector": {
      "version": "2.12.0",
      "resolved": "https://registry.npmjs.org/typed-query-selector/-/typed-query-selector-2.12.0.tgz",
      "integrity": "sha512-SbklCd1F0EiZOyPiW192rrHZzZ5sBijB6xM+cpmrwDqObvdtunOHHIk9fCGsoK5JVIYXoyEp4iEdE3upFH3PAg==",
      "license": "MIT"
    },
    "node_modules/typescript": {
      "version": "5.9.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/undici-types": {
      "version": "6.21.0",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-6.21.0.tgz",
      "integrity": "sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==",
      "license": "MIT"
    },
    "node_modules/unpipe": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
      "integrity": "sha512-pjy2bYhSsufwWlKwPc+l3cN7+wuJlK6uz0YdJEOlQDbl6jo/YlPi4mb8agUkVC8BF7V8NuzeyPNqRksA3hztKQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/unrs-resolver": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/unrs-resolver/-/unrs-resolver-1.11.1.tgz",
      "integrity": "sha512-bSjt9pjaEBnNiGgc9rUiHGKv5l4/TGzDmYw3RhnkJGtLhbnnA/5qJj7x3dNDCRx/PJxu774LlH8lCOlB4hEfKg==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "napi-postinstall": "^0.3.0"
      },
      "funding": {
        "url": "https://opencollective.com/unrs-resolver"
      },
      "optionalDependencies": {
        "@unrs/resolver-binding-android-arm-eabi": "1.11.1",
        "@unrs/resolver-binding-android-arm64": "1.11.1",
        "@unrs/resolver-binding-darwin-arm64": "1.11.1",
        "@unrs/resolver-binding-darwin-x64": "1.11.1",
        "@unrs/resolver-binding-freebsd-x64": "1.11.1",
        "@unrs/resolver-binding-linux-arm-gnueabihf": "1.11.1",
        "@unrs/resolver-binding-linux-arm-musleabihf": "1.11.1",
        "@unrs/resolver-binding-linux-arm64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-arm64-musl": "1.11.1",
        "@unrs/resolver-binding-linux-ppc64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-riscv64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-riscv64-musl": "1.11.1",
        "@unrs/resolver-binding-linux-s390x-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-x64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-x64-musl": "1.11.1",
        "@unrs/resolver-binding-wasm32-wasi": "1.11.1",
        "@unrs/resolver-binding-win32-arm64-msvc": "1.11.1",
        "@unrs/resolver-binding-win32-ia32-msvc": "1.11.1",
        "@unrs/resolver-binding-win32-x64-msvc": "1.11.1"
      }
    },
    "node_modules/update-browserslist-db": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/utils-merge": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/utils-merge/-/utils-merge-1.0.1.tgz",
      "integrity": "sha512-pMZTvIkT1d+TFGvDOqodOclx0QWkkgi6Tdoa8gC8ffGAAqz9pzPTZWAybbsHHoED/ztMtkv/VoYTYyShUn81hA==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4.0"
      }
    },
    "node_modules/uuid": {
      "version": "11.1.0",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-11.1.0.tgz",
      "integrity": "sha512-0/A9rDy9P7cJ+8w1c9WD9V//9Wj15Ce2MPz8Ri6032usz+NfePxx5AcN3bN+r6ZL6jEo066/yNYB3tn4pQEx+A==",
      "funding": [
        "https://github.com/sponsors/broofa",
        "https://github.com/sponsors/ctavan"
      ],
      "license": "MIT",
      "bin": {
        "uuid": "dist/esm/bin/uuid"
      }
    },
    "node_modules/v8-to-istanbul": {
      "version": "9.3.0",
      "resolved": "https://registry.npmjs.org/v8-to-istanbul/-/v8-to-istanbul-9.3.0.tgz",
      "integrity": "sha512-kiGUalWN+rgBJ/1OHZsBtU4rXZOfj/7rKQxULKlIzwzQSvMJUUNgPwJEEh7gU6xEVxC0ahoOBvN2YI8GH6FNgA==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "@jridgewell/trace-mapping": "^0.3.12",
        "@types/istanbul-lib-coverage": "^2.0.1",
        "convert-source-map": "^2.0.0"
      },
      "engines": {
        "node": ">=10.12.0"
      }
    },
    "node_modules/vary": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
      "integrity": "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/walker": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/walker/-/walker-1.0.8.tgz",
      "integrity": "sha512-ts/8E8l5b7kY0vlWLewOkDXMmPdLcVV4GmOQLyxuSswIJsweeFZtAsMF7k1Nszz+TYBQrlYRmzOnr398y1JemQ==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "dependencies": {
        "makeerror": "1.0.12"
      }
    },
    "node_modules/webdriver-bidi-protocol": {
      "version": "0.3.10",
      "resolved": "https://registry.npmjs.org/webdriver-bidi-protocol/-/webdriver-bidi-protocol-0.3.10.tgz",
      "integrity": "sha512-5LAE43jAVLOhB/QqX4bwSiv0Hg1HBfMmOuwBSXHdvg4GMGu9Y0lIq7p4R/yySu6w74WmaR4GM4H9t2IwLW7hgw==",
      "license": "Apache-2.0"
    },
    "node_modules/webidl-conversions": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/webidl-conversions/-/webidl-conversions-3.0.1.tgz",
      "integrity": "sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==",
      "license": "BSD-2-Clause"
    },
    "node_modules/websocket-driver": {
      "version": "0.7.4",
      "resolved": "https://registry.npmjs.org/websocket-driver/-/websocket-driver-0.7.4.tgz",
      "integrity": "sha512-b17KeDIQVjvb0ssuSDF2cYXSg2iztliJ4B9WdsuB6J952qCPKmnVq4DyW5motImXHDC1cBT/1UezrJVsKw5zjg==",
      "license": "Apache-2.0",
      "dependencies": {
        "http-parser-js": ">=0.5.1",
        "safe-buffer": ">=5.1.0",
        "websocket-extensions": ">=0.1.1"
      },
      "engines": {
        "node": ">=0.8.0"
      }
    },
    "node_modules/websocket-extensions": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/websocket-extensions/-/websocket-extensions-0.1.4.tgz",
      "integrity": "sha512-OqedPIGOfsDlo31UNwYbCFMSaO9m9G/0faIHj5/dZFDMFqPTcx6UwqyOy3COEaEOg/9VsGIpdqn62W5KhoKSpg==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=0.8.0"
      }
    },
    "node_modules/whatwg-url": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-url/-/whatwg-url-5.0.0.tgz",
      "integrity": "sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==",
      "license": "MIT",
      "dependencies": {
        "tr46": "~0.0.3",
        "webidl-conversions": "^3.0.0"
      }
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/wrap-ansi": {
      "version": "8.1.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz",
      "integrity": "sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-styles": "^6.1.0",
        "string-width": "^5.0.1",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs": {
      "name": "wrap-ansi",
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "dev": true,
      "license": "MIT",
      "peer": true
    },
    "node_modules/wrap-ansi-cjs/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi/node_modules/ansi-styles": {
      "version": "6.2.3",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.3.tgz",
      "integrity": "sha512-4Dj6M28JB+oAH8kFkTLUo+a2jwOFkuqb3yucU0CANcRRUbxS0cP0nZYCGjcc3BNXwRIsUVmDGgzawme7zvJHvg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/wrappy": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
      "integrity": "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==",
      "license": "ISC"
    },
    "node_modules/write-file-atomic": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/write-file-atomic/-/write-file-atomic-5.0.1.tgz",
      "integrity": "sha512-+QU2zd6OTD8XWIJCbffaiQeH9U73qIqafo1x6V1snCWYGJf6cVE0cDR4D8xRzcEnfI21IFrUPzPGtcPf8AC+Rw==",
      "dev": true,
      "license": "ISC",
      "peer": true,
      "dependencies": {
        "imurmurhash": "^0.1.4",
        "signal-exit": "^4.0.1"
      },
      "engines": {
        "node": "^14.17.0 || ^16.13.0 || >=18.0.0"
      }
    },
    "node_modules/ws": {
      "version": "8.18.3",
      "resolved": "https://registry.npmjs.org/ws/-/ws-8.18.3.tgz",
      "integrity": "sha512-PEIGCY5tSlUt50cqyMXfCzX+oOPqN0vuGqWzbcJ2xvnkzkq46oOpz7dQaTDBdfICb4N14+GARUDw2XV2N4tvzg==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      },
      "peerDependencies": {
        "bufferutil": "^4.0.1",
        "utf-8-validate": ">=5.0.2"
      },
      "peerDependenciesMeta": {
        "bufferutil": {
          "optional": true
        },
        "utf-8-validate": {
          "optional": true
        }
      }
    },
    "node_modules/y18n": {
      "version": "5.0.8",
      "resolved": "https://registry.npmjs.org/y18n/-/y18n-5.0.8.tgz",
      "integrity": "sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==",
      "license": "ISC",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true,
      "license": "ISC",
      "peer": true
    },
    "node_modules/yargs": {
      "version": "17.7.2",
      "resolved": "https://registry.npmjs.org/yargs/-/yargs-17.7.2.tgz",
      "integrity": "sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==",
      "license": "MIT",
      "dependencies": {
        "cliui": "^8.0.1",
        "escalade": "^3.1.1",
        "get-caller-file": "^2.0.5",
        "require-directory": "^2.1.1",
        "string-width": "^4.2.3",
        "y18n": "^5.0.5",
        "yargs-parser": "^21.1.1"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/yargs-parser": {
      "version": "21.1.1",
      "resolved": "https://registry.npmjs.org/yargs-parser/-/yargs-parser-21.1.1.tgz",
      "integrity": "sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/yargs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yargs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "license": "MIT"
    },
    "node_modules/yargs/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "license": "MIT",
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yargs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "license": "MIT",
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yauzl": {
      "version": "2.10.0",
      "resolved": "https://registry.npmjs.org/yauzl/-/yauzl-2.10.0.tgz",
      "integrity": "sha512-p4a9I6X6nu6IhoGmBqAcbJy1mlC4j27vEPZX9F4L4/vZT3Lyq1VkFHw/V/PUcB9Buo+DG3iHkT0x3Qya58zc3g==",
      "license": "MIT",
      "dependencies": {
        "buffer-crc32": "~0.2.3",
        "fd-slicer": "~1.1.0"
      }
    },
    "node_modules/yocto-queue": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
      "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
      "devOptional": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/zod": {
      "version": "3.25.76",
      "resolved": "https://registry.npmjs.org/zod/-/zod-3.25.76.tgz",
      "integrity": "sha512-gzUt/qt81nXsFGKIFcC3YnfEAx5NkunCfnDlvuBSSFS02bcXu4Lmea0AFIUwbLWxWPx3d9p8S5QoaujKcNQxcQ==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/colinhacks"
      }
    }
  }
}

--- FILE: ./functions/package.json ---
{
  "name": "functions",
  "scripts": {
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "24"
  },
  "main": "lib/index.js",
  "dependencies": {
    "@sparticuz/chromium": "^143.0.0",
    "firebase-admin": "^13.6.0",
    "firebase-functions": "^7.0.0",
    "puppeteer-core": "^24.34.0"
  },
  "devDependencies": {
    "@types/puppeteer": "^5.4.7",
    "firebase-functions-test": "^3.4.1",
    "typescript": "^5.7.3"
  },
  "private": true
}

--- FILE: ./functions/lib/index.js ---
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.syncTeamRoster = void 0;
const scheduler_1 = require("firebase-functions/v2/scheduler");
const params_1 = require("firebase-functions/params");
const admin = __importStar(require("firebase-admin"));
const puppeteer = __importStar(require("puppeteer-core"));
const chromium_1 = __importDefault(require("@sparticuz/chromium"));
admin.initializeApp();
const db = admin.firestore();
const lifelenzEmail = (0, params_1.defineSecret)("LIFELENZ_EMAIL");
const lifelenzPassword = (0, params_1.defineSecret)("LIFELENZ_PASSWORD");
exports.syncTeamRoster = (0, scheduler_1.onSchedule)({
    schedule: "0 6 * * *",
    timeZone: "America/New_York",
    timeoutSeconds: 300,
    memory: "2GiB",
    secrets: [lifelenzEmail, lifelenzPassword],
}, async (event) => {
    console.log("🚀 Starting LifeLenz Scraper V7 (Unassigned Default)...");
    let browser = null;
    let scrapedData = [];
    let logStatus = "SUCCESS";
    let logMessage = "";
    try {
        console.log("1. Configuring Chromium...");
        chromium_1.default.setGraphicsMode = false;
        console.log("2. Launching Browser...");
        browser = await puppeteer.launch({
            args: [
                ...chromium_1.default.args,
                "--disable-gpu",
                "--disable-dev-shm-usage",
                "--disable-setuid-sandbox",
                "--no-sandbox",
                "--no-zygote"
            ],
            defaultViewport: {
                width: 1920,
                height: 1080
            },
            executablePath: await chromium_1.default.executablePath(),
            headless: true,
        });
        const page = await browser.newPage();
        await page.setUserAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36');
        console.log("4. Navigating to Login Page...");
        await page.goto("https://admin.lifelenz.com/us01/auth/login", {
            waitUntil: "networkidle2",
            timeout: 60000
        });
        console.log("5. Waiting for Email Input...");
        await page.waitForSelector('#email', { timeout: 10000 });
        console.log("6. Typing Credentials...");
        await page.type("#email", lifelenzEmail.value());
        await page.type("#password", lifelenzPassword.value());
        console.log("7. Clicking Submit...");
        await Promise.all([
            page.waitForNavigation({ waitUntil: "networkidle2", timeout: 60000 }),
            page.click('button[type="submit"]'),
        ]);
        console.log("8. Login Successful.");
        // --- LISTENER SETUP ---
        page.on("response", async (response) => {
            var _a, _b;
            const url = response.url();
            if (url.includes("manager/graphql")) {
                try {
                    const json = await response.json();
                    if ((_b = (_a = json.data) === null || _a === void 0 ? void 0 : _a.employmentsInScheduleTimeRange) === null || _b === void 0 ? void 0 : _b.edges) {
                        console.log("🎯 TARGET DATA STREAM DETECTED!");
                        const newRows = json.data.employmentsInScheduleTimeRange.edges
                            .map((edge) => {
                            const node = edge.node;
                            if (node.currentStatus && node.currentStatus.toLowerCase().includes("terminated")) {
                                return null;
                            }
                            return {
                                id: node.userId || node.id,
                                name: node.computedName,
                                email: node.email || "",
                                // Default values for NEW users only
                                role: "Team Member",
                                status: "Onboarding",
                                // UPDATED: Default to "Unassigned" so you can set it manually in the app
                                dept: "Unassigned",
                                joined: node.duringFrom,
                                image: node.image || "",
                                stats: { speed: 50, accuracy: 50, hospitality: 50, knowledge: 50, leadership: 50 },
                                progress: 0
                            };
                        })
                            .filter((e) => e !== null);
                        scrapedData = [...scrapedData, ...newRows];
                    }
                }
                catch (err) {
                    // Ignore JSON parse errors
                }
            }
        });
        console.log("9. Navigating to Specific Schedule View...");
        const targetUrl = "https://admin.lifelenz.com/us02/schedule/week/f3f058e6-5679-40a7-aed1-6b192897d683/1583007f-55ff-4e69-abc2-b4a053a728ca";
        await page.goto(targetUrl, { waitUntil: "networkidle2", timeout: 60000 });
        console.log("10. Waiting for Data Stream (15 seconds)...");
        await new Promise((resolve) => setTimeout(resolve, 15000));
    }
    catch (error) {
        console.error("❌ CRITICAL SCRAPER ERROR:", error);
        logStatus = "ERROR";
        logMessage = error.message || "Unknown error occurred";
    }
    finally {
        if (browser)
            await browser.close();
    }
    // --- SYNC ---
    if (scrapedData.length > 0) {
        console.log(`📦 Processing ${scrapedData.length} users for Firestore...`);
        const snapshot = await db.collection("teamMembers").get();
        const existingIds = new Set(snapshot.docs.map(doc => doc.id));
        const batch = db.batch();
        let count = 0;
        let newCount = 0;
        for (const member of scrapedData) {
            if (!member.email)
                continue;
            const docRef = db.collection("teamMembers").doc(member.id);
            if (existingIds.has(member.id)) {
                // EXISTING USER:
                // Only update immutable profile data (Name, Email, Join Date)
                // WE DO NOT UPDATE 'dept', 'role', or 'status' so your manual changes stick.
                batch.set(docRef, {
                    name: member.name,
                    email: member.email,
                    joined: member.joined,
                    ...(member.image ? { image: member.image } : {}),
                    updatedAt: admin.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
            }
            else {
                // NEW USER: Create with default "Unassigned"
                console.log(`✨ New Hire Detected: ${member.name}`);
                newCount++;
                batch.set(docRef, {
                    ...member,
                    updatedAt: admin.firestore.FieldValue.serverTimestamp()
                });
            }
            count++;
            if (count >= 400) {
                await batch.commit();
                count = 0;
            }
        }
        if (count > 0)
            await batch.commit();
        console.log("✅ Sync Complete.");
        logMessage = `Sync Complete. Processed ${scrapedData.length} records. ${newCount} new hires added.`;
    }
    else if (logStatus === "SUCCESS") {
        logStatus = "WARNING";
        logMessage = "Scraper ran but found 0 records.";
    }
    // --- WRITE LOG TO FIRESTORE ---
    await db.collection("systemLogs").add({
        source: "LifeLenz Scraper",
        status: logStatus,
        message: logMessage,
        timestamp: admin.firestore.FieldValue.serverTimestamp()
    });
    console.log("✅ Log Entry Created.");
});
//# sourceMappingURL=index.js.map
--- FILE: ./functions/tsconfig.json ---
{
  "compilerOptions": {
    "module": "commonjs",
    "noImplicitReturns": true,
    "noUnusedLocals": true,
    "outDir": "lib",
    "sourceMap": true,
    "strict": true,
    "target": "es2018",
    "lib": ["es2018", "dom"],
    "skipLibCheck": true,
    "esModuleInterop": true
  },
  "compileOnSave": true,
  "include": [
    "src"
  ]
}
--- FILE: ./functions/src/index.ts ---
import { onSchedule } from "firebase-functions/v2/scheduler";
import { defineSecret } from "firebase-functions/params";
import * as admin from "firebase-admin";
import * as puppeteer from "puppeteer-core";
import chromium from "@sparticuz/chromium";

admin.initializeApp();
const db = admin.firestore();

const lifelenzEmail = defineSecret("LIFELENZ_EMAIL");
const lifelenzPassword = defineSecret("LIFELENZ_PASSWORD");

export const syncTeamRoster = onSchedule(
  {
    schedule: "0 6 * * *",
    timeZone: "America/New_York",
    timeoutSeconds: 300, 
    memory: "2GiB",      
    secrets: [lifelenzEmail, lifelenzPassword],
  },
  async (event) => {
    console.log("🚀 Starting LifeLenz Scraper V7 (Unassigned Default)...");

    let browser = null;
    let scrapedData: any[] = [];
    let logStatus = "SUCCESS";
    let logMessage = "";

    try {
      console.log("1. Configuring Chromium...");
      chromium.setGraphicsMode = false;
      
      console.log("2. Launching Browser...");
      browser = await puppeteer.launch({
        args: [
            ...chromium.args,
            "--disable-gpu",
            "--disable-dev-shm-usage",
            "--disable-setuid-sandbox",
            "--no-sandbox",
            "--no-zygote"
        ],
        defaultViewport: {
            width: 1920,
            height: 1080
        },
        executablePath: await chromium.executablePath(),
        headless: true, 
      });

      const page = await browser.newPage();
      
      await page.setUserAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36');

      console.log("4. Navigating to Login Page...");
      await page.goto("https://admin.lifelenz.com/us01/auth/login", { 
          waitUntil: "networkidle2",
          timeout: 60000 
      });

      console.log("5. Waiting for Email Input...");
      await page.waitForSelector('#email', { timeout: 10000 });

      console.log("6. Typing Credentials...");
      await page.type("#email", lifelenzEmail.value());
      await page.type("#password", lifelenzPassword.value());

      console.log("7. Clicking Submit...");
      await Promise.all([
          page.waitForNavigation({ waitUntil: "networkidle2", timeout: 60000 }),
          page.click('button[type="submit"]'),
      ]);
      
      console.log("8. Login Successful.");

      // --- LISTENER SETUP ---
      page.on("response", async (response) => {
        const url = response.url();
        
        if (url.includes("manager/graphql")) {
            try {
                const json = await response.json();
                
                if (json.data?.employmentsInScheduleTimeRange?.edges) {
                    console.log("🎯 TARGET DATA STREAM DETECTED!");
                    
                    const newRows = json.data.employmentsInScheduleTimeRange.edges
                        .map((edge: any) => {
                            const node = edge.node;
                            
                            if (node.currentStatus && node.currentStatus.toLowerCase().includes("terminated")) {
                                return null;
                            }

                            return {
                                id: node.userId || node.id,
                                name: node.computedName,
                                email: node.email || "",
                                // Default values for NEW users only
                                role: "Team Member",
                                status: "Onboarding", 
                                // UPDATED: Default to "Unassigned" so you can set it manually in the app
                                dept: "Unassigned", 
                                joined: node.duringFrom,
                                image: node.image || "",
                                stats: { speed: 50, accuracy: 50, hospitality: 50, knowledge: 50, leadership: 50 },
                                progress: 0
                            };
                        })
                        .filter((e: any) => e !== null);
                        
                    scrapedData = [...scrapedData, ...newRows];
                }
            } catch (err) {
                // Ignore JSON parse errors
            }
        }
      });

      console.log("9. Navigating to Specific Schedule View...");
      const targetUrl = "https://admin.lifelenz.com/us02/schedule/week/f3f058e6-5679-40a7-aed1-6b192897d683/1583007f-55ff-4e69-abc2-b4a053a728ca";
      
      await page.goto(targetUrl, { waitUntil: "networkidle2", timeout: 60000 });
      
      console.log("10. Waiting for Data Stream (15 seconds)...");
      await new Promise((resolve) => setTimeout(resolve, 15000));

    } catch (error: any) {
      console.error("❌ CRITICAL SCRAPER ERROR:", error);
      logStatus = "ERROR";
      logMessage = error.message || "Unknown error occurred";
    } finally {
      if (browser) await browser.close();
    }

    // --- SYNC ---
    if (scrapedData.length > 0) {
      console.log(`📦 Processing ${scrapedData.length} users for Firestore...`);
      
      const snapshot = await db.collection("teamMembers").get();
      const existingIds = new Set(snapshot.docs.map(doc => doc.id));

      const batch = db.batch();
      let count = 0;
      let newCount = 0;

      for (const member of scrapedData) {
        if (!member.email) continue;
        const docRef = db.collection("teamMembers").doc(member.id);

        if (existingIds.has(member.id)) {
            // EXISTING USER:
            // Only update immutable profile data (Name, Email, Join Date)
            // WE DO NOT UPDATE 'dept', 'role', or 'status' so your manual changes stick.
            batch.set(docRef, {
                name: member.name,
                email: member.email,
                joined: member.joined,
                ...(member.image ? { image: member.image } : {}),
                updatedAt: admin.firestore.FieldValue.serverTimestamp()
            }, { merge: true });
        } else {
            // NEW USER: Create with default "Unassigned"
            console.log(`✨ New Hire Detected: ${member.name}`);
            newCount++;
            batch.set(docRef, {
                ...member,
                updatedAt: admin.firestore.FieldValue.serverTimestamp()
            });
        }
        
        count++;
        if (count >= 400) { await batch.commit(); count = 0; }
      }
      
      if (count > 0) await batch.commit();
      console.log("✅ Sync Complete.");
      
      logMessage = `Sync Complete. Processed ${scrapedData.length} records. ${newCount} new hires added.`;
    } else if (logStatus === "SUCCESS") {
      logStatus = "WARNING";
      logMessage = "Scraper ran but found 0 records.";
    }

    // --- WRITE LOG TO FIRESTORE ---
    await db.collection("systemLogs").add({
        source: "LifeLenz Scraper",
        status: logStatus,
        message: logMessage,
        timestamp: admin.firestore.FieldValue.serverTimestamp()
    });

    console.log("✅ Log Entry Created.");
  }
);
--- FILE: ./tsconfig.json ---
{
  "compilerOptions": {
    "target": "es5",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": [
        "./*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts"
  ],
  "exclude": [
    "node_modules",
    "functions"
  ]
}

--- FILE: ./firebase.json ---
{
  "functions": [
    {
      "source": "functions",
      "codebase": "default",
      "disallowLegacyRuntimeConfig": true,
      "ignore": [
        "node_modules",
        ".git",
        "firebase-debug.log",
        "firebase-debug.*.log",
        "*.local"
      ],
      "predeploy": [
        "npm --prefix \"$RESOURCE_DIR\" run build"
      ]
    }
  ]
}

--- FILE: ./eslint.config.mjs ---
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
    // Ignore Firebase Functions code
    "functions/**"
  ]),
]);

export default eslintConfig;
--- FILE: ./next.config.ts ---
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'firebasestorage.googleapis.com',
        port: '',
        pathname: '/**',
      },
    ],
  },
};

export default nextConfig;
